
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.polydiv</title>
<meta name="description" content="Documentation of Coq module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.polydiv" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="rocqnavi.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="rocqnavi.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="Corelib"><summary>Corelib</summary>
          <ul>
          <li><details id="Corelib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Corelib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Corelib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Corelib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Corelib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Corelib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Corelib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Corelib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Corelib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Corelib.Classes.Init.html">Init</a></li>
<li><a href="Corelib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Corelib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Corelib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Corelib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Corelib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Corelib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Corelib.Compat.Coq820.html">Coq820</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Corelib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Corelib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Corelib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Corelib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Corelib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Corelib.Init.Byte.html">Byte</a></li>
<li><a href="Corelib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Corelib.Init.Decimal.html">Decimal</a></li>
<li><a href="Corelib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Corelib.Init.Logic.html">Logic</a></li>
<li><a href="Corelib.Init.Ltac.html">Ltac</a></li>
<li><a href="Corelib.Init.Nat.html">Nat</a></li>
<li><a href="Corelib.Init.Notations.html">Notations</a></li>
<li><a href="Corelib.Init.Number.html">Number</a></li>
<li><a href="Corelib.Init.Peano.html">Peano</a></li>
<li><a href="Corelib.Init.Prelude.html">Prelude</a></li>
<li><a href="Corelib.Init.Specif.html">Specif</a></li>
<li><a href="Corelib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Corelib.Init.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Init.Tauto.html">Tauto</a></li>
<li><a href="Corelib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Corelib.Lists.ListDef.html">ListDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Corelib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Corelib.Numbers.BinNums.html">BinNums</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Corelib.Program.Basics.html">Basics</a></li>
<li><a href="Corelib.Program.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Program.Utils.html">Utils</a></li>
<li><a href="Corelib.Program.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Corelib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Corelib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Corelib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Corelib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Corelib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Corelib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Corelib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Corelib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Corelib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Corelib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Corelib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Corelib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Corelib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Corelib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Corelib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="HB"><summary>HB</summary>
          <ul>
          <li><a href="HB.structures.html">structures</a></li>
          </ul>
          </details>
          </li>
<li><details id="Ltac2"><summary>Ltac2</summary>
          <ul>
          <li><details id="Ltac2.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Ltac2.Compat.Coq818.html">Coq818</a></li>
<li><a href="Ltac2.Compat.Coq819.html">Coq819</a></li>
          </ul>
          </details>
          </li>
<li><a href="Ltac2.Array.html">Array</a></li>
<li><a href="Ltac2.Bool.html">Bool</a></li>
<li><a href="Ltac2.Char.html">Char</a></li>
<li><a href="Ltac2.Constant.html">Constant</a></li>
<li><a href="Ltac2.Constr.html">Constr</a></li>
<li><a href="Ltac2.Constructor.html">Constructor</a></li>
<li><a href="Ltac2.Control.html">Control</a></li>
<li><a href="Ltac2.Env.html">Env</a></li>
<li><a href="Ltac2.Evar.html">Evar</a></li>
<li><a href="Ltac2.FMap.html">FMap</a></li>
<li><a href="Ltac2.FSet.html">FSet</a></li>
<li><a href="Ltac2.Float.html">Float</a></li>
<li><a href="Ltac2.Fresh.html">Fresh</a></li>
<li><a href="Ltac2.Ident.html">Ident</a></li>
<li><a href="Ltac2.Ind.html">Ind</a></li>
<li><a href="Ltac2.Init.html">Init</a></li>
<li><a href="Ltac2.Int.html">Int</a></li>
<li><a href="Ltac2.Lazy.html">Lazy</a></li>
<li><a href="Ltac2.List.html">List</a></li>
<li><a href="Ltac2.Ltac1.html">Ltac1</a></li>
<li><a href="Ltac2.Ltac2.html">Ltac2</a></li>
<li><a href="Ltac2.Message.html">Message</a></li>
<li><a href="Ltac2.Meta.html">Meta</a></li>
<li><a href="Ltac2.Notations.html">Notations</a></li>
<li><a href="Ltac2.Option.html">Option</a></li>
<li><a href="Ltac2.Pattern.html">Pattern</a></li>
<li><a href="Ltac2.Printf.html">Printf</a></li>
<li><a href="Ltac2.Proj.html">Proj</a></li>
<li><a href="Ltac2.Pstring.html">Pstring</a></li>
<li><a href="Ltac2.RedFlags.html">RedFlags</a></li>
<li><a href="Ltac2.Ref.html">Ref</a></li>
<li><a href="Ltac2.Std.html">Std</a></li>
<li><a href="Ltac2.String.html">String</a></li>
<li><a href="Ltac2.TransparentState.html">TransparentState</a></li>
<li><a href="Ltac2.Uint63.html">Uint63</a></li>
<li><a href="Ltac2.Unification.html">Unification</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib"><summary>Stdlib</summary>
          <ul>
          <li><details id="Stdlib.All"><summary>All</summary>
          <ul>
          <li><a href="Stdlib.All.All.html">All</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Arith"><summary>Arith</summary>
          <ul>
          <li><a href="Stdlib.Arith.Arith.html">Arith</a></li>
<li><a href="Stdlib.Arith.Arith_base.html">Arith_base</a></li>
<li><a href="Stdlib.Arith.Between.html">Between</a></li>
<li><a href="Stdlib.Arith.Bool_nat.html">Bool_nat</a></li>
<li><a href="Stdlib.Arith.Cantor.html">Cantor</a></li>
<li><a href="Stdlib.Arith.Compare.html">Compare</a></li>
<li><a href="Stdlib.Arith.Compare_dec.html">Compare_dec</a></li>
<li><a href="Stdlib.Arith.EqNat.html">EqNat</a></li>
<li><a href="Stdlib.Arith.Euclid.html">Euclid</a></li>
<li><a href="Stdlib.Arith.Factorial.html">Factorial</a></li>
<li><a href="Stdlib.Arith.PeanoNat.html">PeanoNat</a></li>
<li><a href="Stdlib.Arith.Peano_dec.html">Peano_dec</a></li>
<li><a href="Stdlib.Arith.Wf_nat.html">Wf_nat</a></li>
<li><a href="Stdlib.Arith.Zerob.html">Zerob</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Stdlib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Stdlib.Array.PArray.html">PArray</a></li>
<li><a href="Stdlib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Stdlib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Stdlib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Stdlib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Bool"><summary>Bool</summary>
          <ul>
          <li><a href="Stdlib.Bool.Bool.html">Bool</a></li>
<li><a href="Stdlib.Bool.BoolEq.html">BoolEq</a></li>
<li><a href="Stdlib.Bool.DecBool.html">DecBool</a></li>
<li><a href="Stdlib.Bool.IfProp.html">IfProp</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Stdlib.Classes.CEquivalence.html">CEquivalence</a></li>
<li><a href="Stdlib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Stdlib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Stdlib.Classes.DecidableClass.html">DecidableClass</a></li>
<li><a href="Stdlib.Classes.EquivDec.html">EquivDec</a></li>
<li><a href="Stdlib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Stdlib.Classes.Init.html">Init</a></li>
<li><a href="Stdlib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Stdlib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Stdlib.Classes.Morphisms_Relations.html">Morphisms_Relations</a></li>
<li><a href="Stdlib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Stdlib.Classes.RelationPairs.html">RelationPairs</a></li>
<li><a href="Stdlib.Classes.SetoidClass.html">SetoidClass</a></li>
<li><a href="Stdlib.Classes.SetoidDec.html">SetoidDec</a></li>
<li><a href="Stdlib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Stdlib.Compat.AdmitAxiom.html">AdmitAxiom</a></li>
<li><a href="Stdlib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Stdlib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Stdlib.Compat.Coq820.html">Coq820</a></li>
<li><a href="Stdlib.Compat.Stdlib818.html">Stdlib818</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.FSets"><summary>FSets</summary>
          <ul>
          <li><a href="Stdlib.FSets.FMapAVL.html">FMapAVL</a></li>
<li><a href="Stdlib.FSets.FMapFacts.html">FMapFacts</a></li>
<li><a href="Stdlib.FSets.FMapFullAVL.html">FMapFullAVL</a></li>
<li><a href="Stdlib.FSets.FMapInterface.html">FMapInterface</a></li>
<li><a href="Stdlib.FSets.FMapList.html">FMapList</a></li>
<li><a href="Stdlib.FSets.FMapPositive.html">FMapPositive</a></li>
<li><a href="Stdlib.FSets.FMapWeakList.html">FMapWeakList</a></li>
<li><a href="Stdlib.FSets.FMaps.html">FMaps</a></li>
<li><a href="Stdlib.FSets.FSetAVL.html">FSetAVL</a></li>
<li><a href="Stdlib.FSets.FSetBridge.html">FSetBridge</a></li>
<li><a href="Stdlib.FSets.FSetCompat.html">FSetCompat</a></li>
<li><a href="Stdlib.FSets.FSetDecide.html">FSetDecide</a></li>
<li><a href="Stdlib.FSets.FSetEqProperties.html">FSetEqProperties</a></li>
<li><a href="Stdlib.FSets.FSetFacts.html">FSetFacts</a></li>
<li><a href="Stdlib.FSets.FSetInterface.html">FSetInterface</a></li>
<li><a href="Stdlib.FSets.FSetList.html">FSetList</a></li>
<li><a href="Stdlib.FSets.FSetPositive.html">FSetPositive</a></li>
<li><a href="Stdlib.FSets.FSetProperties.html">FSetProperties</a></li>
<li><a href="Stdlib.FSets.FSetToFiniteSet.html">FSetToFiniteSet</a></li>
<li><a href="Stdlib.FSets.FSetWeakList.html">FSetWeakList</a></li>
<li><a href="Stdlib.FSets.FSets.html">FSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Stdlib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Stdlib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Stdlib.Floats.FloatLemmas.html">FloatLemmas</a></li>
<li><a href="Stdlib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Stdlib.Floats.Floats.html">Floats</a></li>
<li><a href="Stdlib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Stdlib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Stdlib.Init.Byte.html">Byte</a></li>
<li><a href="Stdlib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Stdlib.Init.Decimal.html">Decimal</a></li>
<li><a href="Stdlib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Stdlib.Init.Logic.html">Logic</a></li>
<li><a href="Stdlib.Init.Ltac.html">Ltac</a></li>
<li><a href="Stdlib.Init.Nat.html">Nat</a></li>
<li><a href="Stdlib.Init.Notations.html">Notations</a></li>
<li><a href="Stdlib.Init.Number.html">Number</a></li>
<li><a href="Stdlib.Init.Peano.html">Peano</a></li>
<li><a href="Stdlib.Init.Prelude.html">Prelude</a></li>
<li><a href="Stdlib.Init.Specif.html">Specif</a></li>
<li><a href="Stdlib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Stdlib.Init.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Init.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Stdlib.Lists.List.html">List</a></li>
<li><a href="Stdlib.Lists.ListDec.html">ListDec</a></li>
<li><a href="Stdlib.Lists.ListDef.html">ListDef</a></li>
<li><a href="Stdlib.Lists.ListSet.html">ListSet</a></li>
<li><a href="Stdlib.Lists.ListTactics.html">ListTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Logic"><summary>Logic</summary>
          <ul>
          <li><a href="Stdlib.Logic.Adjointification.html">Adjointification</a></li>
<li><a href="Stdlib.Logic.Berardi.html">Berardi</a></li>
<li><a href="Stdlib.Logic.ChoiceFacts.html">ChoiceFacts</a></li>
<li><a href="Stdlib.Logic.Classical.html">Classical</a></li>
<li><a href="Stdlib.Logic.ClassicalChoice.html">ClassicalChoice</a></li>
<li><a href="Stdlib.Logic.ClassicalDescription.html">ClassicalDescription</a></li>
<li><a href="Stdlib.Logic.ClassicalEpsilon.html">ClassicalEpsilon</a></li>
<li><a href="Stdlib.Logic.ClassicalFacts.html">ClassicalFacts</a></li>
<li><a href="Stdlib.Logic.ClassicalUniqueChoice.html">ClassicalUniqueChoice</a></li>
<li><a href="Stdlib.Logic.Classical_Pred_Type.html">Classical_Pred_Type</a></li>
<li><a href="Stdlib.Logic.Classical_Prop.html">Classical_Prop</a></li>
<li><a href="Stdlib.Logic.ConstructiveEpsilon.html">ConstructiveEpsilon</a></li>
<li><a href="Stdlib.Logic.Decidable.html">Decidable</a></li>
<li><a href="Stdlib.Logic.Description.html">Description</a></li>
<li><a href="Stdlib.Logic.Diaconescu.html">Diaconescu</a></li>
<li><a href="Stdlib.Logic.Epsilon.html">Epsilon</a></li>
<li><a href="Stdlib.Logic.Eqdep.html">Eqdep</a></li>
<li><a href="Stdlib.Logic.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="Stdlib.Logic.Eqdep_dec.html">Eqdep_dec</a></li>
<li><a href="Stdlib.Logic.ExtensionalFunctionRepresentative.html">ExtensionalFunctionRepresentative</a></li>
<li><a href="Stdlib.Logic.ExtensionalityFacts.html">ExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></li>
<li><a href="Stdlib.Logic.HLevels.html">HLevels</a></li>
<li><a href="Stdlib.Logic.Hurkens.html">Hurkens</a></li>
<li><a href="Stdlib.Logic.IndefiniteDescription.html">IndefiniteDescription</a></li>
<li><a href="Stdlib.Logic.JMeq.html">JMeq</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevance.html">ProofIrrelevance</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevanceFacts.html">ProofIrrelevanceFacts</a></li>
<li><a href="Stdlib.Logic.PropExtensionality.html">PropExtensionality</a></li>
<li><a href="Stdlib.Logic.PropExtensionalityFacts.html">PropExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.PropFacts.html">PropFacts</a></li>
<li><a href="Stdlib.Logic.RelationalChoice.html">RelationalChoice</a></li>
<li><a href="Stdlib.Logic.SetIsType.html">SetIsType</a></li>
<li><a href="Stdlib.Logic.SetoidChoice.html">SetoidChoice</a></li>
<li><a href="Stdlib.Logic.StrictProp.html">StrictProp</a></li>
<li><a href="Stdlib.Logic.WKL.html">WKL</a></li>
<li><a href="Stdlib.Logic.WeakFan.html">WeakFan</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.MSets"><summary>MSets</summary>
          <ul>
          <li><a href="Stdlib.MSets.MSetAVL.html">MSetAVL</a></li>
<li><a href="Stdlib.MSets.MSetDecide.html">MSetDecide</a></li>
<li><a href="Stdlib.MSets.MSetEqProperties.html">MSetEqProperties</a></li>
<li><a href="Stdlib.MSets.MSetFacts.html">MSetFacts</a></li>
<li><a href="Stdlib.MSets.MSetGenTree.html">MSetGenTree</a></li>
<li><a href="Stdlib.MSets.MSetInterface.html">MSetInterface</a></li>
<li><a href="Stdlib.MSets.MSetList.html">MSetList</a></li>
<li><a href="Stdlib.MSets.MSetPositive.html">MSetPositive</a></li>
<li><a href="Stdlib.MSets.MSetProperties.html">MSetProperties</a></li>
<li><a href="Stdlib.MSets.MSetRBT.html">MSetRBT</a></li>
<li><a href="Stdlib.MSets.MSetToFiniteSet.html">MSetToFiniteSet</a></li>
<li><a href="Stdlib.MSets.MSetWeakList.html">MSetWeakList</a></li>
<li><a href="Stdlib.MSets.MSets.html">MSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.NArith"><summary>NArith</summary>
          <ul>
          <li><a href="Stdlib.NArith.BinNat.html">BinNat</a></li>
<li><a href="Stdlib.NArith.BinNatDef.html">BinNatDef</a></li>
<li><a href="Stdlib.NArith.NArith.html">NArith</a></li>
<li><a href="Stdlib.NArith.NArith_base.html">NArith_base</a></li>
<li><a href="Stdlib.NArith.Ndec.html">Ndec</a></li>
<li><a href="Stdlib.NArith.Ndiv_def.html">Ndiv_def</a></li>
<li><a href="Stdlib.NArith.Ngcd_def.html">Ngcd_def</a></li>
<li><a href="Stdlib.NArith.Nnat.html">Nnat</a></li>
<li><a href="Stdlib.NArith.Nsqrt_def.html">Nsqrt_def</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Abstract.CyclicAxioms.html">CyclicAxioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.DoubleType.html">DoubleType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.NZCyclic.html">NZCyclic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Cyclic63.html">Cyclic63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Ring63.html">Ring63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63.html">Sint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63.html">Uint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer"><summary>Integer</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Integer.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Abstract.ZAdd.html">ZAdd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAddOrder.html">ZAddOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAxioms.html">ZAxioms</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBase.html">ZBase</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBits.html">ZBits</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivEucl.html">ZDivEucl</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivFloor.html">ZDivFloor</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivTrunc.html">ZDivTrunc</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZGcd.html">ZGcd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLcm.html">ZLcm</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLt.html">ZLt</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMaxMin.html">ZMaxMin</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMul.html">ZMul</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMulOrder.html">ZMulOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZParity.html">ZParity</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZPow.html">ZPow</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZProperties.html">ZProperties</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZSgnAbs.html">ZSgnAbs</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Binary.ZBinary.html">ZBinary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.NatPairs"><summary>NatPairs</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.NatPairs.ZNatPairs.html">ZNatPairs</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.NatInt"><summary>NatInt</summary>
          <ul>
          <li><a href="Stdlib.Numbers.NatInt.NZAdd.html">NZAdd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAddOrder.html">NZAddOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAxioms.html">NZAxioms</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBase.html">NZBase</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBits.html">NZBits</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDiv.html">NZDiv</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDomain.html">NZDomain</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZGcd.html">NZGcd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZLog.html">NZLog</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMul.html">NZMul</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMulOrder.html">NZMulOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZOrder.html">NZOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZParity.html">NZParity</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZPow.html">NZPow</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZProperties.html">NZProperties</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZSqrt.html">NZSqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural"><summary>Natural</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Natural.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Abstract.NAdd.html">NAdd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAddOrder.html">NAddOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAxioms.html">NAxioms</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBase.html">NBase</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBits.html">NBits</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDefOps.html">NDefOps</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv.html">NDiv</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv0.html">NDiv0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NGcd.html">NGcd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NIso.html">NIso</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm.html">NLcm</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm0.html">NLcm0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLog.html">NLog</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMaxMin.html">NMaxMin</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMulOrder.html">NMulOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NOrder.html">NOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NParity.html">NParity</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NPow.html">NPow</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NProperties.html">NProperties</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSqrt.html">NSqrt</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NStrongRec.html">NStrongRec</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSub.html">NSub</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Binary.NBinary.html">NBinary</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Numbers.AltBinNotations.html">AltBinNotations</a></li>
<li><a href="Stdlib.Numbers.BinNums.html">BinNums</a></li>
<li><a href="Stdlib.Numbers.DecimalFacts.html">DecimalFacts</a></li>
<li><a href="Stdlib.Numbers.DecimalN.html">DecimalN</a></li>
<li><a href="Stdlib.Numbers.DecimalNat.html">DecimalNat</a></li>
<li><a href="Stdlib.Numbers.DecimalPos.html">DecimalPos</a></li>
<li><a href="Stdlib.Numbers.DecimalQ.html">DecimalQ</a></li>
<li><a href="Stdlib.Numbers.DecimalR.html">DecimalR</a></li>
<li><a href="Stdlib.Numbers.DecimalString.html">DecimalString</a></li>
<li><a href="Stdlib.Numbers.DecimalZ.html">DecimalZ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalFacts.html">HexadecimalFacts</a></li>
<li><a href="Stdlib.Numbers.HexadecimalN.html">HexadecimalN</a></li>
<li><a href="Stdlib.Numbers.HexadecimalNat.html">HexadecimalNat</a></li>
<li><a href="Stdlib.Numbers.HexadecimalPos.html">HexadecimalPos</a></li>
<li><a href="Stdlib.Numbers.HexadecimalQ.html">HexadecimalQ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalR.html">HexadecimalR</a></li>
<li><a href="Stdlib.Numbers.HexadecimalString.html">HexadecimalString</a></li>
<li><a href="Stdlib.Numbers.HexadecimalZ.html">HexadecimalZ</a></li>
<li><a href="Stdlib.Numbers.NaryFunctions.html">NaryFunctions</a></li>
<li><a href="Stdlib.Numbers.NumPrelude.html">NumPrelude</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.PArith"><summary>PArith</summary>
          <ul>
          <li><a href="Stdlib.PArith.BinPos.html">BinPos</a></li>
<li><a href="Stdlib.PArith.BinPosDef.html">BinPosDef</a></li>
<li><a href="Stdlib.PArith.PArith.html">PArith</a></li>
<li><a href="Stdlib.PArith.POrderedType.html">POrderedType</a></li>
<li><a href="Stdlib.PArith.Pnat.html">Pnat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Stdlib.Program.Basics.html">Basics</a></li>
<li><a href="Stdlib.Program.Combinators.html">Combinators</a></li>
<li><a href="Stdlib.Program.Equality.html">Equality</a></li>
<li><a href="Stdlib.Program.Program.html">Program</a></li>
<li><a href="Stdlib.Program.Subset.html">Subset</a></li>
<li><a href="Stdlib.Program.Syntax.html">Syntax</a></li>
<li><a href="Stdlib.Program.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Program.Utils.html">Utils</a></li>
<li><a href="Stdlib.Program.Wf.html">Wf</a></li>
<li><a href="Stdlib.Program.WfExtensionality.html">WfExtensionality</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.QArith"><summary>QArith</summary>
          <ul>
          <li><a href="Stdlib.QArith.QArith.html">QArith</a></li>
<li><a href="Stdlib.QArith.QArith_base.html">QArith_base</a></li>
<li><a href="Stdlib.QArith.QOrderedType.html">QOrderedType</a></li>
<li><a href="Stdlib.QArith.Qabs.html">Qabs</a></li>
<li><a href="Stdlib.QArith.Qcabs.html">Qcabs</a></li>
<li><a href="Stdlib.QArith.Qcanon.html">Qcanon</a></li>
<li><a href="Stdlib.QArith.Qfield.html">Qfield</a></li>
<li><a href="Stdlib.QArith.Qminmax.html">Qminmax</a></li>
<li><a href="Stdlib.QArith.Qpower.html">Qpower</a></li>
<li><a href="Stdlib.QArith.Qreduction.html">Qreduction</a></li>
<li><a href="Stdlib.QArith.Qring.html">Qring</a></li>
<li><a href="Stdlib.QArith.Qround.html">Qround</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals"><summary>Reals</summary>
          <ul>
          <li><details id="Stdlib.Reals.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Reals.Abstract.ConstructiveAbs.html">ConstructiveAbs</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLUB.html">ConstructiveLUB</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLimits.html">ConstructiveLimits</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveMinMax.html">ConstructiveMinMax</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructivePower.html">ConstructivePower</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveReals.html">ConstructiveReals</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveRealsMorphisms.html">ConstructiveRealsMorphisms</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveSum.html">ConstructiveSum</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals.Cauchy"><summary>Cauchy</summary>
          <ul>
          <li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyAbs.html">ConstructiveCauchyAbs</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyReals.html">ConstructiveCauchyReals</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyRealsMult.html">ConstructiveCauchyRealsMult</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveExtra.html">ConstructiveExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveRcomplete.html">ConstructiveRcomplete</a></li>
<li><a href="Stdlib.Reals.Cauchy.PosExtra.html">PosExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.QExtra.html">QExtra</a></li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Reals.Alembert.html">Alembert</a></li>
<li><a href="Stdlib.Reals.AltSeries.html">AltSeries</a></li>
<li><a href="Stdlib.Reals.ArithProp.html">ArithProp</a></li>
<li><a href="Stdlib.Reals.Binomial.html">Binomial</a></li>
<li><a href="Stdlib.Reals.Cauchy_prod.html">Cauchy_prod</a></li>
<li><a href="Stdlib.Reals.ClassicalConstructiveReals.html">ClassicalConstructiveReals</a></li>
<li><a href="Stdlib.Reals.ClassicalDedekindReals.html">ClassicalDedekindReals</a></li>
<li><a href="Stdlib.Reals.Cos_plus.html">Cos_plus</a></li>
<li><a href="Stdlib.Reals.Cos_rel.html">Cos_rel</a></li>
<li><a href="Stdlib.Reals.DiscrR.html">DiscrR</a></li>
<li><a href="Stdlib.Reals.Exp_prop.html">Exp_prop</a></li>
<li><a href="Stdlib.Reals.Integration.html">Integration</a></li>
<li><a href="Stdlib.Reals.MVT.html">MVT</a></li>
<li><a href="Stdlib.Reals.Machin.html">Machin</a></li>
<li><a href="Stdlib.Reals.NewtonInt.html">NewtonInt</a></li>
<li><a href="Stdlib.Reals.Nsatz.html">Nsatz</a></li>
<li><a href="Stdlib.Reals.PSeries_reg.html">PSeries_reg</a></li>
<li><a href="Stdlib.Reals.PartSum.html">PartSum</a></li>
<li><a href="Stdlib.Reals.Qreals.html">Qreals</a></li>
<li><a href="Stdlib.Reals.RIneq.html">RIneq</a></li>
<li><a href="Stdlib.Reals.RList.html">RList</a></li>
<li><a href="Stdlib.Reals.ROrderedType.html">ROrderedType</a></li>
<li><a href="Stdlib.Reals.R_Ifp.html">R_Ifp</a></li>
<li><a href="Stdlib.Reals.R_sqr.html">R_sqr</a></li>
<li><a href="Stdlib.Reals.R_sqrt.html">R_sqrt</a></li>
<li><a href="Stdlib.Reals.Ranalysis.html">Ranalysis</a></li>
<li><a href="Stdlib.Reals.Ranalysis1.html">Ranalysis1</a></li>
<li><a href="Stdlib.Reals.Ranalysis2.html">Ranalysis2</a></li>
<li><a href="Stdlib.Reals.Ranalysis3.html">Ranalysis3</a></li>
<li><a href="Stdlib.Reals.Ranalysis4.html">Ranalysis4</a></li>
<li><a href="Stdlib.Reals.Ranalysis5.html">Ranalysis5</a></li>
<li><a href="Stdlib.Reals.Ranalysis_reg.html">Ranalysis_reg</a></li>
<li><a href="Stdlib.Reals.Ratan.html">Ratan</a></li>
<li><a href="Stdlib.Reals.Raxioms.html">Raxioms</a></li>
<li><a href="Stdlib.Reals.Rbase.html">Rbase</a></li>
<li><a href="Stdlib.Reals.Rbasic_fun.html">Rbasic_fun</a></li>
<li><a href="Stdlib.Reals.Rcomplete.html">Rcomplete</a></li>
<li><a href="Stdlib.Reals.Rdefinitions.html">Rdefinitions</a></li>
<li><a href="Stdlib.Reals.Rderiv.html">Rderiv</a></li>
<li><a href="Stdlib.Reals.Reals.html">Reals</a></li>
<li><a href="Stdlib.Reals.Rfunctions.html">Rfunctions</a></li>
<li><a href="Stdlib.Reals.Rgeom.html">Rgeom</a></li>
<li><a href="Stdlib.Reals.RiemannInt.html">RiemannInt</a></li>
<li><a href="Stdlib.Reals.RiemannInt_SF.html">RiemannInt_SF</a></li>
<li><a href="Stdlib.Reals.Rlimit.html">Rlimit</a></li>
<li><a href="Stdlib.Reals.Rlogic.html">Rlogic</a></li>
<li><a href="Stdlib.Reals.Rminmax.html">Rminmax</a></li>
<li><a href="Stdlib.Reals.Rpow_def.html">Rpow_def</a></li>
<li><a href="Stdlib.Reals.Rpower.html">Rpower</a></li>
<li><a href="Stdlib.Reals.Rprod.html">Rprod</a></li>
<li><a href="Stdlib.Reals.Rregisternames.html">Rregisternames</a></li>
<li><a href="Stdlib.Reals.Rseries.html">Rseries</a></li>
<li><a href="Stdlib.Reals.Rsigma.html">Rsigma</a></li>
<li><a href="Stdlib.Reals.Rsqrt_def.html">Rsqrt_def</a></li>
<li><a href="Stdlib.Reals.Rtopology.html">Rtopology</a></li>
<li><a href="Stdlib.Reals.Rtrigo.html">Rtrigo</a></li>
<li><a href="Stdlib.Reals.Rtrigo1.html">Rtrigo1</a></li>
<li><a href="Stdlib.Reals.Rtrigo_alt.html">Rtrigo_alt</a></li>
<li><a href="Stdlib.Reals.Rtrigo_calc.html">Rtrigo_calc</a></li>
<li><a href="Stdlib.Reals.Rtrigo_def.html">Rtrigo_def</a></li>
<li><a href="Stdlib.Reals.Rtrigo_facts.html">Rtrigo_facts</a></li>
<li><a href="Stdlib.Reals.Rtrigo_fun.html">Rtrigo_fun</a></li>
<li><a href="Stdlib.Reals.Rtrigo_reg.html">Rtrigo_reg</a></li>
<li><a href="Stdlib.Reals.Runcountable.html">Runcountable</a></li>
<li><a href="Stdlib.Reals.SeqProp.html">SeqProp</a></li>
<li><a href="Stdlib.Reals.SeqSeries.html">SeqSeries</a></li>
<li><a href="Stdlib.Reals.SplitAbsolu.html">SplitAbsolu</a></li>
<li><a href="Stdlib.Reals.SplitRmult.html">SplitRmult</a></li>
<li><a href="Stdlib.Reals.Sqrt_reg.html">Sqrt_reg</a></li>
<li><a href="Stdlib.Reals.Zfloor.html">Zfloor</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Stdlib.Relations.Operators_Properties.html">Operators_Properties</a></li>
<li><a href="Stdlib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
<li><a href="Stdlib.Relations.Relation_Operators.html">Relation_Operators</a></li>
<li><a href="Stdlib.Relations.Relations.html">Relations</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Stdlib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sets"><summary>Sets</summary>
          <ul>
          <li><a href="Stdlib.Sets.Classical_sets.html">Classical_sets</a></li>
<li><a href="Stdlib.Sets.Constructive_sets.html">Constructive_sets</a></li>
<li><a href="Stdlib.Sets.Cpo.html">Cpo</a></li>
<li><a href="Stdlib.Sets.Ensembles.html">Ensembles</a></li>
<li><a href="Stdlib.Sets.Finite_sets.html">Finite_sets</a></li>
<li><a href="Stdlib.Sets.Finite_sets_facts.html">Finite_sets_facts</a></li>
<li><a href="Stdlib.Sets.Image.html">Image</a></li>
<li><a href="Stdlib.Sets.Infinite_sets.html">Infinite_sets</a></li>
<li><a href="Stdlib.Sets.Integers.html">Integers</a></li>
<li><a href="Stdlib.Sets.Multiset.html">Multiset</a></li>
<li><a href="Stdlib.Sets.Partial_Order.html">Partial_Order</a></li>
<li><a href="Stdlib.Sets.Permut.html">Permut</a></li>
<li><a href="Stdlib.Sets.Powerset.html">Powerset</a></li>
<li><a href="Stdlib.Sets.Powerset_Classical_facts.html">Powerset_Classical_facts</a></li>
<li><a href="Stdlib.Sets.Powerset_facts.html">Powerset_facts</a></li>
<li><a href="Stdlib.Sets.Relations_1.html">Relations_1</a></li>
<li><a href="Stdlib.Sets.Relations_1_facts.html">Relations_1_facts</a></li>
<li><a href="Stdlib.Sets.Relations_2.html">Relations_2</a></li>
<li><a href="Stdlib.Sets.Relations_2_facts.html">Relations_2_facts</a></li>
<li><a href="Stdlib.Sets.Relations_3.html">Relations_3</a></li>
<li><a href="Stdlib.Sets.Relations_3_facts.html">Relations_3_facts</a></li>
<li><a href="Stdlib.Sets.Uniset.html">Uniset</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sorting"><summary>Sorting</summary>
          <ul>
          <li><a href="Stdlib.Sorting.CPermutation.html">CPermutation</a></li>
<li><a href="Stdlib.Sorting.Heap.html">Heap</a></li>
<li><a href="Stdlib.Sorting.Mergesort.html">Mergesort</a></li>
<li><a href="Stdlib.Sorting.PermutEq.html">PermutEq</a></li>
<li><a href="Stdlib.Sorting.PermutSetoid.html">PermutSetoid</a></li>
<li><a href="Stdlib.Sorting.Permutation.html">Permutation</a></li>
<li><a href="Stdlib.Sorting.SetoidList.html">SetoidList</a></li>
<li><a href="Stdlib.Sorting.SetoidPermutation.html">SetoidPermutation</a></li>
<li><a href="Stdlib.Sorting.Sorted.html">Sorted</a></li>
<li><a href="Stdlib.Sorting.Sorting.html">Sorting</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Streams"><summary>Streams</summary>
          <ul>
          <li><a href="Stdlib.Streams.StreamMemo.html">StreamMemo</a></li>
<li><a href="Stdlib.Streams.Streams.html">Streams</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Stdlib.Strings.Ascii.html">Ascii</a></li>
<li><a href="Stdlib.Strings.BinaryString.html">BinaryString</a></li>
<li><a href="Stdlib.Strings.Byte.html">Byte</a></li>
<li><a href="Stdlib.Strings.HexString.html">HexString</a></li>
<li><a href="Stdlib.Strings.OctalString.html">OctalString</a></li>
<li><a href="Stdlib.Strings.PString.html">PString</a></li>
<li><a href="Stdlib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Stdlib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="Stdlib.Strings.String.html">String</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Structures"><summary>Structures</summary>
          <ul>
          <li><a href="Stdlib.Structures.BoolOrder.html">BoolOrder</a></li>
<li><a href="Stdlib.Structures.DecidableType.html">DecidableType</a></li>
<li><a href="Stdlib.Structures.DecidableTypeEx.html">DecidableTypeEx</a></li>
<li><a href="Stdlib.Structures.Equalities.html">Equalities</a></li>
<li><a href="Stdlib.Structures.EqualitiesFacts.html">EqualitiesFacts</a></li>
<li><a href="Stdlib.Structures.GenericMinMax.html">GenericMinMax</a></li>
<li><a href="Stdlib.Structures.OrderedType.html">OrderedType</a></li>
<li><a href="Stdlib.Structures.OrderedTypeAlt.html">OrderedTypeAlt</a></li>
<li><a href="Stdlib.Structures.OrderedTypeEx.html">OrderedTypeEx</a></li>
<li><a href="Stdlib.Structures.Orders.html">Orders</a></li>
<li><a href="Stdlib.Structures.OrdersAlt.html">OrdersAlt</a></li>
<li><a href="Stdlib.Structures.OrdersEx.html">OrdersEx</a></li>
<li><a href="Stdlib.Structures.OrdersFacts.html">OrdersFacts</a></li>
<li><a href="Stdlib.Structures.OrdersLists.html">OrdersLists</a></li>
<li><a href="Stdlib.Structures.OrdersTac.html">OrdersTac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Unicode"><summary>Unicode</summary>
          <ul>
          <li><a href="Stdlib.Unicode.Utf8.html">Utf8</a></li>
<li><a href="Stdlib.Unicode.Utf8_core.html">Utf8_core</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Vectors"><summary>Vectors</summary>
          <ul>
          <li><a href="Stdlib.Vectors.Bvector.html">Bvector</a></li>
<li><a href="Stdlib.Vectors.Fin.html">Fin</a></li>
<li><a href="Stdlib.Vectors.FinFun.html">FinFun</a></li>
<li><a href="Stdlib.Vectors.Vector.html">Vector</a></li>
<li><a href="Stdlib.Vectors.VectorDef.html">VectorDef</a></li>
<li><a href="Stdlib.Vectors.VectorEq.html">VectorEq</a></li>
<li><a href="Stdlib.Vectors.VectorSpec.html">VectorSpec</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Wellfounded"><summary>Wellfounded</summary>
          <ul>
          <li><a href="Stdlib.Wellfounded.Disjoint_Union.html">Disjoint_Union</a></li>
<li><a href="Stdlib.Wellfounded.Inclusion.html">Inclusion</a></li>
<li><a href="Stdlib.Wellfounded.Inverse_Image.html">Inverse_Image</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Exponentiation.html">Lexicographic_Exponentiation</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Product.html">Lexicographic_Product</a></li>
<li><a href="Stdlib.Wellfounded.List_Extension.html">List_Extension</a></li>
<li><a href="Stdlib.Wellfounded.Transitive_Closure.html">Transitive_Closure</a></li>
<li><a href="Stdlib.Wellfounded.Union.html">Union</a></li>
<li><a href="Stdlib.Wellfounded.Well_Ordering.html">Well_Ordering</a></li>
<li><a href="Stdlib.Wellfounded.Wellfounded.html">Wellfounded</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ZArith"><summary>ZArith</summary>
          <ul>
          <li><a href="Stdlib.ZArith.BinInt.html">BinInt</a></li>
<li><a href="Stdlib.ZArith.BinIntDef.html">BinIntDef</a></li>
<li><a href="Stdlib.ZArith.Int.html">Int</a></li>
<li><a href="Stdlib.ZArith.Wf_Z.html">Wf_Z</a></li>
<li><a href="Stdlib.ZArith.ZArith.html">ZArith</a></li>
<li><a href="Stdlib.ZArith.ZArith_base.html">ZArith_base</a></li>
<li><a href="Stdlib.ZArith.ZArith_dec.html">ZArith_dec</a></li>
<li><a href="Stdlib.ZArith.Zabs.html">Zabs</a></li>
<li><a href="Stdlib.ZArith.Zbitwise.html">Zbitwise</a></li>
<li><a href="Stdlib.ZArith.Zbool.html">Zbool</a></li>
<li><a href="Stdlib.ZArith.Zcompare.html">Zcompare</a></li>
<li><a href="Stdlib.ZArith.Zcomplements.html">Zcomplements</a></li>
<li><a href="Stdlib.ZArith.Zdiv.html">Zdiv</a></li>
<li><a href="Stdlib.ZArith.Zdiv_facts.html">Zdiv_facts</a></li>
<li><a href="Stdlib.ZArith.Zeuclid.html">Zeuclid</a></li>
<li><a href="Stdlib.ZArith.Zeven.html">Zeven</a></li>
<li><a href="Stdlib.ZArith.Zgcd_alt.html">Zgcd_alt</a></li>
<li><a href="Stdlib.ZArith.Zhints.html">Zhints</a></li>
<li><a href="Stdlib.ZArith.Zmax.html">Zmax</a></li>
<li><a href="Stdlib.ZArith.Zmin.html">Zmin</a></li>
<li><a href="Stdlib.ZArith.Zminmax.html">Zminmax</a></li>
<li><a href="Stdlib.ZArith.Zmisc.html">Zmisc</a></li>
<li><a href="Stdlib.ZArith.Znat.html">Znat</a></li>
<li><a href="Stdlib.ZArith.Znumtheory.html">Znumtheory</a></li>
<li><a href="Stdlib.ZArith.Zorder.html">Zorder</a></li>
<li><a href="Stdlib.ZArith.Zpow_alt.html">Zpow_alt</a></li>
<li><a href="Stdlib.ZArith.Zpow_def.html">Zpow_def</a></li>
<li><a href="Stdlib.ZArith.Zpow_facts.html">Zpow_facts</a></li>
<li><a href="Stdlib.ZArith.Zpower.html">Zpower</a></li>
<li><a href="Stdlib.ZArith.Zquot.html">Zquot</a></li>
<li><a href="Stdlib.ZArith.Zwf.html">Zwf</a></li>
<li><a href="Stdlib.ZArith.auxiliary.html">auxiliary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.btauto"><summary>btauto</summary>
          <ul>
          <li><a href="Stdlib.btauto.Algebra.html">Algebra</a></li>
<li><a href="Stdlib.btauto.Btauto.html">Btauto</a></li>
<li><a href="Stdlib.btauto.Reflect.html">Reflect</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Stdlib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Stdlib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInt.html">ExtrHaskellNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInteger.html">ExtrHaskellNatInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatNum.html">ExtrHaskellNatNum</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellString.html">ExtrHaskellString</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInt.html">ExtrHaskellZInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInteger.html">ExtrHaskellZInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZNum.html">ExtrHaskellZNum</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlFloats.html">ExtrOCamlFloats</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlInt63.html">ExtrOCamlInt63</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPArray.html">ExtrOCamlPArray</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPString.html">ExtrOCamlPString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlChar.html">ExtrOcamlChar</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlIntConv.html">ExtrOcamlIntConv</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatBigInt.html">ExtrOcamlNatBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatInt.html">ExtrOcamlNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNativeString.html">ExtrOcamlNativeString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlString.html">ExtrOcamlString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZBigInt.html">ExtrOcamlZBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZInt.html">ExtrOcamlZInt</a></li>
<li><a href="Stdlib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.funind"><summary>funind</summary>
          <ul>
          <li><a href="Stdlib.funind.FunInd.html">FunInd</a></li>
<li><a href="Stdlib.funind.Recdef.html">Recdef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.micromega"><summary>micromega</summary>
          <ul>
          <li><a href="Stdlib.micromega.DeclConstant.html">DeclConstant</a></li>
<li><a href="Stdlib.micromega.DeclConstantZ.html">DeclConstantZ</a></li>
<li><a href="Stdlib.micromega.Env.html">Env</a></li>
<li><a href="Stdlib.micromega.EnvRing.html">EnvRing</a></li>
<li><a href="Stdlib.micromega.Fourier.html">Fourier</a></li>
<li><a href="Stdlib.micromega.Fourier_util.html">Fourier_util</a></li>
<li><a href="Stdlib.micromega.Lia.html">Lia</a></li>
<li><a href="Stdlib.micromega.Lqa.html">Lqa</a></li>
<li><a href="Stdlib.micromega.Lra.html">Lra</a></li>
<li><a href="Stdlib.micromega.OrderedRing.html">OrderedRing</a></li>
<li><a href="Stdlib.micromega.Psatz.html">Psatz</a></li>
<li><a href="Stdlib.micromega.QMicromega.html">QMicromega</a></li>
<li><a href="Stdlib.micromega.RMicromega.html">RMicromega</a></li>
<li><a href="Stdlib.micromega.Refl.html">Refl</a></li>
<li><a href="Stdlib.micromega.RingMicromega.html">RingMicromega</a></li>
<li><a href="Stdlib.micromega.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.micromega.VarMap.html">VarMap</a></li>
<li><a href="Stdlib.micromega.ZArith_hints.html">ZArith_hints</a></li>
<li><a href="Stdlib.micromega.ZCoeff.html">ZCoeff</a></li>
<li><a href="Stdlib.micromega.ZMicromega.html">ZMicromega</a></li>
<li><a href="Stdlib.micromega.Zify.html">Zify</a></li>
<li><a href="Stdlib.micromega.ZifyBool.html">ZifyBool</a></li>
<li><a href="Stdlib.micromega.ZifyClasses.html">ZifyClasses</a></li>
<li><a href="Stdlib.micromega.ZifyComparison.html">ZifyComparison</a></li>
<li><a href="Stdlib.micromega.ZifyInst.html">ZifyInst</a></li>
<li><a href="Stdlib.micromega.ZifyN.html">ZifyN</a></li>
<li><a href="Stdlib.micromega.ZifyNat.html">ZifyNat</a></li>
<li><a href="Stdlib.micromega.ZifyPow.html">ZifyPow</a></li>
<li><a href="Stdlib.micromega.ZifySint63.html">ZifySint63</a></li>
<li><a href="Stdlib.micromega.ZifyUint63.html">ZifyUint63</a></li>
<li><a href="Stdlib.micromega.Ztac.html">Ztac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.nsatz"><summary>nsatz</summary>
          <ul>
          <li><a href="Stdlib.nsatz.NsatzTactic.html">NsatzTactic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.omega"><summary>omega</summary>
          <ul>
          <li><a href="Stdlib.omega.OmegaLemmas.html">OmegaLemmas</a></li>
<li><a href="Stdlib.omega.PreOmega.html">PreOmega</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.rtauto"><summary>rtauto</summary>
          <ul>
          <li><a href="Stdlib.rtauto.Bintree.html">Bintree</a></li>
<li><a href="Stdlib.rtauto.Rtauto.html">Rtauto</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.setoid_ring"><summary>setoid_ring</summary>
          <ul>
          <li><a href="Stdlib.setoid_ring.Algebra_syntax.html">Algebra_syntax</a></li>
<li><a href="Stdlib.setoid_ring.ArithRing.html">ArithRing</a></li>
<li><a href="Stdlib.setoid_ring.BinList.html">BinList</a></li>
<li><a href="Stdlib.setoid_ring.Cring.html">Cring</a></li>
<li><a href="Stdlib.setoid_ring.Field.html">Field</a></li>
<li><a href="Stdlib.setoid_ring.Field_tac.html">Field_tac</a></li>
<li><a href="Stdlib.setoid_ring.Field_theory.html">Field_theory</a></li>
<li><a href="Stdlib.setoid_ring.InitialRing.html">InitialRing</a></li>
<li><a href="Stdlib.setoid_ring.Integral_domain.html">Integral_domain</a></li>
<li><a href="Stdlib.setoid_ring.NArithRing.html">NArithRing</a></li>
<li><a href="Stdlib.setoid_ring.Ncring.html">Ncring</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_initial.html">Ncring_initial</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_polynom.html">Ncring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_tac.html">Ncring_tac</a></li>
<li><a href="Stdlib.setoid_ring.RealField.html">RealField</a></li>
<li><a href="Stdlib.setoid_ring.Ring.html">Ring</a></li>
<li><a href="Stdlib.setoid_ring.Ring_base.html">Ring_base</a></li>
<li><a href="Stdlib.setoid_ring.Ring_polynom.html">Ring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ring_tac.html">Ring_tac</a></li>
<li><a href="Stdlib.setoid_ring.Ring_theory.html">Ring_theory</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Q.html">Rings_Q</a></li>
<li><a href="Stdlib.setoid_ring.Rings_R.html">Rings_R</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Z.html">Rings_Z</a></li>
<li><a href="Stdlib.setoid_ring.ZArithRing.html">ZArithRing</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Stdlib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Stdlib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Stdlib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Stdlib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Stdlib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Stdlib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Stdlib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi"><summary>elpi</summary>
          <ul>
          <li><details id="elpi.apps"><summary>apps</summary>
          <ul>
          <li><details id="elpi.apps.NES"><summary>NES</summary>
          <ul>
          <li><details id="elpi.apps.NES.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.NES.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.NES.NES.html">NES</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.coercion"><summary>coercion</summary>
          <ul>
          <li><a href="elpi.apps.coercion.coercion.html">coercion</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.cs"><summary>cs</summary>
          <ul>
          <li><a href="elpi.apps.cs.cs.html">cs</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive"><summary>derive</summary>
          <ul>
          <li><details id="elpi.apps.derive.derive"><summary>derive</summary>
          <ul>
          <li><a href="elpi.apps.derive.derive.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="elpi.apps.derive.derive.bcongr.html">bcongr</a></li>
<li><a href="elpi.apps.derive.derive.cast.html">cast</a></li>
<li><a href="elpi.apps.derive.derive.eq.html">eq</a></li>
<li><a href="elpi.apps.derive.derive.eqK.html">eqK</a></li>
<li><a href="elpi.apps.derive.derive.eqOK.html">eqOK</a></li>
<li><a href="elpi.apps.derive.derive.eqType_ast.html">eqType_ast</a></li>
<li><a href="elpi.apps.derive.derive.eqb.html">eqb</a></li>
<li><a href="elpi.apps.derive.derive.eqbOK.html">eqbOK</a></li>
<li><a href="elpi.apps.derive.derive.eqb_core_defs.html">eqb_core_defs</a></li>
<li><a href="elpi.apps.derive.derive.eqbcorrect.html">eqbcorrect</a></li>
<li><a href="elpi.apps.derive.derive.eqcorrect.html">eqcorrect</a></li>
<li><a href="elpi.apps.derive.derive.experimental.html">experimental</a></li>
<li><a href="elpi.apps.derive.derive.fields.html">fields</a></li>
<li><a href="elpi.apps.derive.derive.idx2inv.html">idx2inv</a></li>
<li><a href="elpi.apps.derive.derive.induction.html">induction</a></li>
<li><a href="elpi.apps.derive.derive.invert.html">invert</a></li>
<li><a href="elpi.apps.derive.derive.isK.html">isK</a></li>
<li><a href="elpi.apps.derive.derive.legacy.html">legacy</a></li>
<li><a href="elpi.apps.derive.derive.lens.html">lens</a></li>
<li><a href="elpi.apps.derive.derive.lens_laws.html">lens_laws</a></li>
<li><a href="elpi.apps.derive.derive.map.html">map</a></li>
<li><a href="elpi.apps.derive.derive.param1.html">param1</a></li>
<li><a href="elpi.apps.derive.derive.param1_congr.html">param1_congr</a></li>
<li><a href="elpi.apps.derive.derive.param1_functor.html">param1_functor</a></li>
<li><a href="elpi.apps.derive.derive.param1_trivial.html">param1_trivial</a></li>
<li><a href="elpi.apps.derive.derive.param2.html">param2</a></li>
<li><a href="elpi.apps.derive.derive.projK.html">projK</a></li>
<li><a href="elpi.apps.derive.derive.std.html">std</a></li>
<li><a href="elpi.apps.derive.derive.tag.html">tag</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.derive.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.derive.derive.html">derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.eltac"><summary>eltac</summary>
          <ul>
          <li><a href="elpi.apps.eltac.apply.html">apply</a></li>
<li><a href="elpi.apps.eltac.assumption.html">assumption</a></li>
<li><a href="elpi.apps.eltac.case.html">case</a></li>
<li><a href="elpi.apps.eltac.clear.html">clear</a></li>
<li><a href="elpi.apps.eltac.constructor.html">constructor</a></li>
<li><a href="elpi.apps.eltac.cycle.html">cycle</a></li>
<li><a href="elpi.apps.eltac.discriminate.html">discriminate</a></li>
<li><a href="elpi.apps.eltac.fail.html">fail</a></li>
<li><a href="elpi.apps.eltac.generalize.html">generalize</a></li>
<li><a href="elpi.apps.eltac.injection.html">injection</a></li>
<li><a href="elpi.apps.eltac.intro.html">intro</a></li>
<li><a href="elpi.apps.eltac.rewrite.html">rewrite</a></li>
<li><a href="elpi.apps.eltac.tactics.html">tactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.locker"><summary>locker</summary>
          <ul>
          <li><details id="elpi.apps.locker.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.locker.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.locker.locker.html">locker</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.rbuild"><summary>rbuild</summary>
          <ul>
          <li><details id="elpi.apps.rbuild.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.rbuild.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.rbuild.rbuild.html">rbuild</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.tc"><summary>tc</summary>
          <ul>
          <li><details id="elpi.apps.tc.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.tc.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.tc.add_commands.html">add_commands</a></li>
<li><a href="elpi.apps.tc.db.html">db</a></li>
<li><a href="elpi.apps.tc.tc.html">tc</a></li>
<li><a href="elpi.apps.tc.wip.html">wip</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi.core"><summary>core</summary>
          <ul>
          <li><a href="elpi.core.Bool.html">Bool</a></li>
<li><a href="elpi.core.ListDef.html">ListDef</a></li>
<li><a href="elpi.core.Morphisms.html">Morphisms</a></li>
<li><a href="elpi.core.PosDef.html">PosDef</a></li>
<li><a href="elpi.core.PrimFloat.html">PrimFloat</a></li>
<li><a href="elpi.core.PrimInt63.html">PrimInt63</a></li>
<li><a href="elpi.core.PrimString.html">PrimString</a></li>
<li><a href="elpi.core.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="elpi.core.RelationClasses.html">RelationClasses</a></li>
<li><a href="elpi.core.Setoid.html">Setoid</a></li>
<li><a href="elpi.core.Uint63Axioms.html">Uint63Axioms</a></li>
<li><a href="elpi.core.ssrbool.html">ssrbool</a></li>
<li><a href="elpi.core.ssreflect.html">ssreflect</a></li>
<li><a href="elpi.core.ssrfun.html">ssrfun</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.elpi.html">elpi</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_elpi"><summary>elpi_elpi</summary>
          <ul>
          <li><a href="elpi_elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_examples"><summary>elpi_examples</summary>
          <ul>
          <li><a href="elpi_examples.example_abs_evars.html">example_abs_evars</a></li>
<li><a href="elpi_examples.example_curry_howard_tactics.html">example_curry_howard_tactics</a></li>
<li><a href="elpi_examples.example_data_base.html">example_data_base</a></li>
<li><a href="elpi_examples.example_fuzzer.html">example_fuzzer</a></li>
<li><a href="elpi_examples.example_generalize.html">example_generalize</a></li>
<li><a href="elpi_examples.example_import_projections.html">example_import_projections</a></li>
<li><a href="elpi_examples.example_record_expansion.html">example_record_expansion</a></li>
<li><a href="elpi_examples.example_record_to_sigma.html">example_record_to_sigma</a></li>
<li><a href="elpi_examples.example_reduction_surgery.html">example_reduction_surgery</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_HOAS.html">tutorial_coq_elpi_HOAS</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_command.html">tutorial_coq_elpi_command</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_tactic.html">tutorial_coq_elpi_tactic</a></li>
<li><a href="elpi_examples.tutorial_elpi_lang.html">tutorial_elpi_lang</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp"><summary>mathcomp</summary>
          <ul>
          <li><details id="mathcomp.algebra"><summary>algebra</summary>
          <ul>
          <li><a href="mathcomp.algebra.all_algebra.html">all_algebra</a></li>
<li><a href="mathcomp.algebra.archimedean.html">archimedean</a></li>
<li><a href="mathcomp.algebra.countalg.html">countalg</a></li>
<li><a href="mathcomp.algebra.finalg.html">finalg</a></li>
<li><a href="mathcomp.algebra.fraction.html">fraction</a></li>
<li><a href="mathcomp.algebra.intdiv.html">intdiv</a></li>
<li><a href="mathcomp.algebra.interval.html">interval</a></li>
<li><a href="mathcomp.algebra.interval_inference.html">interval_inference</a></li>
<li><a href="mathcomp.algebra.matrix.html">matrix</a></li>
<li><a href="mathcomp.algebra.mxalgebra.html">mxalgebra</a></li>
<li><a href="mathcomp.algebra.mxpoly.html">mxpoly</a></li>
<li><a href="mathcomp.algebra.mxred.html">mxred</a></li>
<li><a href="mathcomp.algebra.poly.html">poly</a></li>
<li><a href="mathcomp.algebra.polyXY.html">polyXY</a></li>
<li><a href="mathcomp.algebra.polydiv.html">polydiv</a></li>
<li><a href="mathcomp.algebra.qpoly.html">qpoly</a></li>
<li><a href="mathcomp.algebra.rat.html">rat</a></li>
<li><a href="mathcomp.algebra.ring_quotient.html">ring_quotient</a></li>
<li><a href="mathcomp.algebra.sesquilinear.html">sesquilinear</a></li>
<li><a href="mathcomp.algebra.spectral.html">spectral</a></li>
<li><a href="mathcomp.algebra.ssralg.html">ssralg</a></li>
<li><a href="mathcomp.algebra.ssrint.html">ssrint</a></li>
<li><a href="mathcomp.algebra.ssrnum.html">ssrnum</a></li>
<li><a href="mathcomp.algebra.vector.html">vector</a></li>
<li><a href="mathcomp.algebra.zmodp.html">zmodp</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis"><summary>analysis</summary>
          <ul>
          <li><details id="mathcomp.analysis.homotopy_theory"><summary>homotopy_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.homotopy_theory.continuous_path.html">continuous_path</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.homotopy.html">homotopy</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.wedge_sigT.html">wedge_sigT</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.lebesgue_integral_theory"><summary>lebesgue_integral_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_Rintegral.html">lebesgue_Rintegral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integrable.html">lebesgue_integrable</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral.html">lebesgue_integral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_definition.html">lebesgue_integral_definition</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_differentiation.html">lebesgue_integral_differentiation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_dominated_convergence.html">lebesgue_integral_dominated_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_fubini.html">lebesgue_integral_fubini</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_monotone_convergence.html">lebesgue_integral_monotone_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_nonneg.html">lebesgue_integral_nonneg</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_under.html">lebesgue_integral_under</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.measurable_fun_approximation.html">measurable_fun_approximation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.simple_functions.html">simple_functions</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.measure_theory"><summary>measure_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.measure_theory.counting_measure.html">counting_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.dirac_measure.html">dirac_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_function.html">measurable_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_structure.html">measurable_structure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure.html">measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_extension.html">measure_extension</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_function.html">measure_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_negligible.html">measure_negligible</a></li>
<li><a href="mathcomp.analysis.measure_theory.probability_measure.html">probability_measure</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.normedtype_theory"><summary>normedtype_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.normedtype_theory.complete_normed_module.html">complete_normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.ereal_normedtype.html">ereal_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.matrix_normedtype.html">matrix_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normed_module.html">normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normedtype.html">normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.num_normedtype.html">num_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.pseudometric_normed_Zmodule.html">pseudometric_normed_Zmodule</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.urysohn.html">urysohn</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.vitali_lemma.html">vitali_lemma</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis.showcase.pnt.html">pnt</a></li>
<li><a href="mathcomp.analysis.showcase.summability.html">summability</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.topology_theory"><summary>topology_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.topology_theory.bool_topology.html">bool_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.compact.html">compact</a></li>
<li><a href="mathcomp.analysis.topology_theory.connected.html">connected</a></li>
<li><a href="mathcomp.analysis.topology_theory.discrete_topology.html">discrete_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.matrix_topology.html">matrix_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.nat_topology.html">nat_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.num_topology.html">num_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.one_point_compactification.html">one_point_compactification</a></li>
<li><a href="mathcomp.analysis.topology_theory.order_topology.html">order_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.product_topology.html">product_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.pseudometric_structure.html">pseudometric_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.quotient_topology.html">quotient_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.separation_axioms.html">separation_axioms</a></li>
<li><a href="mathcomp.analysis.topology_theory.sigT_topology.html">sigT_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subspace_topology.html">subspace_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subtype_topology.html">subtype_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.supremum_topology.html">supremum_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology.html">topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology_structure.html">topology_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.uniform_structure.html">uniform_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.weak_topology.html">weak_topology</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis.all_analysis.html">all_analysis</a></li>
<li><a href="mathcomp.analysis.borel_hierarchy.html">borel_hierarchy</a></li>
<li><a href="mathcomp.analysis.cantor.html">cantor</a></li>
<li><a href="mathcomp.analysis.charge.html">charge</a></li>
<li><a href="mathcomp.analysis.convex.html">convex</a></li>
<li><a href="mathcomp.analysis.derive.html">derive</a></li>
<li><a href="mathcomp.analysis.ereal.html">ereal</a></li>
<li><a href="mathcomp.analysis.ess_sup_inf.html">ess_sup_inf</a></li>
<li><a href="mathcomp.analysis.esum.html">esum</a></li>
<li><a href="mathcomp.analysis.exp.html">exp</a></li>
<li><a href="mathcomp.analysis.ftc.html">ftc</a></li>
<li><a href="mathcomp.analysis.function_spaces.html">function_spaces</a></li>
<li><a href="mathcomp.analysis.gauss_integral.html">gauss_integral</a></li>
<li><a href="mathcomp.analysis.hoelder.html">hoelder</a></li>
<li><a href="mathcomp.analysis.kernel.html">kernel</a></li>
<li><a href="mathcomp.analysis.landau.html">landau</a></li>
<li><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></li>
<li><a href="mathcomp.analysis.lebesgue_stieltjes_measure.html">lebesgue_stieltjes_measure</a></li>
<li><a href="mathcomp.analysis.measurable_realfun.html">measurable_realfun</a></li>
<li><a href="mathcomp.analysis.numfun.html">numfun</a></li>
<li><a href="mathcomp.analysis.pi_irrational.html">pi_irrational</a></li>
<li><a href="mathcomp.analysis.probability.html">probability</a></li>
<li><a href="mathcomp.analysis.realfun.html">realfun</a></li>
<li><a href="mathcomp.analysis.sequences.html">sequences</a></li>
<li><a href="mathcomp.analysis.trigo.html">trigo</a></li>
<li><a href="mathcomp.analysis.tvs.html">tvs</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis_stdlib"><summary>analysis_stdlib</summary>
          <ul>
          <li><details id="mathcomp.analysis_stdlib.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis_stdlib.showcase.uniform_bigO.html">uniform_bigO</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis_stdlib.Rstruct_topology.html">Rstruct_topology</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.bigenough"><summary>bigenough</summary>
          <ul>
          <li><a href="mathcomp.bigenough.bigenough.html">bigenough</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.classical"><summary>classical</summary>
          <ul>
          <li><a href="mathcomp.classical.all_classical.html">all_classical</a></li>
<li><a href="mathcomp.classical.boolp.html">boolp</a></li>
<li><a href="mathcomp.classical.cardinality.html">cardinality</a></li>
<li><a href="mathcomp.classical.classical_orders.html">classical_orders</a></li>
<li><a href="mathcomp.classical.classical_sets.html">classical_sets</a></li>
<li><a href="mathcomp.classical.contra.html">contra</a></li>
<li><a href="mathcomp.classical.filter.html">filter</a></li>
<li><a href="mathcomp.classical.fsbigop.html">fsbigop</a></li>
<li><a href="mathcomp.classical.functions.html">functions</a></li>
<li><a href="mathcomp.classical.internal_Eqdep_dec.html">internal_Eqdep_dec</a></li>
<li><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></li>
<li><a href="mathcomp.classical.set_interval.html">set_interval</a></li>
<li><a href="mathcomp.classical.unstable.html">unstable</a></li>
<li><a href="mathcomp.classical.wochoice.html">wochoice</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.experimental_reals"><summary>experimental_reals</summary>
          <ul>
          <li><a href="mathcomp.experimental_reals.discrete.html">discrete</a></li>
<li><a href="mathcomp.experimental_reals.distr.html">distr</a></li>
<li><a href="mathcomp.experimental_reals.realseq.html">realseq</a></li>
<li><a href="mathcomp.experimental_reals.realsum.html">realsum</a></li>
<li><a href="mathcomp.experimental_reals.xfinmap.html">xfinmap</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.field"><summary>field</summary>
          <ul>
          <li><a href="mathcomp.field.algC.html">algC</a></li>
<li><a href="mathcomp.field.algebraics_fundamentals.html">algebraics_fundamentals</a></li>
<li><a href="mathcomp.field.algnum.html">algnum</a></li>
<li><a href="mathcomp.field.all_field.html">all_field</a></li>
<li><a href="mathcomp.field.closed_field.html">closed_field</a></li>
<li><a href="mathcomp.field.cyclotomic.html">cyclotomic</a></li>
<li><a href="mathcomp.field.falgebra.html">falgebra</a></li>
<li><a href="mathcomp.field.fieldext.html">fieldext</a></li>
<li><a href="mathcomp.field.finfield.html">finfield</a></li>
<li><a href="mathcomp.field.galois.html">galois</a></li>
<li><a href="mathcomp.field.qfpoly.html">qfpoly</a></li>
<li><a href="mathcomp.field.separable.html">separable</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.fingroup"><summary>fingroup</summary>
          <ul>
          <li><a href="mathcomp.fingroup.action.html">action</a></li>
<li><a href="mathcomp.fingroup.all_fingroup.html">all_fingroup</a></li>
<li><a href="mathcomp.fingroup.automorphism.html">automorphism</a></li>
<li><a href="mathcomp.fingroup.fingroup.html">fingroup</a></li>
<li><a href="mathcomp.fingroup.gproduct.html">gproduct</a></li>
<li><a href="mathcomp.fingroup.morphism.html">morphism</a></li>
<li><a href="mathcomp.fingroup.perm.html">perm</a></li>
<li><a href="mathcomp.fingroup.presentation.html">presentation</a></li>
<li><a href="mathcomp.fingroup.quotient.html">quotient</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.finmap"><summary>finmap</summary>
          <ul>
          <li><a href="mathcomp.finmap.finmap.html">finmap</a></li>
<li><a href="mathcomp.finmap.multiset.html">multiset</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals"><summary>reals</summary>
          <ul>
          <li><a href="mathcomp.reals.all_reals.html">all_reals</a></li>
<li><a href="mathcomp.reals.constructive_ereal.html">constructive_ereal</a></li>
<li><a href="mathcomp.reals.prodnormedzmodule.html">prodnormedzmodule</a></li>
<li><a href="mathcomp.reals.real_interval.html">real_interval</a></li>
<li><a href="mathcomp.reals.reals.html">reals</a></li>
<li><a href="mathcomp.reals.signed.html">signed</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals_stdlib"><summary>reals_stdlib</summary>
          <ul>
          <li><a href="mathcomp.reals_stdlib.Rstruct.html">Rstruct</a></li>
<li><a href="mathcomp.reals_stdlib.nsatz_realtype.html">nsatz_realtype</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.solvable"><summary>solvable</summary>
          <ul>
          <li><a href="mathcomp.solvable.abelian.html">abelian</a></li>
<li><a href="mathcomp.solvable.all_solvable.html">all_solvable</a></li>
<li><a href="mathcomp.solvable.alt.html">alt</a></li>
<li><a href="mathcomp.solvable.burnside_app.html">burnside_app</a></li>
<li><a href="mathcomp.solvable.center.html">center</a></li>
<li><a href="mathcomp.solvable.commutator.html">commutator</a></li>
<li><a href="mathcomp.solvable.cyclic.html">cyclic</a></li>
<li><a href="mathcomp.solvable.extraspecial.html">extraspecial</a></li>
<li><a href="mathcomp.solvable.extremal.html">extremal</a></li>
<li><a href="mathcomp.solvable.finmodule.html">finmodule</a></li>
<li><a href="mathcomp.solvable.frobenius.html">frobenius</a></li>
<li><a href="mathcomp.solvable.gfunctor.html">gfunctor</a></li>
<li><a href="mathcomp.solvable.gseries.html">gseries</a></li>
<li><a href="mathcomp.solvable.hall.html">hall</a></li>
<li><a href="mathcomp.solvable.jordanholder.html">jordanholder</a></li>
<li><a href="mathcomp.solvable.maximal.html">maximal</a></li>
<li><a href="mathcomp.solvable.nilpotent.html">nilpotent</a></li>
<li><a href="mathcomp.solvable.pgroup.html">pgroup</a></li>
<li><a href="mathcomp.solvable.primitive_action.html">primitive_action</a></li>
<li><a href="mathcomp.solvable.sylow.html">sylow</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.ssreflect"><summary>ssreflect</summary>
          <ul>
          <li><a href="mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></li>
<li><a href="mathcomp.ssreflect.bigop.html">bigop</a></li>
<li><a href="mathcomp.ssreflect.binomial.html">binomial</a></li>
<li><a href="mathcomp.ssreflect.choice.html">choice</a></li>
<li><a href="mathcomp.ssreflect.div.html">div</a></li>
<li><a href="mathcomp.ssreflect.eqtype.html">eqtype</a></li>
<li><a href="mathcomp.ssreflect.finfun.html">finfun</a></li>
<li><a href="mathcomp.ssreflect.fingraph.html">fingraph</a></li>
<li><a href="mathcomp.ssreflect.finset.html">finset</a></li>
<li><a href="mathcomp.ssreflect.fintype.html">fintype</a></li>
<li><a href="mathcomp.ssreflect.generic_quotient.html">generic_quotient</a></li>
<li><a href="mathcomp.ssreflect.order.html">order</a></li>
<li><a href="mathcomp.ssreflect.path.html">path</a></li>
<li><a href="mathcomp.ssreflect.prime.html">prime</a></li>
<li><a href="mathcomp.ssreflect.seq.html">seq</a></li>
<li><a href="mathcomp.ssreflect.ssrAC.html">ssrAC</a></li>
<li><a href="mathcomp.ssreflect.ssrbool.html">ssrbool</a></li>
<li><a href="mathcomp.ssreflect.ssreflect.html">ssreflect</a></li>
<li><a href="mathcomp.ssreflect.ssrfun.html">ssrfun</a></li>
<li><a href="mathcomp.ssreflect.ssrmatching.html">ssrmatching</a></li>
<li><a href="mathcomp.ssreflect.ssrnat.html">ssrnat</a></li>
<li><a href="mathcomp.ssreflect.ssrnotations.html">ssrnotations</a></li>
<li><a href="mathcomp.ssreflect.tuple.html">tuple</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.polydiv</h1>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> ssreflect</span><span class="id"> ssrfun</span><span class="id"> ssrbool</span><span class="id"> eqtype</span><span class="id"> ssrnat</span><span class="id"> seq</span><span class="id"> choice</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> fintype</span><span class="id"> bigop</span><span class="id"> ssralg</span><span class="id"> poly</span>.<br/>
<br/>
<pre class="ssrdoc">
This file provides a library for the basic theory of Euclidean and pseudo-
Euclidean division for polynomials over non trivial ring structures.
The library defines two versions of the pseudo-euclidean division: one for
coefficients in a (not necessarily commutative) non-trivial ring structure
and one for coefficients equipped with a structure of integral domain.
From the latter we derive the definition of the usual Euclidean division
for coefficients in a field. Only the definition of the pseudo-division
for coefficients in an integral domain is exported by default and benefits
from notations.
Also, the only theory exported by default is the one of division for
polynomials with coefficients in a field.
Other definitions and facts are qualified using name spaces indicating the
hypotheses made on the structure of coefficients and the properties of the
polynomial one divides with.

Pdiv.Field (exported by the present library):
         edivp p q == pseudo-division of p by q with p q : {poly R} where
                      R is an idomainType.
                      Computes (k, quo, rem) : nat * {poly r} * {poly R},
                      such that size rem &lt; size q and:
                      + if lead_coef q is not a unit, then:
                        (lead_coef q ^+ k) *: p = q * quo + rem
                      + else if lead_coef q is a unit, then:
                        p = q * quo + rem and k = 0
            p %/ q == quotient (second component) computed by (edivp p q).
            p %% q == remainder (third component) computed by (edivp p q).
         scalp p q == exponent (first component) computed by (edivp p q).
            p %| q == tests the nullity of the remainder of the
                      pseudo-division of p by q.
        rgcdp p q  == Pseudo-greater common divisor obtained by performing
                      the Euclidean algorithm on p and q using redivp as
                      Euclidean division.
            p %= q == p and q are associate polynomials, i.e., p %| q and
                      q %| p, or equivalently, p = c *: q for some nonzero
                      constant c.
          gcdp p q == Pseudo-greater common divisor obtained by performing
                      the Euclidean algorithm on p and q using  edivp as
                      Euclidean division.
         egcdp p q == The pair of Bezout coefficients: if e := egcdp p q,
                      then size e.1 &lt;= size q, size e.2 &lt;= size p, and
                      gcdp p q %= e.1 * p + e.2 * q
      coprimep p q == p and q are coprime, i.e., (gcdp p q) is a nonzero
                      constant.
         gdcop q p == greatest divisor of p which is coprime to q.
irreducible_poly p &lt;-&gt; p has only trivial (constant) divisors.
           mup x q == multplicity of x as a root of q

Pdiv.Idomain: theory available for edivp and the related operation under
   the sole assumption that the ring of coefficients is canonically an
   integral domain (R : idomainType).

Pdiv.IdomainMonic:  theory available for edivp and the related operations
   under the assumption that the ring of coefficients is canonically
   and integral domain (R : idomainType) an the divisor is monic.

Pdiv.IdomainUnit: theory available for edivp and the related operations
   under the assumption that the ring of coefficients is canonically an
   integral domain (R : idomainType) and the leading coefficient of the
   divisor is a unit.

Pdiv.ClosedField: theory available for edivp and the related operation
   under the sole assumption that the ring of coefficients is canonically
   an algebraically closed field (R : closedField).

 Pdiv.Ring :
  redivp p q == pseudo-division of p by q with p q : {poly R} where R is
                a nzRingType.
                Computes (k, quo, rem) : nat * {poly r} * {poly R},
                such that if rem = 0 then quo * q = p * (lead_coef q ^+ k)

  rdivp p q  == quotient (second component) computed by (redivp p q).
  rmodp p q  == remainder (third component) computed by (redivp p q).
  rscalp p q == exponent (first component) computed by (redivp p q).
  rdvdp p q  == tests the nullity of the remainder of the pseudo-division
                of p by q.
  rgcdp p q  == analogue of gcdp for coefficients in a nzRingType.
  rgdcop p q == analogue of gdcop for coefficients in a nzRingType.
(*rcoprimep p q == analogue of coprimep p q for coefficients in a nzRingType.

Pdiv.RingComRreg : theory of the operations defined in Pdiv.Ring, when the
  ring of coefficients is canonically commutative (R : comNzRingType) and
  the leading coefficient of the divisor is both right regular and
  commutes as a constant polynomial with the divisor itself

Pdiv.RingMonic : theory of the operations defined in Pdiv.Ring, under the
  assumption that the divisor is monic.

Pdiv.UnitRing: theory of the operations defined in Pdiv.Ring, when the
  ring R of coefficients is canonically with units (R : unitRingType).

</pre>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> GRing</span>.<span class="id">Theory</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;p %= q&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 70,</span><span class="id"> no</span><span class="id"> associativity</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> simp</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">simpm</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Pdiv</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> CommonRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RingPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> nzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> redivp_rec</span> (<span class="id">q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> sq</span><span class="id"> :=</span><span class="id"> size</span><span class="id"> q</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> cq</span><span class="id"> :=</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">fix</span><span class="id"> loop</span> (<span class="id">k</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">qq</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)(<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> {struct</span><span class="id"> n}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> sq</span><span class="gallina-kwd"> then</span> (<span class="id">k,</span><span class="id"> qq,</span><span class="id"> r</span>)<span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> m</span><span class="id"> :=</span> (<span class="id">lead_coef</span><span class="id"> r</span>)<span class="id"> *:</span><span class="id"> 'X^</span>(<span class="id">size</span><span class="id"> r</span><span class="id"> -</span><span class="id"> sq</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> qq1</span><span class="id"> :=</span><span class="id"> qq</span><span class="id"> *</span><span class="id"> cq%:P</span><span class="id"> +</span><span class="id"> m</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> r1</span><span class="id"> :=</span><span class="id"> r</span><span class="id"> *</span><span class="id"> cq%:P</span><span class="id"> -</span><span class="id"> m</span><span class="id"> *</span><span class="id"> q</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> n</span><span class="id"> is</span><span class="id"> n1</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><span class="id"> loop</span><span class="id"> k</span>.<span class="id">+1</span><span class="id"> qq1</span><span class="id"> r1</span><span class="id"> n1</span><span class="gallina-kwd"> else</span> (<span class="id">k</span>.<span class="id">+1,</span><span class="id"> qq1,</span><span class="id"> r1</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> redivp_expanded_def</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span> (<span class="id">0,</span><span class="id"> 0,</span><span class="id"> p</span>)<span class="gallina-kwd"> else</span><span class="id"> redivp_rec</span><span class="id"> q</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> p</span> (<span class="id">size</span><span class="id"> p</span>).<br/>
<span class="vernacular">Fact</span><span class="id"> redivp_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> redivp</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="id"> nat</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">locked_with</span><span class="id"> redivp_key</span><span class="id"> redivp_expanded_def</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> redivp_unlockable</span><span class="id"> :=</span><span class="id"> [unlockable</span><span class="gallina-kwd"> fun</span><span class="id"> redivp]</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> ((<span class="id">redivp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">1</span>).<span class="id">2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> (<span class="id">redivp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> ((<span class="id">redivp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">1</span>).<span class="id">1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rdvdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><span class="id"> rmodp</span><span class="id"> q</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> 0</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> redivp_def</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> redivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">rscalp</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rscalp</span><span class="id"> /rdivp</span><span class="id"> /rmodp;</span><span class="id"> case:</span> (<span class="id">redivp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [[]]</span><span class="id"> /=</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdiv0p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdivp</span><span class="id"> 0</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rdivp</span><span class="id"> unlock;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> Hp;</span><span class="id"> rewrite</span><span class="id"> /redivp_rec</span><span class="id"> !size_poly0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polySpred</span><span class="id"> ?Hp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rdivp</span><span class="id"> unlock</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_small</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rdivp</span><span class="id"> unlock;</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> _</span><span class="id"> ltpq]</span><span class="id"> :=</span><span class="id"> eqP;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> =&gt;</span><span class="id"> [|s];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ltpq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_rdivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [/rdivp_small-&gt;|]</span><span class="id"> :=</span><span class="id"> ltnP</span> (<span class="id">size</span><span class="id"> p</span>) (<span class="id">size</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span>.<br/>
<span class="id">rewrite</span><span class="id"> /rdivp</span><span class="id"> /rmodp</span><span class="id"> /rscalp</span><span class="id"> unlock</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|q0]</span><span class="id"> //=</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
<span class="id">have:</span><span class="id"> size</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span>.<br/>
<span class="id">move:</span><span class="id"> {2</span><span class="id"> 3</span><span class="id"> 4</span><span class="id"> 6}</span>(<span class="id">size</span><span class="id"> p</span>) (<span class="id">leqnn</span> (<span class="id">size</span><span class="id"> p</span>))<span class="id"> =&gt;</span><span class="id"> A</span>.<br/>
<span class="id">elim:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> 0%N</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> {1</span><span class="id"> 3</span><span class="id"> 4}p</span> (<span class="id">leqnn</span> (<span class="id">size</span><span class="id"> p</span>))<span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ihn]</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/size_poly_leq0P-&gt;;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> q0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /=</span><span class="id"> hrn</span><span class="id"> hr</span><span class="id"> hq1</span><span class="id"> hq;</span><span class="id"> case:</span><span class="id"> ltnP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> hqr</span>.<br/>
<span class="id">have</span><span class="id"> sq:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">have</span><span class="id"> sr:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> r</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> sq</span><span class="id"> hqr</span>.<br/>
<span class="id">apply:</span><span class="id"> ihn</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">-</span><span class="id"> apply/leq_sizeP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> hnj</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> coefB</span><span class="id"> -scalerAl</span><span class="id"> coefZ</span><span class="id"> coefXnM</span><span class="id"> ltn_subRL</span><span class="id"> ltnNge</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> hj</span><span class="id"> :</span> (<span class="id">size</span><span class="id"> r</span>).<span class="id">-1</span><span class="id"> &lt;=</span><span class="id"> j</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> hnj;</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> prednK</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [leqLHS]polySpred</span><span class="id"> -?size_poly_gt0</span><span class="id"> //</span><span class="id"> coefMC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">leq_ltn_trans</span><span class="id"> hj</span>)<span class="id"> /=;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -add1n</span><span class="id"> leq_add2r</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span><span class="id"> hj;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> prednK</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /predU1P</span><span class="id"> [&lt;-</span><span class="id"> |</span><span class="id"> hj]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -subn1</span><span class="id"> subnAC</span><span class="id"> subKn</span><span class="id"> //</span><span class="id"> !subn1</span><span class="id"> !lead_coefE</span><span class="id"> subrr</span>.<br/>
&nbsp;&nbsp;<span class="id">have/leq_sizeP-&gt;</span><span class="id"> //:</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> j</span><span class="id"> -</span> (<span class="id">size</span><span class="id"> r</span><span class="id"> -</span><span class="id"> size</span><span class="id"> q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subnBA</span><span class="id"> //</span><span class="id"> leq_psubRL</span><span class="id"> //</span><span class="id"> leq_add2r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/leq_sizeP:</span> (<span class="id">hj</span>)<span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> mulr0</span><span class="id"> subr0</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span><span class="id"> leq_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> geq_max;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> leq_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_polyC</span><span class="id"> lead_coef_eq0</span><span class="id"> q0</span><span class="id"> /=</span><span class="id"> addn1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_polyN;</span><span class="id"> apply:</span><span class="id"> leq_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> leq_trans</span><span class="id"> hr;</span><span class="id"> rewrite</span><span class="id"> -subn1</span><span class="id"> leq_subLR</span><span class="id"> -[in</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> _</span>)<span class="id">%N]</span>(<span class="id">subnK</span><span class="id"> hqr</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addnA</span><span class="id"> leq_add2r</span><span class="id"> add1n</span><span class="id"> -</span>(<span class="id">@size_polyXn</span><span class="id"> R</span>)<span class="id"> size_scale_leq</span>.<br/>
<span class="id">apply:</span><span class="id"> leq_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> geq_max;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> leq_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_polyC</span><span class="id"> lead_coef_eq0</span><span class="id"> q0</span><span class="id"> /=</span><span class="id"> addnS</span><span class="id"> addn0</span>.<br/>
<span class="id">apply:</span><span class="id"> leq_trans</span> (<span class="id">size_scale_leq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_polyXn</span><span class="id"> -subSn</span><span class="id"> //</span><span class="id"> leq_subLR</span><span class="id"> -add1n</span><span class="id"> leq_add</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmod0p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span><span class="id"> 0</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rmodp</span><span class="id"> unlock;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> Hp;</span><span class="id"> rewrite</span><span class="id"> /redivp_rec</span><span class="id"> !size_poly0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polySpred</span><span class="id"> ?Hp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> p</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rmodp</span><span class="id"> unlock</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rscalp_small</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rscalp</span><span class="id"> unlock;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> //</span><span class="id"> spq</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> sp:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> s]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> spq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltn_rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">size</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">q</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rdivp</span><span class="id"> /rmodp</span><span class="id"> /rscalp</span><span class="id"> unlock;</span><span class="id"> have</span><span class="id"> [-&gt;|q0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> size_poly0</span><span class="id"> ltn0</span>.<br/>
<span class="id">elim:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> 0%N</span><span class="id"> 0</span><span class="id"> {1</span><span class="id"> 3}p</span> (<span class="id">leqnn</span> (<span class="id">size</span><span class="id"> p</span>))<span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ihn]</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="id">move/size_poly_leq0P-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> q0</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> hr</span><span class="id"> /=;</span><span class="id"> case:</span> (<span class="id">ltnP</span> (<span class="id">size</span><span class="id"> r</span>))<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> hsrq;</span><span class="id"> apply/ihn/leq_sizeP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> hnj</span>.<br/>
<span class="id">rewrite</span><span class="id"> coefB</span><span class="id"> -scalerAl</span><span class="id"> !coefZ</span><span class="id"> coefXnM</span><span class="id"> coefMC</span><span class="id"> ltn_subRL</span><span class="id"> ltnNge</span>.<br/>
<span class="id">have</span><span class="id"> sq:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">have</span><span class="id"> sr:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> r</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> hsrq</span>.<br/>
<span class="id">have</span><span class="id"> hj:</span> (<span class="id">size</span><span class="id"> r</span>).<span class="id">-1</span><span class="id"> &lt;=</span><span class="id"> j</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> hnj;</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> prednK</span>.<br/>
<span class="id">move:</span> (<span class="id">leq_add</span><span class="id"> sq</span><span class="id"> hj</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> add1n</span><span class="id"> prednK</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">move:</span><span class="id"> hj;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> prednK</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /predU1P</span><span class="id"> [&lt;-</span><span class="id"> |</span><span class="id"> hj]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -predn_sub</span><span class="id"> subKn</span><span class="id"> //</span><span class="id"> !lead_coefE</span><span class="id"> subrr</span>.<br/>
<span class="id">have/leq_sizeP</span><span class="id"> -&gt;</span><span class="id"> //:</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> j</span><span class="id"> -</span> (<span class="id">size</span><span class="id"> r</span><span class="id"> -</span><span class="id"> size</span><span class="id"> q</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subnBA</span><span class="id"> //</span><span class="id"> leq_subRL</span><span class="id"> ?leq_add2r</span><span class="id"> //</span> (<span class="id">leq_trans</span><span class="id"> hj</span>)<span class="id"> //</span><span class="id"> leq_addr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/leq_sizeP:</span><span class="id"> hj</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> mulr0</span><span class="id"> subr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltn_rmodpN0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_rmodp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> ltn_rmodp</span><span class="id"> p</span><span class="id"> 1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !oner_neq0</span><span class="id"> -size_poly_eq0</span><span class="id"> size_poly1</span><span class="id"> ltnS</span><span class="id"> leqn0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_small</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rmodp</span><span class="id"> unlock;</span><span class="id"> have</span><span class="id"> [-&gt;|_]</span><span class="id"> :=</span><span class="id"> eqP;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> sp:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> s]</span><span class="id"> Hs</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> sp</span><span class="id"> Hs</span><span class="id"> /=</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_rmodp</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">rmodp</span><span class="id"> m</span><span class="id"> d</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [/rmodp_small</span><span class="id"> -&gt;</span><span class="id"> //|h]</span><span class="id"> :=</span><span class="id"> ltnP</span> (<span class="id">size</span><span class="id"> m</span>) (<span class="id">size</span><span class="id"> d</span>).<br/>
<span class="id">have</span><span class="id"> [-&gt;|d0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmodp0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> h;</span><span class="id"> apply:</span><span class="id"> ltnW;</span><span class="id"> rewrite</span><span class="id"> ltn_rmodp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpC</span><span class="id"> p</span><span class="id"> c</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> c%:P</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Hc;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -size_poly_leq0</span><span class="id"> -ltnS</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> 1%N</span><span class="id"> =</span><span class="id"> nat_of_bool</span> (<span class="id">c</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> Hc</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_polyC</span><span class="id"> ltn_rmodp</span><span class="id"> polyC_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp0</span><span class="id"> d</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rdvdp</span><span class="id"> rmod0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvd0p</span><span class="id"> n</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> 0</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rdvdp</span><span class="id"> rmodp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvd0pP</span><span class="id"> n</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">n</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">rdvdp</span><span class="id"> 0</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> rdvd0p;</span><span class="id"> move/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdpN0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> pq</span><span class="id"> hq;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> pq</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> rdvd0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp1</span><span class="id"> d</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> 1</span><span class="id"> =</span> (<span class="id">size</span><span class="id"> d</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rdvdp;</span><span class="id"> have</span><span class="id"> [-&gt;|]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmodp0</span><span class="id"> size_poly0</span> (<span class="id">negPf</span> (<span class="id">oner_neq0</span><span class="id"> _</span>)).<br/>
<span class="id">rewrite</span><span class="id"> -size_poly_leq0</span><span class="id"> -ltnS;</span><span class="id"> case:</span><span class="id"> ltngtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [|/eqP]</span><span class="id"> hd</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmodp_small</span><span class="id"> ?size_poly1</span><span class="id"> //</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">have</span><span class="id"> [c</span><span class="id"> cn0</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> size_poly1P</span><span class="id"> _</span><span class="id"> hd</span>.<br/>
<span class="id">rewrite</span><span class="id"> /rmodp</span><span class="id"> unlock</span><span class="id"> -size_poly_eq0</span><span class="id"> size_poly1</span><span class="id"> /=</span><span class="id"> size_poly1</span><span class="id"> size_polyC</span><span class="id"> cn0</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polyC_eq0</span> (<span class="id">negPf</span><span class="id"> cn0</span>)<span class="id"> !lead_coefC</span><span class="id"> !scale1r</span><span class="id"> subrr</span><span class="id"> !size_poly0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvd1p</span><span class="id"> m</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> 1</span><span class="id"> m</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rdvdp</span><span class="id"> rmodp1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Nrdvdp_small</span> (<span class="id">n</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> n</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nn0</span><span class="id"> hs;</span><span class="id"> rewrite</span><span class="id"> /rdvdp</span> (<span class="id">rmodp_small</span><span class="id"> hs</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> negPf</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_eq0P</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">rdvdp</span><span class="id"> q</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">iffP</span><span class="id"> eqP</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_eq0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> q</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmodp_eq0P</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_leq</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dvd_pq;</span><span class="id"> rewrite</span><span class="id"> leqNgt;</span><span class="id"> apply:</span><span class="id"> contra</span><span class="id"> =&gt;</span><span class="id"> /rmodp_small</span><span class="id"> &lt;-</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> rgcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">p1,</span><span class="id"> q1</span>)<span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="gallina-kwd"> then</span> (<span class="id">q,</span><span class="id"> p</span>)<span class="gallina-kwd"> else</span> (<span class="id">p,</span><span class="id"> q</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> p1</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> q1</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="gallina-kwd"> fix</span><span class="id"> loop</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">pp</span><span class="id"> qq</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> {struct</span><span class="id"> n}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> rr</span><span class="id"> :=</span><span class="id"> rmodp</span><span class="id"> pp</span><span class="id"> qq</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> rr</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> qq</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> n</span><span class="id"> is</span><span class="id"> n1</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><span class="id"> loop</span><span class="id"> n1</span><span class="id"> qq</span><span class="id"> rr</span><span class="gallina-kwd"> else</span><span class="id"> rr</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">loop</span> (<span class="id">size</span><span class="id"> p1</span>)<span class="id"> p1</span><span class="id"> q1</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rgcd0p</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> 0</span><span class="id"> rgcdp</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> /rgcdp</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> if_neg</span>.<br/>
<span class="id">case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [_</span><span class="id"> |</span><span class="id"> nzp];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polySpred</span><span class="id"> !</span>(<span class="id">rmodp0,</span><span class="id"> nzp</span>)<span class="id"> //;</span><span class="id"> case:</span><span class="id"> _</span>.<span class="id">-1</span><span class="id"> =&gt;</span><span class="id"> [|m];</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rgcdp0</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> 0</span><span class="id"> rgcdp</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p;</span><span class="id"> have:=</span><span class="id"> rgcd0p</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> /rgcdp</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> p0;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">eqxx,</span><span class="id"> p0</span>)<span class="id"> //=</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rgcdpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rgcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="gallina-kwd"> if</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span><span class="id"> rgcdp</span> (<span class="id">rmodp</span><span class="id"> q</span><span class="id"> p</span>)<span class="id"> p</span><span class="gallina-kwd"> else</span><span class="id"> rgcdp</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> rgcdp_rec</span><span class="id"> :=</span><span class="gallina-kwd"> fix</span><span class="id"> rgcdp_rec</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">pp</span><span class="id"> qq</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> {struct</span><span class="id"> n}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> rr</span><span class="id"> :=</span><span class="id"> rmodp</span><span class="id"> pp</span><span class="id"> qq</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> rr</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> qq</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> n</span><span class="id"> is</span><span class="id"> n1</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><span class="id"> rgcdp_rec</span><span class="id"> n1</span><span class="id"> qq</span><span class="id"> rr</span><span class="gallina-kwd"> else</span><span class="id"> rr</span>.<br/>
<span class="id">have</span><span class="id"> Irec:</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-&gt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> rgcdp_rec</span><span class="id"> m</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> rgcdp_rec</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> elim=&gt;</span><span class="id"> [|m</span><span class="id"> Hrec]</span><span class="id"> [|n]</span><span class="id"> //=</span><span class="id"> p1</span><span class="id"> q1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span><span class="id"> move/size_poly_leq0P=&gt;</span><span class="id"> -&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> rmodp0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/negPf-&gt;;</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> /size_poly_leq0P</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> rmodp0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/negPf-&gt;;</span><span class="id"> case:</span><span class="id"> m</span><span class="id"> {Hrec}</span><span class="id"> =&gt;</span><span class="id"> [|m]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> Epq</span><span class="id"> Sm</span><span class="id"> Sn</span><span class="id"> Sq</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [-&gt;|nzq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q1</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> m</span><span class="id"> {Sm</span><span class="id"> Sn</span><span class="id"> Hrec}</span><span class="id"> =&gt;</span><span class="id"> [|m]</span><span class="id"> [|n]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> Hrec;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_rmodp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> Sm</span>)<span class="id"> //</span><span class="id"> ltn_rmodp</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> Sn</span>)<span class="id"> //</span><span class="id"> ltn_rmodp</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nzp]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> rmodp0</span><span class="id"> rgcd0p</span><span class="id"> rgcdp0</span><span class="id"> if_same</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nzq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> rmodp0</span><span class="id"> rgcd0p</span><span class="id"> rgcdp0</span><span class="id"> if_same</span>.<br/>
<span class="id">rewrite</span><span class="id"> /rgcdp</span><span class="id"> -/rgcdp_rec</span><span class="id"> !ltn_rmodp</span> (<span class="id">negPf</span><span class="id"> nzp</span>) (<span class="id">negPf</span><span class="id"> nzq</span>)<span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [ltpq|leqp]</span><span class="id"> :=</span><span class="id"> ltnP;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">negPf</span><span class="id"> nzp,</span><span class="id"> negPf</span><span class="id"> nzq</span>)<span class="id"> //=</span><span class="id"> polySpred</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|nzqp]</span><span class="id"> :=</span><span class="id"> eqVneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> =&gt;</span><span class="id"> [|[|s]];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rmodp0</span> (<span class="id">negPf</span><span class="id"> nzp</span>)<span class="id"> //</span><span class="id"> rmod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> Irec</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_rmodp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> -polySpred</span><span class="id"> //</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> ltpq</span>)<span class="id"> ?leqW</span><span class="id"> //</span><span class="id"> ltn_rmodp</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltnW</span><span class="id"> //</span><span class="id"> ltn_rmodp</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nzpq]</span><span class="id"> :=</span><span class="id"> eqVneq</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">size</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [|[|s]];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rmodp0</span> (<span class="id">negPf</span><span class="id"> nzq</span>)<span class="id"> //</span><span class="id"> rmod0p</span><span class="id"> eqxx</span>.<br/>
<span class="id">apply:</span><span class="id"> Irec</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_rmodp</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> -polySpred</span><span class="id"> //</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> leqp</span>)<span class="id"> //</span><span class="id"> ltn_rmodp</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltnW</span><span class="id"> //</span><span class="id"> ltn_rmodp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> comm_redivp_spec</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">ComEdivnSpec</span><span class="id"> k</span> (<span class="id">q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> of</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">GRing</span>.<span class="id">comm</span><span class="id"> d</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id">%:P</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> comm_redivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">k,</span><span class="id"> q,</span><span class="id"> r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_redivpP</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> comm_redivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">redivp</span><span class="id"> m</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock;</span><span class="id"> have</span><span class="id"> [-&gt;|Hd]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> constructor;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">simp,</span><span class="id"> eqxx</span>).<br/>
<span class="id">have:</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> d</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id">%:P</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> 0</span>)<span class="id">%:P</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> m</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !simp</span>.<br/>
<span class="id">elim:</span> (<span class="id">size</span><span class="id"> m</span>)<span class="id"> 0%N</span><span class="id"> 0</span><span class="id"> {1</span><span class="id"> 4</span><span class="id"> 6}m</span> (<span class="id">leqnn</span> (<span class="id">size</span><span class="id"> m</span>))<span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> k</span><span class="id"> q</span><span class="id"> r</span><span class="id"> Hr</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">move/size_poly_leq0P:</span><span class="id"> Hr</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> hsd:</span><span class="id"> size</span> (<span class="id">0:</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> hsd</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> ?;</span><span class="id"> constructor</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">case:</span><span class="id"> ltnP</span><span class="id"> =&gt;</span><span class="id"> Hlt</span><span class="id"> Heq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> constructor</span>.<br/>
<span class="id">apply/IHn=&gt;</span><span class="id"> [|Cda];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> addrAC</span><span class="id"> -addrA</span><span class="id"> subrK</span><span class="id"> exprSr</span><span class="id"> polyCM</span><span class="id"> mulrA</span><span class="id"> Heq</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> -mulrA</span><span class="vernacular"> Cda</span><span class="id"> mulrA</span>.<br/>
<span class="id">apply/leq_sizeP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> Hj;</span><span class="id"> rewrite</span><span class="id"> coefB</span><span class="id"> coefMC</span><span class="id"> -scalerAl</span><span class="id"> coefZ</span><span class="id"> coefXnM</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltn_subRL</span><span class="id"> ltnNge</span> (<span class="id">leq_trans</span><span class="id"> Hr</span>)<span class="id"> /=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leq_ltn_trans</span><span class="id"> Hj</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -add1n</span><span class="id"> leq_add2r</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">move:</span><span class="id"> Hj;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt;</span><span class="id"> case/predU1P</span><span class="id"> =&gt;</span><span class="id"> [&lt;-{j}</span><span class="id"> |</span><span class="id"> Hj];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !nth_default</span><span class="id"> ?simp</span><span class="id"> ?oppr0</span><span class="id"> ?</span>(<span class="id">leq_trans</span><span class="id"> Hr</span>)<span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">subKn</span><span class="id"> Hlt</span>)<span class="id"> leq_sub2r</span><span class="id"> //</span> (<span class="id">leq_trans</span><span class="id"> Hr</span>).<br/>
<span class="id">move:</span><span class="id"> Hr;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> ltnS;</span><span class="id"> case/predU1P=&gt;</span><span class="id"> Hqq;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !nth_default</span><span class="id"> ?simp</span><span class="id"> ?oppr0</span><span class="id"> //</span><span class="id"> -{1}</span>(<span class="id">subKn</span><span class="id"> Hlt</span>)<span class="id"> leq_sub2r</span>.<br/>
<span class="id">rewrite</span><span class="id"> /lead_coef</span><span class="id"> Hqq</span><span class="id"> polySpred</span><span class="id"> //</span><span class="id"> subSS</span><span class="id"> subKn</span><span class="id"> ?addrN</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -subn1</span><span class="id"> leq_subLR</span><span class="id"> add1n</span><span class="id"> -Hqq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpp</span><span class="id"> p</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> p</span> (<span class="id">lead_coef</span><span class="id"> p</span>)<span class="id">%:P</span><span class="id"> -&gt;</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hC;</span><span class="id"> rewrite</span><span class="id"> /rmodp</span><span class="id"> unlock;</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> //|]</span><span class="id"> :=</span><span class="id"> eqVneq</span>.<br/>
<span class="id">rewrite</span><span class="id"> -size_poly_eq0</span><span class="id"> /redivp_rec;</span><span class="id"> case</span><span class="id"> sp:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id">=&gt;</span><span class="id"> [|n]</span><span class="id"> //</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> sp</span><span class="id"> ltnn</span><span class="id"> subnn</span><span class="id"> expr0</span><span class="id"> hC</span><span class="id"> alg_polyC</span><span class="id"> !simp</span><span class="id"> subrr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> sp</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> sp;</span><span class="id"> rewrite</span><span class="id"> size_polyC</span><span class="id"> /=</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> rcoprimep</span> (<span class="id">p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :=</span><span class="id"> size</span> (<span class="id">rgcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> ==</span><span class="id"> 1</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> rgdcop_rec</span><span class="id"> q</span><span class="id"> p</span><span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> n</span><span class="id"> is</span><span class="id"> m</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> rcoprimep</span><span class="id"> p</span><span class="id"> q</span><span class="gallina-kwd"> then</span><span class="id"> p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="id"> rgdcop_rec</span><span class="id"> q</span> (<span class="id">rdivp</span><span class="id"> p</span> (<span class="id">rgcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> rgdcop</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> rgdcop_rec</span><span class="id"> q</span><span class="id"> p</span> (<span class="id">size</span><span class="id"> p</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rgdcop0</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rgdcop</span><span class="id"> q</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rgdcop</span><span class="id"> size_poly0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RingPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> CommonRing</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RingComRreg</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> CommonRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComRegDivisor</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> nzRingType</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="vernacular"> Cdl</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> d</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id">%:P</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> Rreg</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">rreg</span> (<span class="id">lead_coef</span><span class="id"> d</span>).<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> redivp_eq</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> k</span><span class="id"> :=</span> (<span class="id">redivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span>).<span class="id">1</span>.<span class="id">1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> c</span><span class="id"> :=</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">redivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span> (<span class="id">k,</span><span class="id"> q</span><span class="id"> *</span><span class="id"> c,</span><span class="id"> r</span><span class="id"> *</span><span class="id"> c</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> lt_rd;</span><span class="id"> case:</span><span class="id"> comm_redivpP=&gt;</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> r1</span><span class="id"> /</span>(_<span class="vernacular"> Cdl</span>)<span class="id"> Heq</span>.<br/>
<span class="id">have</span><span class="id"> dn0:</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">size</span><span class="id"> d</span>)<span class="id"> lt_rd</span> (<span class="id">size_poly_eq0</span><span class="id"> d</span>)<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> _</span><span class="id"> &lt;-</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /</span>(_<span class="id"> dn0</span>)<span class="id"> Hs</span>.<br/>
<span class="id">have</span><span class="id"> eC</span><span class="id"> :</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="id"> *</span><span class="id"> d</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrA</span><span class="id"> polyC_exp</span> (<span class="id">commrX</span><span class="id"> k</span><span class="vernacular"> Cdl</span>)<span class="id"> mulrA</span>.<br/>
<span class="id">suff</span><span class="id"> e1</span><span class="id"> :</span><span class="id"> q1</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_,</span><span class="id"> _,</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> move/eqP:</span><span class="id"> Heq</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> +</span><span class="id"> r1]addrC</span><span class="id"> -subr_eq</span><span class="id"> e1</span><span class="id"> mulrDl</span><span class="id"> addrAC</span><span class="id"> eC</span><span class="id"> subrr</span><span class="id"> add0r;</span><span class="id"> move/eqP</span>.<br/>
<span class="id">have</span><span class="id"> :</span> (<span class="id">q1</span><span class="id"> -</span><span class="id"> q</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> =</span><span class="id"> r</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="id"> -</span><span class="id"> r1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@addIr</span><span class="id"> _</span><span class="id"> r1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> subrK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@addrI</span><span class="id"> _</span> ((<span class="id">q</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">%:P</span>)<span class="id"> *</span><span class="id"> d</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> mulNr</span><span class="id"> !addrA</span><span class="id"> [_</span><span class="id"> +</span> (<span class="id">q1</span><span class="id"> *</span><span class="id"> d</span>)<span class="id">]addrC</span><span class="id"> addrK</span><span class="id"> -eC</span><span class="id"> -mulrDl</span>.<br/>
<span class="id">move/eqP;</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> ==</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _]subr_eq0</span><span class="id"> rreg_div0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/andP;</span><span class="id"> rewrite</span><span class="id"> subr_eq0;</span><span class="id"> move/eqP</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_polyN;</span><span class="id"> apply:</span> (<span class="id">leq_ltn_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> size_polyN</span>.<br/>
<span class="id">rewrite</span><span class="id"> gtn_max</span><span class="id"> Hs</span> (<span class="id">leq_ltn_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_polyC;</span><span class="id"> case:</span> (_<span class="id"> ==</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addnS</span><span class="id"> addn0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addn0;</span><span class="id"> apply:</span><span class="id"> leq_ltn_trans</span><span class="id"> lt_rd;</span><span class="id"> case:</span><span class="id"> size</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_eq</span><span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span> (<span class="id">rscalp</span><span class="id"> p</span><span class="id"> d</span>))<span class="id">%:P</span><span class="id"> =</span> (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /rdivp</span><span class="id"> /rmodp</span><span class="id"> /rscalp;</span><span class="id"> case:</span><span class="id"> comm_redivpP=&gt;</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> r1</span><span class="id"> Hc</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> Hc</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_rdvdp</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> p:</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> *</span> ((<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id">^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="id"> =</span><span class="id"> q1</span><span class="id"> *</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> he</span>.<br/>
<span class="id">have</span><span class="id"> Hnq0</span><span class="id"> :=</span><span class="id"> rreg_lead0</span><span class="id"> Rreg;</span><span class="id"> set</span><span class="id"> lq</span><span class="id"> :=</span><span class="id"> lead_coef</span><span class="id"> d</span>.<br/>
<span class="id">pose</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> d;</span><span class="id"> pose</span><span class="id"> m</span><span class="id"> :=</span><span class="id"> maxn</span><span class="id"> v</span><span class="id"> k</span>.<br/>
<span class="id">rewrite</span><span class="id"> /rdvdp</span><span class="id"> -</span>(<span class="id">rreg_polyMC_eq0</span><span class="id"> _</span> (<span class="id">@rregX</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> v</span>)<span class="id"> Rreg</span>)).<br/>
<span class="id">suff:</span><br/>
&nbsp;((<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *</span> (<span class="id">lq</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> v</span>))<span class="id">%:P</span><span class="id"> -</span><span class="id"> q1</span><span class="id"> *</span> (<span class="id">lq</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> k</span>))<span class="id">%:P</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><br/>
&nbsp;&nbsp;(<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *</span> (<span class="id">lq</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> v</span>))<span class="id">%:P</span><span class="id"> ==</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> rreg_div0</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case/andP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rreg_size</span><span class="id"> ?ltn_rmodp</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> rregX</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> addrAC</span><span class="id"> mulNr</span><span class="id"> -!mulrA</span><span class="id"> polyC_exp</span><span class="id"> -</span>(<span class="id">commrX</span> (<span class="id">m-v</span>)<span class="vernacular"> Cdl</span>).<br/>
<span class="id">rewrite</span><span class="id"> -polyC_exp</span><span class="id"> mulrA</span><span class="id"> -mulrDl</span><span class="id"> -rdivp_eq</span><span class="id"> //</span><span class="id"> [</span>(_<span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> k</span>))<span class="id">%:P]polyC_exp</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">commrX</span> (<span class="id">m-k</span>)<span class="vernacular"> Cdl</span>)<span class="id"> -polyC_exp</span><span class="id"> mulrA</span><span class="id"> -he</span><span class="id"> -!mulrA</span><span class="id"> -!polyCM</span><span class="id"> -/v</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!exprD</span><span class="id"> addnC</span><span class="id"> subnK</span><span class="id"> ?leq_maxl</span><span class="id"> //</span><span class="id"> addnC</span><span class="id"> subnK</span><span class="id"> ?subrr</span><span class="id"> ?leq_maxr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> rdvdp_spec</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Rdvdp</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> &amp;</span><span class="id"> p</span><span class="id"> *</span> ((<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">^+</span><span class="id"> k</span>)<span class="id">%:P</span><span class="id"> =</span><span class="id"> q1</span><span class="id"> *</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rdvdp_spec</span><span class="id"> p</span><span class="id"> q</span><span class="id"> 0</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> RdvdpN</span><span class="id"> &amp;</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> rdvdp_spec</span><span class="id"> p</span><span class="id"> q</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> false</span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_eqP</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdvdp_spec</span><span class="id"> p</span><span class="id"> d</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>) (<span class="id">rdvdp</span><span class="id"> d</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> hdvd:</span> (<span class="id">rdvdp</span><span class="id"> d</span><span class="id"> p</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> RdvdpN;</span><span class="id"> move/rmodp_eq0P/eqP:</span><span class="id"> hdvd</span>.<br/>
<span class="id">move/rmodp_eq0P:</span> (<span class="id">hdvd</span>)<span class="id">-&gt;;</span><span class="id"> apply:</span> (<span class="id">@Rdvdp</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">rscalp</span><span class="id"> p</span><span class="id"> d</span>) (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rdivp_eq</span><span class="id"> //;</span><span class="id"> move/rmodp_eq0P:</span> (<span class="id">hdvd</span>)<span class="id">-&gt;;</span><span class="id"> rewrite</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_mull</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">@eq_rdvdp</span><span class="id"> 0</span><span class="id"> p</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> expr0</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_mull</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/eqP/rdvdp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpp</span><span class="id"> :</span><span class="id"> rmodp</span><span class="id"> d</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[d</span><span class="gallina-kwd"> in</span><span class="id"> rmodp</span><span class="id"> d</span><span class="id"> _]mul1r</span><span class="id"> rmodp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivpp</span><span class="id"> :</span><span class="id"> rdivp</span><span class="id"> d</span><span class="id"> d</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> d</span><span class="id"> d</span>)<span class="id">%:P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> dn0</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0</span><span class="id"> rreg_neq0</span>.<br/>
<span class="id">move:</span> (<span class="id">rdivp_eq</span><span class="id"> d</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> rmodpp</span><span class="id"> addr0</span>.<br/>
<span class="id">suff</span><span class="id"> -&gt;:</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> d</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> d</span><span class="id"> d</span>)<span class="id">%:P</span><span class="gallina-kwd"> by</span><span class="id"> move/</span>(<span class="id">rreg_lead</span><span class="id"> Rreg</span>)<span class="id">-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polyC_exp;</span><span class="id"> apply:</span><span class="id"> commrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdpp</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> d</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/eqP/rmodpp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivpK</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> p</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span><span class="id"> *</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id">%:P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rdivp_eq</span><span class="id"> /rdvdp;</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ComRegDivisor</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> RingComRreg</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RingMonic</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> CommonRing</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> RingComRreg</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RingMonic</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> nzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MonicDivisor</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> mond</span><span class="id"> :</span><span class="id"> d</span><span class="id"> \is</span><span class="id"> monic</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> redivp_eq</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> k</span><span class="id"> :=</span> (<span class="id">redivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span>).<span class="id">1</span>.<span class="id">1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">redivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span> (<span class="id">k,</span><span class="id"> q,</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id">=&gt;</span><span class="id"> Hc</span><span class="id"> Hr</span><span class="id"> /</span>(<span class="id">redivp_eq</span><span class="id"> Hc</span><span class="id"> Hr</span><span class="id"> q</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> !mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_eq</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -rdivp_eq</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> commr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivpp</span><span class="id"> :</span><span class="id"> rdivp</span><span class="id"> d</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id"> =&gt;</span><span class="id"> hc</span><span class="id"> hr;</span><span class="id"> rewrite</span><span class="id"> rdivpp</span><span class="id"> //</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id"> expr1n</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_addl_mul_small</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> rdivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Hd;</span><span class="id"> case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id">=&gt;</span><span class="id"> Hc</span><span class="id"> Hr;</span><span class="id"> rewrite</span><span class="id"> /rdivp</span><span class="id"> redivp_eq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_addl_mul</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> rdivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> q</span><span class="id"> +</span><span class="id"> rdivp</span><span class="id"> r</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id">=&gt;</span><span class="id"> Hc</span><span class="id"> Hr;</span><span class="id"> rewrite</span><span class="id"> [r</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> *</span><span class="id"> _</span><span class="id"> +</span><span class="id"> r]rdivp_eq</span><span class="id"> addrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrDl</span><span class="id"> rdivp_addl_mul_small</span><span class="id"> //</span><span class="id"> ltn_rmodp</span><span class="id"> monic_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivpDl</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> rdivp</span> (<span class="id">q</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rdivp</span><span class="id"> q</span><span class="id"> d</span><span class="id"> +</span><span class="id"> rdivp</span><span class="id"> r</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id">=&gt;</span><span class="id"> Hc</span><span class="id"> Hr;</span><span class="id"> rewrite</span><span class="id"> [r</span><span class="gallina-kwd"> in</span><span class="id"> q</span><span class="id"> +</span><span class="id"> r]rdivp_eq</span><span class="id"> addrA</span>.<br/>
<span class="id">rewrite</span><span class="id"> [q</span><span class="gallina-kwd"> in</span><span class="id"> q</span><span class="id"> +</span><span class="id"> _</span><span class="id"> +</span><span class="id"> _]rdivp_eq;</span><span class="id"> move/rmodp_eq0P-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addr0</span><span class="id"> -mulrDl</span><span class="id"> rdivp_addl_mul_small</span><span class="id"> //</span><span class="id"> ltn_rmodp</span><span class="id"> monic_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivpDr</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> rdivp</span> (<span class="id">q</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rdivp</span><span class="id"> q</span><span class="id"> d</span><span class="id"> +</span><span class="id"> rdivp</span><span class="id"> r</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrC;</span><span class="id"> move/rdivpDl-&gt;;</span><span class="id"> rewrite</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_mull</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdivp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[p</span><span class="id"> *</span><span class="id"> d]addr0</span><span class="id"> rdivp_addl_mul</span><span class="id"> rdiv0p</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_mull</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> rmodp_mull;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id">;</span><span class="id"> [apply:</span><span class="id"> commr1</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rreg1]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpp</span><span class="id"> :</span><span class="id"> rmodp</span><span class="id"> d</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> rmodpp;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id">;</span><span class="id"> [apply:</span><span class="id"> commr1</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rreg1]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_addl_mul_small</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> rmodp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Hd;</span><span class="id"> case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id">=&gt;</span><span class="id"> Hc</span><span class="id"> Hr;</span><span class="id"> rewrite</span><span class="id"> /rmodp</span><span class="id"> redivp_eq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_id</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmodp_small</span><span class="id"> //</span><span class="id"> ltn_rmodpN0</span><span class="id"> //</span><span class="id"> monic_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpD</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> d</span><span class="id"> +</span><span class="id"> rmodp</span><span class="id"> q</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [p</span><span class="gallina-kwd"> in</span><span class="id"> LHS]rdivp_eq</span><span class="id"> [q</span><span class="gallina-kwd"> in</span><span class="id"> LHS]rdivp_eq</span><span class="id"> addrACA</span><span class="id"> -mulrDl</span>.<br/>
<span class="id">rewrite</span><span class="id"> rmodp_addl_mul_small</span><span class="id"> //;</span><span class="id"> apply:</span> (<span class="id">leq_ltn_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtn_max</span><span class="id"> !ltn_rmodp</span><span class="id"> //</span><span class="id"> monic_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpN</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {1}</span>(<span class="id">rdivp_eq</span><span class="id"> p</span>)<span class="id"> opprD</span><span class="id"> //</span><span class="id"> -mulNr</span><span class="id"> rmodp_addl_mul_small</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_polyN</span><span class="id"> ltn_rmodp</span><span class="id"> //</span><span class="id"> monic_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpB</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> -</span><span class="id"> q</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> d</span><span class="id"> -</span><span class="id"> rmodp</span><span class="id"> q</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmodpD</span><span class="id"> rmodpN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpZ</span><span class="id"> a</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">altP</span> (<span class="id">a</span><span class="id"> =P</span><span class="id"> 0%R</span>))<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> cn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !scale0r</span><span class="id"> rmod0p</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span> ((<span class="id">a</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> *:</span> (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span>))<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>))<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerDr</span><span class="id"> -rdivp_eq</span>.<br/>
<span class="id">rewrite</span> <span class="id"> rmodp_addl_mul_small</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> -mul_polyC;</span><span class="id"> apply:</span><span class="id"> leq_ltn_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_polyC</span><span class="id"> cn0</span><span class="id"> addSn</span><span class="id"> add0n</span><span class="id"> /=</span><span class="id"> ltn_rmodp</span>.<br/>
<span class="id">exact:</span><span class="id"> monic_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">rmodp</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> d</span><span class="id"> =</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">rmodp</span> (<span class="id">F</span><span class="id"> i</span>)<span class="id"> d</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> elim/big_rec2:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> p</span><span class="id"> q</span><span class="id"> _</span><span class="id"> &lt;-];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">rmod0p,</span><span class="id"> rmodpD</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_mulmr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> *</span> (<span class="id">rmodp</span><span class="id"> q</span><span class="id"> d</span>))<span class="id"> d</span><span class="id"> =</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [q</span><span class="gallina-kwd"> in</span><span class="id"> RHS]rdivp_eq</span><span class="id"> mulrDr</span><span class="id"> rmodpD</span><span class="id"> mulrA</span><span class="id"> rmodp_mull</span><span class="id"> add0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdpp</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> rdvdpp;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id">;</span><span class="id"> [apply:</span><span class="id"> commr1</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rreg1]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_rdvdp</span><span class="id"> q1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q1</span><span class="id"> *</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="comment">(*&nbsp;&nbsp;this&nbsp;probably&nbsp;means&nbsp;I&nbsp;need&nbsp;to&nbsp;specify&nbsp;impl&nbsp;args&nbsp;for&nbsp;comm_rref_rdvdp&nbsp;*)</span><br/>
<span class="id">move=&gt;</span><span class="id"> h;</span><span class="id"> apply:</span> (<span class="id">@eq_rdvdp</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 1</span><span class="id"> q1</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>).<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> commr1</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> rreg1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_mull</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> rdvdp_mull;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id"> //;</span><span class="id"> [apply:</span><span class="id"> commr1</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rreg1]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdpP</span><span class="id"> p</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> qq,</span><span class="id"> p</span><span class="id"> =</span><span class="id"> qq</span><span class="id"> *</span><span class="id"> d</span>) (<span class="id">rdvdp</span><span class="id"> d</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">monic_comreg</span><span class="id"> mond</span>)<span class="id">=&gt;</span><span class="id"> Hc</span><span class="id"> Hr;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[qq]</span><span class="id"> /eq_rdvdp</span><span class="id"> //]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> rdvdp_eqP=&gt;</span><span class="id"> //</span><span class="id"> k</span><span class="id"> qq;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> mond</span>)<span class="id"> expr1n</span><span class="id"> mulr1</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="gallina-kwd"> exists</span><span class="id"> qq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivpK</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdvdp</span><span class="id"> d</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dvddp;</span><span class="id"> rewrite</span><span class="id"> [RHS]rdivp_eq</span><span class="id"> rmodp_eq0</span><span class="id"> ?addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MonicDivisor</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> drop_poly_rdivp</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> drop_poly</span><span class="id"> n</span><span class="id"> p</span><span class="id"> =</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> 'X^n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[p</span><span class="gallina-kwd"> in</span><span class="id"> RHS]</span>(<span class="id">poly_take_drop</span><span class="id"> n</span>)<span class="id"> addrC</span><span class="id"> rdivp_addl_mul</span><span class="id"> ?monicXn//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rdivp_small</span><span class="id"> ?addr0//</span><span class="id"> size_polyXn</span><span class="id"> ltnS</span><span class="id"> size_take_poly</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> take_poly_rmodp</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> take_poly</span><span class="id"> n</span><span class="id"> p</span><span class="id"> =</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> 'X^n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> mX</span><span class="id"> :=</span><span class="id"> monicXn</span><span class="id"> R</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> -[p</span><span class="gallina-kwd"> in</span><span class="id"> RHS]</span>(<span class="id">poly_take_drop</span><span class="id"> n</span>)<span class="id"> rmodpD//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmodp_small</span><span class="id"> ?rmodp_mull</span><span class="id"> ?addr0//</span><span class="id"> size_polyXn</span><span class="id"> ltnS</span><span class="id"> size_take_poly</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RingMonic</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComRingMonic</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comNzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> mond</span><span class="id"> :</span><span class="id"> d</span><span class="id"> \is</span><span class="id"> monic</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_mulml</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [in</span><span class="id"> LHS]mulrC</span><span class="id"> [in</span><span class="id"> RHS]mulrC</span><span class="id"> rmodp_mulmr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodpX</span><span class="id"> p</span><span class="id"> n</span><span class="id"> :</span><span class="id"> rmodp</span> ((<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> d</span><span class="id"> =</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IH];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !exprS</span><span class="id"> -rmodp_mulmr</span><span class="id"> //</span><span class="id"> IH</span><span class="id"> rmodp_mulmr</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> rmodp_mulmr</span><span class="id"> //</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmodp_compr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rmodp</span> (<span class="id">p</span><span class="id"> \Po</span> (<span class="id">rmodp</span><span class="id"> q</span><span class="id"> d</span>))<span class="id"> d</span><span class="id"> =</span> (<span class="id">rmodp</span> (<span class="id">p</span><span class="id"> \Po</span><span class="id"> q</span>)<span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/poly_ind:</span><span class="id"> p</span><span class="id"> =&gt;</span><span class="id"> [|p</span><span class="id"> c</span><span class="id"> IH];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !comp_polyC</span><span class="id"> !rmod0p</span>.<br/>
<span class="id">rewrite</span><span class="id"> !comp_polyD</span><span class="id"> !comp_polyM</span><span class="id"> addrC</span><span class="id"> rmodpD</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrC</span><span class="id"> -rmodp_mulmr</span><span class="id"> //</span><span class="id"> IH</span><span class="id"> rmodp_mulmr</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !comp_polyX</span><span class="id"> !comp_polyC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> rmodp_mulmr</span><span class="id"> //</span><span class="id"> -rmodpD</span><span class="id"> //</span><span class="id"> addrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ComRingMonic</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> RingMonic</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Ring</span>.<br/>
<br/>
<span class="vernacular">Include</span><span class="id"> CommonRing</span>.<br/>
<span class="vernacular">Import</span><span class="id"> RingMonic</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ExtraMonicDivisor</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> nzRingType</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[p</span><span class="gallina-kwd"> in</span><span class="id"> LHS]mulr1</span><span class="id"> rdivp_mull</span><span class="id"> //</span><span class="id"> monic1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_XsubCl</span><span class="id"> p</span><span class="id"> x</span><span class="id"> :</span><span class="id"> rdvdp</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> p</span><span class="id"> =</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [HcX</span><span class="id"> Hr]</span><span class="id"> :=</span><span class="id"> monic_comreg</span> (<span class="id">monicXsubC</span><span class="id"> x</span>).<br/>
<span class="id">apply/rmodp_eq0P/factor_theorem</span><span class="id"> =&gt;</span><span class="id"> [|[p1</span><span class="id"> -&gt;]];</span><span class="id"> last</span><span class="id"> exact/rmodp_mull/monicXsubC</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> e0;</span><span class="gallina-kwd"> exists</span> (<span class="id">rdivp</span><span class="id"> p</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [LHS]</span>(<span class="id">rdivp_eq</span> (<span class="id">monicXsubC</span><span class="id"> x</span>))<span class="id"> e0</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> polyXsubCP</span><span class="id"> p</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">p</span>.<span class="id">[x]</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">rdvdp</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> rdvdp_XsubCl;</span><span class="id"> move/rootP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_factor_theorem</span><span class="id"> p</span><span class="id"> x</span><span class="id"> :</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> =</span> (<span class="id">rdvdp</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rdvdp_XsubCl</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ExtraMonicDivisor</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Ring</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComRing</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> RingComRreg</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CommutativeRingPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comNzRingType</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> m</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> redivp_spec</span> (<span class="id">m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><span class="id"> nat</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">EdivnSpec</span><span class="id"> k</span> (<span class="id">q</span><span class="id"> r:</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> of</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> *:</span><span class="id"> m</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> redivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">k,</span><span class="id"> q,</span><span class="id"> r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> redivpP</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> redivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">redivp</span><span class="id"> m</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> redivp_def;</span><span class="id"> constructor;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dn0;</span><span class="id"> rewrite</span><span class="id"> ltn_rmodp</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mul_polyC</span><span class="id"> mulrC</span><span class="id"> rdivp_eq</span><span class="id"> //=</span><span class="id"> /GRing</span>.<span class="id">comm</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdivp_eq</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *:</span><span class="id"> p</span><span class="id"> =</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /rdivp</span><span class="id"> /rmodp</span><span class="id"> /rscalp;</span><span class="id"> case:</span><span class="id"> redivpP=&gt;</span><span class="id"> k</span><span class="id"> q1</span><span class="id"> r1</span><span class="id"> Hc</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> Hc</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_eqP</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rdvdp_spec</span><span class="id"> p</span><span class="id"> d</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> d</span>) (<span class="id">rdvdp</span><span class="id"> d</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> hdvd:</span> (<span class="id">rdvdp</span><span class="id"> d</span><span class="id"> p</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move/rmodp_eq0P/eqP/RdvdpN:</span><span class="id"> hdvd</span>.<br/>
<span class="id">move/rmodp_eq0P:</span> (<span class="id">hdvd</span>)<span class="id">-&gt;;</span><span class="id"> apply:</span> (<span class="id">@Rdvdp</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">rscalp</span><span class="id"> p</span><span class="id"> d</span>) (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> d</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mul_polyC</span><span class="id"> rdivp_eq;</span><span class="id"> move/rmodp_eq0P:</span> (<span class="id">hdvd</span>)<span class="id">-&gt;;</span><span class="id"> rewrite</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rdvdp_eq</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rdvdp</span><span class="id"> q</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> rdivp_eq;</span><span class="id"> apply/rmodp_eq0P/eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|/eqP];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> addrC</span><span class="id"> -subr_eq</span><span class="id"> subrr;</span><span class="id"> move/eqP&lt;-</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CommutativeRingPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ComRing</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> UnitRing</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitRingPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> unitRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> uniq_roots_rdvdp</span><span class="id"> p</span><span class="id"> rs</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">all</span> (<span class="id">root</span><span class="id"> p</span>)<span class="id"> rs</span><span class="id"> -&gt;</span><span class="id"> uniq_roots</span><span class="id"> rs</span><span class="id"> -&gt;</span><span class="id"> rdvdp</span> (<span class="id">\prod_</span>(<span class="id">z</span><span class="id"> &lt;-</span><span class="id"> rs</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> z%:P</span>))<span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rrs</span><span class="id"> /</span>(<span class="id">uniq_roots_prod_XsubC</span><span class="id"> rrs</span>)<span class="id"> [q</span><span class="id"> -&gt;]</span>.<br/>
<span class="id">exact/RingMonic</span>.<span class="id">rdvdp_mull/monic_prod_XsubC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> UnitRingPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> UnitRing</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> IdomainDefs</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> IDomainPseudoDivisionDefs</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> edivp_expanded_def</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">k,</span><span class="id"> d,</span><span class="id"> r</span>)<span class="gallina-kwd"> as</span><span class="id"> edvpq</span><span class="id"> :=</span><span class="id"> redivp</span><span class="id"> p</span><span class="id"> q</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="gallina-kwd"> then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0,</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">^-k</span><span class="id"> *:</span><span class="id"> d,</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">^-k</span><span class="id"> *:</span><span class="id"> r</span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="id"> edvpq</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> edivp_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> edivp</span><span class="id"> :=</span><span class="id"> locked_with</span><span class="id"> edivp_key</span><span class="id"> edivp_expanded_def</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> edivp_unlockable</span><span class="id"> :=</span><span class="id"> [unlockable</span><span class="gallina-kwd"> fun</span><span class="id"> edivp]</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> divp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> ((<span class="id">edivp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">1</span>).<span class="id">2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> modp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> (<span class="id">edivp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> ((<span class="id">edivp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">1</span>).<span class="id">1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> dvdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><span class="id"> modp</span><span class="id"> q</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> 0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eqp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span> (<span class="id">dvdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &amp;&amp;</span> (<span class="id">dvdp</span><span class="id"> q</span><span class="id"> p</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> IDomainPseudoDivisionDefs</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;m %/ d&quot;</span><span class="id"> :=</span> (<span class="id">divp</span><span class="id"> m</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;m %% d&quot;</span><span class="id"> :=</span> (<span class="id">modp</span><span class="id"> m</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;p %| q&quot;</span><span class="id"> :=</span> (<span class="id">dvdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;p %= q&quot;</span><span class="id"> :=</span> (<span class="id">eqp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">End</span><span class="id"> IdomainDefs</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> WeakIdomain</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span><span class="id"> ComRing</span><span class="id"> UnitRing</span><span class="id"> IdomainDefs</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> WeakTheoryForIDomainPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivp_def</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> edivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">scalp</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> divp</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> modp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /scalp</span><span class="id"> /divp</span><span class="id"> /modp;</span><span class="id"> case:</span> (<span class="id">edivp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [[]]</span><span class="id"> /=</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivp_redivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> =</span><span class="id"> false</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">edivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> redivp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hu;</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> hu;</span><span class="id"> case:</span> (<span class="id">redivp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [[?</span><span class="id"> ?]</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="gallina-kwd"> if</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^-</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> /divp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="gallina-kwd"> if</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^-</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="gallina-kwd"> if</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="gallina-kwd"> then</span><span class="id"> 0</span><span class="gallina-kwd"> else</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> /scalp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> =</span><span class="id"> rdvdp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /dvdp</span><span class="id"> modpE</span><span class="id"> /rdvdp;</span><span class="id"> case</span><span class="id"> ulcq:</span> (<span class="id">lead_coef</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">=&gt;</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[in</span><span class="id"> LHS]size_poly_eq0</span><span class="id"> size_scale</span><span class="id"> ?size_poly_eq0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> invr_eq0</span><span class="id"> expf_neq0</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcq</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lc_expn_scalp_neq0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|nzq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> ?lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /scalp</span><span class="id"> 2!unlock</span><span class="id"> /=</span><span class="id"> eqxx</span><span class="id"> lead_coef0</span><span class="id"> unitr0</span><span class="id"> /=</span><span class="id"> oner_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> lc_expn_scalp_neq0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> edivp_spec</span> (<span class="id">m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nat</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
<span class="id">|Redivp_spec</span><span class="id"> k</span> (<span class="id">q</span><span class="id"> r:</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> of</span><br/>
&nbsp;&nbsp;(<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> *:</span><span class="id"> m</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> &amp;</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> \notin</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;(<span class="id">d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> edivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">k,</span><span class="id"> q,</span><span class="id"> r</span>)<span class="id"> false</span><br/>
<span class="id">|Fedivp_spec</span> (<span class="id">q</span><span class="id"> r:</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> of</span><span class="id"> m</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> &amp;</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> &amp;</span><br/>
&nbsp;&nbsp;(<span class="id">d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> edivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">0,</span><span class="id"> q,</span><span class="id"> r</span>)<span class="id"> true</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivpP</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> edivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">edivp</span><span class="id"> m</span><span class="id"> d</span>) (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> hC</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> d</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id">%:P</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /GRing</span>.<span class="id">comm</span><span class="id"> mulrC</span>.<br/>
<span class="id">case</span><span class="id"> ud:</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> edivp_redivp</span><span class="id"> //</span><span class="id"> redivp_def;</span><span class="id"> constructor;</span><span class="id"> rewrite</span><span class="id"> ?ltn_rmodp</span><span class="id"> //</span><span class="id"> ?ud</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rdivp_eq</span>.<br/>
<span class="id">have</span><span class="id"> cdn0:</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ud</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> unlock</span><span class="id"> ud</span><span class="id"> redivp_def;</span><span class="id"> constructor</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerDr</span><span class="id"> -mul_polyC</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> hn0</span><span class="id"> :</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> m</span><span class="id"> d</span>)<span class="id">%:P</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polyC_eq0;</span><span class="id"> apply:</span><span class="id"> expf_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">mulfI</span><span class="id"> hn0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mulrA</span><span class="id"> -exprVn</span><span class="id"> !polyC_exp</span><span class="id"> -exprMn</span><span class="id"> -polyCM</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divrr</span><span class="id"> //</span><span class="id"> expr1n</span><span class="id"> mul1r</span><span class="id"> -polyC_exp</span><span class="id"> mul_polyC</span><span class="id"> rdivp_eq</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> dn0;</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?ltn_rmodp</span><span class="id"> //</span><span class="id"> -exprVn</span><span class="id"> expf_eq0</span><span class="id"> negb_and</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> invr_eq0</span><span class="id"> cdn0</span><span class="id"> orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivp_eq</span><span class="id"> d</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">edivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span> (<span class="id">0,</span><span class="id"> q,</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> hC</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> d</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id">%:P</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> mulrC</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> hsrd</span><span class="id"> hu;</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> hu;</span><span class="id"> case</span><span class="id"> et:</span> (<span class="id">redivp</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> [[s</span><span class="id"> qq]</span><span class="id"> rr]</span>.<br/>
<span class="id">have</span><span class="id"> cdn0</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> hu</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">move:</span> (<span class="id">et</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> RingComRreg</span>.<span class="id">redivp_eq</span><span class="id"> //;</span><span class="id"> last</span><span class="id"> exact/rregP</span>.<br/>
<span class="id">rewrite</span><span class="id"> et</span><span class="id"> /=</span><span class="id"> mulrC</span> (<span class="id">mulrC</span><span class="id"> r</span>)<span class="id"> !mul_polyC;</span><span class="id"> case=&gt;</span><span class="id"> &lt;-</span><span class="id"> &lt;-</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !scalerA</span><span class="id"> mulVr</span><span class="id"> ?scale1r</span><span class="id"> //</span><span class="id"> unitrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_eq</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> *:</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> q</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> divpE</span><span class="id"> modpE</span><span class="id"> scalpE</span>.<br/>
<span class="id">case</span><span class="id"> uq:</span> (<span class="id">lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rdivp_eq</span>.<br/>
<span class="id">rewrite</span><span class="id"> expr0</span><span class="id"> scale1r;</span><span class="id"> have</span><span class="id"> [-&gt;|qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lead_coef0</span><span class="id"> expr0n</span><span class="id"> /rscalp</span><span class="id"> unlock</span><span class="id"> eqxx</span><span class="id"> invr1</span><span class="id"> !scale1r</span><span class="id"> rmodp0</span><span class="id"> !simp</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerDr</span><span class="id"> -rdivp_eq</span><span class="id"> scalerA</span><span class="id"> mulVr</span> (<span class="id">scale1r,</span><span class="id"> unitrX</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span><span class="id"> p</span><span class="id"> ==</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> dvdpE</span><span class="id"> rdvdp_eq</span><span class="id"> scalpE</span><span class="id"> divpE;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> ulcq</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> expr0</span><span class="id"> scale1r</span><span class="id"> -scalerAl;</span><span class="id"> apply/eqP/eqP</span><span class="id"> =&gt;</span><span class="id"> [&lt;-</span><span class="id"> |</span><span class="id"> {2}-&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerA</span><span class="id"> mulVr</span><span class="id"> ?scale1r</span><span class="id"> //</span><span class="id"> unitrX</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerA</span><span class="id"> mulrV</span><span class="id"> ?scale1r</span><span class="id"> //</span><span class="id"> unitrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpK</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *:</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> move/eqP-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpKC</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> *:</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> divpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpP</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> cqq,</span><span class="id"> cqq</span>.<span class="id">1</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> &amp;</span><span class="id"> cqq</span>.<span class="id">1</span><span class="id"> *:</span><span class="id"> p</span><span class="id"> =</span><span class="id"> cqq</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q</span>) (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> eqP</span>)<span class="id"> =&gt;</span><span class="id"> [e</span><span class="id"> |</span><span class="id"> [[c</span><span class="id"> qq]</span><span class="id"> cn0</span><span class="id"> e]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -dvdp_eq</span><span class="id"> dvdpE</span>.<br/>
<span class="id">have</span><span class="id"> Ecc:</span><span class="id"> c%:P</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> polyC_eq0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nz_p]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rdvdp0</span>.<br/>
<span class="id">pose</span><span class="id"> p1</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> :=</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> rscalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span><span class="id"> qq</span><span class="id"> -</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<span class="id">have</span><span class="id"> E1:</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p1</span><span class="id"> *</span><span class="id"> q</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> mulNr</span><span class="id"> -scalerAl</span><span class="id"> -e</span><span class="id"> scalerA</span><span class="id"> mulrC</span><span class="id"> -scalerA</span><span class="id"> -scalerAl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerBr</span><span class="id"> rdivp_eq</span><span class="id"> addrC</span><span class="id"> addKr</span>.<br/>
<span class="id">suff:</span><span class="id"> p1</span><span class="id"> *</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -E1</span><span class="id"> -mul_polyC</span><span class="id"> mulf_eq0</span> (<span class="id">negPf</span><span class="id"> Ecc</span>).<br/>
<span class="id">rewrite</span><span class="id"> mulf_eq0;</span><span class="id"> apply/norP;</span><span class="id"> case=&gt;</span><span class="id"> p1_nz</span><span class="id"> q_nz;</span><span class="id"> have:=</span><span class="id"> ltn_rmodp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> q_nz</span><span class="id"> -</span>(<span class="id">size_scale</span><span class="id"> _</span><span class="id"> cn0</span>)<span class="id"> E1</span><span class="id"> size_mul</span><span class="id"> //</span><span class="id"> polySpred</span><span class="id"> //</span><span class="id"> ltnNge</span><span class="id"> leq_addl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulpK</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> q</span><span class="id"> *:</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> qn0;</span><span class="id"> apply:</span> (<span class="id">rregP</span><span class="id"> qn0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> divp_eq</span>.<br/>
<span class="id">suff</span><span class="id"> -&gt;</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> modpE</span><span class="id"> RingComRreg</span>.<span class="id">rmodp_mull</span><span class="id"> ?scaler0</span><span class="id"> ?if_same</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> red;</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/rregP;</span><span class="id"> rewrite</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> q</span><span class="id"> *:</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nzq;</span><span class="id"> rewrite</span><span class="id"> mulrC;</span><span class="id"> apply:</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpp</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> p</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> p</span>)<span class="id">%:P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> np0;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> divp_eq</span><span class="id"> p</span><span class="id"> p</span>.<br/>
<span class="id">suff</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addr0</span><span class="id"> -mul_polyC;</span><span class="id"> move/</span>(<span class="id">mulIf</span><span class="id"> np0</span>).<br/>
<span class="id">rewrite</span><span class="id"> modpE</span><span class="id"> Ring</span>.<span class="id">rmodpp;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> red;</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scaler0</span><span class="id"> if_same</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> WeakTheoryForIDomainPseudoDivision</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> lc_expn_scalp_neq0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> WeakIdomain</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> CommonIdomain</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span><span class="id"> ComRing</span><span class="id"> UnitRing</span><span class="id"> IdomainDefs</span><span class="id"> WeakIdomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> IDomainPseudoDivision</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalp0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /scalp</span><span class="id"> unlock</span><span class="id"> lead_coef0</span><span class="id"> unitr0</span><span class="id"> unlock</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_small</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> spq;</span><span class="id"> rewrite</span><span class="id"> /divp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rdivp_small</span><span class="id"> //</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_divp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">size</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /divp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> ulcq;</span><span class="id"> rewrite</span><span class="id"> ?leq_rdivp</span><span class="id"> //=</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_scale</span><span class="id"> ?leq_rdivp</span><span class="id"> //</span><span class="id"> -exprVn</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> invr_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> ulcq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> div0p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /divp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rdiv0p</span><span class="id"> //</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /divp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rdivp0</span><span class="id"> //</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp1</span><span class="id"> m</span><span class="id"> :</span><span class="id"> m</span><span class="id"> %/</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divpE</span><span class="id"> lead_coefC</span><span class="id"> unitr1</span><span class="id"> Ring</span>.<span class="id">rdivp1</span><span class="id"> expr1n</span><span class="id"> invr1</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rmodp0</span><span class="id"> //=</span><span class="id"> lead_coef0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mod0p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> %%</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rmod0p</span><span class="id"> //</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rmodp1</span><span class="id"> //</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> divp0</span><span class="id"> divp1</span><span class="id"> mod0p</span><span class="id"> modp0</span><span class="id"> modp1</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_small</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> spq;</span><span class="id"> rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> rmodp_small</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rscalp_small</span><span class="id"> //</span><span class="id"> expr0</span><span class="id"> /=</span><span class="id"> invr1</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpC</span><span class="id"> p</span><span class="id"> c</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> c%:P</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cn0;</span><span class="id"> rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> ?rmodpC</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_mull</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modp0</span><span class="id"> mulr0</span>.<br/>
<span class="id">have</span><span class="id"> rlcq</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">rreg</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="gallina-kwd"> by</span><span class="id"> apply/rregP;</span><span class="id"> rewrite</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">have</span><span class="id"> hC</span><span class="id"> :</span><span class="id"> GRing</span>.<span class="id">comm</span><span class="id"> q</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">%:P</span><span class="gallina-kwd"> by</span><span class="id"> red;</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
<span class="id">rewrite</span><span class="id"> modpE;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> ulcq;</span><span class="id"> rewrite</span><span class="id"> RingComRreg</span>.<span class="id">rmodp_mull</span><span class="id"> //</span>.<br/>
<span class="id">exact:</span><span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_mulr</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> modp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpp</span><span class="id"> d</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[d</span><span class="gallina-kwd"> in</span><span class="id"> d</span><span class="id"> %%</span><span class="id"> _]mul1r</span><span class="id"> modp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltn_modp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">q</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP=&gt;</span><span class="id"> ulcq;</span><span class="id"> rewrite</span><span class="id"> ?ltn_rmodp</span><span class="id"> //=</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_scale</span><span class="id"> ?ltn_rmodp</span><span class="id"> //</span><span class="id"> -exprVn</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> invr_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> ulcq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltn_divpl</span><span class="id"> d</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">size</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">size</span><span class="id"> q</span><span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dn0</span>.<br/>
<span class="id">have:</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id"> ^+</span> (<span class="id">scalp</span><span class="id"> q</span><span class="id"> d</span>)<span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
<span class="id">move/</span>(<span class="id">size_scale</span><span class="id"> q</span>)<span class="id">&lt;-;</span><span class="id"> rewrite</span><span class="id"> divp_eq;</span><span class="id"> have</span><span class="id"> [-&gt;|quo0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul0r</span><span class="id"> add0r</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> size_poly0</span><span class="id"> ltn0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> pn0</span>)<span class="id"> addSn</span><span class="id"> ltn_addl</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_polyDl;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> quo0</span>)<span class="id"> addSn</span><span class="id"> /=</span><span class="id"> ltn_addl</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> size_poly0</span><span class="id"> !ltn0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !size_mul</span><span class="id"> ?quo0</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> dn0</span>)<span class="id"> !addnS</span><span class="id"> ltn_add2r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_divpr</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> size</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> =</span> (<span class="id">size</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dn0;</span><span class="id"> rewrite</span><span class="id"> leqNgt</span><span class="id"> ltn_divpl</span><span class="id"> //</span><span class="id"> -leqNgt</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpN0</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">size</span><span class="id"> d</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dn0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[d</span><span class="gallina-kwd"> in</span><span class="id"> RHS]mul1r</span><span class="id"> -leq_divpr</span><span class="id"> //</span><span class="id"> size_polyC</span><span class="id"> oner_eq0</span><span class="id"> size_poly_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> size_divp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> -</span> (<span class="id">size</span><span class="id"> q</span>).<span class="id">-1</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nq0;</span><span class="id"> case:</span> (<span class="id">leqP</span> (<span class="id">size</span><span class="id"> q</span>) (<span class="id">size</span><span class="id"> p</span>))<span class="id"> =&gt;</span><span class="id"> sqp;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">sqp</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">ltn_predK</span><span class="id"> sqp</span>)<span class="id"> ltnS</span><span class="id"> -subn_eq0</span><span class="id"> divp_small</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> size_poly0</span>.<br/>
<span class="id">have</span><span class="id"> np0</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> sqp;</span><span class="id"> rewrite</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">have</span><span class="id"> /=</span><span class="id"> :=</span><span class="id"> congr1</span> (<span class="id">size</span><span class="id"> \o</span><span class="id"> @polyseq</span><span class="id"> R</span>) (<span class="id">divp_eq</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<span class="id">rewrite</span><span class="id"> size_scale;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span> (<span class="id">negPf</span><span class="id"> nq0</span>)<span class="id"> andbF</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|qq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> add0r=&gt;</span><span class="id"> es;</span><span class="id"> move:</span><span class="id"> nq0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ltn_modp</span><span class="id"> p</span>)<span class="id"> -es</span><span class="id"> ltnNge</span><span class="id"> sqp</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_polyDl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move-&gt;;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> nq0</span>)<span class="id"> addnS</span><span class="id"> /=</span><span class="id"> addnK</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_mul</span><span class="id"> ?qq0</span><span class="id"> //</span>.<br/>
<span class="id">move:</span><span class="id"> nq0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ltn_modp</span><span class="id"> p</span>)<span class="id">;</span><span class="id"> move/leq_trans;</span><span class="id"> apply</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">polySpred</span><span class="id"> qq0</span>)<span class="id"> addSn</span><span class="id"> /=</span><span class="id"> leq_addl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltn_modpN0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_id</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [-&gt;|qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> ?modp0</span><span class="id"> //</span><span class="id"> modp_small</span><span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_modp</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">m</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /modp</span><span class="id"> unlock</span><span class="id"> redivp_def</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> ?leq_rmodp</span><span class="id"> //</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> ud;</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?leq_rmodp</span><span class="id"> //</span><span class="id"> invr_eq0</span><span class="id"> expf_neq0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ud</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp0</span><span class="id"> d</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dvdp</span><span class="id"> mod0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> dvdp0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvd0p</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dvdp</span><span class="id"> modp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvd0pP</span><span class="id"> p</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">p</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvd0p;</span><span class="id"> move/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpN0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> pq</span><span class="id"> hq;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> pq</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> dvd0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp1</span><span class="id"> d</span><span class="id"> :</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">size</span><span class="id"> d</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /dvdp</span><span class="id"> modpE;</span><span class="id"> case</span><span class="id"> ud:</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> rdvdp1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -size_poly_eq0</span><span class="id"> size_scale;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly_eq0</span><span class="id"> -rdvdp1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> invr_eq0</span><span class="id"> expf_neq0</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ud</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvd1p</span><span class="id"> m</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> %|</span><span class="id"> m</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dvdp</span><span class="id"> modp1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtNdvdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> nn0</span><span class="id"> hs;</span><span class="id"> rewrite</span><span class="id"> /dvdp;</span><span class="id"> rewrite</span> (<span class="id">modp_small</span><span class="id"> hs</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> negPf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_eq0P</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">iffP</span><span class="id"> eqP</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_eq0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> modp_eq0P</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_divpl</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">size</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> size</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> nd0</span><span class="id"> hd]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divp0</span><span class="id"> size_poly0</span><span class="id"> !leq0n</span>.<br/>
<span class="id">rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> ltn_divpl</span><span class="id"> //</span> (<span class="id">leq_eqVlt</span> (<span class="id">size</span><span class="id"> p</span>)).<br/>
<span class="id">case</span><span class="id"> lhs:</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?orbT</span><span class="id"> ?orbF</span><span class="id"> //</span>.<br/>
<span class="id">have:</span> (<span class="id">lead_coef</span><span class="id"> d</span>)<span class="id"> ^+</span> (<span class="id">scalp</span><span class="id"> p</span><span class="id"> d</span>)<span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">move/</span>(<span class="id">size_scale</span><span class="id"> p</span>)<span class="id">&lt;-;</span><span class="id"> rewrite</span><span class="id"> divp_eq;</span><span class="id"> move/modp_eq0P:</span><span class="id"> hd-&gt;;</span><span class="id"> rewrite</span><span class="id"> addr0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> quon0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul0r</span><span class="id"> size_poly0</span><span class="id"> 2!</span>(<span class="id">eq_sym</span><span class="id"> 0</span>)<span class="id"> !size_poly_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span> (<span class="id">negPf</span><span class="id"> nd0</span>)<span class="id"> orbF</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> size_poly0</span><span class="id"> !size_poly_eq0</span><span class="id"> mulf_eq0</span> (<span class="id">negPf</span><span class="id"> nd0</span>)<span class="id"> orbF</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> nd0</span>)<span class="id"> !addnS</span><span class="id"> /=</span><span class="id"> eqn_add2r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_leq</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nq0</span><span class="id"> /modp_eq0P</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> leqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /modp_small</span><span class="id"> -&gt;</span><span class="id"> /eqP;</span><span class="id"> rewrite</span> (<span class="id">negPf</span><span class="id"> nq0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_dvdp</span><span class="id"> c</span><span class="id"> quo</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> p</span><span class="id"> =</span><span class="id"> quo</span><span class="id"> *</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cn0;</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> p</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;|nz_quo</span><span class="id"> def_quo]</span><span class="id"> //</span>.<br/>
<span class="id">pose</span><span class="id"> p1</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> :=</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span><span class="id"> quo</span><span class="id"> -</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>).<br/>
<span class="id">have</span><span class="id"> E1:</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> =</span><span class="id"> p1</span><span class="id"> *</span><span class="id"> q</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> mulNr</span><span class="id"> -scalerAl</span><span class="id"> -def_quo</span><span class="id"> scalerA</span><span class="id"> mulrC</span><span class="id"> -scalerA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerBr</span><span class="id"> divp_eq</span><span class="id"> addrAC</span><span class="id"> subrr</span><span class="id"> add0r</span>.<br/>
<span class="id">rewrite</span><span class="id"> /dvdp;</span><span class="id"> apply/idPn=&gt;</span><span class="id"> m_nz</span>.<br/>
<span class="id">have:</span><span class="id"> p1</span><span class="id"> *</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -E1</span><span class="id"> -mul_polyC</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> polyC_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulf_eq0;</span><span class="id"> case/norP=&gt;</span><span class="id"> p1_nz</span><span class="id"> q_nz</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> ltn_modp</span><span class="id"> p</span><span class="id"> q;</span><span class="id"> rewrite</span><span class="id"> q_nz</span><span class="id"> -</span>(<span class="id">size_scale</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> cn0</span>)<span class="id"> E1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_mul</span><span class="id"> //</span><span class="id"> polySpred</span><span class="id"> //</span><span class="id"> ltnNge</span><span class="id"> leq_addl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpp</span><span class="id"> d</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> d</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dvdp</span><span class="id"> modpp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> dvdpp</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_dvd</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> p</span>)<span class="id"> %|</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> np0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divp0</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> h</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span> ((<span class="id">lead_coef</span><span class="id"> p</span>)<span class="id">^+</span> (<span class="id">scalp</span><span class="id"> q</span><span class="id"> p</span>))<span class="id"> p</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mull</span><span class="id"> m</span><span class="id"> d</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> *</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> dn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> dvdpp</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> e</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span> (<span class="id">lead_coef</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> n</span><span class="id"> d</span>) (<span class="id">m</span><span class="id"> *</span> (<span class="id">n</span><span class="id"> %/</span><span class="id"> d</span>))).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerAr</span><span class="id"> e</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mulr</span><span class="id"> n</span><span class="id"> d</span><span class="id"> m</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> *</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hdm;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> dvdp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> dvdp_mull</span><span class="id"> dvdp_mulr</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mul</span><span class="id"> d1</span><span class="id"> d2</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> :</span><span class="id"> d1</span><span class="id"> %|</span><span class="id"> m1</span><span class="id"> -&gt;</span><span class="id"> d2</span><span class="id"> %|</span><span class="id"> m2</span><span class="id"> -&gt;</span><span class="id"> d1</span><span class="id"> *</span><span class="id"> d2</span><span class="id"> %|</span><span class="id"> m1</span><span class="id"> *</span><span class="id"> m2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d1</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> d1n0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mul0r</span><span class="id"> dvdpp</span>.<br/>
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d2</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> d2n0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Hq1</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Hq2</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span> (<span class="id">c1</span><span class="id"> *</span><span class="id"> c2</span>) (<span class="id">q1</span><span class="id"> *</span><span class="id"> q2</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -scalerA</span><span class="id"> scalerAr</span><span class="id"> scalerAl</span><span class="id"> Hq1</span><span class="id"> Hq2</span><span class="id"> -!mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [d1</span><span class="id"> *</span> (<span class="id">q2</span><span class="id"> *</span><span class="id"> _</span>)<span class="id">]mulrCA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_addr</span><span class="id"> m</span><span class="id"> d</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> dn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> add0r</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Eq1</span>.<br/>
<span class="id">apply/idP/idP;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> sn0</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> *</span><span class="id"> c2</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulf_neq0</span><span class="id"> //</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span> (<span class="id">negPf</span><span class="id"> dn0</span>)<span class="id"> andbF</span>.<br/>
&nbsp;&nbsp;<span class="id">move/eqP=&gt;</span><span class="id"> Eq2;</span><span class="id"> apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> _</span> (<span class="id">c1</span><span class="id"> *:</span><span class="id"> q2</span><span class="id"> -</span><span class="id"> c2</span><span class="id"> *:</span><span class="id"> q1</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> sn0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> -scaleNr</span><span class="id"> -!scalerAl</span><span class="id"> -Eq1</span><span class="id"> -Eq2</span><span class="id"> !scalerA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulNr</span><span class="id"> mulrC</span><span class="id"> scaleNr</span><span class="id"> -scalerBr</span><span class="id"> addrC</span><span class="id"> addKr</span>.<br/>
<span class="id">have</span><span class="id"> sn0</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> *</span><span class="id"> c2</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulf_neq0</span><span class="id"> //</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span> (<span class="id">negPf</span><span class="id"> dn0</span>)<span class="id"> andbF</span>.<br/>
<span class="id">move/eqP=&gt;</span><span class="id"> Eq2;</span><span class="id"> apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> _</span> (<span class="id">c1</span><span class="id"> *:</span><span class="id"> q2</span><span class="id"> +</span><span class="id"> c2</span><span class="id"> *:</span><span class="id"> q1</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> sn0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> -!scalerAl</span><span class="id"> -Eq1</span><span class="id"> -Eq2</span><span class="id"> !scalerA</span><span class="id"> mulrC</span><span class="id"> addrC</span><span class="id"> scalerDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_addl</span><span class="id"> n</span><span class="id"> d</span><span class="id"> m</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrC;</span><span class="id"> apply:</span><span class="id"> dvdp_addr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_add</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> +</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/dvdp_addr-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_add_eq</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> +</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply/idP/idP;</span><span class="id"> [move/dvdp_addr</span><span class="id"> &lt;-|</span><span class="id"> move/dvdp_addl</span><span class="id"> &lt;-]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_subr</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> dvdp_add_eq;</span><span class="id"> rewrite</span><span class="id"> -addrA</span><span class="id"> addNr</span><span class="id"> simp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_subl</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/dvdp_addl&lt;-;</span><span class="id"> rewrite</span><span class="id"> subrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_sub</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> dvdp_subl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mod</span><span class="id"> d</span><span class="id"> n</span><span class="id"> m</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> %%</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> n</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modp0</span>.<br/>
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> dn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modp0</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Eq1</span>.<br/>
<span class="id">apply/idP/idP;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> sn0</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> *</span><span class="id"> c2</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulf_neq0</span><span class="id"> //</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span> (<span class="id">negPf</span><span class="id"> dn0</span>)<span class="id"> andbF</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span><span class="id"> quo</span><span class="id"> :=</span> (<span class="id">c1</span><span class="id"> *</span><span class="id"> lead_coef</span><span class="id"> n</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> *:</span><span class="id"> q2</span><span class="id"> -</span><span class="id"> c2</span><span class="id"> *:</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> n</span>)<span class="id"> *</span><span class="id"> q1</span>.<br/>
&nbsp;&nbsp;<span class="id">move/eqP=&gt;</span><span class="id"> Eq2;</span><span class="id"> apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> _</span><span class="id"> quo</span><span class="id"> _</span><span class="id"> _</span><span class="id"> sn0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> mulNr</span><span class="id"> -!scalerAl</span><span class="id"> -!mulrA</span><span class="id"> -Eq1</span><span class="id"> -Eq2</span><span class="id"> -scalerAr</span><span class="id"> !scalerA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrC</span><span class="id"> [_</span><span class="id"> *</span><span class="id"> c2]mulrC</span><span class="id"> mulrA</span><span class="id"> -[</span>((_<span class="id"> *</span><span class="id"> _</span>)<span class="id"> *</span><span class="id"> _</span>)<span class="id"> *:</span><span class="id"> _]scalerA</span><span class="id"> -scalerBr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divp_eq</span><span class="id"> addrC</span><span class="id"> addKr</span>.<br/>
<span class="id">have</span><span class="id"> sn0</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> *</span><span class="id"> c2</span><span class="id"> *</span><span class="id"> lead_coef</span><span class="id"> n</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mulf_neq0</span><span class="id"> //</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span><span class="id"> ?</span>(<span class="id">negPf</span><span class="id"> dn0</span>)<span class="id"> ?andbF</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">negPf</span><span class="id"> nn0</span>)<span class="id"> andbF</span>.<br/>
<span class="id">move/eqP=&gt;</span><span class="id"> Eq2;</span><span class="id"> apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> _</span> (<span class="id">c2</span><span class="id"> *:</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> n</span>)<span class="id"> *</span><span class="id"> q1</span><span class="id"> +</span><span class="id"> c1</span><span class="id"> *:</span><span class="id"> q2</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> sn0</span>).<br/>
<span class="id">rewrite</span><span class="id"> -scalerA</span><span class="id"> divp_eq</span><span class="id"> scalerDr</span><span class="id"> -!scalerA</span><span class="id"> Eq2</span><span class="id"> scalerAl</span><span class="id"> scalerAr</span><span class="id"> Eq1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerAl</span><span class="id"> mulrDl</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_trans</span><span class="id"> :</span><span class="id"> transitive</span> (<span class="id">@dvdp</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n</span><span class="id"> d</span><span class="id"> m</span>.<br/>
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> dn0]</span>.<br/>
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> n</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> nn0]</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Hq1</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Hq2</span>.<br/>
<span class="id">have</span><span class="id"> sn0</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> *</span><span class="id"> c2</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> _</span> (<span class="id">q2</span><span class="id"> *</span><span class="id"> q1</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> sn0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerA</span><span class="id"> Hq2</span><span class="id"> scalerAr</span><span class="id"> Hq1</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mulIl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/dvdp_mulr/dvdpp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mulIr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/dvdp_mull/dvdpp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mul2r</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> *</span><span class="id"> r</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nzr</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> !dvd0p</span><span class="id"> mulf_eq0</span> (<span class="id">negPf</span><span class="id"> nzr</span>)<span class="id"> orbF</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> !dvdp0</span>.<br/>
<span class="id">apply/idP/idP;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> dvdp_mul</span><span class="id"> ?dvdpp</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Hx</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> c</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span><span class="id"> mulf_neq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">mulIf</span><span class="id"> nzr</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrA</span><span class="id"> -scalerAl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mul2l</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q:</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">r</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> r</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ![r</span><span class="id"> *</span><span class="id"> _]mulrC;</span><span class="id"> apply:</span><span class="id"> dvdp_mul2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltn_divpr</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> =</span> (<span class="id">size</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dv_d_q;</span><span class="id"> rewrite</span><span class="id"> !ltnNge</span><span class="id"> leq_divpl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_exp</span><span class="id"> d</span><span class="id"> k</span><span class="id"> p</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span> (<span class="id">p</span><span class="id"> ^+</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> k</span><span class="id"> _</span><span class="id"> d_dv_m;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> dvdp_mulr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_exp2l</span><span class="id"> d</span><span class="id"> k</span><span class="id"> l</span><span class="id"> :</span><span class="id"> k</span><span class="id"> &lt;=</span><span class="id"> l</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> %|</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> l</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/subnK</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> exprD</span><span class="id"> dvdp_mull</span><span class="id"> //</span><span class="id"> ?lead_coef_exp</span><span class="id"> ?unitrX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_Pexp2l</span><span class="id"> d</span><span class="id"> k</span><span class="id"> l</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> %|</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> l</span>)<span class="id"> =</span> (<span class="id">k</span><span class="id"> &lt;=</span><span class="id"> l</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sd;</span><span class="id"> case:</span><span class="id"> leqP</span><span class="id"> =&gt;</span><span class="id"> [|gt_n_m];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> dvdp_exp2l</span>.<br/>
<span class="id">have</span><span class="id"> dn0</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0;</span><span class="id"> apply:</span><span class="id"> ltn_trans</span><span class="id"> sd</span>.<br/>
<span class="id">rewrite</span><span class="id"> gtNdvdp</span><span class="id"> ?expf_neq0</span><span class="id"> //</span><span class="id"> polySpred</span><span class="id"> ?expf_neq0</span><span class="id"> //</span><span class="id"> size_exp</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> [size</span> (<span class="id">d</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id">]polySpred</span><span class="id"> ?expf_neq0</span><span class="id"> //</span><span class="id"> size_exp</span><span class="id"> ltnS</span><span class="id"> ltn_mul2l</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> sd;</span><span class="id"> rewrite</span><span class="id"> -subn_gt0</span><span class="id"> subn1;</span><span class="id"> move-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_exp2r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> k</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> k</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> p</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> pn0]</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> t</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> e</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span> (<span class="id">c</span><span class="id"> ^+</span><span class="id"> k</span>) (<span class="id">t</span><span class="id"> ^+</span><span class="id"> k</span>))<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expf_neq0</span><span class="id"> ?lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -exprMn</span><span class="id"> -exprZn;</span><span class="id"> congr</span> (_<span class="id"> ^+</span><span class="id"> k</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_exp_sub</span><span class="id"> p</span><span class="id"> q</span><span class="id"> k</span><span class="id"> l:</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">p</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> *</span><span class="id"> p</span><span class="id"> ^+</span><span class="id"> l</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ^+</span> (<span class="id">k</span><span class="id"> -</span><span class="id"> l</span>)<span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> pn0;</span><span class="id"> case:</span> (<span class="id">leqP</span><span class="id"> k</span><span class="id"> l</span>)<span class="id">=&gt;</span><span class="id"> [|/ltnW]</span><span class="id"> hkl</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">hkl</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -subn_eq0;</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> expr0</span><span class="id"> dvd1p</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/dvdp_mull/dvdp_exp2l</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">subnK</span><span class="id"> hkl</span>)<span class="id"> exprD</span><span class="id"> dvdp_mul2r</span><span class="id"> //</span><span class="id"> expf_eq0</span> (<span class="id">negPf</span><span class="id"> pn0</span>)<span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_XsubCl</span><span class="id"> p</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> %|</span><span class="id"> p</span><span class="id"> =</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdpE;</span><span class="id"> apply:</span><span class="id"> Ring</span>.<span class="id">rdvdp_XsubCl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_dvdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> x</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> q</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!dvdp_XsubCl</span><span class="id"> =&gt;</span><span class="id"> /[swap];</span><span class="id"> exact:</span><span class="id"> dvdp_trans</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> polyXsubCP</span><span class="id"> p</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">p</span>.<span class="id">[x]</span><span class="id"> =</span><span class="id"> 0</span>) ((<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdpE;</span><span class="id"> apply:</span><span class="id"> Ring</span>.<span class="id">polyXsubCP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_div_XsubC</span><span class="id"> p</span><span class="id"> c</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">p</span><span class="id"> ==</span> (<span class="id">p</span><span class="id"> %/</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>))<span class="id"> *</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>))<span class="id"> =</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_eq</span><span class="id"> lead_coefXsubC</span><span class="id"> expr1n</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_factor_theorem</span><span class="id"> p</span><span class="id"> x</span><span class="id"> :</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> =</span> ((<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_XsubCl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> uniq_roots_dvdp</span><span class="id"> p</span><span class="id"> rs</span><span class="id"> :</span><span class="id"> all</span> (<span class="id">root</span><span class="id"> p</span>)<span class="id"> rs</span><span class="id"> -&gt;</span><span class="id"> uniq_roots</span><span class="id"> rs</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">z</span><span class="id"> &lt;-</span><span class="id"> rs</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> z%:P</span>))<span class="id"> %|</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rrs;</span><span class="id"> case/</span>(<span class="id">uniq_roots_prod_XsubC</span><span class="id"> rrs</span>)<span class="id">=&gt;</span><span class="id"> q</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> dvdp_mull;</span><span class="id"> rewrite</span><span class="id"> //</span> (<span class="id">eqP</span> (<span class="id">monic_prod_XsubC</span><span class="id"> _</span>))<span class="id"> unitr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_bigmul</span><span class="id"> x</span> (<span class="id">ps</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">~~root</span> (<span class="id">\big[*%R/1]_</span>(<span class="id">p</span><span class="id"> &lt;-</span><span class="id"> ps</span>)<span class="id"> p</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> all</span> (<span class="gallina-kwd">fun</span><span class="id"> p</span><span class="id"> =&gt;</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>)<span class="id"> ps</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> ps</span><span class="id"> =&gt;</span><span class="id"> [|p</span><span class="id"> ps</span><span class="id"> ihp];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_nil</span><span class="id"> root1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_cons</span><span class="id"> /=</span><span class="id"> rootM</span><span class="id"> negb_or</span><span class="id"> ihp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqpP</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> c12,</span> (<span class="id">c12</span>.<span class="id">1</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">c12</span>.<span class="id">2</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;</span><span class="id"> c12</span>.<span class="id">1</span><span class="id"> *:</span><span class="id"> m</span><span class="id"> =</span><span class="id"> c12</span>.<span class="id">2</span><span class="id"> *:</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span><span class="id"> %=</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> [[c1</span><span class="id"> c2]/andP[nz_c1</span><span class="id"> nz_c2</span><span class="id"> eq_cmn]]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /eqp</span> (<span class="id">@eq_dvdp</span><span class="id"> c2</span><span class="id"> c1%:P</span>)<span class="id"> -?eq_cmn</span><span class="id"> ?mul_polyC</span><span class="id"> //</span> (<span class="id">@eq_dvdp</span><span class="id"> c1</span><span class="id"> c2%:P</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_cmn</span><span class="id"> mul_polyC</span>.<br/>
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> m</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /andP</span><span class="id"> [/dvd0pP</span><span class="id"> -&gt;</span><span class="id"> _]</span><span class="id"> |</span><span class="id"> m_nz]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?scaler0</span><span class="id"> //</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> n</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /andP</span><span class="id"> [_</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;]</span><span class="id"> |</span><span class="id"> n_nz</span><span class="id"> /andP</span><span class="id"> []]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?scaler0</span><span class="id"> //</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !dvdp_eq;</span><span class="id"> set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _</span>.<br/>
<span class="id">set</span><span class="id"> q1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP</span><span class="id"> =&gt;</span><span class="id"> Hq1</span><span class="id"> /eqP</span><span class="id"> Hq2;</span><br/>
<span class="id">have</span><span class="id"> Hc1</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span><span class="id"> negb_and</span><span class="id"> m_nz</span><span class="id"> orbT</span>.<br/>
<span class="id">have</span><span class="id"> Hc2</span><span class="id"> :</span><span class="id"> c2</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_eq0</span><span class="id"> lead_coef_eq0</span><span class="id"> negb_and</span><span class="id"> n_nz</span><span class="id"> orbT</span>.<br/>
<span class="id">have</span><span class="id"> def_q12:</span><span class="id"> q1</span><span class="id"> *</span><span class="id"> q2</span><span class="id"> =</span> (<span class="id">c1</span><span class="id"> *</span><span class="id"> c2</span>)<span class="id">%:P</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">mulIf</span><span class="id"> m_nz</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulrAC</span><span class="id"> mulrC</span><span class="id"> -Hq1</span><span class="id"> -scalerAr</span><span class="id"> -Hq2</span><span class="id"> scalerA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mul_polyC</span>.<br/>
<span class="id">have:</span><span class="id"> q1</span><span class="id"> *</span><span class="id"> q2</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> def_q12</span><span class="id"> -size_poly_eq0</span><span class="id"> size_polyC</span><span class="id"> mulf_neq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulf_eq0;</span><span class="id"> case/norP=&gt;</span><span class="id"> nz_q1</span><span class="id"> nz_q2</span>.<br/>
<span class="id">have:</span><span class="id"> size</span><span class="id"> q2</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="id">have:=</span><span class="id"> size_mul</span><span class="id"> nz_q1</span><span class="id"> nz_q2;</span><span class="id"> rewrite</span><span class="id"> def_q12</span><span class="id"> size_polyC</span><span class="id"> mulf_neq0</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polySpred</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> leq_addl</span>.<br/>
<span class="id">rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> ltnS</span><span class="id"> size_poly_leq0</span> (<span class="id">negPf</span><span class="id"> nz_q2</span>)<span class="id"> orbF</span>.<br/>
<span class="id">case/size_poly1P=&gt;</span><span class="id"> c</span><span class="id"> cn0</span><span class="id"> cqe;</span><span class="gallina-kwd"> exists</span> (<span class="id">c2,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> Hc2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> Hq2</span><span class="id"> -mul_polyC</span><span class="id"> -cqe</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_eq</span><span class="id"> p</span><span class="id"> q:</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id"> *:</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> p</span>)<span class="id"> *:</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /eqpP</span><span class="id"> [[c1</span><span class="id"> c2]</span><span class="id"> /=</span><span class="id"> /andP</span><span class="id"> [nz_c1</span><span class="id"> nz_c2]]</span><span class="id"> eq</span>.<br/>
<span class="id">have/</span>(<span class="id">congr1</span><span class="id"> lead_coef</span>)<span class="id"> :=</span><span class="id"> eq;</span><span class="id"> rewrite</span><span class="id"> !lead_coefZ</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> eqC;</span><span class="id"> apply/</span>(<span class="id">@mulfI</span><span class="id"> _</span><span class="id"> c2%:P</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?polyC_eq0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mul_polyC</span><span class="id"> scalerA</span><span class="id"> -eqC</span><span class="id"> mulrC</span><span class="id"> -scalerA</span><span class="id"> eq</span><span class="id"> !scalerA</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqpxx</span><span class="id"> :</span><span class="id"> reflexive</span> (<span class="id">@eqp</span><span class="id"> R</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> dvdpp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> eqpxx</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqpW</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move-&gt;;</span><span class="id"> rewrite</span><span class="id"> eqpxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_sym</span><span class="id"> :</span><span class="id"> symmetric</span> (<span class="id">@eqp</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p</span><span class="id"> q;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> andbC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_trans</span><span class="id"> :</span><span class="id"> transitive</span> (<span class="id">@eqp</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r;</span><span class="id"> case/andP=&gt;</span><span class="id"> Dp</span><span class="id"> pD;</span><span class="id"> case/andP=&gt;</span><span class="id"> Dq</span><span class="id"> qD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /eqp</span> (<span class="id">dvdp_trans</span><span class="id"> Dp</span>)<span class="id"> //</span> (<span class="id">dvdp_trans</span><span class="id"> qD</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_ltrans</span><span class="id"> :</span><span class="id"> left_transitive</span> (<span class="id">@eqp</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sym_left_transitive</span><span class="id"> eqp_sym</span><span class="id"> eqp_trans</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_rtrans</span><span class="id"> :</span><span class="id"> right_transitive</span> (<span class="id">@eqp</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sym_right_transitive</span><span class="id"> eqp_sym</span><span class="id"> eqp_trans</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp0</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/idP/eqP</span><span class="id"> =&gt;</span><span class="id"> [/andP</span><span class="id"> [_</span><span class="id"> /dvd0pP]</span><span class="id"> |</span><span class="id"> -&gt;</span><span class="id"> //]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> %=</span> (<span class="id">1</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> eqp0</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_scale</span><span class="id"> p</span><span class="id"> c</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> c0;</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> c0</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_size</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> size</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|Eq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp0;</span><span class="id"> move/eqP-&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> eqp_sym;</span><span class="id"> have</span><span class="id"> [-&gt;|Ep]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp0;</span><span class="id"> move/eqP-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/andP</span><span class="id"> =&gt;</span><span class="id"> Dp</span><span class="id"> Dq;</span><span class="id"> apply:</span><span class="id"> anti_leq;</span><span class="id"> rewrite</span><span class="id"> !dvdp_leq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> size_poly_eq1</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/size_poly1P/idP=&gt;</span><span class="id"> [[c</span><span class="id"> cn0</span><span class="id"> ep]</span><span class="id"> |]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?oner_eq0</span><span class="id"> //</span><span class="id"> alg_polyC</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/eqp_size;</span><span class="id"> rewrite</span><span class="id"> size_poly1;</span><span class="id"> move/eqP/size_poly1P</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> polyXsubC_eqp1</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span><span class="id"> %=</span><span class="id"> 1</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1</span><span class="id"> size_XsubC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eqp1</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dpq</span><span class="id"> hq</span>.<br/>
<span class="id">have</span><span class="id"> sizeq</span><span class="id"> :</span><span class="id"> size</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly_eq1</span>.<br/>
<span class="id">have</span><span class="id"> n0q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> hq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> eqp01</span>.<br/>
<span class="id">rewrite</span><span class="id"> -size_poly_eq1</span><span class="id"> eqn_leq</span><span class="id"> -{1}</span>(<span class="id">eqP</span><span class="id"> sizeq</span>)<span class="id"> dvdp_leq</span><span class="id"> //=</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> p0;</span><span class="id"> move:</span><span class="id"> dpq</span><span class="id"> n0q;</span><span class="id"> rewrite</span><span class="id"> p0</span><span class="id"> dvd0p</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_dvdr</span><span class="id"> q</span><span class="id"> p</span><span class="id"> d:</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">suff</span><span class="id"> Hmn</span><span class="id"> m</span><span class="id"> n:</span><span class="id"> m</span><span class="id"> %=</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span>)<span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> mn;</span><span class="id"> apply/idP/idP;</span><span class="id"> apply:</span><span class="id"> Hmn=&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /eqp;</span><span class="id"> case/andP=&gt;</span><span class="id"> pq</span><span class="id"> qp</span><span class="id"> dp;</span><span class="id"> apply:</span> (<span class="id">dvdp_trans</span><span class="id"> dp</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_dvdl</span><span class="id"> d2</span><span class="id"> d1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d1</span><span class="id"> %=</span><span class="id"> d2</span><span class="id"> -&gt;</span><span class="id"> d1</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">d2</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<span class="id">suff</span><span class="id"> Hmn</span><span class="id"> m</span><span class="id"> n:</span><span class="id"> m</span><span class="id"> %=</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> -&gt;</span> (<span class="id">n</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply/idP/idP;</span><span class="id"> apply:</span><span class="id"> Hmn;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> eqp_sym</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /eqp;</span><span class="id"> case/andP=&gt;</span><span class="id"> dd'</span><span class="id"> d'd</span><span class="id"> dp;</span><span class="id"> apply:</span> (<span class="id">dvdp_trans</span><span class="id"> d'd</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpZr</span><span class="id"> c</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> %|</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">m</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> cn0;</span><span class="id"> exact/eqp_dvdr/eqp_scale</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpZl</span><span class="id"> c</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> m</span><span class="id"> %|</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> cn0;</span><span class="id"> exact/eqp_dvdl/eqp_scale</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpNl</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> d</span>)<span class="id"> %|</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scaleN1r;</span><span class="id"> apply/eqp_dvdl/eqp_scale;</span><span class="id"> rewrite</span><span class="id"> oppr_eq0</span><span class="id"> oner_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpNr</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eqp_dvdr;</span><span class="id"> rewrite</span><span class="id"> -scaleN1r</span><span class="id"> eqp_scale</span><span class="id"> ?oppr_eq0</span><span class="id"> ?oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_mul2r</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> *</span><span class="id"> r</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nz_r;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !dvdp_mul2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_mul2l</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q:</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">r</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nz_r;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !dvdp_mul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_mull</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q:</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> p</span><span class="id"> *</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c</span><span class="id"> d]]</span><span class="id"> /andP</span><span class="id"> [c0</span><span class="id"> d0</span><span class="id"> e];</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">c,</span><span class="id"> d</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?c0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerAr</span><span class="id"> e</span><span class="id"> -scalerAr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_mulr</span><span class="id"> q</span><span class="id"> p</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span><span class="id"> r</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> *</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> epq;</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> r]mulrC</span><span class="id"> eqp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_exp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> k</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> k</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> pq;</span><span class="id"> elim:</span><span class="id"> k=&gt;</span><span class="id"> [|k</span><span class="id"> ihk];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expr0</span><span class="id"> eqpxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !exprS</span> (<span class="id">@eqp_trans</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> p</span><span class="id"> ^+</span><span class="id"> k</span>))<span class="id"> //</span> (<span class="id">eqp_mulr,</span><span class="id"> eqp_mull</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> polyC_eqp1</span> (<span class="id">c</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">c%:P</span><span class="id"> %=</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">c</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqpP/idP</span><span class="id"> =&gt;</span><span class="id"> [[[x</span><span class="id"> y]]</span><span class="id"> |nc0]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> c</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;|]</span><span class="id"> //=</span><span class="id"> /andP</span><span class="id"> [_]</span><span class="id"> /negPf</span><span class="id"> &lt;-</span><span class="id"> /eqP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> alg_polyC</span><span class="id"> scaler0</span><span class="id"> eq_sym</span><span class="id"> polyC_eq0</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">1,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> nc0</span><span class="id"> /=</span><span class="id"> oner_neq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> alg_polyC</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdUp</span><span class="id"> d</span><span class="id"> p:</span><span class="id"> d</span><span class="id"> %=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqp_dvdl-&gt;;</span><span class="id"> rewrite</span><span class="id"> dvd1p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_size_eqp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> size</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> pq;</span><span class="id"> apply/idP/idP;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move/eqp_size-&gt;</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|Hq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> size_poly_eq0</span><span class="id"> eqp0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|Hp]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> eq_sym</span><span class="id"> size_poly_eq0</span><span class="id"> eqp_sym</span><span class="id"> eqp0</span>.<br/>
<span class="id">move:</span><span class="id"> pq;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> eqpq</span>.<br/>
<span class="id">have</span><span class="id"> /=</span><span class="id"> :=</span><span class="id"> congr1</span> (<span class="id">size</span><span class="id"> \o</span><span class="id"> @polyseq</span><span class="id"> R</span>)<span class="id"> eqpq</span>.<br/>
<span class="id">have</span><span class="id"> cn0</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">rewrite</span> (<span class="id">@eqp_size</span><span class="id"> _</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> eqp_scale</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_mul</span><span class="id"> ?p0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> HH|];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP=&gt;</span><span class="id"> HH;</span><span class="id"> move:</span><span class="id"> eqpq;</span><span class="id"> rewrite</span><span class="id"> HH</span><span class="id"> mul0r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> scale_poly_eq0</span> (<span class="id">negPf</span><span class="id"> Hq</span>) (<span class="id">negPf</span><span class="id"> cn0</span>).<br/>
<span class="id">suff:</span><span class="id"> size</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1%N</span>.<br/>
&nbsp;&nbsp;<span class="id">case/size_poly1P=&gt;</span><span class="id"> y</span><span class="id"> H1y</span><span class="id"> H2y</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">y,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?H1y</span><span class="id"> //</span><span class="id"> eqpq</span><span class="id"> H2y</span><span class="id"> mul_polyC</span>.<br/>
<span class="id">case:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> HH</span> (<span class="id">size_poly_eq0</span><span class="id"> p</span>)<span class="id">=&gt;</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> Hp</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addnS</span><span class="id"> -add1n</span><span class="id"> eqn_add2r;</span><span class="id"> move/eqP-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_root</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> =1</span><span class="id"> root</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/eqpP=&gt;</span><span class="id"> [[c</span><span class="id"> d]]</span><span class="id"> /andP</span><span class="id"> [c0</span><span class="id"> d0</span><span class="id"> e]</span><span class="id"> x;</span><span class="id"> move/negPf:c0=&gt;c0;</span><span class="id"> move/negPf:d0=&gt;d0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rootE</span><span class="id"> -[_==_]orFb</span><span class="id"> -c0</span><span class="id"> -mulf_eq0</span><span class="id"> -hornerZ</span><span class="id"> e</span><span class="id"> hornerZ</span><span class="id"> mulf_eq0</span><span class="id"> d0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_rmod_mod</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> modp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> modpE</span><span class="id"> eqp_sym;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> ulcq</span><span class="id"> //</span>.<br/>
<span class="id">apply:</span><span class="id"> eqp_scale;</span><span class="id"> rewrite</span><span class="id"> invr_eq0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> expf_neq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcq</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_rdiv_div</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> divp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> divpE</span><span class="id"> eqp_sym;</span><span class="id"> case:</span><span class="id"> ifP=&gt;</span><span class="id"> ulcq//;</span><span class="id"> apply:</span><span class="id"> eqp_scale;</span><span class="id"> rewrite</span><span class="id"> invr_eq0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> expf_neq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcq</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvd_eqp_divl</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span> (<span class="id">dvd_dp</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> q</span>) (<span class="id">eq_pq</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> q</span><span class="id"> 0</span>)<span class="id"> eq_pq=&gt;</span><span class="id"> [-&gt;|q_neq0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp0=&gt;</span><span class="id"> /eqP-&gt;</span>.<br/>
<span class="id">have</span><span class="id"> d_neq0:</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> dvd_dp=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> dvd0p</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> eq_pq;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@eqp_mul2r</span><span class="id"> d</span>)<span class="id"> //</span><span class="id"> !divpK</span><span class="id"> //</span><span class="id"> ?</span>(<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> eq_pq</span>)<span class="id"> //</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eqp_ltrans</span> (<span class="id">eqp_scale</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> ?lc_expn_scalp_neq0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqp_rtrans</span> (<span class="id">eqp_scale</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> ?lc_expn_scalp_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">p1,</span><span class="id"> q1</span>)<span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="gallina-kwd"> then</span> (<span class="id">q,</span><span class="id"> p</span>)<span class="gallina-kwd"> else</span> (<span class="id">p,</span><span class="id"> q</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> p1</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> q1</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="gallina-kwd"> fix</span><span class="id"> loop</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">pp</span><span class="id"> qq</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> {struct</span><span class="id"> n}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> rr</span><span class="id"> :=</span><span class="id"> modp</span><span class="id"> pp</span><span class="id"> qq</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> rr</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> qq</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> n</span><span class="id"> is</span><span class="id"> n1</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><span class="id"> loop</span><span class="id"> n1</span><span class="id"> qq</span><span class="id"> rr</span><span class="gallina-kwd"> else</span><span class="id"> rr</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">loop</span> (<span class="id">size</span><span class="id"> p1</span>)<span class="id"> p1</span><span class="id"> q1</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> gcdp</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcd0p</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> 0</span><span class="id"> gcdp</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> /gcdp</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> if_neg</span>.<br/>
<span class="id">case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [_</span><span class="id"> |</span><span class="id"> nzp];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polySpred</span><span class="id"> !</span>(<span class="id">modp0,</span><span class="id"> nzp</span>)<span class="id"> //;</span><span class="id"> case:</span><span class="id"> _</span>.<span class="id">-1</span><span class="id"> =&gt;</span><span class="id"> [|m];</span><span class="id"> rewrite</span><span class="id"> mod0p</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp0</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> 0</span><span class="id"> gcdp</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p;</span><span class="id"> have:=</span><span class="id"> gcd0p</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> /gcdp</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="gallina-kwd"> if</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span><span class="id"> gcdp</span> (<span class="id">modp</span><span class="id"> q</span><span class="id"> p</span>)<span class="id"> p</span><span class="gallina-kwd"> else</span><span class="id"> gcdp</span> (<span class="id">modp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> gcdpE_rec</span><span class="id"> :=</span><span class="gallina-kwd"> fix</span><span class="id"> gcdpE_rec</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">pp</span><span class="id"> qq</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> {struct</span><span class="id"> n}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> rr</span><span class="id"> :=</span><span class="id"> modp</span><span class="id"> pp</span><span class="id"> qq</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> rr</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> qq</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> n</span><span class="id"> is</span><span class="id"> n1</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><span class="id"> gcdpE_rec</span><span class="id"> n1</span><span class="id"> qq</span><span class="id"> rr</span><span class="gallina-kwd"> else</span><span class="id"> rr</span>.<br/>
<span class="id">have</span><span class="id"> Irec:</span><span class="gallina-kwd"> forall</span><span class="id"> k</span><span class="id"> l</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-&gt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> gcdpE_rec</span><span class="id"> k</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> gcdpE_rec</span><span class="id"> l</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<span class="id">+</span><span class="id"> elim=&gt;</span><span class="id"> [|m</span><span class="id"> Hrec]</span><span class="id"> [|n]</span><span class="id"> //=</span><span class="id"> p1</span><span class="id"> q1</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> move/size_poly_leq0P=&gt;</span><span class="id"> -&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> modp0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/negPf</span><span class="id"> -&gt;;</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> mod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> /size_poly_leq0P</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span><span class="id"> modp0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/negPf</span><span class="id"> -&gt;;</span><span class="id"> case:</span><span class="id"> m</span><span class="id"> {Hrec}</span><span class="id"> =&gt;</span><span class="id"> [|m]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> mod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> Epq</span><span class="id"> Sm</span><span class="id"> Sn</span><span class="id"> Sq</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [-&gt;|nzq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q1</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> m</span><span class="id"> {Sm</span><span class="id"> Sn</span><span class="id"> Hrec}</span><span class="id"> =&gt;</span><span class="id"> [|m]</span><span class="id"> [|n]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> mod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> Hrec;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> Sm</span>)<span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> Sn</span>)<span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nzp]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mod0p</span><span class="id"> modp0</span><span class="id"> gcd0p</span><span class="id"> gcdp0</span><span class="id"> if_same</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nzq]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mod0p</span><span class="id"> modp0</span><span class="id"> gcd0p</span><span class="id"> gcdp0</span><span class="id"> if_same</span>.<br/>
<span class="id">rewrite</span><span class="id"> /gcdp</span><span class="id"> !ltn_modp</span><span class="id"> !</span>(<span class="id">negPf</span><span class="id"> nzp,</span><span class="id"> negPf</span><span class="id"> nzq</span>)<span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [ltpq|leqp]</span><span class="id"> :=</span><span class="id"> ltnP;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">negPf</span><span class="id"> nzp,</span><span class="id"> negPf</span><span class="id"> nzq</span>)<span class="id"> /=</span><span class="id"> polySpred</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|nzqp]</span><span class="id"> :=</span><span class="id"> eqVneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> =&gt;</span><span class="id"> [|[|s]];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> modp0</span> (<span class="id">negPf</span><span class="id"> nzp</span>)<span class="id"> //</span><span class="id"> mod0p</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> Irec</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> -polySpred</span><span class="id"> //</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> ltpq</span>)<span class="id"> ?leqW</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltnW</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|nzpq]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">size</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [|[|s]];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> modp0</span> (<span class="id">negPf</span><span class="id"> nzq</span>)<span class="id"> //</span><span class="id"> mod0p</span><span class="id"> eqxx</span>.<br/>
<span class="id">apply:</span><span class="id"> Irec</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?ltn_modp</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> -polySpred</span><span class="id"> //</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> leqp</span>)<span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltnW</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> size_gcd1p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> 1</span><span class="id"> p</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> gcdpE</span><span class="id"> size_polyC</span><span class="id"> oner_eq0</span><span class="id"> /=</span><span class="id"> modp1;</span><span class="id"> have</span><span class="id"> [|/size1_polyC</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> ltnP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> size_polyC</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|p00]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p`_0</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modp0</span><span class="id"> gcdp0</span><span class="id"> size_poly1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> modpC</span><span class="id"> //</span><span class="id"> gcd0p</span><span class="id"> size_polyC</span><span class="id"> p00</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> size_gcdp1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> 1</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> gcdpE</span><span class="id"> size_polyC</span><span class="id"> oner_eq0</span><span class="id"> /=</span><span class="id"> modp1</span><span class="id"> ltnS;</span><span class="id"> case:</span><span class="id"> leqP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/size_poly_leq0P-&gt;;</span><span class="id"> rewrite</span><span class="id"> gcdp0</span><span class="id"> modp0</span><span class="id"> size_polyC</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> size_polyC</span><span class="id"> oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdpp</span><span class="id"> :</span><span class="id"> idempotent_op</span><span class="id"> gcdp</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> gcdpE</span><span class="id"> ltnn</span><span class="id"> modpp</span><span class="id"> gcd0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gcdlr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> &amp;&amp;</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [r]</span><span class="id"> :=</span><span class="id"> ubnP</span> (<span class="id">minn</span> (<span class="id">size</span><span class="id"> q</span>) (<span class="id">size</span><span class="id"> p</span>))<span class="id">;</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> r</span><span class="id"> IHr</span><span class="gallina-kwd"> in</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_p]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> dvdpp</span><span class="id"> andbT</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_q]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcdp0</span><span class="id"> dvdpp</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltnS</span><span class="id"> gcdpE;</span><span class="id"> case:</span><span class="id"> leqP</span><span class="id"> =&gt;</span><span class="id"> [le_pq</span><span class="id"> |</span><span class="id"> lt_pq]</span><span class="id"> le_qr</span>.<br/>
&nbsp;&nbsp;<span class="id">suffices</span><span class="id"> /IHr/andP[E1</span><span class="id"> E2]:</span><span class="id"> minn</span> (<span class="id">size</span><span class="id"> q</span>) (<span class="id">size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>))<span class="id"> &lt;</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> E2</span><span class="id"> andbT</span> (<span class="id">dvdp_mod</span><span class="id"> _</span><span class="id"> E2</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtn_min</span><span class="id"> orbC</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> le_qr</span>)<span class="id"> ?ltn_modp</span>.<br/>
<span class="id">suffices</span><span class="id"> /IHr/andP[E1</span><span class="id"> E2]:</span><span class="id"> minn</span> (<span class="id">size</span><span class="id"> p</span>) (<span class="id">size</span> (<span class="id">q</span><span class="id"> %%</span><span class="id"> p</span>))<span class="id"> &lt;</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> E2</span> (<span class="id">dvdp_mod</span><span class="id"> _</span><span class="id"> E2</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtn_min</span><span class="id"> orbC</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> le_qr</span>)<span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gcdl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/andP:</span> (<span class="id">dvdp_gcdlr</span><span class="id"> p</span><span class="id"> q</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gcdr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/andP:</span> (<span class="id">dvdp_gcdlr</span><span class="id"> p</span><span class="id"> q</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_gcdpl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> pn0;</span><span class="id"> move:</span> (<span class="id">dvdp_gcdl</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> dvdp_leq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_gcdpr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> qn0;</span><span class="id"> move:</span> (<span class="id">dvdp_gcdr</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> dvdp_leq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gcd</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> m</span>)<span class="id"> &amp;&amp;</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/andP=&gt;</span><span class="id"> [dv_pmn</span><span class="id"> |</span><span class="id"> []]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">dvdp_trans</span><span class="id"> dv_pmn</span>)<span class="id"> ?dvdp_gcdl</span><span class="id"> ?dvdp_gcdr</span>.<br/>
<span class="id">have</span><span class="id"> [r]</span><span class="id"> :=</span><span class="id"> ubnP</span> (<span class="id">minn</span> (<span class="id">size</span><span class="id"> n</span>) (<span class="id">size</span><span class="id"> m</span>))<span class="id">;</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> r</span><span class="id"> IHr</span><span class="gallina-kwd"> in</span><span class="id"> m</span><span class="id"> n</span><span class="id"> *</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_m]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> m</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_n]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> n</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcdp0</span>.<br/>
<span class="id">rewrite</span><span class="id"> gcdpE</span><span class="id"> ltnS;</span><span class="id"> case:</span><span class="id"> leqP</span><span class="id"> =&gt;</span><span class="id"> [le_nm</span><span class="id"> |</span><span class="id"> lt_mn]</span><span class="id"> le_r</span><span class="id"> dv_m</span><span class="id"> dv_n</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> IHr</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">dvdp_mod</span><span class="id"> _</span><span class="id"> dv_n</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtn_min</span><span class="id"> orbC</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> le_r</span>)<span class="id"> ?ltn_modp</span>.<br/>
<span class="id">apply:</span><span class="id"> IHr</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">dvdp_mod</span><span class="id"> _</span><span class="id"> dv_m</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtn_min</span><span class="id"> orbC</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> le_r</span>)<span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdpC</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> q</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !dvdp_gcd</span><span class="id"> !dvdp_gcdl</span><span class="id"> !dvdp_gcdr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcd1p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> 1</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -size_poly_eq1</span><span class="id"> gcdpE</span><span class="id"> size_poly1;</span><span class="id"> case:</span><span class="id"> ltnP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> modp1</span><span class="id"> gcd0p</span><span class="id"> size_poly1</span><span class="id"> eqxx</span>.<br/>
<span class="id">move/size1_polyC=&gt;</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> e</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|p00]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p`_0</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modp0</span><span class="id"> gcdp0</span><span class="id"> size_poly1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> modpC</span><span class="id"> //</span><span class="id"> gcd0p</span><span class="id"> size_polyC</span><span class="id"> p00</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> 1</span><span class="id"> %=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">eqp_ltrans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> gcd1p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_addl_mul</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r:</span><span class="id"> gcdp</span><span class="id"> r</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> r</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">suff</span><span class="id"> h</span><span class="id"> m</span><span class="id"> n</span><span class="id"> d</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> d</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> gcdp</span><span class="id"> d</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> n</span>).<br/>
&nbsp;&nbsp;<span class="id">apply/andP;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> {2}</span>(<span class="id">_:</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">-p</span>)<span class="id"> *</span><span class="id"> r</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span><span class="id"> +</span><span class="id"> q</span>))<span class="id"> ?H</span><span class="id"> //</span><span class="id"> mulNr</span><span class="id"> addKr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd</span><span class="id"> dvdp_gcdl</span><span class="id"> /=</span><span class="id"> dvdp_addr</span><span class="id"> ?dvdp_gcdr</span><span class="id"> ?dvdp_mull</span><span class="id"> ?dvdp_gcdl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_addl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> m</span> (<span class="id">m</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[m</span><span class="gallina-kwd"> in</span><span class="id"> m</span><span class="id"> +</span><span class="id"> _]mul1r</span><span class="id"> gcdp_addl_mul</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_addr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> m</span> (<span class="id">n</span><span class="id"> +</span><span class="id"> m</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> gcdp_addl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_mull</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> n</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> %=</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> n</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> mulr0</span><span class="id"> eqpxx</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> mn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> m</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> gcdp0</span><span class="id"> eqpxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> gcdpE</span><span class="id"> modp_mull</span><span class="id"> gcd0p</span><span class="id"> size_mul</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> leqP;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqpxx</span>.<br/>
<span class="id">rewrite</span> (<span class="id">polySpred</span><span class="id"> mn0</span>)<span class="id"> addSn</span><span class="id"> /=</span><span class="id"> -[leqRHS]add0n</span><span class="id"> leq_add2r</span><span class="id"> -ltnS</span>.<br/>
<span class="id">rewrite</span><span class="id"> -polySpred</span><span class="id"> //=</span><span class="id"> leq_eqVlt</span><span class="id"> ltnS</span><span class="id"> size_poly_leq0</span> (<span class="id">negPf</span><span class="id"> mn0</span>)<span class="id"> orbF</span>.<br/>
<span class="id">case/size_poly1P=&gt;</span><span class="id"> c</span><span class="id"> cn0</span><span class="id"> -&gt;</span><span class="id"> {mn0</span><span class="id"> m};</span><span class="id"> rewrite</span><span class="id"> mul_polyC</span>.<br/>
<span class="id">suff</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> n</span><span class="id"> %%</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcd0p;</span><span class="id"> apply:</span><span class="id"> eqp_scale</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/modp_eq0P;</span><span class="id"> rewrite</span><span class="id"> dvdpZl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_mulr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> n</span> (<span class="id">n</span><span class="id"> *</span><span class="id"> m</span>)<span class="id"> %=</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> gcdp_mull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_scalel</span><span class="id"> c</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> gcdp</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> m</span>)<span class="id"> n</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cn0;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> dvdp_gcd</span><span class="id"> [gcdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> _]dvdp_gcd</span><span class="id"> !dvdp_gcdr</span><span class="id"> !andbT</span>.<br/>
<span class="id">apply/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> dvdp_trans</span> (<span class="id">dvdp_gcdl</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> dvdpZr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> dvdp_trans</span> (<span class="id">dvdp_gcdl</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> dvdpZl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_scaler</span><span class="id"> c</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> m</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> n</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cn0;</span><span class="id"> apply:</span><span class="id"> eqp_trans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eqp_trans</span> (<span class="id">gcdp_scalel</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> gcdpC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gcd_idl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> m</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> %=</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> mn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> m</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvd0p</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> gcdp0</span><span class="id"> eqpxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> move/eqP/</span>(<span class="id">f_equal</span> (<span class="id">gcdp</span><span class="id"> m</span>))<span class="id"> =&gt;</span><span class="id"> h</span>.<br/>
<span class="id">apply:</span><span class="id"> eqp_trans</span> (<span class="id">gcdp_mull</span> (<span class="id">n</span><span class="id"> %/</span><span class="id"> m</span>)<span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -h</span><span class="id"> eqp_sym</span><span class="id"> gcdp_scaler</span><span class="id"> //</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gcd_idr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> %=</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/dvdp_gcd_idl;</span><span class="id"> exact/eqp_trans/gcdpC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_exp</span><span class="id"> p</span><span class="id"> k</span><span class="id"> l</span><span class="id"> :</span><span class="id"> gcdp</span> (<span class="id">p</span><span class="id"> ^+</span><span class="id"> k</span>) (<span class="id">p</span><span class="id"> ^+</span><span class="id"> l</span>)<span class="id"> %=</span><span class="id"> p</span><span class="id"> ^+</span><span class="id"> minn</span><span class="id"> k</span><span class="id"> l</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> leqP</span><span class="id"> =&gt;</span><span class="id"> [|/ltnW]</span><span class="id"> /subnK</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> exprD;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> gcdp_mull</span>.<br/>
<span class="id">exact/</span>(<span class="id">eqp_trans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">/gcdp_mull</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_eq0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/idP;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case/andP</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> gcdp0</span>.<br/>
<span class="id">have</span><span class="id"> h</span><span class="id"> m</span><span class="id"> n:</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">dvd0p</span><span class="id"> m</span>)<span class="id">;</span><span class="id"> move/eqP&lt;-;</span><span class="id"> rewrite</span><span class="id"> dvdp_gcdl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span> (<span class="id">h</span><span class="id"> _</span><span class="id"> q</span>)<span class="id"> //</span> (<span class="id">h</span><span class="id"> _</span><span class="id"> p</span>)<span class="id"> //</span><span class="id"> -eqp0</span> (<span class="id">eqp_ltrans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> eqp0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_gcdr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqr;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !</span>(<span class="id">dvdp_gcd,</span><span class="id"> dvdp_gcdl,</span><span class="id"> andbT</span>)<span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> eqr</span>)<span class="id"> dvdp_gcdr</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> eqr</span>)<span class="id"> dvdp_gcdr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_gcdl</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> r</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> q</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqr;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !</span>(<span class="id">dvdp_gcd,</span><span class="id"> dvdp_gcdr,</span><span class="id"> andbT</span>)<span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> eqr</span>)<span class="id"> dvdp_gcdl</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> eqr</span>)<span class="id"> dvdp_gcdl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_gcd</span><span class="id"> p1</span><span class="id"> p2</span><span class="id"> q1</span><span class="id"> q2</span><span class="id"> :</span><span class="id"> p1</span><span class="id"> %=</span><span class="id"> p2</span><span class="id"> -&gt;</span><span class="id"> q1</span><span class="id"> %=</span><span class="id"> q2</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> p1</span><span class="id"> q1</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> p2</span><span class="id"> q2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> e1</span><span class="id"> e2;</span><span class="id"> exact:</span><span class="id"> eqp_trans</span> (<span class="id">eqp_gcdr</span><span class="id"> _</span><span class="id"> e2</span>) (<span class="id">eqp_gcdl</span><span class="id"> _</span><span class="id"> e1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_rgcd_gcd</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> rgcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> {2}</span>(<span class="id">minn</span> (<span class="id">size</span><span class="id"> p</span>) (<span class="id">size</span><span class="id"> q</span>)) (<span class="id">leqnn</span> (<span class="id">minn</span> (<span class="id">size</span><span class="id"> p</span>) (<span class="id">size</span><span class="id"> q</span>)))<span class="id"> =&gt;</span><span class="id"> n</span>.<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =&gt;</span><span class="id"> [p</span><span class="id"> q|n</span><span class="id"> ihn</span><span class="id"> p</span><span class="id"> q</span><span class="id"> hs]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> leqn0;</span><span class="id"> case:</span><span class="id"> ltnP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> size_poly_eq0;</span><span class="id"> move/eqP-&gt;</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> rgcd0p</span><span class="id"> eqpxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcdp0</span><span class="id"> rgcdp0</span><span class="id"> eqpxx</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> rgcd0p</span><span class="id"> eqpxx</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcdp0</span><span class="id"> rgcdp0</span><span class="id"> eqpxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> gcdpE</span><span class="id"> rgcdpE;</span><span class="id"> case:</span><span class="id"> ltnP</span><span class="id"> hs</span><span class="id"> =&gt;</span><span class="id"> sp</span><span class="id"> hs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> e</span><span class="id"> :=</span><span class="id"> eqp_rmod_mod</span><span class="id"> q</span><span class="id"> p;</span><span class="id"> apply/eqp_trans/ihn:</span> (<span class="id">eqp_gcdl</span><span class="id"> p</span><span class="id"> e</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqp_size</span><span class="id"> e</span>)<span class="id"> geq_min</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> hs</span>)<span class="id"> ?ltn_modp</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :=</span><span class="id"> eqp_rmod_mod</span><span class="id"> p</span><span class="id"> q;</span><span class="id"> apply/eqp_trans/ihn:</span> (<span class="id">eqp_gcdl</span><span class="id"> q</span><span class="id"> e</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqp_size</span><span class="id"> e</span>)<span class="id"> geq_min</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> _</span><span class="id"> hs</span>)<span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_modl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> gcdp</span> (<span class="id">m</span><span class="id"> %%</span><span class="id"> n</span>)<span class="id"> n</span><span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [/modp_small</span><span class="id"> -&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> lenm]</span><span class="id"> :=</span><span class="id"> ltnP</span> (<span class="id">size</span><span class="id"> m</span>) (<span class="id">size</span><span class="id"> n</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">gcdpE</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> ltnNge</span><span class="id"> lenm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_modr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> m</span> (<span class="id">n</span><span class="id"> %%</span><span class="id"> m</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> eqp_trans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eqp_trans</span> (<span class="id">gcdp_modl</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> gcdpC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_def</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> d',</span><span class="id"> d'</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> d'</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> d'</span><span class="id"> %|</span><span class="id"> d</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">gcdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> %=</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dm</span><span class="id"> dn</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> dvdp_gcd</span><span class="id"> dm</span><span class="id"> dn</span><span class="id"> !andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> h;</span><span class="id"> [apply:</span><span class="id"> dvdp_gcdl</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> dvdp_gcdr]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> ==</span><span class="id"> 1%N</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_size_gcd</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /coprimep=&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_def</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> done</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepZl</span><span class="id"> c</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> coprimep</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> m</span>)<span class="id"> n</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !coprimep_def</span> (<span class="id">eqp_size</span> (<span class="id">gcdp_scalel</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepZr</span><span class="id"> c</span><span class="id"> m</span><span class="id"> n:</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> m</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !coprimep_def</span> (<span class="id">eqp_size</span> (<span class="id">gcdp_scaler</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepp</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> coprimep_def</span><span class="id"> gcdpp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_eqp1</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> coprimep_def</span><span class="id"> size_poly_eq1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_sym</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> q</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!gcdp_eqp1;</span><span class="id"> apply:</span><span class="id"> eqp_ltrans;</span><span class="id"> rewrite</span><span class="id"> gcdpC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprime1p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> 1</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /coprimep</span><span class="id"> -[1%N]</span>(<span class="id">size_poly1</span><span class="id"> R</span>)<span class="id">;</span><span class="id"> exact/eqP/eqp_size/gcd1p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep1</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> coprimep_sym;</span><span class="id"> apply:</span><span class="id"> coprime1p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /coprimep</span><span class="id"> gcdp0</span><span class="id"> size_poly_eq1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprime0p</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> 0</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> coprimep_sym</span><span class="id"> coprimep0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> d,</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %=</span><span class="id"> 1</span>) (<span class="id">coprimep</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /coprimep;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> hs</span><span class="id"> d</span><span class="id"> dvddp</span><span class="id"> dvddq</span><span class="id"> |</span><span class="id"> h]</span>.<br/>
&nbsp;&nbsp;<span class="id">have/dvdp_eqp1:</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd</span><span class="id"> dvddp</span><span class="id"> dvddq</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1</span><span class="id"> hs;</span><span class="id"> exact</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_poly_eq1;</span><span class="id"> case/andP:</span> (<span class="id">dvdp_gcdlr</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> h</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepPn</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> d,</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &amp;&amp;</span><span class="id"> ~~</span> (<span class="id">d</span><span class="id"> %=</span><span class="id"> 1</span>)) (<span class="id">~~</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p0;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -gcdp_eqp1=&gt;</span><span class="id"> ng1;</span><span class="gallina-kwd"> exists</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdpp</span><span class="id"> /=</span>.<br/>
<span class="id">case=&gt;</span><span class="id"> d</span><span class="id"> /andP</span><span class="id"> [dg];</span><span class="id"> apply:</span><span class="id"> contra;</span><span class="id"> rewrite</span><span class="id"> -gcdp_eqp1=&gt;</span><span class="id"> g1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> dg;</span><span class="id"> rewrite</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> g1</span>)<span class="id"> dvdp1</span><span class="id"> size_poly_eq1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_dvdl</span><span class="id"> q</span><span class="id"> p</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rp</span><span class="id"> /coprimepP</span><span class="id"> cpq';</span><span class="id"> apply/coprimepP</span><span class="id"> =&gt;</span><span class="id"> d</span><span class="id"> dp</span><span class="id"> dr</span>.<br/>
<span class="id">exact/cpq'/</span>(<span class="id">dvdp_trans</span><span class="id"> dr</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_dvdr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> r</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> rp;</span><span class="id"> rewrite</span><span class="id"> ![coprimep</span><span class="id"> _</span><span class="id"> q]coprimep_sym;</span><span class="id"> apply/coprimep_dvdl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_modl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> coprimep</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> q</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !coprimep_def</span><span class="id"> [in</span><span class="id"> RHS]gcdpE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltnP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> hpq;</span><span class="id"> rewrite</span><span class="id"> modp_small</span><span class="id"> //</span><span class="id"> gcdpE</span><span class="id"> hpq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_modr</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> q</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> =</span><span class="id"> coprimep</span><span class="id"> q</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ![coprimep</span><span class="id"> q</span><span class="id"> _]coprimep_sym</span><span class="id"> coprimep_modl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rcoprimep_coprimep</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rcoprimep</span><span class="id"> q</span><span class="id"> p</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> q</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /coprimep</span><span class="id"> /rcoprimep</span> (<span class="id">eqp_size</span> (<span class="id">eqp_rgcd_gcd</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_coprimepr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!gcdp_eqp1;</span><span class="id"> move/</span>(<span class="id">eqp_gcdr</span><span class="id"> p</span>)<span class="id">/eqp_ltrans</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_coprimepl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> q</span><span class="id"> p</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> r</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">coprimep_sym</span><span class="id"> _</span><span class="id"> p</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eqp_coprimepr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> egcdp_rec</span><span class="id"> p</span><span class="id"> q</span><span class="id"> k</span><span class="id"> {struct</span><span class="id"> k}</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> k</span><span class="id"> is</span><span class="id"> k'</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span> (<span class="id">1,</span><span class="id"> 0</span>)<span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">u,</span><span class="id"> v</span>)<span class="id"> :=</span><span class="id"> egcdp_rec</span><span class="id"> q</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> k'</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lead_coef</span><span class="id"> q</span><span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *:</span><span class="id"> v,</span> (<span class="id">u</span><span class="id"> -</span><span class="id"> v</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)))<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> (<span class="id">1,</span><span class="id"> 0</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> egcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span><span class="gallina-kwd"> then</span><span class="id"> egcdp_rec</span><span class="id"> p</span><span class="id"> q</span> (<span class="id">size</span><span class="id"> q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="gallina-kwd"> let</span><span class="id"> e</span><span class="id"> :=</span><span class="id"> egcdp_rec</span><span class="id"> q</span><span class="id"> p</span> (<span class="id">size</span><span class="id"> p</span>)<span class="gallina-kwd"> in</span> (<span class="id">e</span>.<span class="id">2,</span><span class="id"> e</span>.<span class="id">1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> egcdp0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> egcdp</span><span class="id"> p</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">1,</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /egcdp</span><span class="id"> size_poly0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> egcdp_recP</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> k</span><span class="id"> p</span><span class="id"> q,</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> e</span><span class="id"> :=</span> (<span class="id">egcdp_rec</span><span class="id"> p</span><span class="id"> q</span><span class="id"> k</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[/\</span><span class="id"> size</span><span class="id"> e</span>.<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q,</span><span class="id"> size</span><span class="id"> e</span>.<span class="id">2</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &amp;</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> e</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> e</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim=&gt;</span><span class="id"> [|k</span><span class="id"> ihk]</span><span class="id"> p</span><span class="id"> q</span><span class="id"> /=</span><span class="id"> qn0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly_leq0</span> (<span class="id">negPf</span><span class="id"> qn0</span>).<br/>
<span class="id">move=&gt;</span><span class="id"> sqSn</span><span class="id"> qsp;</span><span class="id"> rewrite</span> (<span class="id">negPf</span><span class="id"> qn0</span>).<br/>
<span class="id">have</span><span class="id"> sp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> qsp;</span><span class="id"> rewrite</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">have</span><span class="id"> [r0</span><span class="id"> |</span><span class="id"> rn0]</span><span class="id"> /=</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">p</span><span class="id"> %%q</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> r0</span><span class="id"> /egcdp_rec;</span><span class="id"> case:</span><span class="id"> k</span><span class="id"> ihk</span><span class="id"> sqSn</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> ihn</span><span class="id"> sqSn</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !scaler0</span><span class="id"> !mul0r</span><span class="id"> subr0</span><span class="id"> add0r</span><span class="id"> mul1r</span><span class="id"> size_poly0</span><span class="id"> size_poly1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd_idr</span><span class="id"> /dvdp</span><span class="id"> ?r0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !eqxx</span><span class="id"> mul0r</span><span class="id"> scaler0</span><span class="id"> /=</span><span class="id"> mul0r</span><span class="id"> add0r</span><span class="id"> subr0</span><span class="id"> mul1r</span><span class="id"> size_poly0</span><span class="id"> size_poly1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd_idr</span><span class="id"> /dvdp</span><span class="id"> ?r0</span><span class="id"> //</span>.<br/>
<span class="id">have</span><span class="id"> h1</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> k</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> sqSn;</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">have</span><span class="id"> h2</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltnW</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> ihk</span><span class="id"> q</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> rn0</span><span class="id"> h1</span><span class="id"> h2</span>.<br/>
<span class="id">case:</span> (<span class="id">egcdp_rec</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">=&gt;</span><span class="id"> u</span><span class="id"> v</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> [[ihn'1</span><span class="id"> ihn'2</span><span class="id"> ihn'3]]</span>.<br/>
<span class="id">rewrite</span><span class="id"> gcdpE</span><span class="id"> ltnNge</span><span class="id"> qsp</span><span class="id"> //=</span> (<span class="id">eqp_ltrans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span> (<span class="id">eqp_trans</span><span class="id"> ihn'3</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrBl</span><span class="id"> addrCA</span><span class="id"> -scalerAl</span><span class="id"> scalerAr</span><span class="id"> -mulrA</span><span class="id"> -mulrBr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divp_eq</span><span class="id"> addrAC</span><span class="id"> subrr</span><span class="id"> add0r</span><span class="id"> eqpxx</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span> (<span class="id">leq_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> vn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> v</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul0r</span><span class="id"> size_polyN</span><span class="id"> size_poly0</span><span class="id"> maxn0;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> ihn'1</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> leq_modp</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qqn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulr0</span><span class="id"> size_polyN</span><span class="id"> size_poly0</span><span class="id"> maxn0;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> ihn'1</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> leq_modp</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> geq_max</span> (<span class="id">leq_trans</span><span class="id"> ihn'1</span>)<span class="id"> ?leq_modp</span><span class="id"> //=</span><span class="id"> size_polyN</span><span class="id"> size_mul</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">ihn'2</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">polySpred</span><span class="id"> vn0</span>) (<span class="id">polySpred</span><span class="id"> qn0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">ltn_add2r</span> (<span class="id">size</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)))<span class="id"> !addSn</span><span class="id"> /=</span><span class="id"> ltnS;</span><span class="id"> move/leq_trans;</span><span class="id"> apply</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_divp</span><span class="id"> //</span><span class="id"> addnBA</span><span class="id"> ?addKn</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> qsp;</span><span class="id"> apply:</span><span class="id"> leq_pred</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> //</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> egcdpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span> (<span class="id">e</span><span class="id"> :=</span><span class="id"> egcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="id">[/\</span><span class="id"> size</span><span class="id"> e</span>.<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> q,</span><span class="id"> size</span><span class="id"> e</span>.<span class="id">2</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &amp;</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> e</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> e</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /egcdp</span><span class="id"> =&gt;</span><span class="id"> pn0</span><span class="id"> qn0;</span><span class="id"> case:</span> (<span class="id">leqP</span> (<span class="id">size</span><span class="id"> q</span>) (<span class="id">size</span><span class="id"> p</span>))<span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|/ltnW]</span><span class="id"> hp</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> egcdp_recP</span>.<br/>
<span class="id">case:</span> (<span class="id">egcdp_recP</span><span class="id"> pn0</span> (<span class="id">leqnn</span> (<span class="id">size</span><span class="id"> p</span>))<span class="id"> hp</span>)<span class="id"> =&gt;</span><span class="id"> h1</span><span class="id"> h2</span><span class="id"> h3;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqp_ltrans</span> (<span class="id">gcdpC</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> addrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> egcdpE</span><span class="id"> p</span><span class="id"> q</span> (<span class="id">e</span><span class="id"> :=</span><span class="id"> egcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> e</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> e</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {}/e;</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> /=</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcdp0</span><span class="id"> egcdp0</span><span class="id"> mul1r</span><span class="id"> mulr0</span><span class="id"> addr0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">egcdpP</span><span class="id"> pn0</span><span class="id"> qn0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcd0p</span><span class="id"> /egcdp</span><span class="id"> size_poly0</span><span class="id"> size_poly_leq0</span> (<span class="id">negPf</span><span class="id"> qn0</span>)<span class="id"> /=</span><span class="id"> !simp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Bezoutp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> u,</span><span class="id"> u</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> u</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %=</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcd0p;</span><span class="gallina-kwd"> exists</span> (<span class="id">0,</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> mul1r</span><span class="id"> add0r</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gcdp0;</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> mul1r</span><span class="id"> addr0</span>.<br/>
<span class="id">pose</span><span class="id"> e</span><span class="id"> :=</span><span class="id"> egcdp</span><span class="id"> p</span><span class="id"> q;</span><span class="gallina-kwd"> exists</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">egcdpP</span><span class="id"> pn0</span><span class="id"> qn0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Bezout_coprimepP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> u,</span><span class="id"> u</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> u</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> 1</span>) (<span class="id">coprimep</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -gcdp_eqp1;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">=&gt;</span><span class="id"> [g1|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">Bezoutp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [[u</span><span class="id"> v]</span><span class="id"> Puv];</span><span class="gallina-kwd"> exists</span> (<span class="id">u,</span><span class="id"> v</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eqp_trans</span><span class="id"> g1</span>.<br/>
<span class="id">case=&gt;</span><span class="id"> [[u</span><span class="id"> v]];</span><span class="id"> rewrite</span><span class="id"> eqp_sym=&gt;</span><span class="id"> Puv;</span><span class="id"> rewrite</span><span class="id"> /eqp</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> Puv</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_addr</span><span class="id"> dvdp_mull</span><span class="id"> ?dvdp_gcdl</span><span class="id"> ?dvdp_gcdr</span><span class="id"> //=</span><span class="id"> dvd1p</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_root</span><span class="id"> p</span><span class="id"> q</span><span class="id"> x</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> q</span>.<span class="id">[x]</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/Bezout_coprimepP=&gt;</span><span class="id"> [[u</span><span class="id"> v]</span><span class="id"> euv]</span><span class="id"> px0</span>.<br/>
<span class="id">move/eqpP:</span><span class="id"> euv</span><span class="id"> =&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> /=</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="id">suffices:</span><span class="id"> c1</span><span class="id"> *</span> (<span class="id">v</span>.<span class="id">[x]</span><span class="id"> *</span><span class="id"> q</span>.<span class="id">[x]</span>)<span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulf_eq0</span><span class="id"> !negb_or</span><span class="id"> c1n0</span><span class="id"> /=;</span><span class="id"> case/andP</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> f_equal</span> (<span class="id">horner^~</span><span class="id"> x</span>)<span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> !hornerZ</span><span class="id"> hornerD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !hornerM</span> (<span class="id">eqP</span><span class="id"> px0</span>)<span class="id"> mulr0</span><span class="id"> add0r</span><span class="id"> hornerC</span><span class="id"> mulr1;</span><span class="id"> move-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Gauss_dvdpl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> d:</span><span class="id"> coprimep</span><span class="id"> d</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/Bezout_coprimepP=&gt;[[u</span><span class="id"> v]</span><span class="id"> Puv];</span><span class="id"> apply/idP/idP;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> dvdp_mulr</span>.<br/>
<span class="id">move/</span>(<span class="id">eqp_mull</span><span class="id"> p</span>)<span class="id">:</span><span class="id"> Puv;</span><span class="id"> rewrite</span><span class="id"> mulr1</span><span class="id"> mulrDr</span><span class="id"> eqp_sym=&gt;</span><span class="id"> peq</span><span class="id"> dpq</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> peq</span>)<span class="id"> dvdp_addr;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> mulrAC</span><span class="id"> dvdp_mulr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> dvdp_mull</span><span class="id"> ?dvdpp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Gauss_dvdpr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> d:</span><span class="id"> coprimep</span><span class="id"> d</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> *</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC;</span><span class="id"> apply:</span><span class="id"> Gauss_dvdpl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Gauss_dvdp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> &amp;&amp;</span> (<span class="id">n</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> mn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> m</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> coprime0p</span><span class="id"> =&gt;</span><span class="id"> /eqp_dvdl-&gt;;</span><span class="id"> rewrite</span><span class="id"> !mul0r</span><span class="id"> dvd0p</span><span class="id"> dvd1p</span><span class="id"> andbT</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> n</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> coprimep0</span><span class="id"> =&gt;</span><span class="id"> /eqp_dvdl-&gt;;</span><span class="id"> rewrite</span><span class="id"> !mulr0</span><span class="id"> dvd1p</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> hc;</span><span class="id"> apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [mnmp</span><span class="id"> |</span><span class="id"> /andP</span><span class="id"> [dmp</span><span class="id"> dnp]]</span>.<br/>
&nbsp;&nbsp;<span class="id">move/Gauss_dvdpl:</span><span class="id"> hc</span><span class="id"> =&gt;</span><span class="id"> &lt;-;</span><span class="id"> move:</span> (<span class="id">dvdp_mull</span><span class="id"> m</span><span class="id"> mnmp</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_mul2l</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">move-&gt;;</span><span class="id"> move:</span> (<span class="id">dvdp_mulr</span><span class="id"> n</span><span class="id"> mnmp</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_mul2r</span><span class="id"> //</span><span class="id"> andbT</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> dvdp_mulr</span>.<br/>
<span class="id">move:</span> (<span class="id">dnp</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq</span>.<br/>
<span class="id">set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> e2</span>.<br/>
<span class="id">have/esym</span><span class="id"> :=</span><span class="id"> Gauss_dvdpl</span><span class="id"> q2</span><span class="id"> hc;</span><span class="id"> rewrite</span><span class="id"> -e2</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> m</span><span class="id"> %|</span><span class="id"> c2</span><span class="id"> *:</span><span class="id"> p</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mul_polyC</span><span class="id"> dvdp_mull</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c3</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> q3</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> e3</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span> (<span class="id">c3</span><span class="id"> *</span><span class="id"> c2</span>)<span class="id"> q3</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> -e3</span><span class="id"> -scalerAl</span><span class="id"> -e2</span><span class="id"> scalerA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Gauss_gcdpr</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> p</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> co_pm;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !dvdp_gcd</span><span class="id"> !dvdp_gcdl</span><span class="id"> /=</span><span class="id"> andbC</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_mull</span><span class="id"> ?dvdp_gcdr</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">@Gauss_dvdpl</span><span class="id"> _</span><span class="id"> m</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> dvdp_gcdr</span>.<br/>
<span class="id">apply/coprimepP=&gt;</span><span class="id"> d;</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd;</span><span class="id"> case/andP=&gt;</span><span class="id"> hdp</span><span class="id"> _</span><span class="id"> hdm</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/coprimepP:</span><span class="id"> co_pm;</span><span class="id"> apply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Gauss_gcdpl</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> gcdp</span><span class="id"> p</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> co_pn;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> Gauss_gcdpr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepMr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> r</span>)<span class="id"> =</span> (<span class="id">coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> &amp;&amp;</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/coprimepP/andP=&gt;</span><span class="id"> [hp</span><span class="id"> |</span><span class="id"> [/coprimepP-hq</span><span class="id"> hr]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> apply/coprimepP=&gt;</span><span class="id"> d</span><span class="id"> dp</span><span class="id"> dq;</span><span class="id"> rewrite</span><span class="id"> hp</span><span class="id"> //;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[apply/dvdp_mulr</span><span class="id"> |</span><span class="id"> apply/dvdp_mull]</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> d</span><span class="id"> dp</span><span class="id"> dqr;</span><span class="id"> move/</span>(_<span class="id"> _</span><span class="id"> dp</span>)<span class="gallina-kwd"> in</span><span class="id"> hq</span>.<br/>
<span class="id">rewrite</span><span class="id"> Gauss_dvdpl</span><span class="gallina-kwd"> in</span><span class="id"> dqr;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> hq</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/coprimep_dvdr:</span><span class="id"> hr;</span><span class="id"> apply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepMl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r:</span><span class="id"> coprimep</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> r</span>)<span class="id"> p</span><span class="id"> =</span> (<span class="id">coprimep</span><span class="id"> q</span><span class="id"> p</span><span class="id"> &amp;&amp;</span><span class="id"> coprimep</span><span class="id"> r</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ![coprimep</span><span class="id"> _</span><span class="id"> p]coprimep_sym</span><span class="id"> coprimepMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_coprime</span><span class="id"> k</span><span class="id"> u</span><span class="id"> n</span><span class="id"> :</span><span class="id"> k</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">k</span><span class="id"> *</span><span class="id"> u</span>)<span class="id"> %%</span><span class="id"> n</span><span class="id"> %=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> k</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> kn0</span><span class="id"> hmod;</span><span class="id"> apply/Bezout_coprimepP</span>.<br/>
<span class="gallina-kwd">exists</span> (((<span class="id">lead_coef</span><span class="id"> n</span>)<span class="id">^+</span>(<span class="id">scalp</span> (<span class="id">k</span><span class="id"> *</span><span class="id"> u</span>)<span class="id"> n</span>)<span class="id"> *:</span><span class="id"> u</span>)<span class="id">,</span> (<span class="id">-</span> (<span class="id">k</span><span class="id"> *</span><span class="id"> u</span><span class="id"> %/</span><span class="id"> n</span>))).<br/>
<span class="id">rewrite</span><span class="id"> -scalerAl</span><span class="id"> mulrC</span> (<span class="id">divp_eq</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> k</span>)<span class="id"> n</span>)<span class="id"> mulNr</span><span class="id"> -addrAC</span><span class="id"> subrr</span><span class="id"> add0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_pexpl</span><span class="id"> k</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> coprimep</span> (<span class="id">m</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> n</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> k</span><span class="id"> _;</span><span class="id"> elim:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> [|k</span><span class="id"> IHk];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> coprimepMl</span><span class="id"> -IHk</span><span class="id"> andbb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_pexpr</span><span class="id"> k</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> m</span> (<span class="id">n</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> k_gt0;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">coprimep_sym</span><span class="id"> m</span>)<span class="id"> coprimep_pexpl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_expl</span><span class="id"> k</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> coprimep</span> (<span class="id">m</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> [|k]</span><span class="id"> co_pm;</span><span class="id"> rewrite</span><span class="id"> ?coprime1p</span><span class="id"> //</span><span class="id"> coprimep_pexpl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_expr</span><span class="id"> k</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> m</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> m</span> (<span class="id">n</span><span class="id"> ^+</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">coprimep_sym</span><span class="id"> m</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> coprimep_expl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_mul2l</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> gcdp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>) (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span>)<span class="id"> %=</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> gcdp</span><span class="id"> q</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|hp]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mul0r</span><span class="id"> gcdp0</span><span class="id"> eqpxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> /eqp</span><span class="id"> !dvdp_gcd</span><span class="id"> !dvdp_mul2l</span><span class="id"> //</span><span class="id"> dvdp_gcdr</span><span class="id"> dvdp_gcdl</span><span class="id"> !andbT</span>.<br/>
<span class="id">move:</span> (<span class="id">Bezoutp</span><span class="id"> q</span><span class="id"> r</span>)<span class="id"> =&gt;</span><span class="id"> [[u</span><span class="id"> v]]</span><span class="id"> huv</span>.<br/>
<span class="id">rewrite</span><span class="id"> eqp_sym</span><span class="gallina-kwd"> in</span><span class="id"> huv;</span><span class="id"> rewrite</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span> (<span class="id">eqp_mull</span><span class="id"> _</span><span class="id"> huv</span>)).<br/>
<span class="id">rewrite</span><span class="id"> mulrDr</span><span class="id"> ![p</span><span class="id"> *</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">]mulrCA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> dvdp_add;</span><span class="id"> rewrite</span><span class="id"> dvdp_mull//</span> (<span class="id">dvdp_gcdr,</span><span class="id"> dvdp_gcdl</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_mul2r</span><span class="id"> q</span><span class="id"> r</span><span class="id"> p</span><span class="id"> :</span><span class="id"> gcdp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> p</span>) (<span class="id">r</span><span class="id"> *</span><span class="id"> p</span>)<span class="id"> %=</span><span class="id"> gcdp</span><span class="id"> q</span><span class="id"> r</span><span class="id"> *</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> p]mulrC</span><span class="id"> gcdp_mul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulp_gcdr</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> *</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> %=</span><span class="id"> gcdp</span> (<span class="id">r</span><span class="id"> *</span><span class="id"> p</span>) (<span class="id">r</span><span class="id"> *</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> gcdp_mul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulp_gcdl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> r</span><span class="id"> %=</span><span class="id"> gcdp</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span>) (<span class="id">q</span><span class="id"> *</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> gcdp_mul2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_div_gcd</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">q</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">coprimep</span> (<span class="id">p</span><span class="id"> %/</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)) (<span class="id">q</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -negb_and</span><span class="id"> -gcdp_eq0</span><span class="id"> -gcdp_eqp1</span><span class="id"> =&gt;</span><span class="id"> gpq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@eqp_mul2r</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> //</span><span class="id"> mul1r</span> (<span class="id">eqp_ltrans</span> (<span class="id">mulp_gcdl</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="id">have:</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcdl</span>.<br/>
<span class="id">have:</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> q</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcdr</span>.<br/>
<span class="id">rewrite</span><span class="id"> !dvdp_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> &lt;-</span><span class="id"> /eqP</span><span class="id"> &lt;-</span>.<br/>
<span class="id">have</span><span class="id"> lcn0</span><span class="id"> k</span><span class="id"> :</span> (<span class="id">lead_coef</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> ^+</span><span class="id"> k</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> ?lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eqp_gcd;</span><span class="id"> rewrite</span><span class="id"> ?eqp_scale</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_eq0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> [||</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> 0,</span><span class="id"> q</span><span class="id"> ==0</span><span class="id"> |</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP/idP=&gt;</span><span class="id"> [d0|];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">case/or3P;</span><span class="id"> [by</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> div0p|</span><span class="gallina-kwd"> by</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> divp0|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/divp_small</span>.<br/>
<span class="id">case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> qn0</span>.<br/>
<span class="id">move:</span> (<span class="id">divp_eq</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> d0</span><span class="id"> mul0r</span><span class="id"> add0r</span>.<br/>
<span class="id">move/</span>(<span class="id">f_equal</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> =&gt;</span><span class="id"> size</span><span class="id"> x</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?lc_expn_scalp_neq0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span><span class="id"> qn0</span><span class="id"> !orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_div_eq0</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dvdp_qp;</span><span class="id"> have</span><span class="id"> [-&gt;|p_neq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> div0p</span><span class="id"> eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> divp_eq0</span><span class="id"> ltnNge</span><span class="id"> dvdp_leq</span><span class="id"> //</span> (<span class="id">negPf</span><span class="id"> p_neq0</span>)<span class="id"> orbF</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTF</span><span class="id"> dvdp_qp=&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> dvd0p</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Bezout_coprimepPn</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> uv</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> R},</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> uv</span>.<span class="id">1</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> uv</span>.<span class="id">2</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span>)<span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">uv</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> =</span><span class="id"> uv</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">~~</span> (<span class="id">coprimep</span><span class="id"> p</span><span class="id"> q</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> pn0</span><span class="id"> qn0;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">case=&gt;</span><span class="id"> [[u</span><span class="id"> v]</span><span class="id"> /=</span><span class="id"> /andP</span><span class="id"> [/andP</span><span class="id"> [ps1</span><span class="id"> s1]</span><span class="id"> /andP</span><span class="id"> [ps2</span><span class="id"> s2]]</span><span class="id"> e]</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span><span class="id"> ~~</span>(<span class="id">size</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> p</span>)<span class="id"> &lt;=</span><span class="id"> size</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> p</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -ltnNge</span><span class="id"> !size_mul</span><span class="id"> //</span><span class="id"> -?size_poly_gt0</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> pn0</span>)<span class="id"> !addnS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltn_add2r</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contra</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> dvdp_leq;</span><span class="id"> rewrite</span><span class="id"> ?mulf_neq0</span><span class="id"> //</span><span class="id"> -?size_poly_gt0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> Gauss_dvdp</span><span class="id"> //</span><span class="id"> dvdp_mull</span><span class="id"> //</span><span class="id"> e</span><span class="id"> dvdp_mull</span>.<br/>
<span class="id">rewrite</span><span class="id"> coprimep_def</span><span class="id"> neq_ltn</span><span class="id"> ltnS</span><span class="id"> size_poly_leq0</span><span class="id"> gcdp_eq0</span>.<br/>
<span class="id">rewrite</span> (<span class="id">negPf</span><span class="id"> pn0</span>) (<span class="id">negPf</span><span class="id"> qn0</span>)<span class="id"> /=</span>.<br/>
<span class="id">case</span><span class="id"> sg:</span> (<span class="id">size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> sg=&gt;</span><span class="id"> [|n]</span><span class="id"> //</span><span class="id"> sg</span><span class="id"> _</span>.<br/>
<span class="id">move:</span> (<span class="id">dvdp_gcdl</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> hu1</span>.<br/>
<span class="id">move:</span> (<span class="id">dvdp_gcdr</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> hv1</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">c1</span><span class="id"> *:</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">,</span><span class="id"> c2</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!scalerAl</span><span class="id"> !scalerAr</span><span class="id"> hu1</span><span class="id"> hv1</span><span class="id"> mulrCA</span>.<br/>
<span class="id">rewrite</span><span class="id"> !size_scale</span><span class="id"> ?lc_expn_scalp_neq0</span><span class="id"> //=</span><span class="id"> !size_poly_gt0</span><span class="id"> !divp_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> gcdp_eq0</span><span class="id"> !</span>(<span class="id">negPf</span><span class="id"> pn0</span>)<span class="id"> !</span>(<span class="id">negPf</span><span class="id"> qn0</span>)<span class="id"> /=</span><span class="id"> -!leqNgt</span><span class="id"> leq_gcdpl</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> leq_gcdpr</span><span class="id"> //=</span><span class="id"> !ltn_divpl</span><span class="id"> -?size_poly_eq0</span><span class="id"> ?sg</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> !size_mul</span><span class="id"> //</span><span class="id"> -?size_poly_eq0</span><span class="id"> ?sg</span><span class="id"> //</span><span class="id"> ![</span>(_<span class="id"> +</span><span class="id"> n</span>.<span class="id">+2</span>)<span class="id">%N]addnS</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">addn1</span> (<span class="id">size</span><span class="id"> _</span>))<span class="id"> !leq_add2l</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_pexp2r</span><span class="id"> m</span><span class="id"> n</span><span class="id"> k</span><span class="id"> :</span><span class="id"> k</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> %|</span><span class="id"> n</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> %|</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> k_gt0;</span><span class="id"> apply/idP/idP;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> dvdp_exp2r</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> nn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> n</span><span class="id"> 0;</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> mn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> m</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">move/prednK:</span><span class="id"> k_gt0=&gt;</span><span class="id"> {1}&lt;-;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mul0r</span><span class="id"> //=</span><span class="id"> !dvd0p</span><span class="id"> expf_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/andP=&gt;</span><span class="id"> _</span><span class="id"> -&gt;</span>.<br/>
<span class="id">set</span><span class="id"> d</span><span class="id"> :=</span><span class="id"> gcdp</span><span class="id"> m</span><span class="id"> n;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> dvdp_gcdr</span><span class="id"> m</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> -/d</span><span class="id"> dvdp_eq</span>.<br/>
<span class="id">set</span><span class="id"> c1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> n'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> def_n</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> dvdp_gcdl</span><span class="id"> m</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> -/d</span><span class="id"> dvdp_eq</span>.<br/>
<span class="id">set</span><span class="id"> c2</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> m'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> def_m</span>.<br/>
<span class="id">have</span><span class="id"> dn0</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gcdp_eq0</span><span class="id"> negb_and</span><span class="id"> nn0</span><span class="id"> orbT</span>.<br/>
<span class="id">have</span><span class="id"> c1n0</span><span class="id"> :</span><span class="id"> c1</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">have</span><span class="id"> c2n0</span><span class="id"> :</span><span class="id"> c2</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">have</span><span class="id"> c2k_n0</span><span class="id"> :</span><span class="id"> c2</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@dvdpZr</span> (<span class="id">c1</span><span class="id"> ^+</span><span class="id"> k</span>))<span class="id"> ?expf_neq0</span><span class="id"> ?lead_coef_eq0</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@dvdpZl</span> (<span class="id">c2</span><span class="id"> ^+</span><span class="id"> k</span>))<span class="id"> //</span><span class="id"> -!exprZn</span><span class="id"> def_m</span><span class="id"> def_n</span><span class="id"> !exprMn</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_mul2r</span><span class="id"> ?expf_neq0</span><span class="id"> //</span>.<br/>
<span class="id">have:</span><span class="id"> coprimep</span> (<span class="id">m'</span><span class="id"> ^+</span><span class="id"> k</span>) (<span class="id">n'</span><span class="id"> ^+</span><span class="id"> k</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> coprimep_pexpl</span><span class="id"> //</span><span class="id"> coprimep_pexpr</span><span class="id"> //</span><span class="id"> coprimep_div_gcd</span><span class="id"> ?mn0</span>.<br/>
<span class="id">move/coprimepP=&gt;</span><span class="id"> hc</span><span class="id"> hd</span>.<br/>
<span class="id">have</span><span class="id"> /size_poly1P</span><span class="id"> [c</span><span class="id"> cn0</span><span class="id"> em']</span><span class="id"> :</span><span class="id"> size</span><span class="id"> m'</span><span class="id"> ==</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> m'</span><span class="id"> 0</span>)<span class="id"> def_m</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /eqP</span><span class="id"> |</span><span class="id"> m'_n0</span><span class="id"> def_m]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> scale_poly_eq0</span> (<span class="id">negPf</span><span class="id"> mn0</span>) (<span class="id">negPf</span><span class="id"> c2n0</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> :=</span><span class="id"> hc</span><span class="id"> _</span> (<span class="id">dvdpp</span><span class="id"> _</span>)<span class="id"> hd;</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> polySpred;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_eq0</span><span class="id"> negb_and</span><span class="id"> m'_n0</span><span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_exp</span><span class="id"> eqSS</span><span class="id"> muln_eq0</span><span class="id"> orbC</span><span class="id"> eqn0Ngt</span><span class="id"> k_gt0</span><span class="id"> /=</span><span class="id"> -eqSS</span><span class="id"> -polySpred</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@dvdpZl</span><span class="id"> c2</span>)<span class="id"> //</span><span class="id"> def_m</span><span class="id"> em'</span><span class="id"> mul_polyC</span><span class="id"> dvdpZl</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@dvdpZr</span><span class="id"> c1</span>)<span class="id"> //</span><span class="id"> def_n</span><span class="id"> dvdp_mull</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_gcd</span><span class="id"> p</span><span class="id"> q</span><span class="id"> x</span><span class="id"> :</span><span class="id"> root</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> &amp;&amp;</span><span class="id"> root</span><span class="id"> q</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> !root_factor_theorem;</span><span class="id"> apply/idP/andP=&gt;</span><span class="id"> [dg|</span><span class="id"> [dp</span><span class="id"> dq]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> apply:</span><span class="id"> dvdp_trans</span><span class="id"> dg</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">dvdp_gcdl,</span><span class="id"> dvdp_gcdr</span>).<br/>
<span class="id">have:=</span><span class="id"> Bezoutp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =&gt;</span><span class="id"> [[[u</span><span class="id"> v]]];</span><span class="id"> rewrite</span><span class="id"> eqp_sym=&gt;</span><span class="id"> e</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span><span class="id"> e</span>)<span class="id"> dvdp_addl</span><span class="id"> dvdp_mull</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_biggcd</span><span class="id"> x</span> (<span class="id">ps</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> {poly</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">root</span> (<span class="id">\big[gcdp/0]_</span>(<span class="id">p</span><span class="id"> &lt;-</span><span class="id"> ps</span>)<span class="id"> p</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> all</span> (<span class="gallina-kwd">fun</span><span class="id"> p</span><span class="id"> =&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>)<span class="id"> ps</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> ps</span><span class="id"> =&gt;</span><span class="id"> [|p</span><span class="id"> ps</span><span class="id"> ihp];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_nil</span><span class="id"> root0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_cons</span><span class="id"> /=</span><span class="id"> root_gcd</span><span class="id"> ihp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> gdcop_rec</span><span class="id"> q</span><span class="id"> p</span><span class="id"> k</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> k</span><span class="id"> is</span><span class="id"> m</span>.<span class="id">+1</span><span class="gallina-kwd"> then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="gallina-kwd"> then</span><span class="id"> p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="id"> gdcop_rec</span><span class="id"> q</span> (<span class="id">divp</span><span class="id"> p</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> gdcop</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> gdcop_rec</span><span class="id"> q</span><span class="id"> p</span> (<span class="id">size</span><span class="id"> p</span>).<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> gdcop_spec</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GdcopSpec</span><span class="id"> r</span><span class="id"> of</span> (<span class="id">dvdp</span><span class="id"> r</span><span class="id"> p</span>)<span class="id"> &amp;</span> ((<span class="id">coprimep</span><span class="id"> r</span><span class="id"> q</span>)<span class="id"> ||</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> 0</span>))<br/>
&nbsp;&nbsp;<span class="id">&amp;</span> (<span class="gallina-kwd">forall</span><span class="id"> d,</span><span class="id"> dvdp</span><span class="id"> d</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> d</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> dvdp</span><span class="id"> d</span><span class="id"> r</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> gdcop_spec</span><span class="id"> q</span><span class="id"> p</span><span class="id"> r</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gdcop0</span><span class="id"> q</span><span class="id"> :</span><span class="id"> gdcop</span><span class="id"> q</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /gdcop</span><span class="id"> size_poly0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gdcop_recP</span><span class="id"> q</span><span class="id"> p</span><span class="id"> k</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> gdcop_spec</span><span class="id"> q</span><span class="id"> p</span> (<span class="id">gdcop_rec</span><span class="id"> q</span><span class="id"> p</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> k</span><span class="id"> p</span><span class="id"> =&gt;</span><span class="id"> [p</span><span class="id"> |</span><span class="id"> k</span><span class="id"> ihk</span><span class="id"> p]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">move/size_poly_leq0P-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|q0]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> ?coprime1p</span><span class="id"> //</span><span class="id"> ?eqxx</span><span class="id"> ?orbT</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> d</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> coprimep0</span><span class="id"> dvdp1</span><span class="id"> size_poly_eq1</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> hs;</span><span class="id"> case</span><span class="id"> cop</span><span class="id"> :</span> (<span class="id">coprimep</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> ?dvdpp</span><span class="id"> ?cop</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> p0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> div0p;</span><span class="id"> apply:</span><span class="id"> ihk;</span><span class="id"> rewrite</span><span class="id"> size_poly0</span><span class="id"> leq0n</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> q0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> gcdp0</span><span class="id"> divpp</span><span class="id"> ?p0</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> {hs</span><span class="id"> ihk};</span><span class="id"> case:</span><span class="id"> k=&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> eqxx;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> ?dvd1p</span><span class="id"> ?coprimep0</span><span class="id"> ?eqpxx</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> d</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> coprimep0</span><span class="id"> dvdp1</span><span class="id"> size_poly_eq1</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> coprimep0</span><span class="id"> polyC_eqp1</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id">split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">@eqp_dvdl</span><span class="id"> 1</span>)<span class="id"> ?dvd1p</span><span class="id"> //</span><span class="id"> polyC_eqp1</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> coprimep0</span><span class="id"> polyC_eqp1</span><span class="id"> //</span><span class="id"> ?lc_expn_scalp_neq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> d</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> coprimep0;</span><span class="id"> move/eqp_dvdl-&gt;;</span><span class="id"> rewrite</span><span class="id"> dvd1p</span>.<br/>
<span class="id">move:</span> (<span class="id">dvdp_gcdl</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> move/eqP=&gt;</span><span class="id"> e</span>.<br/>
<span class="id">have</span><span class="id"> sgp</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> dvdp_leq;</span><span class="id"> rewrite</span><span class="id"> ?gcdp_eq0</span><span class="id"> ?p0</span><span class="id"> ?q0</span><span class="id"> //</span><span class="id"> dvdp_gcdl</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0;</span><span class="id"> last</span><span class="id"> move/negPf=&gt;p'n0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> dvdpN0</span> (<span class="id">dvdp_mulIl</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>) (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -e</span><span class="id"> scale_poly_eq0</span><span class="id"> negb_or</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
<span class="id">have</span><span class="id"> gn0</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> dvdpN0</span> (<span class="id">dvdp_mulIr</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>) (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -e</span><span class="id"> scale_poly_eq0</span><span class="id"> negb_or</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
<span class="id">have</span><span class="id"> sp'</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %/</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> &lt;=</span><span class="id"> k</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_divp</span><span class="id"> ?sgp</span><span class="id"> //</span><span class="id"> leq_subLR</span> (<span class="id">leq_trans</span><span class="id"> hs</span>)<span class="id"> //</span><span class="id"> -add1n</span><span class="id"> leq_add2r</span><span class="id"> -subn1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltn_subRL</span><span class="id"> add1n</span><span class="id"> ltn_neqAle</span><span class="id"> eq_sym</span><span class="id"> [_</span><span class="id"> ==</span><span class="id"> _]cop</span><span class="id"> size_poly_gt0</span><span class="id"> gn0</span>.<br/>
<span class="id">case</span> (<span class="id">ihk</span><span class="id"> _</span><span class="id"> sp'</span>)<span class="id">=&gt;</span><span class="id"> r'</span><span class="id"> dr'p';</span><span class="id"> first</span><span class="id"> rewrite</span><span class="id"> p'n0</span><span class="id"> orbF=&gt;</span><span class="id"> cr'q</span><span class="id"> maxr'</span>.<br/>
<span class="id">constructor=&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">negPf</span><span class="id"> p0</span>)<span class="id"> ?orbF</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/</span>(<span class="id">dvdp_trans</span><span class="id"> dr'p'</span>)<span class="id">/divp_dvd/dvdp_gcdl</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> d</span><span class="id"> dp</span><span class="id"> cdq;</span><span class="id"> apply:</span><span class="id"> maxr';</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cdq</span>.<br/>
<span class="id">case</span><span class="id"> dpq:</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">dpq</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd</span><span class="id"> dp</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> dq;</span><span class="id"> apply:</span><span class="id"> dvdUp</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contraLR</span><span class="id"> cdq</span><span class="id"> =&gt;</span><span class="id"> nd1;</span><span class="id"> apply/coprimepPn;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> d;</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd</span><span class="id"> dvdpp</span><span class="id"> dq</span><span class="id"> nd1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> p0</span><span class="id"> =&gt;</span><span class="id"> d0;</span><span class="id"> move:</span><span class="id"> dp;</span><span class="id"> rewrite</span><span class="id"> d0</span><span class="id"> dvd0p</span>.<br/>
<span class="id">apply:</span><span class="id"> contraLR</span><span class="id"> dp</span><span class="id"> =&gt;</span><span class="id"> ndp'</span>.<br/>
<span class="id">rewrite</span> (<span class="id">@eqp_dvdr</span> ((<span class="id">lead_coef</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> ^+</span><span class="id"> scalp</span><span class="id"> p</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>))<span class="id">*:p</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> Gauss_dvdpl</span><span class="id"> //;</span><span class="id"> apply:</span> (<span class="id">coprimep_dvdl</span> (<span class="id">dvdp_gcdr</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> eqp_scale</span><span class="id"> //</span><span class="id"> lc_expn_scalp_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gdcopP</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> gdcop_spec</span><span class="id"> q</span><span class="id"> p</span> (<span class="id">gdcop</span><span class="id"> q</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /gdcop;</span><span class="id"> apply:</span><span class="id"> gdcop_recP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_gdco</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%B</span><span class="id"> -&gt;</span><span class="id"> coprimep</span> (<span class="id">gdcop</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> q_neq0;</span><span class="id"> case:</span><span class="id"> gdcopP=&gt;</span><span class="id"> d;</span><span class="id"> rewrite</span> (<span class="id">negPf</span><span class="id"> q_neq0</span>)<span class="id"> orbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> size2_dvdp_gdco</span><span class="id"> p</span><span class="id"> q</span><span class="id"> d</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 2</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">d</span><span class="id"> %|</span> (<span class="id">gdcop</span><span class="id"> q</span><span class="id"> p</span>))<span class="id"> =</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> &amp;&amp;</span><span class="id"> ~~</span>(<span class="id">d</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_poly0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> p0</span><span class="id"> sd;</span><span class="id"> apply/idP/idP</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> gdcopP=&gt;</span><span class="id"> r</span><span class="id"> rp</span><span class="id"> crq</span><span class="id"> maxr</span><span class="id"> dr;</span><span class="id"> move/negPf:</span> (<span class="id">p0</span>)<span class="id">=&gt;</span><span class="id"> p0f</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">dvdp_trans</span><span class="id"> dr</span>)<span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contraL</span><span class="id"> crq</span><span class="id"> =&gt;</span><span class="id"> dq;</span><span class="id"> rewrite</span><span class="id"> p0f</span><span class="id"> orbF;</span><span class="id"> apply/coprimepPn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> p0</span><span class="id"> =&gt;</span><span class="id"> r0;</span><span class="id"> move:</span><span class="id"> rp;</span><span class="id"> rewrite</span><span class="id"> r0</span><span class="id"> dvd0p</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> d;</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd</span><span class="id"> dr</span><span class="id"> dq</span><span class="id"> -size_poly_eq1</span><span class="id"> sd</span>.<br/>
<span class="id">case/andP=&gt;</span><span class="id"> dp</span><span class="id"> dq;</span><span class="id"> case:</span><span class="id"> gdcopP=&gt;</span><span class="id"> r</span><span class="id"> rp</span><span class="id"> crq</span><span class="id"> maxr;</span><span class="id"> apply:</span><span class="id"> maxr=&gt;</span><span class="id"> //</span>.<br/>
<span class="id">apply/coprimepP=&gt;</span><span class="id"> x</span><span class="id"> xd</span><span class="id"> xq</span>.<br/>
<span class="id">move:</span> (<span class="id">dvdp_leq</span><span class="id"> dn0</span><span class="id"> xd</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> sd;</span><span class="id"> case/orP;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ltnS</span><span class="id"> leq_eqVlt</span><span class="id"> ltnS</span><span class="id"> size_poly_leq0</span><span class="id"> orbC</span>.<br/>
&nbsp;&nbsp;<span class="id">case/predU1P</span><span class="id"> =&gt;</span><span class="id"> [x0|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> xd;</span><span class="id"> rewrite</span><span class="id"> x0</span><span class="id"> dvd0p</span> (<span class="id">negPf</span><span class="id"> dn0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -sd</span><span class="id"> dvdp_size_eqp</span><span class="id"> //;</span><span class="id"> move/</span>(<span class="id">eqp_dvdl</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> xq</span> (<span class="id">negPf</span><span class="id"> dq</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gdco</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">gdcop</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> %|</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> gdcopP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_gdco</span><span class="id"> p</span><span class="id"> q</span><span class="id"> x</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> root</span> (<span class="id">gdcop</span><span class="id"> q</span><span class="id"> p</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> &amp;&amp;</span><span class="id"> ~~</span>(<span class="id">root</span><span class="id"> q</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p0</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !root_factor_theorem</span>.<br/>
<span class="id">apply:</span><span class="id"> size2_dvdp_gdco;</span><span class="id"> rewrite</span><span class="id"> ?p0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_polyDl</span><span class="id"> size_polyX</span><span class="id"> //</span><span class="id"> size_polyN</span><span class="id"> size_polyC</span><span class="id"> ltnS;</span><span class="id"> case:</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_comp_poly</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> q</span>)<span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> \Po</span><span class="id"> r</span>)<span class="id"> %|</span> (<span class="id">q</span><span class="id"> \Po</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> comp_poly0</span><span class="id"> !dvd0p;</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> comp_poly0</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> set</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^+</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> %/</span><span class="id"> _;</span><span class="id"> move/eqP=&gt;</span><span class="id"> Hq</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_dvdp</span><span class="id"> c</span> (<span class="id">s</span><span class="id"> \Po</span><span class="id"> r</span>))<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -comp_polyZ</span><span class="id"> Hq</span><span class="id"> comp_polyM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_comp_poly</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> \Po</span><span class="id"> r</span><span class="id"> %=</span><span class="id"> gcdp</span> (<span class="id">p</span><span class="id"> \Po</span><span class="id"> r</span>) (<span class="id">q</span><span class="id"> \Po</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_gcd</span><span class="id"> !dvdp_comp_poly</span><span class="id"> ?dvdp_gcdl</span><span class="id"> ?dvdp_gcdr</span>.<br/>
<span class="id">case:</span> (<span class="id">Bezoutp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [[u</span><span class="id"> v]]</span><span class="id"> /andP</span><span class="id"> []</span>.<br/>
<span class="id">move/</span>(<span class="id">dvdp_comp_poly</span><span class="id"> r</span>)<span class="id"> =&gt;</span><span class="id"> Huv</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span> (<span class="id">dvdp_trans</span><span class="id"> _</span><span class="id"> Huv</span>)<span class="id"> //</span><span class="id"> comp_polyD</span><span class="id"> !comp_polyM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_add</span><span class="id"> //</span><span class="id"> dvdp_mull</span><span class="id"> //</span> (<span class="id">dvdp_gcdl,dvdp_gcdr</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_comp_poly</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> coprimep</span> (<span class="id">p</span><span class="id"> \Po</span><span class="id"> r</span>) (<span class="id">q</span><span class="id"> \Po</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -!gcdp_eqp1</span><span class="id"> -!size_poly_eq1</span><span class="id"> -!dvdp1;</span><span class="id"> move/</span>(<span class="id">dvdp_comp_poly</span><span class="id"> r</span>).<br/>
<span class="id">rewrite</span><span class="id"> comp_polyC</span><span class="id"> =&gt;</span><span class="id"> Hgcd</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> dvdp_trans</span><span class="id"> Hgcd;</span><span class="id"> case/andP:</span> (<span class="id">gcdp_comp_poly</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_addl_mul</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> r</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> =</span><span class="id"> coprimep</span><span class="id"> r</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !coprimep_def</span> (<span class="id">eqp_size</span> (<span class="id">gcdp_addl_mul</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> irreducible_poly</span><span class="id"> p</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">size</span><span class="id"> p</span><span class="id"> &gt;</span><span class="id"> 1</span>)<span class="id"> *</span> (<span class="gallina-kwd">forall</span><span class="id"> q,</span><span class="id"> size</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> p</span>)<span class="id"> :</span><span class="gallina-kwd"> Prop</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> irredp_neq0</span><span class="id"> p</span><span class="id"> :</span><span class="id"> irreducible_poly</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0</span><span class="id"> =&gt;</span><span class="id"> [[/ltnW]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> apply_irredp</span><span class="id"> p</span> (<span class="id">irr_p</span><span class="id"> :</span><span class="id"> irreducible_poly</span><span class="id"> p</span>)<span class="id"> :=</span><span class="id"> irr_p</span>.<span class="id">2</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> apply_irredp</span><span class="id"> :</span><span class="id"> irreducible_poly</span><span class="id"> &gt;-&gt;</span><span class="id"> Funclass</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_XsubC</span><span class="id"> p</span><span class="id"> c</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %%</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> =</span><span class="id"> p</span>.<span class="id">[c]%:P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have/factor_theorem</span><span class="id"> [q</span><span class="id"> /</span>(<span class="id">canRL</span> (<span class="id">subrK</span><span class="id"> _</span>))<span class="id"> Dp]:</span><span class="id"> root</span> (<span class="id">p</span><span class="id"> -</span><span class="id"> p</span>.<span class="id">[c]%:P</span>)<span class="id"> c</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /root</span><span class="id"> !hornerE</span><span class="id"> subrr</span>.<br/>
<span class="id">rewrite</span><span class="id"> modpE</span><span class="id"> /=</span><span class="id"> lead_coefXsubC</span><span class="id"> unitr1</span><span class="id"> expr1n</span><span class="id"> invr1</span><span class="id"> scale1r</span><span class="id"> [in</span><span class="id"> LHS]Dp</span>.<br/>
<span class="id">rewrite</span><span class="id"> RingMonic</span>.<span class="id">rmodp_addl_mul_small</span><span class="id"> //</span><span class="id"> ?monicXsubC//</span><span class="id"> size_XsubC</span><span class="id"> size_polyC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">p</span>.<span class="id">[c]</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_XsubC</span><span class="id"> p</span><span class="id"> c</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> =</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> p</span><span class="id"> c</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -coprimep_modl</span><span class="id"> modp_XsubC</span><span class="id"> /root</span><span class="id"> -alg_polyC</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> /coprimepZl-&gt;]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> coprime1p</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scale0r</span><span class="id"> /coprimep</span><span class="id"> gcd0p</span><span class="id"> size_XsubC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_XsubC2</span> (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> b</span><span class="id"> -</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">coprimep</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> a%:P</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> b%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> bBa_neq0;</span><span class="id"> rewrite</span><span class="id"> coprimep_XsubC</span><span class="id"> rootE</span><span class="id"> hornerXsubC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepX</span><span class="id"> p</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> 'X</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -['X]subr0</span><span class="id"> coprimep_XsubC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_monic</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> monic</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> p</span><span class="id"> q,</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> q</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p</span><span class="id"> q</span><span class="id"> monic_p</span><span class="id"> monic_q;</span><span class="id"> apply/idP/eqP=&gt;</span><span class="id"> [|-&gt;</span><span class="id"> //]</span>.<br/>
<span class="id">case/eqpP=&gt;</span><span class="id"> [[a</span><span class="id"> b]</span><span class="id"> /=</span><span class="id"> /andP[a_neq0</span><span class="id"> _]</span><span class="id"> eq_pq]</span>.<br/>
<span class="id">apply:</span> (<span class="id">@mulfI</span><span class="id"> _</span><span class="id"> a%:P</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> polyC_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !mul_polyC</span><span class="id"> eq_pq;</span><span class="id"> congr</span> (_<span class="id"> *:</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> apply:</span> (<span class="id">mulIf</span> (<span class="id">oner_neq0</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">monicP</span><span class="id"> monic_q</span>)<span class="id"> -</span>(<span class="id">monicP</span><span class="id"> monic_p</span>)<span class="id"> -!lead_coefZ</span><span class="id"> eq_pq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_mul_XsubC</span><span class="id"> p</span><span class="id"> q</span><span class="id"> c</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">p</span><span class="id"> %|</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> *</span><span class="id"> q</span>)<span class="id"> =</span> ((<span class="gallina-kwd">if</span><span class="id"> root</span><span class="id"> p</span><span class="id"> c</span><span class="gallina-kwd"> then</span><span class="id"> p</span><span class="id"> %/</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="gallina-kwd"> else</span><span class="id"> p</span>)<span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> not_pc0];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> Gauss_dvdpr</span><span class="id"> ?coprimep_XsubC</span>.<br/>
<span class="id">rewrite</span><span class="id"> root_factor_theorem</span><span class="id"> -eqp_div_XsubC</span><span class="id"> mulrC</span><span class="id"> =&gt;</span><span class="id"> /eqP{1}-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_mul2l</span><span class="id"> ?polyXsubC_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_prod_XsubC</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">p</span><span class="id"> %|</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>) (<span class="id">'X</span><span class="id"> -</span> (<span class="id">F</span><span class="id"> i</span>)<span class="id">%:P</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{m</span><span class="id"> |</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> mask</span><span class="id"> m</span><span class="id"> r</span>) (<span class="id">'X</span><span class="id"> -</span> (<span class="id">F</span><span class="id"> i</span>)<span class="id">%:P</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> r</span><span class="id"> IHr]</span><span class="gallina-kwd"> in</span><span class="id"> p</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_nil</span><span class="id"> dvdp1;</span><span class="gallina-kwd"> exists</span><span class="id"> nil;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> big_nil</span><span class="id"> -size_poly_eq1</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_cons</span><span class="id"> dvdp_mul_XsubC</span><span class="id"> root_factor_theorem</span><span class="id"> -eqp_div_XsubC</span>.<br/>
<span class="id">case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [{2}-&gt;</span><span class="id"> |</span><span class="id"> _]</span><span class="id"> /IHr[m</span><span class="id"> Dp];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span> (<span class="id">false</span><span class="id"> ::</span><span class="id"> m</span>).<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">true</span><span class="id"> ::</span><span class="id"> m</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> mulrC</span><span class="id"> big_cons</span><span class="id"> eqp_mul2l</span><span class="id"> ?polyXsubC_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> irredp_XsubC</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> irreducible_poly</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|d</span><span class="id"> size_d</span><span class="id"> d_dv_Xx];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_XsubC</span>.<br/>
<span class="id">have:</span><span class="id"> ~</span><span class="id"> d</span><span class="id"> %=</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> apply/negP;</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1</span>.<br/>
<span class="id">have</span><span class="id"> [|m</span><span class="id"> /=]</span><span class="id"> :=</span><span class="id"> @dvdp_prod_XsubC</span><span class="id"> _</span><span class="id"> [::</span><span class="id"> x]</span><span class="id"> id</span><span class="id"> d;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_seq1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> [|[]</span><span class="id"> [|_</span><span class="id"> _]</span><span class="id"> /=];</span><span class="id"> rewrite</span> (<span class="id">big_nil,</span><span class="id"> big_seq1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> irredp_XaddC</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> irreducible_poly</span> (<span class="id">'X</span><span class="id"> +</span><span class="id"> x%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[x]opprK</span><span class="id"> rmorphN;</span><span class="id"> apply:</span><span class="id"> irredp_XsubC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> irredp_XsubCP</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">irreducible_poly</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> {d</span><span class="id"> %=</span><span class="id"> 1}</span><span class="id"> +</span><span class="id"> {d</span><span class="id"> %=</span><span class="id"> p}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> irred_p</span><span class="id"> dvd_dp;</span><span class="id"> have</span><span class="id"> []</span><span class="id"> :=</span><span class="id"> boolP</span> (_<span class="id"> %=</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> left</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1=&gt;</span><span class="id"> /irred_p</span><span class="id"> /</span>(_<span class="id"> dvd_dp</span>)<span class="id">;</span><span class="id"> right</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_exp_XsubCP</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>) (<span class="id">c</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> k,</span> (<span class="id">k</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &amp;</span><span class="id"> p</span><span class="id"> %=</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> ^+</span><span class="id"> k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span><span class="id"> %|</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[k</span><span class="id"> lkn</span><span class="id"> /eqp_dvdl-&gt;]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_exp2l</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /Pdiv</span>.<span class="id">WeakIdomain</span>.<span class="id">dvdpP[[/=</span><span class="id"> a</span><span class="id"> q]</span><span class="id"> a_neq0]</span>.<br/>
<span class="id">have</span><span class="id"> [m</span><span class="id"> [r]]</span><span class="id"> :=</span><span class="id"> multiplicity_XsubC</span><span class="id"> p</span><span class="id"> c;</span><span class="id"> have</span><span class="id"> [-&gt;|pN0]/=</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulr0</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /eqP;</span> <span class="id"> rewrite</span><span class="id"> scale_poly_eq0</span> (<span class="id">negPf</span><span class="id"> a_neq0</span>)<span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expf_eq0/=</span><span class="id"> andbC</span><span class="id"> polyXsubC_eq0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> rNc</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> =&gt;</span><span class="id"> eq_qrm;</span><span class="gallina-kwd"> exists</span><span class="id"> m</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> ^+</span><span class="id"> m</span><span class="id"> %|</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eq_qrm</span><span class="id"> dvdp_mull</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span> (<span class="id">eqp_scale</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> dvdp_Pexp2l//</span><span class="id"> size_XsubC</span>.<br/>
<span class="id">suff</span><span class="id"> /eqP</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 1%N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_poly_eq1</span><span class="id"> =&gt;</span><span class="id"> /eqp_mulr/eqp_trans-&gt;//;</span><span class="id"> rewrite</span><span class="id"> mul1r</span><span class="id"> eqpxx</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> r</span><span class="id"> %|</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> c%:P</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eq_qrm</span><span class="id"> mulrAC</span><span class="id"> dvdp_mull</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eqp_dvdr</span><span class="id"> _</span> (<span class="id">eqp_scale</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span>.<br/>
<span class="id">move:</span><span class="id"> rNc;</span><span class="id"> rewrite</span><span class="id"> -coprimep_XsubC</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">coprimep_expr</span><span class="id"> n</span>)<span class="id"> /coprimepP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(_<span class="id"> _</span> (<span class="id">dvdpp</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -size_poly_eq1</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> _</span>)<span class="id">/eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> IDomainPseudoDivision</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> gcdp</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> eqpxx</span><span class="id"> divp0</span><span class="id"> divp1</span><span class="id"> mod0p</span><span class="id"> modp0</span><span class="id"> modp1</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> dvdp_mull</span><span class="id"> dvdp_mulr</span><span class="id"> dvdpp</span><span class="id"> dvdp0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> dvdp_exp_XsubCP</span><span class="id"> {R</span><span class="id"> p</span><span class="id"> c</span><span class="id"> n}</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> CommonIdomain</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Idomain</span>.<br/>
<br/>
<span class="vernacular">Include</span><span class="id"> IdomainDefs</span>.<br/>
<span class="vernacular">Export</span><span class="id"> IdomainDefs</span>.<br/>
<span class="vernacular">Include</span><span class="id"> WeakIdomain</span>.<br/>
<span class="vernacular">Include</span><span class="id"> CommonIdomain</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Idomain</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> IdomainMonic</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span><span class="id"> ComRing</span><span class="id"> UnitRing</span><span class="id"> IdomainDefs</span><span class="id"> Idomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> IdomainMonic</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> d</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MonicDivisor</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> monq</span><span class="id"> :</span><span class="id"> q</span><span class="id"> \is</span><span class="id"> monic</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpE</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> rdivp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divpE</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> unitr1</span><span class="id"> expr1n</span><span class="id"> invr1</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpE</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> rmodp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modpE</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> unitr1</span><span class="id"> expr1n</span><span class="id"> invr1</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalpE</span><span class="id"> p</span><span class="id"> :</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalpE</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> unitr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_eq</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> q</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -divp_eq</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> expr1n</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpp</span><span class="id"> p</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divpp</span><span class="id"> ?monic_neq0</span><span class="id"> //</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> expr1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_eq</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> expr1n</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpP</span><span class="id"> p</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> qq,</span><span class="id"> p</span><span class="id"> =</span><span class="id"> qq</span><span class="id"> *</span><span class="id"> q</span>) (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> move/eqP=&gt;</span><span class="id"> e;</span><span class="gallina-kwd"> exists</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> qq</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> dvdp_mull</span><span class="id"> //</span><span class="id"> dvdpp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulpK</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulpK</span><span class="id"> ?monic_neq0</span><span class="id"> //</span> (<span class="id">eqP</span><span class="id"> monq</span>)<span class="id"> expr1n</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKp</span><span class="id"> p</span><span class="id"> :</span><span class="id"> q</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MonicDivisor</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> drop_poly_divp</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> drop_poly</span><span class="id"> n</span><span class="id"> p</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> 'X^n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> RingMonic</span>.<span class="id">drop_poly_rdivp</span><span class="id"> divpE</span><span class="id"> //</span><span class="id"> monicXn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> take_poly_modp</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> take_poly</span><span class="id"> n</span><span class="id"> p</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> 'X^n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> RingMonic</span>.<span class="id">take_poly_rmodp</span><span class="id"> modpE</span><span class="id"> //</span><span class="id"> monicXn</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> IdomainMonic</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> IdomainMonic</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> IdomainUnit</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span><span class="id"> ComRing</span><span class="id"> UnitRing</span><span class="id"> IdomainDefs</span><span class="id"> Idomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitDivisor</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> ulcd</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_eq</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> divp_eq</span><span class="id"> p</span><span class="id"> d;</span><span class="id"> rewrite</span><span class="id"> scalpE</span><span class="id"> ulcd</span><span class="id"> expr0</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">q</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> /\</span><span class="id"> r</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ep</span><span class="id"> srd;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> divp_eq</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> [LHS]ep</span>.<br/>
<span class="id">move/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq</span><span class="id"> -addrA</span><span class="id"> addrC</span><span class="id"> eq_sym</span><span class="id"> -subr_eq</span><span class="id"> -mulrBl;</span><span class="id"> move/eqP</span>.<br/>
<span class="id">have</span><span class="id"> lcdn0</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> /esym</span><span class="id"> /eqP|abs]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> q</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subrr</span><span class="id"> mul0r</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP&lt;-</span>.<br/>
<span class="id">have</span><span class="id"> hleq</span><span class="id"> :</span><span class="id"> size</span><span class="id"> d</span><span class="id"> &lt;=</span><span class="id"> size</span> ((<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> -</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_proper_mul;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span> (<span class="id">negPf</span><span class="id"> lcdn0</span>)<span class="id"> orbF</span><span class="id"> lead_coef_eq0</span><span class="id"> subr_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> abs;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0;</span><span class="id"> move/polySpred-&gt;;</span><span class="id"> rewrite</span><span class="id"> addSn</span><span class="id"> /=</span><span class="id"> leq_addl</span>.<br/>
<span class="id">have</span><span class="id"> hlt</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">r</span><span class="id"> -</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> leq_ltn_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtn_max</span><span class="id"> srd</span><span class="id"> size_polyN</span><span class="id"> ltn_modp</span><span class="id"> -lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> have:=</span><span class="id"> leq_trans</span><span class="id"> hlt</span><span class="id"> hleq;</span><span class="id"> rewrite</span><span class="id"> e</span><span class="id"> ltnn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/edivpP=&gt;</span><span class="id"> h;</span><span class="id"> case/h</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> r</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/edivpP=&gt;</span><span class="id"> h;</span><span class="id"> case/h</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ulc_eqpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> c</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> &amp;</span><span class="id"> p</span><span class="id"> =</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> q</span>) (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> lead_coef_eq0</span><span class="id"> =&gt;</span><span class="id"> nz_q</span><span class="id"> ulcq;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|nz_p]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> eqp0</span> (<span class="id">negPf</span><span class="id"> nz_q</span>).<br/>
&nbsp;&nbsp;<span class="id">move/eqp_eq=&gt;</span><span class="id"> eq;</span><span class="gallina-kwd"> exists</span> (<span class="id">lead_coef</span><span class="id"> p</span><span class="id"> /</span><span class="id"> lead_coef</span><span class="id"> q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> ?invr_eq0</span><span class="id"> lead_coef_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/</span>(<span class="id">scaler_injl</span><span class="id"> ulcq</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> scalerA</span><span class="id"> mulrCA</span><span class="id"> divrr</span><span class="id"> //</span><span class="id"> mulr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> c</span><span class="id"> nz_c</span><span class="id"> -&gt;;</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?scale1r</span><span class="id"> ?oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP/eqP=&gt;</span><span class="id"> [modp0</span><span class="id"> |</span><span class="id"> -&gt;];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> modp_mull</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [p</span><span class="gallina-kwd"> in</span><span class="id"> LHS]divp_eq</span><span class="id"> modp0</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ucl_eqp_eq</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> p</span><span class="id"> /</span><span class="id"> lead_coef</span><span class="id"> q</span>)<span class="id"> *:</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ulcq</span><span class="id"> /eqp_eq;</span><span class="id"> move/</span>(<span class="id">congr1</span> (<span class="id"> *:%R</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">^-1</span> )).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !scalerA</span><span class="id"> mulrC</span><span class="id"> divrr</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpZl</span><span class="id"> c</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> cn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> c</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !scale0r</span><span class="id"> mod0p</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerDr</span><span class="id"> -divp_eq</span>.<br/>
<span class="id">suff</span><span class="id"> s:</span><span class="id"> size</span> (<span class="id">c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>))<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">edivpP</span><span class="id"> e</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> -mul_polyC;</span><span class="id"> apply:</span><span class="id"> leq_ltn_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_polyC</span><span class="id"> cn0</span><span class="id"> addSn</span><span class="id"> add0n</span><span class="id"> /=</span><span class="id"> ltn_modp</span><span class="id"> -lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpZl</span><span class="id"> c</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> cn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> c</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !scale0r</span><span class="id"> div0p</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerDr</span><span class="id"> -divp_eq</span>.<br/>
<span class="id">suff</span><span class="id"> s:</span><span class="id"> size</span> (<span class="id">c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>))<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">edivpP</span><span class="id"> e</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> -mul_polyC;</span><span class="id"> apply:</span><span class="id"> leq_ltn_trans</span> (<span class="id">size_polyMleq</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_polyC</span><span class="id"> cn0</span><span class="id"> addSn</span><span class="id"> add0n</span><span class="id"> /=</span><span class="id"> ltn_modp</span><span class="id"> -lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_modpl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> %=</span> (<span class="id">q</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> /=</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">c1,</span><span class="id"> c2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?c1n0</span><span class="id"> //=</span><span class="id"> -!modpZl</span><span class="id"> e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_divl</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> %=</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> /=</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">c1,</span><span class="id"> c2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?c1n0</span><span class="id"> //</span><span class="id"> -!divpZl</span><span class="id"> e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpN</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulN1r</span><span class="id"> -[RHS]mulN1r</span><span class="id"> -polyCN</span><span class="id"> !mul_polyC</span><span class="id"> modpZl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpN</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulN1r</span><span class="id"> -[RHS]mulN1r</span><span class="id"> -polyCN</span><span class="id"> !mul_polyC</span><span class="id"> divpZl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpD</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %%</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have/edivpP</span><span class="id"> []</span><span class="id"> //</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> addrACA</span><span class="id"> -!divp_eq</span>.<br/>
<span class="id">apply:</span><span class="id"> leq_ltn_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> gtn_max</span><span class="id"> !ltn_modp</span><span class="id"> andbb</span><span class="id"> -lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpD</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have/edivpP</span><span class="id"> []</span><span class="id"> //</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> *</span><span class="id"> d</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> addrACA</span><span class="id"> -!divp_eq</span>.<br/>
<span class="id">apply:</span><span class="id"> leq_ltn_trans</span> (<span class="id">size_polyD</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> gtn_max</span><span class="id"> !ltn_modp</span><span class="id"> andbb</span><span class="id"> -lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulpK</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/esym/edivpP:</span> (<span class="id">addr0</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKp</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC;</span><span class="id"> apply:</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_addl_mul_small</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> srd;</span><span class="id"> rewrite</span><span class="id"> divpD</span> (<span class="id">divp_small</span><span class="id"> srd</span>)<span class="id"> addr0</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_addl_mul_small</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> srd;</span><span class="id"> rewrite</span><span class="id"> modpD</span><span class="id"> modp_mull</span><span class="id"> add0r</span><span class="id"> modp_small</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_addl_mul</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> q</span><span class="id"> +</span><span class="id"> r</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divpD</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpp</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[d</span><span class="gallina-kwd"> in</span><span class="id"> d</span><span class="id"> %/</span><span class="id"> _]mul1r</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_divMp</span><span class="id"> m</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|dn0</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lead_coef0</span><span class="id"> unitr0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|q0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> size_poly0</span><span class="id"> leq0n</span>.<br/>
<span class="id">rewrite</span><span class="id"> {2}</span>(<span class="id">divp_eq</span><span class="id"> m</span>)<span class="id"> size_polyDl</span><span class="id"> //</span><span class="id"> size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> q0</span>)<span class="id"> addSn</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltn_addl</span><span class="id"> //</span><span class="id"> ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpP</span><span class="id"> p</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> q,</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span>) (<span class="id">d</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> [k</span><span class="id"> -&gt;]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> modp_mull</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> move/eqP-&gt;;</span><span class="gallina-kwd"> exists</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpK</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_eq;</span><span class="id"> move/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpKC</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> divpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq_div</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> ==</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/divpK=&gt;</span><span class="id"> {2}&lt;-;</span><span class="id"> apply/eqP/eqP;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move-&gt;</span>.<br/>
<span class="id">apply/mulIf;</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq_mul</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> ==</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dv_d_p;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> -dvdp_eq_div</span><span class="id"> //</span><span class="id"> eq_sym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_mulA</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hdm;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> -dvdp_eq_mul</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrA</span><span class="id"> divpK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/divpK:</span><span class="id"> hdm&lt;-;</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> dvdp_mull</span><span class="id"> //</span><span class="id"> dvdpp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_mulAC</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> n</span><span class="id"> =</span><span class="id"> m</span><span class="id"> *</span><span class="id"> n</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hdm;</span><span class="id"> rewrite</span><span class="id"> mulrC</span> (<span class="id">mulrC</span><span class="id"> m</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> divp_mulA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_mulCA</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> q</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hdp</span><span class="id"> hdq;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> divp_mulAC</span><span class="id"> //</span><span class="id"> divp_mulA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_mul</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> *</span> (<span class="id">q</span><span class="id"> %%</span><span class="id"> d</span>))<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [q</span><span class="gallina-kwd"> in</span><span class="id"> RHS]divp_eq</span><span class="id"> mulrDr</span><span class="id"> modpD</span><span class="id"> mulrA</span><span class="id"> modp_mull</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> UnitDivisor</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Renamed to leq_divMp.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> leq_trunc_divp</span><span class="id"> :=</span><span class="id"> leq_divMp</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MoreUnitDivisor</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> ulcd</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> d</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expp_sub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>))<span class="id">%N</span><span class="id"> =</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/subnK=&gt;</span><span class="id"> {2}&lt;-;</span><span class="id"> rewrite</span><span class="id"> exprD</span><span class="id"> mulpK</span><span class="id"> //</span><span class="id"> lead_coef_exp</span><span class="id"> unitrX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_pmul2l</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> q</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %/</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> =</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> uq;</span><span class="id"> rewrite</span><span class="id"> {1}</span>(<span class="id">divp_eq</span><span class="id"> uq</span><span class="id"> p</span>)<span class="id"> mulrDr</span><span class="id"> mulrCA</span><span class="id"> divp_addl_mul</span><span class="id"> //;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lead_coefM</span><span class="id"> unitrM_comm</span><span class="id"> ?ulcd</span><span class="id"> //;</span><span class="id"> red;</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
<span class="id">have</span><span class="id"> dn0</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcd</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">have</span><span class="id"> qn0</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> uq</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">have</span><span class="id"> dqn0</span><span class="id"> :</span><span class="id"> d</span><span class="id"> *</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span><span class="id"> negb_or</span><span class="id"> dn0</span>.<br/>
<span class="id">suff</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">d</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>))<span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> q</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltnNge</span><span class="id"> -divpN0</span><span class="id"> //</span><span class="id"> negbK</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> addr0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> rn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> size_poly0</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> dn0</span>)<span class="id"> !addSn</span><span class="id"> /=</span><span class="id"> ltn_add2l</span><span class="id"> ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_pmul2r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> %/</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> uq;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">mulrC</span><span class="id"> d</span>)<span class="id"> divp_pmul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_divl</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lead_coef</span><span class="id"> r</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> lead_coef</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">q</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> r</span><span class="id"> =</span><span class="id"> q</span><span class="id"> %/</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ulcr</span><span class="id"> ulcp</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> r</span>)<span class="id"> *</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span>)<span class="id"> +</span> ((<span class="id">q</span><span class="id"> %/</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> r</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %%</span><span class="id"> p</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addrA</span> (<span class="id">mulrC</span><span class="id"> p</span>)<span class="id"> mulrA</span><span class="id"> -mulrDl;</span><span class="id"> rewrite</span><span class="id"> -divp_eq</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> divp_eq</span>.<br/>
<span class="id">have</span><span class="id"> pn0</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcp</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">have</span><span class="id"> rn0</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> ulcr</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
<span class="id">have</span><span class="id"> s</span><span class="id"> :</span><span class="id"> size</span> ((<span class="id">q</span><span class="id"> %/</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> r</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %%</span><span class="id"> p</span>)<span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span> ((<span class="id">q</span><span class="id"> %/</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> r</span>)<span class="id"> 0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul0r</span><span class="id"> add0r</span><span class="id"> size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> rn0</span>)<span class="id"> addnS</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leq_trans</span> (<span class="id">leq_addr</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_polyDl</span><span class="id"> mulrC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> pn0</span>)<span class="id"> !addSn</span><span class="id"> /=</span><span class="id"> ltn_add2l</span><span class="id"> ltn_modp</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_mul</span><span class="id"> //</span> (<span class="id">polySpred</span><span class="id"> qn0</span>)<span class="id"> addnS</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leq_trans</span> (<span class="id">leq_addr</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>.<br/>
<span class="id">case:</span> (<span class="id">edivpP</span><span class="id"> _</span><span class="id"> e</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> lead_coefM</span><span class="id"> unitrM_comm</span><span class="id"> ?ulcp</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> red;</span><span class="id"> rewrite</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpAC</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> lead_coef</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ulcp;</span><span class="id"> rewrite</span><span class="id"> !divp_divl</span><span class="id"> //</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpZr</span><span class="id"> c</span><span class="id"> p</span><span class="id"> :</span><span class="id"> c</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %%</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0</span><span class="id"> cn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler0</span><span class="id"> !modp0</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">c^-1</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> *</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerCA</span><span class="id"> scalerA</span><span class="id"> mulVr</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> -</span>(<span class="id">divp_eq</span><span class="id"> ulcd</span>).<br/>
<span class="id">suff</span><span class="id"> s</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">modpP</span><span class="id"> _</span><span class="id"> e</span><span class="id"> s</span>)<span class="id"> //</span><span class="id"> -mul_polyC</span><span class="id"> lead_coefM</span><span class="id"> lead_coefC</span><span class="id"> unitrM</span><span class="id"> cn0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?ltn_modp</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> cn0</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpZr</span><span class="id"> c</span><span class="id"> p</span><span class="id"> :</span><span class="id"> c</span><span class="id"> \in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> c^-1</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0</span><span class="id"> cn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler0</span><span class="id"> !divp0</span><span class="id"> scaler0</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">c^-1</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> *</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerCA</span><span class="id"> scalerA</span><span class="id"> mulVr</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> -</span>(<span class="id">divp_eq</span><span class="id"> ulcd</span>).<br/>
<span class="id">suff</span><span class="id"> s</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">divpP</span><span class="id"> _</span><span class="id"> e</span><span class="id"> s</span>)<span class="id"> //</span><span class="id"> -mul_polyC</span><span class="id"> lead_coefM</span><span class="id"> lead_coefC</span><span class="id"> unitrM</span><span class="id"> cn0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?ltn_modp</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> cn0</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MoreUnitDivisor</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> IdomainUnit</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Field</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Ring</span><span class="id"> ComRing</span><span class="id"> UnitRing</span>.<br/>
<span class="vernacular">Include</span><span class="id"> IdomainDefs</span>.<br/>
<span class="vernacular">Export</span><span class="id"> IdomainDefs</span>.<br/>
<span class="vernacular">Include</span><span class="id"> CommonIdomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldDivision</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> d</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_eq</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id"> *</span><span class="id"> q</span><span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> modp0</span><span class="id"> mulr0</span><span class="id"> add0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divp_eq;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_modpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> d</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">q</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> /\</span><span class="id"> r</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> he</span><span class="id"> hs;</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">edivpP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> hs</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> d</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">q</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/divp_modpP=&gt;</span><span class="id"> h;</span><span class="id"> case/h</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> d</span><span class="id"> r</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> r</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/divp_modpP=&gt;</span><span class="id"> h;</span><span class="id"> case/h</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqpfP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> p</span><span class="id"> /</span><span class="id"> lead_coef</span><span class="id"> q</span>)<span class="id"> *:</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|nz_q]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqp0</span><span class="id"> scaler0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/IdomainUnit</span>.<span class="id">ucl_eqp_eq;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> *</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvd0p</span><span class="id"> mulr0</span><span class="id"> eq_sym</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">dvdp_eq;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqpf_eq</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> c,</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> &amp;</span><span class="id"> p</span><span class="id"> =</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> q</span>) (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">case=&gt;</span><span class="id"> c</span><span class="id"> nz_c</span><span class="id"> -&gt;;</span><span class="id"> apply/eqpP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">1,</span><span class="id"> c</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?scale1r</span><span class="id"> ?oner_eq0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nz_q]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eqp0=&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="gallina-kwd"> exists</span><span class="id"> 1;</span><span class="id"> rewrite</span><span class="id"> ?scale1r</span><span class="id"> ?oner_eq0</span>.<br/>
<span class="id">case/IdomainUnit</span>.<span class="id">ulc_eqpP;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> c</span><span class="id"> nz_c</span><span class="id"> -&gt;;</span><span class="gallina-kwd"> exists</span><span class="id"> c</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpZl</span><span class="id"> c</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !modp0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">modpZl;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulpK</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> qn0;</span><span class="id"> rewrite</span><span class="id"> IdomainUnit</span>.<span class="id">mulpK</span><span class="id"> //</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC;</span><span class="id"> apply:</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpZl</span><span class="id"> c</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> p</span>)<span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> c</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !divp0</span><span class="id"> scaler0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divpZl;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpZr</span><span class="id"> c</span><span class="id"> p</span><span class="id"> d</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %%</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0</span><span class="id"> cn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler0</span><span class="id"> !modp0</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">c^-1</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> *</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerCA</span><span class="id"> scalerA</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> -divp_eq</span>.<br/>
<span class="id">suff</span><span class="id"> s</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">modpP</span><span class="id"> e</span><span class="id"> s</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpZr</span><span class="id"> c</span><span class="id"> p</span><span class="id"> d</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> c^-1</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0</span><span class="id"> cn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler0</span><span class="id"> !divp0</span><span class="id"> scaler0</span>.<br/>
<span class="id">have</span><span class="id"> e</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">c^-1</span><span class="id"> *:</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>))<span class="id"> *</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="id"> +</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalerCA</span><span class="id"> scalerA</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> -divp_eq</span>.<br/>
<span class="id">suff</span><span class="id"> s</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">c</span><span class="id"> *:</span><span class="id"> d</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">divpP</span><span class="id"> e</span><span class="id"> s</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_scale</span><span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_modpl</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> d</span>)<span class="id"> %=</span> (<span class="id">q</span><span class="id"> %%</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> /=</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">c1,</span><span class="id"> c2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?c1n0</span><span class="id"> //</span><span class="id"> -!modpZl</span><span class="id"> e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_divl</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> %=</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> /=</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqpP;</span><span class="gallina-kwd"> exists</span> (<span class="id">c1,</span><span class="id"> c2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?c1n0</span><span class="id"> //</span><span class="id"> -!divpZl</span><span class="id"> e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_modpr</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> q</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %%</span><span class="id"> p</span>)<span class="id"> %=</span> (<span class="id">d</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">c1^-1</span><span class="id"> *</span><span class="id"> c2</span>)<span class="id"> *:</span><span class="id"> q</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -scalerA</span><span class="id"> -e</span><span class="id"> scalerA</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> modpZr</span><span class="id"> ?eqpxx</span><span class="id"> //</span><span class="id"> mulf_eq0</span><span class="id"> negb_or</span><span class="id"> invr_eq0</span><span class="id"> c1n0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_mod</span><span class="id"> p1</span><span class="id"> p2</span><span class="id"> q1</span><span class="id"> q2</span><span class="id"> :</span><span class="id"> p1</span><span class="id"> %=</span><span class="id"> p2</span><span class="id"> -&gt;</span><span class="id"> q1</span><span class="id"> %=</span><span class="id"> q2</span><span class="id"> -&gt;</span><span class="id"> p1</span><span class="id"> %%</span><span class="id"> q1</span><span class="id"> %=</span><span class="id"> p2</span><span class="id"> %%</span><span class="id"> q2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> e1</span><span class="id"> e2;</span><span class="id"> exact:</span><span class="id"> eqp_trans</span> (<span class="id">eqp_modpl</span><span class="id"> _</span><span class="id"> e1</span>) (<span class="id">eqp_modpr</span><span class="id"> _</span><span class="id"> e2</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_divr</span> (<span class="id">d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> %=</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> %/</span><span class="id"> m</span>)<span class="id"> %=</span> (<span class="id">d</span><span class="id"> %/</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> [c1n0</span><span class="id"> c2n0</span><span class="id"> e]</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> m</span><span class="id"> =</span> (<span class="id">c1^-1</span><span class="id"> *</span><span class="id"> c2</span>)<span class="id"> *:</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -scalerA</span><span class="id"> -e</span><span class="id"> scalerA</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divpZr</span><span class="id"> ?eqp_scale</span><span class="id"> //</span><span class="id"> ?invr_eq0</span><span class="id"> mulf_eq0</span><span class="id"> negb_or</span><span class="id"> invr_eq0</span><span class="id"> c1n0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_div</span><span class="id"> p1</span><span class="id"> p2</span><span class="id"> q1</span><span class="id"> q2</span><span class="id"> :</span><span class="id"> p1</span><span class="id"> %=</span><span class="id"> p2</span><span class="id"> -&gt;</span><span class="id"> q1</span><span class="id"> %=</span><span class="id"> q2</span><span class="id"> -&gt;</span><span class="id"> p1</span><span class="id"> %/</span><span class="id"> q1</span><span class="id"> %=</span><span class="id"> p2</span><span class="id"> %/</span><span class="id"> q2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> e1</span><span class="id"> e2;</span><span class="id"> exact:</span><span class="id"> eqp_trans</span> (<span class="id">eqp_divl</span><span class="id"> _</span><span class="id"> e1</span>) (<span class="id">eqp_divr</span><span class="id"> _</span><span class="id"> e2</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_gdcor</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> gdcop</span><span class="id"> p</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> gdcop</span><span class="id"> p</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqr;</span><span class="id"> rewrite</span><span class="id"> /gdcop</span> (<span class="id">eqp_size</span><span class="id"> eqr</span>).<br/>
<span class="id">move:</span> (<span class="id">size</span><span class="id"> r</span>)<span class="id">=&gt;</span><span class="id"> n;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> eqr</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ihn]</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqpxx</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> eqr</span><span class="id"> /=;</span><span class="id"> rewrite</span> (<span class="id">eqp_coprimepl</span><span class="id"> p</span><span class="id"> eqr</span>)<span class="id">;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> //</span>.<br/>
<span class="id">exact/ihn/eqp_div/eqp_gcdl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_gdcol</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> gdcop</span><span class="id"> q</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> gdcop</span><span class="id"> r</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqr;</span><span class="id"> rewrite</span><span class="id"> /gdcop;</span><span class="id"> move:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id">=&gt;</span><span class="id"> n</span>.<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> eqr</span><span class="id"> {1</span><span class="id"> 3}p</span> (<span class="id">eqpxx</span><span class="id"> p</span>)<span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ihn]</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> eqr</span><span class="id"> s</span><span class="id"> esp</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> q</span><span class="id"> 0</span>)<span class="id"> eqr</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nq0</span><span class="id"> eqr]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> eqp0</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> eqpxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> r</span><span class="id"> 0</span>)<span class="id"> eqr</span><span class="id"> nq0</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?eqpxx</span><span class="id"> //</span><span class="id"> eqp0</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eqp_coprimepr</span><span class="id"> _</span><span class="id"> eqr</span>) (<span class="id">eqp_coprimepl</span><span class="id"> _</span><span class="id"> esp</span>)<span class="id">;</span><span class="id"> case:</span><span class="id"> ifP=&gt;</span><span class="id"> _</span><span class="id"> //</span>.<br/>
<span class="id">exact/ihn/eqp_div/eqp_gcd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_rgdco_gdco</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> rgdcop</span><span class="id"> q</span><span class="id"> p</span><span class="id"> %=</span><span class="id"> gdcop</span><span class="id"> q</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rgdcop</span><span class="id"> /gdcop;</span><span class="id"> move:</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id">=&gt;</span><span class="id"> n</span>.<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> {1</span><span class="id"> 3}p</span><span class="id"> {1</span><span class="id"> 3}q</span> (<span class="id">eqpxx</span><span class="id"> p</span>) (<span class="id">eqpxx</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ihn]</span><span class="id"> p</span><span class="id"> q</span><span class="id"> s</span><span class="id"> t</span><span class="id"> /=</span><span class="id"> sp</span><span class="id"> tq</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> t</span><span class="id"> 0</span>)<span class="id"> tq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nt0</span><span class="id"> etq]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eqp_sym</span><span class="id"> eqp0</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> eqpxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> q</span><span class="id"> 0</span>)<span class="id"> etq</span><span class="id"> nt0</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?eqpxx</span><span class="id"> //</span><span class="id"> eqp0</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> rcoprimep_coprimep</span> (<span class="id">eqp_coprimepl</span><span class="id"> t</span><span class="id"> sp</span>) (<span class="id">eqp_coprimepr</span><span class="id"> p</span><span class="id"> tq</span>).<br/>
<span class="id">case:</span><span class="id"> ifP=&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> ihn</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> eqp_trans</span> (<span class="id">eqp_rdiv_div</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eqp_div</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> eqp_trans</span> (<span class="id">eqp_rgcd_gcd</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> apply:</span><span class="id"> eqp_gcd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpD</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %%</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !modp0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">modpD;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpN</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -addr_eq0</span><span class="id"> -modpD</span><span class="id"> addNr</span><span class="id"> mod0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modNp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> modpN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpD</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> +</span><span class="id"> q</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> +</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !divp0</span><span class="id"> addr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divpD;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpN</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -addr_eq0</span><span class="id"> -divpD</span><span class="id"> addNr</span><span class="id"> div0p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_addl_mul_small</span><span class="id"> d</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> srd;</span><span class="id"> rewrite</span><span class="id"> divpD</span> (<span class="id">divp_small</span><span class="id"> srd</span>)<span class="id"> addr0</span><span class="id"> mulpK</span><span class="id"> //</span><span class="id"> -size_poly_gt0</span>.<br/>
<span class="id">exact:</span><span class="id"> leq_trans</span><span class="id"> srd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_addl_mul_small</span><span class="id"> d</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> %%</span><span class="id"> d</span><span class="id"> =</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> srd;</span><span class="id"> rewrite</span><span class="id"> modpD</span><span class="id"> modp_mull</span><span class="id"> add0r</span><span class="id"> modp_small</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_addl_mul</span><span class="id"> d</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> q</span><span class="id"> +</span><span class="id"> r</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dn0;</span><span class="id"> rewrite</span><span class="id"> divpD</span><span class="id"> mulpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpp</span><span class="id"> d</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> dn0;</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divpp;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leq_divMp</span><span class="id"> d</span><span class="id"> m</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> dn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> d</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> size_poly0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">leq_divMp;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpK</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> d</span><span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> dn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divpK;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpKC</span><span class="id"> d</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> divpK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq_div</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">q</span><span class="id"> ==</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> ==</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> dn0;</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">dvdp_eq_div;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_eq_mul</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> ==</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dn0</span><span class="id"> dv_d_p;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> -dvdp_eq_div</span><span class="id"> //</span><span class="id"> eq_sym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_mulA</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> p</span><span class="id"> *</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> d</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> /dvd0pP</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> dn0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !divp0</span><span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divp_mulA;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_mulAC</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> *</span><span class="id"> n</span><span class="id"> =</span><span class="id"> m</span><span class="id"> *</span><span class="id"> n</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hdm;</span><span class="id"> rewrite</span><span class="id"> mulrC</span> (<span class="id">mulrC</span><span class="id"> m</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> divp_mulA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_mulCA</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> *</span> (<span class="id">q</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> q</span><span class="id"> *</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hdp</span><span class="id"> hdq;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> divp_mulAC</span><span class="id"> //</span><span class="id"> divp_mulA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expp_sub</span><span class="id"> d</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> &gt;=</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">d</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>))<span class="id">%N</span><span class="id"> =</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dn0</span><span class="id"> /subnK=&gt;</span><span class="id"> {2}&lt;-;</span><span class="id"> rewrite</span><span class="id"> exprD</span><span class="id"> mulpK</span><span class="id"> //</span><span class="id"> expf_neq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_pmul2l</span><span class="id"> d</span><span class="id"> q</span><span class="id"> p</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> d</span><span class="id"> *</span><span class="id"> p</span><span class="id"> %/</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> =</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> dn0</span><span class="id"> qn0;</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divp_pmul2l;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_pmul2r</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> d</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> %/</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dn0</span><span class="id"> qn0;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">mulrC</span><span class="id"> d</span>)<span class="id"> divp_pmul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divp_divl</span><span class="id"> r</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> r</span><span class="id"> =</span><span class="id"> q</span><span class="id"> %/</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> rn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> r</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> !divp0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> pn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> !divp0</span><span class="id"> div0p</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">divp_divl;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpAC</span><span class="id"> d</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> d</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> =</span><span class="id"> q</span><span class="id"> %/</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !divp_divl</span><span class="id"> //</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivp_def</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> edivp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">0,</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q,</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> Idomain</span>.<span class="id">edivp_def;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /scalp</span><span class="id"> 2!unlock</span><span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lead_coef0</span><span class="id"> unitr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span><span class="id"> qn0</span><span class="id"> /=;</span><span class="id"> case:</span> (<span class="id">redivp_rec</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> [[]]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %/</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">^-</span>(<span class="id">rscalp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> *:</span> (<span class="id">rdivp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rdivp0</span><span class="id"> divp0</span><span class="id"> scaler0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> Idomain</span>.<span class="id">divpE</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span><span class="id"> qn0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %%</span><span class="id"> q</span><span class="id"> =</span> (<span class="id">lead_coef</span><span class="id"> q</span>)<span class="id">^-</span>(<span class="id">rscalp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> *:</span> (<span class="id">rmodp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmodp0</span><span class="id"> modp0</span><span class="id"> /rscalp</span><span class="id"> unlock</span><span class="id"> eqxx</span><span class="id"> lead_coef0</span><span class="id"> expr0</span><span class="id"> invr1</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> Idomain</span>.<span class="id">modpE</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span><span class="id"> qn0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalp0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> Idomain</span>.<span class="id">scalpE</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span><span class="id"> qn0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpE</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> q</span><span class="id"> =</span><span class="id"> rdvdp</span><span class="id"> p</span><span class="id"> q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Idomain</span>.<span class="id">dvdpE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> edivp_spec</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> F}</span><span class="id"> *</span><span class="id"> {poly</span><span class="id"> F}</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">EdivpSpec</span><span class="id"> n</span><span class="id"> q</span><span class="id"> r</span><span class="id"> of</span><br/>
&nbsp;&nbsp;<span class="id">m</span><span class="id"> =</span><span class="id"> q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span><span class="id"> &amp;</span> (<span class="id">d</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> ==&gt;</span> (<span class="id">size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span>)<span class="id"> :</span><span class="id"> edivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">n,</span><span class="id"> q,</span><span class="id"> r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivpP</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><span class="id"> edivp_spec</span><span class="id"> m</span><span class="id"> d</span> (<span class="id">edivp</span><span class="id"> m</span><span class="id"> d</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> edivp_def;</span><span class="id"> constructor;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> divp_eq</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/implyP=&gt;</span><span class="id"> dn0;</span><span class="id"> rewrite</span><span class="id"> ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivp_eq</span><span class="id"> d</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> size</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> d</span><span class="id"> -&gt;</span><span class="id"> edivp</span> (<span class="id">q</span><span class="id"> *</span><span class="id"> d</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> d</span><span class="id"> =</span> (<span class="id">0,</span><span class="id"> q,</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> srd;</span><span class="id"> apply:</span><span class="id"> Idomain</span>.<span class="id">edivp_eq;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> srd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> modp_mul</span><span class="id"> p</span><span class="id"> q</span><span class="id"> m</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> *</span> (<span class="id">q</span><span class="id"> %%</span><span class="id"> m</span>))<span class="id"> %%</span><span class="id"> m</span><span class="id"> =</span> (<span class="id">p</span><span class="id"> *</span><span class="id"> q</span>)<span class="id"> %%</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [in</span><span class="id"> RHS]</span>(<span class="id">divp_eq</span><span class="id"> q</span><span class="id"> m</span>)<span class="id"> mulrDr</span><span class="id"> modpD</span><span class="id"> mulrA</span><span class="id"> modp_mull</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> horner_mod</span><span class="id"> p</span><span class="id"> q</span><span class="id"> x</span><span class="id"> :</span><span class="id"> root</span><span class="id"> q</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>).<span class="id">[x]</span><span class="id"> =</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [in</span><span class="id"> RHS]</span>(<span class="id">divp_eq</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> !hornerE</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> add0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdpP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> qq,</span><span class="id"> p</span><span class="id"> =</span><span class="id"> qq</span><span class="id"> *</span><span class="id"> q</span>) (<span class="id">q</span><span class="id"> %|</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> qn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IdomainUnit</span>.<span class="id">dvdpP;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvd0p;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> eqP</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;|</span><span class="id"> [?</span><span class="id"> -&gt;]];</span><span class="id"> [exists</span><span class="id"> 1|];</span><span class="id"> rewrite</span><span class="id"> mulr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Bezout_eq1_coprimepP</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> u,</span><span class="id"> u</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> p</span><span class="id"> +</span><span class="id"> u</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 1</span>) (<span class="id">coprimep</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">=&gt;</span><span class="id"> [hpq|];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> -[u</span><span class="id"> v]</span><span class="id"> /=</span><span class="id"> e;</span><span class="id"> apply/Bezout_coprimepP;</span><span class="gallina-kwd"> exists</span> (<span class="id">u,</span><span class="id"> v</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> e</span><span class="id"> eqpxx</span>.<br/>
<span class="id">case/Bezout_coprimepP:</span><span class="id"> hpq</span><span class="id"> =&gt;</span><span class="id"> [[u</span><span class="id"> v]]</span><span class="id"> /=</span>.<br/>
<span class="id">case/eqpP=&gt;</span><span class="id"> [[c1</span><span class="id"> c2]]</span><span class="id"> /andP</span><span class="id"> /=</span><span class="id"> [c1n0</span><span class="id"> c2n0]</span><span class="id"> e</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">c2^-1</span><span class="id"> *:</span> (<span class="id">c1</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id">,</span><span class="id"> c2^-1</span><span class="id"> *:</span> (<span class="id">c1</span><span class="id"> *:</span><span class="id"> v</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> -!scalerAl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!scalerDr</span><span class="id"> e</span><span class="id"> scalerA</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_gdcor</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> %|</span> (<span class="id">gdcop</span><span class="id"> q</span><span class="id"> p</span>)<span class="id"> *</span> (<span class="id">q</span><span class="id"> ^+</span><span class="id"> size</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /gdcop</span><span class="id"> =&gt;</span><span class="id"> nz_q;</span><span class="id"> have</span><span class="id"> [n</span><span class="id"> hsp]</span><span class="id"> :=</span><span class="id"> ubnPleq</span> (<span class="id">size</span><span class="id"> p</span>).<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> p</span><span class="id"> hsp</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">negPf</span><span class="id"> nz_q</span>)<span class="id"> mul0r</span><span class="id"> dvdp0</span>.<br/>
<span class="id">have</span><span class="id"> [_</span><span class="id"> |</span><span class="id"> ncop_pq]</span><span class="id"> :=</span><span class="id"> ifPn;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dvdp_mulr</span>.<br/>
<span class="id">have</span><span class="id"> g_gt1:</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> size</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ltn_neqAle</span><span class="id"> eq_sym</span><span class="id"> ncop_pq</span><span class="id"> size_poly_gt0</span><span class="id"> gcdp_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> negb_and</span><span class="id"> nz_q</span><span class="id"> orbT</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_p]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> div0p</span><span class="id"> exprSr</span><span class="id"> mulrA</span><span class="id"> dvdp_mulr</span><span class="id"> //</span><span class="id"> IHn</span><span class="id"> //</span><span class="id"> size_poly0</span>.<br/>
<span class="id">have</span><span class="id"> le_d_p:</span><span class="id"> size</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_divp</span><span class="id"> -?size_poly_eq0</span><span class="id"> -</span>(<span class="id">subnKC</span><span class="id"> g_gt1</span>)<span class="id"> //</span><span class="id"> add2n</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> polySpred</span><span class="id"> //</span><span class="id"> ltnS</span><span class="id"> subSS</span><span class="id"> leq_subr</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[p</span><span class="gallina-kwd"> in</span><span class="id"> p</span><span class="id"> %|</span><span class="id"> _]</span>(<span class="id">divpK</span> (<span class="id">dvdp_gcdl</span><span class="id"> p</span><span class="id"> q</span>))<span class="id"> exprSr</span><span class="id"> mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_mul</span><span class="id"> ?IHn</span><span class="id"> ?dvdp_gcdr</span><span class="id"> //</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> le_d_p</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> reducible_cubic_root</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> 4</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> q</span><span class="id"> %|</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> {r</span><span class="id"> |</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p_le4</span><span class="id"> /andP[];</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> eq_sym</span>.<br/>
<span class="id">have</span><span class="id"> [/poly2_root[x</span><span class="id"> qx0]</span><span class="id"> _</span><span class="id"> _</span><span class="id"> |</span><span class="id"> _</span><span class="id"> /=</span><span class="id"> q_gt2</span><span class="id"> p_gt_q]</span><span class="id"> :=</span><span class="id"> size</span><span class="id"> q</span><span class="id"> =P</span><span class="id"> 2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> -!dvdp_XsubCl</span><span class="gallina-kwd"> in</span><span class="id"> qx0</span><span class="id"> *;</span><span class="id"> apply:</span> (<span class="id">dvdp_trans</span><span class="id"> qx0</span>).<br/>
<span class="id">case/dvdpP/sig_eqW=&gt;</span><span class="id"> r</span><span class="id"> def_p;</span><span class="id"> rewrite</span><span class="id"> def_p</span>.<br/>
<span class="id">suffices</span><span class="id"> /poly2_root[x</span><span class="id"> rx0]:</span><span class="id"> size</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 2</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> rootM</span><span class="id"> rx0</span>.<br/>
<span class="id">have</span><span class="id"> /norP[nz_r</span><span class="id"> nz_q]:</span><span class="id"> ~~</span><span class="id"> [||</span><span class="id"> r</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> |</span><span class="id"> q</span><span class="id"> ==</span><span class="id"> 0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulf_eq0</span><span class="id"> -def_p</span><span class="id"> -size_poly_gt0</span> (<span class="id">leq_ltn_trans</span><span class="id"> _</span><span class="id"> p_gt_q</span>).<br/>
<span class="id">rewrite</span><span class="id"> def_p</span><span class="id"> size_mul</span><span class="id"> //</span><span class="id"> -subn1</span><span class="id"> leq_subLR</span><span class="id"> ltn_subRL</span><span class="gallina-kwd"> in</span><span class="id"> p_gt_q</span><span class="id"> p_le4</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqn_add2r</span> (<span class="id">size</span><span class="id"> q</span>))<span class="id"> eqn_leq</span> (<span class="id">leq_trans</span><span class="id"> p_le4</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cubic_irreducible</span><span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">1</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> 4</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> irreducible_poly</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[p_gt1</span><span class="id"> p_le4]</span><span class="id"> root'p;</span><span class="id"> split=&gt;</span><span class="id"> //</span><span class="id"> q</span><span class="id"> sz_q_neq1</span><span class="id"> q_dv_p</span>.<br/>
<span class="id">have</span><span class="id"> nz_p:</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0</span><span class="id"> ltnW</span>.<br/>
<span class="id">have</span><span class="id"> nz_q:</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> q_dv_p</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> dvd0p</span>.<br/>
<span class="id">have</span><span class="id"> q_gt1:</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &gt;</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltn_neqAle</span><span class="id"> eq_sym</span><span class="id"> sz_q_neq1</span><span class="id"> size_poly_gt0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -dvdp_size_eqp</span><span class="id"> //</span><span class="id"> eqn_leq</span><span class="id"> dvdp_leq</span><span class="id"> //=</span><span class="id"> leqNgt;</span><span class="id"> apply/negP=&gt;</span><span class="id"> p_gt_q</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [|x</span><span class="id"> /idPn//]</span><span class="id"> :=</span><span class="id"> reducible_cubic_root</span><span class="id"> p_le4</span><span class="id"> _</span><span class="id"> q_dv_p;</span><span class="id"> rewrite</span><span class="id"> q_gt1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Multiplicity</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[arg</span><span class="id"> max_</span>(<span class="id">n</span><span class="id"> &gt;</span><span class="id"> ord0</span><span class="id"> :</span><span class="id"> 'I_</span>(<span class="id">size</span><span class="id"> q</span>).<span class="id">+1</span><span class="id"> |</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> q</span>)<span class="id"> n]</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mup_geq</span><span class="id"> x</span><span class="id"> q</span><span class="id"> n</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q</span>)<span class="id">%N</span><span class="id"> =</span> ((<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> q_neq0;</span><span class="id"> rewrite</span><span class="id"> /mup;</span><span class="id"> symmetry</span>.<br/>
<span class="id">case:</span><span class="id"> arg_maxnP;</span><span class="id"> rewrite</span><span class="id"> ?expr0</span><span class="id"> ?dvd1p//=</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> i_dvd</span><span class="id"> gti</span>.<br/>
<span class="id">case:</span><span class="id"> ltnP</span><span class="id"> =&gt;</span><span class="id"> [|/dvdp_exp2l/dvdp_trans];</span><span class="id"> last</span><span class="id"> exact</span>.<br/>
<span class="id">apply:</span><span class="id"> contraTF</span><span class="id"> =&gt;</span><span class="id"> dvdq;</span><span class="id"> rewrite</span><span class="id"> -leqNgt</span>.<br/>
<span class="id">suff</span><span class="id"> n_small</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &lt;</span> (<span class="id">size</span><span class="id"> q</span>).<span class="id">+1</span>)<span class="id">%N</span><span class="gallina-kwd"> by</span><span class="id"> exact:</span> (<span class="id">gti</span> (<span class="id">Ordinal</span><span class="id"> n_small</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltnS</span><span class="id"> ltnW//</span><span class="id"> -</span>(<span class="id">size_exp_XsubC</span><span class="id"> _</span><span class="id"> x</span>)<span class="id"> dvdp_leq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mup_leq</span><span class="id"> x</span><span class="id"> q</span><span class="id"> n</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">mup</span><span class="id"> x</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> =</span><span class="id"> ~~</span> ((<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> qN0;</span><span class="id"> rewrite</span><span class="id"> leqNgt</span><span class="id"> mup_geq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mup_ltn</span><span class="id"> x</span><span class="id"> q</span><span class="id"> n</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">mup</span><span class="id"> x</span><span class="id"> q</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> =</span><span class="id"> ~~</span> ((<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> qN0;</span><span class="id"> rewrite</span><span class="id"> ltnNge</span><span class="id"> mup_geq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> XsubC_dvd</span><span class="id"> x</span><span class="id"> q</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span><span class="id"> %|</span><span class="id"> q</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /mup_geq-/</span>(_<span class="id"> _</span><span class="id"> 1%N</span>)<span class="id">/esym;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mup_XsubCX</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mup</span><span class="id"> x</span> ((<span class="id">'X</span><span class="id"> -</span><span class="id"> y%:P</span>)<span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="gallina-kwd">if</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> x</span>)<span class="gallina-kwd"> then</span><span class="id"> n</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> Xxn0</span><span class="id"> :</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> y%:P</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?expf_neq0</span><span class="id"> ?polyXsubC_eq0</span>.<br/>
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> mup_leq</span><span class="id"> ?mup_geq//</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|Nxy]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> y</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> dvdpp</span><span class="id"> ?dvdp_Pexp2l</span><span class="id"> ?size_XsubC</span><span class="id"> ?ltnn</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvd1p</span><span class="id"> dvdp_XsubCl</span><span class="id"> /root</span><span class="id"> horner_exp</span><span class="id"> !hornerE</span><span class="id"> expf_neq0//</span><span class="id"> subr_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mupNroot</span><span class="id"> x</span><span class="id"> q</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> q</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q</span><span class="id"> =</span><span class="id"> 0%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> qNx;</span><span class="id"> have</span><span class="id"> qN0</span><span class="id"> :</span><span class="id"> q</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> qNx</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> root0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> qNx;</span><span class="id"> rewrite</span><span class="id"> -dvdp_XsubCl</span><span class="id"> XsubC_dvd//</span><span class="id"> lt0n</span><span class="id"> negbK</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mupMr</span><span class="id"> x</span><span class="id"> q1</span><span class="id"> q2</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> q1</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> mup</span><span class="id"> x</span> (<span class="id">q1</span><span class="id"> *</span><span class="id"> q2</span>)<span class="id"> =</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> q1Nx;</span><span class="id"> have</span><span class="id"> q1N0</span><span class="id"> :</span><span class="id"> q1</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> q1Nx</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> root0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|q2N0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q2</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span>.<br/>
<span class="id">apply/esym/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> mup_geq</span><span class="id"> ?mulf_neq0//</span><span class="id"> dvdp_mull</span><span class="id"> -?mup_geq//=</span>.<br/>
<span class="id">rewrite</span><span class="id"> mup_leq</span><span class="id"> ?mulf_neq0//</span><span class="id"> Gauss_dvdpr</span><span class="id"> -?mup_ltn//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> coprimep_expl//</span><span class="id"> coprimep_sym</span><span class="id"> coprimep_XsubC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mupMl</span><span class="id"> x</span><span class="id"> q1</span><span class="id"> q2</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> q2</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> mup</span><span class="id"> x</span> (<span class="id">q1</span><span class="id"> *</span><span class="id"> q2</span>)<span class="id"> =</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC;</span><span class="id"> apply/mupMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mupM</span><span class="id"> x</span><span class="id"> q1</span><span class="id"> q2</span><span class="id"> :</span><span class="id"> q1</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> q2</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">mup</span><span class="id"> x</span> (<span class="id">q1</span><span class="id"> *</span><span class="id"> q2</span>)<span class="id"> =</span> (<span class="id">mup</span><span class="id"> x</span><span class="id"> q1</span><span class="id"> +</span><span class="id"> mup</span><span class="id"> x</span><span class="id"> q2</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> q1N0</span><span class="id"> q2N0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> mup_leq</span><span class="id"> ?mulf_neq0//</span>.<br/>
<span class="id">rewrite</span><span class="id"> mup_geq</span><span class="id"> ?mulf_neq0//</span><span class="id"> exprD</span><span class="id"> ?dvdp_mul;</span><span class="id"> do</span><span class="id"> ?by</span><span class="id"> rewrite</span><span class="id"> -mup_geq</span>.<br/>
<span class="id">have</span><span class="id"> [m1</span><span class="id"> [r1]]</span><span class="id"> :=</span><span class="id"> multiplicity_XsubC</span><span class="id"> q1</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> q1N0</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> r1Nx</span><span class="id"> -&gt;</span>.<br/>
<span class="id">have</span><span class="id"> [m2</span><span class="id"> [r2]]</span><span class="id"> :=</span><span class="id"> multiplicity_XsubC</span><span class="id"> q2</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> q2N0</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> r2Nx</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> !mupMr//</span><span class="id"> ?mup_XsubCX</span><span class="id"> eqxx/=</span><span class="id"> mulrACA</span><span class="id"> exprS</span><span class="id"> exprD</span>.<br/>
<span class="id">rewrite</span><span class="id"> dvdp_mul2r</span><span class="id"> ?mulf_neq0</span><span class="id"> ?expf_neq0</span><span class="id"> ?polyXsubC_eq0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdp_XsubCl</span><span class="id"> rootM</span><span class="id"> negb_or</span><span class="id"> r1Nx</span><span class="id"> r2Nx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mu_prod_XsubC</span><span class="id"> x</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mup</span><span class="id"> x</span> (<span class="id">\prod_</span>(<span class="id">y</span><span class="id"> &lt;-</span><span class="id"> s</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> y%:P</span>))<span class="id"> =</span><span class="id"> count_mem</span><span class="id"> x</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> [|y</span><span class="id"> s</span><span class="id"> IHs];</span><span class="id"> rewrite</span> (<span class="id">big_cons,</span><span class="id"> big_nil</span>)<span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mupNroot//</span><span class="id"> root1</span>.<br/>
<span class="id">rewrite</span><span class="id"> mupM</span><span class="id"> ?polyXsubC_eq0//</span><span class="id"> ?monic_neq0</span><span class="id"> ?monic_prod_XsubC//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> IHs</span> (<span class="id">@mup_XsubCX</span><span class="id"> 1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prod_XsubC_eq</span> (<span class="id">s</span><span class="id"> t</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">x</span><span class="id"> &lt;-</span><span class="id"> s</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">x</span><span class="id"> &lt;-</span><span class="id"> t</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> -&gt;</span><span class="id"> perm_eq</span><span class="id"> s</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eq_prod;</span><span class="id"> apply/allP</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> _</span><span class="id"> /=;</span><span class="id"> apply/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> /</span>(<span class="id">congr1</span> (<span class="id">mup</span><span class="id"> x</span>))<span class="id"> :=</span><span class="id"> eq_prod;</span><span class="id"> rewrite</span><span class="id"> !mu_prod_XsubC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Multiplicity</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldRingMap</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> rR</span><span class="id"> :</span><span class="id"> nzRingType</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> rR}</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;p ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_poly</span><span class="id"> f</span><span class="id"> p</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> redivp_map</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">redivp</span><span class="id"> a^f</span><span class="id"> b^f</span><span class="id"> =</span> (<span class="id">rscalp</span><span class="id"> a</span><span class="id"> b,</span> (<span class="id">rdivp</span><span class="id"> a</span><span class="id"> b</span>)<span class="id">^f,</span> (<span class="id">rmodp</span><span class="id"> a</span><span class="id"> b</span>)<span class="id">^f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /rdivp</span><span class="id"> /rscalp</span><span class="id"> /rmodp</span><span class="id"> !unlock</span><span class="id"> map_poly_eq0</span><span class="id"> size_map_poly</span>.<br/>
<span class="id">have</span><span class="id"> [//</span><span class="id"> |</span><span class="id"> q_nz]</span><span class="id"> :=</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">rmorph0</span> (<span class="id">map_poly</span><span class="id"> f</span>))<span class="id"> //</span>.<br/>
<span class="id">have</span><span class="id"> [m</span><span class="id"> _]</span><span class="id"> :=</span><span class="id"> ubnPeq</span> (<span class="id">size</span><span class="id"> a</span>)<span class="id">;</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> 0%N</span><span class="id"> 0</span><span class="id"> a</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> qq</span><span class="id"> r</span><span class="id"> a</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -!mul_polyC</span><span class="id"> !size_map_poly</span><span class="id"> !lead_coef_map</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">map_polyXn</span><span class="id"> f</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">map_polyC</span><span class="id"> f</span>)<span class="id"> -!rmorphM</span><span class="id"> -rmorphB</span><span class="id"> -rmorphD;</span><span class="id"> case:</span> (_<span class="id"> &lt;</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> -!mul_polyC</span><span class="id"> !size_map_poly</span><span class="id"> !lead_coef_map</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">map_polyXn</span><span class="id"> f</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">map_polyC</span><span class="id"> f</span>)<span class="id"> -!rmorphM</span><span class="id"> -rmorphB</span><span class="id"> -rmorphD</span><span class="id"> /=</span><span class="id"> IHm;</span><span class="id"> case:</span> (_<span class="id"> &lt;</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FieldRingMap</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldMap</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> rR</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> rR}</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;p ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_poly</span><span class="id"> f</span><span class="id"> p</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> edivp_map</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">edivp</span><span class="id"> a^f</span><span class="id"> b^f</span><span class="id"> =</span> (<span class="id">0,</span> (<span class="id">a</span><span class="id"> %/</span><span class="id"> b</span>)<span class="id">^f,</span> (<span class="id">a</span><span class="id"> %%</span><span class="id"> b</span>)<span class="id">^f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> bn0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> b</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">rmorph0</span> (<span class="id">map_poly</span><span class="id"> f</span>))<span class="id"> WeakIdomain</span>.<span class="id">edivp_def</span><span class="id"> !modp0</span><span class="id"> !divp0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">rmorph0</span> (<span class="id">map_poly</span><span class="id"> f</span>))<span class="id"> scalp0</span>.<br/>
<span class="id">rewrite</span><span class="id"> unlock</span><span class="id"> redivp_map</span><span class="id"> lead_coef_map</span><span class="id"> rmorph_unit;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lead_coef_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> modpE</span><span class="id"> divpE</span><span class="id"> !map_polyZ</span><span class="id"> [in</span><span class="id"> RHS]rmorphV</span><span class="id"> ?rmorphXn</span><span class="id"> //</span><span class="id"> unitfE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expf_neq0</span><span class="id"> //</span><span class="id"> lead_coef_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalp_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> scalp</span><span class="id"> p^f</span><span class="id"> q^f</span><span class="id"> =</span><span class="id"> scalp</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /scalp</span><span class="id"> edivp_map</span><span class="id"> edivp_def</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_divp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %/</span><span class="id"> q</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> p^f</span><span class="id"> %/</span><span class="id"> q^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /divp</span><span class="id"> edivp_map</span><span class="id"> edivp_def</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_modp</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> p^f</span><span class="id"> %%</span><span class="id"> q^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /modp</span><span class="id"> edivp_map</span><span class="id"> edivp_def</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> egcdp_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">egcdp</span> (<span class="id">map_poly</span><span class="id"> f</span><span class="id"> p</span>) (<span class="id">map_poly</span><span class="id"> f</span><span class="id"> q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span> (<span class="id">map_poly</span><span class="id"> f</span> (<span class="id">egcdp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">1,</span><span class="id"> map_poly</span><span class="id"> f</span> (<span class="id">egcdp</span><span class="id"> p</span><span class="id"> q</span>).<span class="id">2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">wlog</span><span class="id"> le_qp:</span><span class="id"> p</span><span class="id"> q</span><span class="id"> /</span><span class="id"> size</span><span class="id"> q</span><span class="id"> &lt;=</span><span class="id"> size</span><span class="id"> p</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> IH;</span><span class="id"> have</span><span class="id"> [/IH//</span><span class="id"> |</span><span class="id"> lt_qp]</span><span class="id"> :=</span><span class="id"> leqP</span> (<span class="id">size</span><span class="id"> q</span>) (<span class="id">size</span><span class="id"> p</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> /IH</span><span class="id"> :=</span><span class="id"> ltnW</span><span class="id"> lt_qp;</span><span class="id"> rewrite</span><span class="id"> /egcdp</span><span class="id"> !size_map_poly</span><span class="id"> ltnW</span><span class="id"> //</span><span class="id"> leqNgt</span><span class="id"> lt_qp</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">egcdp_rec</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> u</span><span class="id"> v</span><span class="id"> [-&gt;</span><span class="id"> -&gt;]</span>.<br/>
<span class="id">rewrite</span><span class="id"> /egcdp</span><span class="id"> !size_map_poly</span><span class="id"> {}le_qp;</span><span class="id"> move:</span> (<span class="id">size</span><span class="id"> q</span>)<span class="id"> =&gt;</span><span class="id"> n</span>.<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="gallina-kwd"> in</span><span class="id"> p</span><span class="id"> q</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph1</span><span class="id"> rmorph0</span>.<br/>
<span class="id">rewrite</span><span class="id"> map_poly_eq0;</span><span class="id"> have</span><span class="id"> [_</span><span class="id"> |</span><span class="id"> nz_q]</span><span class="id"> :=</span><span class="id"> ifPn;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph1</span><span class="id"> rmorph0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -map_modp</span> (<span class="id">IHn</span><span class="id"> q</span> (<span class="id">p</span><span class="id"> %%</span><span class="id"> q</span>))<span class="id">;</span><span class="id"> case:</span> (<span class="id">egcdp_rec</span><span class="id"> _</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> u</span><span class="id"> v</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> map_polyZ</span><span class="id"> lead_coef_map</span><span class="id"> -rmorphXn</span><span class="id"> scalp_map</span><span class="id"> rmorphB</span><span class="id"> rmorphM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -map_divp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdp_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p^f</span><span class="id"> %|</span><span class="id"> q^f</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dvdp</span><span class="id"> -map_modp</span><span class="id"> map_poly_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqp_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">p^f</span><span class="id"> %=</span><span class="id"> q^f</span>)<span class="id"> =</span> (<span class="id">p</span><span class="id"> %=</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /eqp</span><span class="id"> !dvdp_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gcdp_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">gcdp</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> gcdp</span><span class="id"> p^f</span><span class="id"> q^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">wlog</span><span class="id"> lt_p_q:</span><span class="id"> p</span><span class="id"> q</span><span class="id"> /</span><span class="id"> size</span><span class="id"> p</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> q</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> IHpq;</span><span class="id"> case:</span> (<span class="id">ltnP</span> (<span class="id">size</span><span class="id"> p</span>) (<span class="id">size</span><span class="id"> q</span>))<span class="id"> =&gt;</span><span class="id"> [|le_q_p];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> IHpq</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> gcdpE</span> (<span class="id">gcdpE</span><span class="id"> p^f</span>)<span class="id"> !size_map_poly</span><span class="id"> ltnNge</span><span class="id"> le_q_p</span><span class="id"> /=</span><span class="id"> -map_modp</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> q_nz]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> q</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> !gcdp0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> IHpq</span><span class="id"> ?ltn_modp</span>.<br/>
<span class="id">have</span><span class="id"> [m</span><span class="id"> le_q_m]</span><span class="id"> :=</span><span class="id"> ubnP</span> (<span class="id">size</span><span class="id"> q</span>)<span class="id">;</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> m</span><span class="id"> IHm</span><span class="gallina-kwd"> in</span><span class="id"> p</span><span class="id"> q</span><span class="id"> lt_p_q</span><span class="id"> le_q_m</span><span class="id"> *</span>.<br/>
<span class="id">rewrite</span><span class="id"> gcdpE</span> (<span class="id">gcdpE</span><span class="id"> p^f</span>)<span class="id"> !size_map_poly</span><span class="id"> lt_p_q</span><span class="id"> -map_modp</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> q_nz]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> p</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> !gcdp0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> IHm</span><span class="id"> ?</span>(<span class="id">leq_trans</span><span class="id"> lt_p_q</span>)<span class="id"> ?ltn_modp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimep_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> coprimep</span><span class="id"> p^f</span><span class="id"> q^f</span><span class="id"> =</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!gcdp_eqp1</span><span class="id"> -eqp_map</span><span class="id"> rmorph1</span><span class="id"> gcdp_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gdcop_rec_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">gdcop_rec</span><span class="id"> p</span><span class="id"> q</span><span class="id"> n</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> gdcop_rec</span><span class="id"> p^f</span><span class="id"> q^f</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IH]</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> p</span><span class="id"> q</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> map_poly_eq0;</span><span class="id"> case:</span><span class="id"> eqP;</span><span class="id"> rewrite</span><span class="id"> ?rmorph1</span><span class="id"> ?rmorph0</span>.<br/>
<span class="id">rewrite</span><span class="id"> /coprimep</span><span class="id"> -gcdp_map</span><span class="id"> size_map_poly</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> Hq0</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -map_divp</span><span class="id"> -IH</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gdcop_map</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span> (<span class="id">gdcop</span><span class="id"> p</span><span class="id"> q</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> gdcop</span><span class="id"> p^f</span><span class="id"> q^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /gdcop</span><span class="id"> gdcop_rec_map</span><span class="id"> !size_map_poly</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FieldMap</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FieldDivision</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Renamed to leq_divMp.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> leq_trunc_divp</span><span class="id"> :=</span><span class="id"> leq_divMp</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Field</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> ClosedField</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Field</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> closed</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> closedFieldType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root_coprimep</span> (<span class="id">p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> q</span>.<span class="id">[x]</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> coprimep</span><span class="id"> p</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ncmn;</span><span class="id"> rewrite</span><span class="id"> -gcdp_eqp1</span><span class="id"> -size_poly_eq1;</span><span class="id"> apply/closed_rootP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> root_gcd</span><span class="id"> !rootE=&gt;</span><span class="id"> /andP</span><span class="id"> [/Ncmn/negPf-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> coprimepP</span> (<span class="id">p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> q</span>.<span class="id">[x]</span><span class="id"> !=</span><span class="id"> 0</span>) (<span class="id">coprimep</span><span class="id"> p</span><span class="id"> q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">=&gt;</span><span class="id"> [/coprimep_root|/root_coprimep]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> closed</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedField</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Pdiv</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> Pdiv</span>.<span class="id">Field</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/affeldt-aist/rocqnavi/">rocqnavi</a></div>
    </div>
  </div>
    </main>
</body>
</html>
