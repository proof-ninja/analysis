
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.ssrnum</title>
<meta name="description" content="Documentation of Coq module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.ssrnum" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="rocqnavi.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="rocqnavi.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="Corelib"><summary>Corelib</summary>
          <ul>
          <li><details id="Corelib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Corelib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Corelib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Corelib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Corelib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Corelib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Corelib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Corelib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Corelib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Corelib.Classes.Init.html">Init</a></li>
<li><a href="Corelib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Corelib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Corelib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Corelib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Corelib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Corelib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Corelib.Compat.Coq820.html">Coq820</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Corelib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Corelib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Corelib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Corelib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Corelib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Corelib.Init.Byte.html">Byte</a></li>
<li><a href="Corelib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Corelib.Init.Decimal.html">Decimal</a></li>
<li><a href="Corelib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Corelib.Init.Logic.html">Logic</a></li>
<li><a href="Corelib.Init.Ltac.html">Ltac</a></li>
<li><a href="Corelib.Init.Nat.html">Nat</a></li>
<li><a href="Corelib.Init.Notations.html">Notations</a></li>
<li><a href="Corelib.Init.Number.html">Number</a></li>
<li><a href="Corelib.Init.Peano.html">Peano</a></li>
<li><a href="Corelib.Init.Prelude.html">Prelude</a></li>
<li><a href="Corelib.Init.Specif.html">Specif</a></li>
<li><a href="Corelib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Corelib.Init.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Init.Tauto.html">Tauto</a></li>
<li><a href="Corelib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Corelib.Lists.ListDef.html">ListDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Corelib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Corelib.Numbers.BinNums.html">BinNums</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Corelib.Program.Basics.html">Basics</a></li>
<li><a href="Corelib.Program.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Program.Utils.html">Utils</a></li>
<li><a href="Corelib.Program.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Corelib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Corelib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Corelib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Corelib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Corelib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Corelib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Corelib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Corelib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Corelib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Corelib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Corelib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Corelib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Corelib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Corelib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Corelib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="HB"><summary>HB</summary>
          <ul>
          <li><a href="HB.structures.html">structures</a></li>
          </ul>
          </details>
          </li>
<li><details id="Ltac2"><summary>Ltac2</summary>
          <ul>
          <li><details id="Ltac2.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Ltac2.Compat.Coq818.html">Coq818</a></li>
<li><a href="Ltac2.Compat.Coq819.html">Coq819</a></li>
          </ul>
          </details>
          </li>
<li><a href="Ltac2.Array.html">Array</a></li>
<li><a href="Ltac2.Bool.html">Bool</a></li>
<li><a href="Ltac2.Char.html">Char</a></li>
<li><a href="Ltac2.Constant.html">Constant</a></li>
<li><a href="Ltac2.Constr.html">Constr</a></li>
<li><a href="Ltac2.Constructor.html">Constructor</a></li>
<li><a href="Ltac2.Control.html">Control</a></li>
<li><a href="Ltac2.Env.html">Env</a></li>
<li><a href="Ltac2.Evar.html">Evar</a></li>
<li><a href="Ltac2.FMap.html">FMap</a></li>
<li><a href="Ltac2.FSet.html">FSet</a></li>
<li><a href="Ltac2.Float.html">Float</a></li>
<li><a href="Ltac2.Fresh.html">Fresh</a></li>
<li><a href="Ltac2.Ident.html">Ident</a></li>
<li><a href="Ltac2.Ind.html">Ind</a></li>
<li><a href="Ltac2.Init.html">Init</a></li>
<li><a href="Ltac2.Int.html">Int</a></li>
<li><a href="Ltac2.Lazy.html">Lazy</a></li>
<li><a href="Ltac2.List.html">List</a></li>
<li><a href="Ltac2.Ltac1.html">Ltac1</a></li>
<li><a href="Ltac2.Ltac2.html">Ltac2</a></li>
<li><a href="Ltac2.Message.html">Message</a></li>
<li><a href="Ltac2.Meta.html">Meta</a></li>
<li><a href="Ltac2.Notations.html">Notations</a></li>
<li><a href="Ltac2.Option.html">Option</a></li>
<li><a href="Ltac2.Pattern.html">Pattern</a></li>
<li><a href="Ltac2.Printf.html">Printf</a></li>
<li><a href="Ltac2.Proj.html">Proj</a></li>
<li><a href="Ltac2.Pstring.html">Pstring</a></li>
<li><a href="Ltac2.RedFlags.html">RedFlags</a></li>
<li><a href="Ltac2.Ref.html">Ref</a></li>
<li><a href="Ltac2.Std.html">Std</a></li>
<li><a href="Ltac2.String.html">String</a></li>
<li><a href="Ltac2.TransparentState.html">TransparentState</a></li>
<li><a href="Ltac2.Uint63.html">Uint63</a></li>
<li><a href="Ltac2.Unification.html">Unification</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib"><summary>Stdlib</summary>
          <ul>
          <li><details id="Stdlib.All"><summary>All</summary>
          <ul>
          <li><a href="Stdlib.All.All.html">All</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Arith"><summary>Arith</summary>
          <ul>
          <li><a href="Stdlib.Arith.Arith.html">Arith</a></li>
<li><a href="Stdlib.Arith.Arith_base.html">Arith_base</a></li>
<li><a href="Stdlib.Arith.Between.html">Between</a></li>
<li><a href="Stdlib.Arith.Bool_nat.html">Bool_nat</a></li>
<li><a href="Stdlib.Arith.Cantor.html">Cantor</a></li>
<li><a href="Stdlib.Arith.Compare.html">Compare</a></li>
<li><a href="Stdlib.Arith.Compare_dec.html">Compare_dec</a></li>
<li><a href="Stdlib.Arith.EqNat.html">EqNat</a></li>
<li><a href="Stdlib.Arith.Euclid.html">Euclid</a></li>
<li><a href="Stdlib.Arith.Factorial.html">Factorial</a></li>
<li><a href="Stdlib.Arith.PeanoNat.html">PeanoNat</a></li>
<li><a href="Stdlib.Arith.Peano_dec.html">Peano_dec</a></li>
<li><a href="Stdlib.Arith.Wf_nat.html">Wf_nat</a></li>
<li><a href="Stdlib.Arith.Zerob.html">Zerob</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Stdlib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Stdlib.Array.PArray.html">PArray</a></li>
<li><a href="Stdlib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Stdlib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Stdlib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Stdlib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Bool"><summary>Bool</summary>
          <ul>
          <li><a href="Stdlib.Bool.Bool.html">Bool</a></li>
<li><a href="Stdlib.Bool.BoolEq.html">BoolEq</a></li>
<li><a href="Stdlib.Bool.DecBool.html">DecBool</a></li>
<li><a href="Stdlib.Bool.IfProp.html">IfProp</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Stdlib.Classes.CEquivalence.html">CEquivalence</a></li>
<li><a href="Stdlib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Stdlib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Stdlib.Classes.DecidableClass.html">DecidableClass</a></li>
<li><a href="Stdlib.Classes.EquivDec.html">EquivDec</a></li>
<li><a href="Stdlib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Stdlib.Classes.Init.html">Init</a></li>
<li><a href="Stdlib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Stdlib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Stdlib.Classes.Morphisms_Relations.html">Morphisms_Relations</a></li>
<li><a href="Stdlib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Stdlib.Classes.RelationPairs.html">RelationPairs</a></li>
<li><a href="Stdlib.Classes.SetoidClass.html">SetoidClass</a></li>
<li><a href="Stdlib.Classes.SetoidDec.html">SetoidDec</a></li>
<li><a href="Stdlib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Stdlib.Compat.AdmitAxiom.html">AdmitAxiom</a></li>
<li><a href="Stdlib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Stdlib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Stdlib.Compat.Coq820.html">Coq820</a></li>
<li><a href="Stdlib.Compat.Stdlib818.html">Stdlib818</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.FSets"><summary>FSets</summary>
          <ul>
          <li><a href="Stdlib.FSets.FMapAVL.html">FMapAVL</a></li>
<li><a href="Stdlib.FSets.FMapFacts.html">FMapFacts</a></li>
<li><a href="Stdlib.FSets.FMapFullAVL.html">FMapFullAVL</a></li>
<li><a href="Stdlib.FSets.FMapInterface.html">FMapInterface</a></li>
<li><a href="Stdlib.FSets.FMapList.html">FMapList</a></li>
<li><a href="Stdlib.FSets.FMapPositive.html">FMapPositive</a></li>
<li><a href="Stdlib.FSets.FMapWeakList.html">FMapWeakList</a></li>
<li><a href="Stdlib.FSets.FMaps.html">FMaps</a></li>
<li><a href="Stdlib.FSets.FSetAVL.html">FSetAVL</a></li>
<li><a href="Stdlib.FSets.FSetBridge.html">FSetBridge</a></li>
<li><a href="Stdlib.FSets.FSetCompat.html">FSetCompat</a></li>
<li><a href="Stdlib.FSets.FSetDecide.html">FSetDecide</a></li>
<li><a href="Stdlib.FSets.FSetEqProperties.html">FSetEqProperties</a></li>
<li><a href="Stdlib.FSets.FSetFacts.html">FSetFacts</a></li>
<li><a href="Stdlib.FSets.FSetInterface.html">FSetInterface</a></li>
<li><a href="Stdlib.FSets.FSetList.html">FSetList</a></li>
<li><a href="Stdlib.FSets.FSetPositive.html">FSetPositive</a></li>
<li><a href="Stdlib.FSets.FSetProperties.html">FSetProperties</a></li>
<li><a href="Stdlib.FSets.FSetToFiniteSet.html">FSetToFiniteSet</a></li>
<li><a href="Stdlib.FSets.FSetWeakList.html">FSetWeakList</a></li>
<li><a href="Stdlib.FSets.FSets.html">FSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Stdlib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Stdlib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Stdlib.Floats.FloatLemmas.html">FloatLemmas</a></li>
<li><a href="Stdlib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Stdlib.Floats.Floats.html">Floats</a></li>
<li><a href="Stdlib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Stdlib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Stdlib.Init.Byte.html">Byte</a></li>
<li><a href="Stdlib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Stdlib.Init.Decimal.html">Decimal</a></li>
<li><a href="Stdlib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Stdlib.Init.Logic.html">Logic</a></li>
<li><a href="Stdlib.Init.Ltac.html">Ltac</a></li>
<li><a href="Stdlib.Init.Nat.html">Nat</a></li>
<li><a href="Stdlib.Init.Notations.html">Notations</a></li>
<li><a href="Stdlib.Init.Number.html">Number</a></li>
<li><a href="Stdlib.Init.Peano.html">Peano</a></li>
<li><a href="Stdlib.Init.Prelude.html">Prelude</a></li>
<li><a href="Stdlib.Init.Specif.html">Specif</a></li>
<li><a href="Stdlib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Stdlib.Init.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Init.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Stdlib.Lists.List.html">List</a></li>
<li><a href="Stdlib.Lists.ListDec.html">ListDec</a></li>
<li><a href="Stdlib.Lists.ListDef.html">ListDef</a></li>
<li><a href="Stdlib.Lists.ListSet.html">ListSet</a></li>
<li><a href="Stdlib.Lists.ListTactics.html">ListTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Logic"><summary>Logic</summary>
          <ul>
          <li><a href="Stdlib.Logic.Adjointification.html">Adjointification</a></li>
<li><a href="Stdlib.Logic.Berardi.html">Berardi</a></li>
<li><a href="Stdlib.Logic.ChoiceFacts.html">ChoiceFacts</a></li>
<li><a href="Stdlib.Logic.Classical.html">Classical</a></li>
<li><a href="Stdlib.Logic.ClassicalChoice.html">ClassicalChoice</a></li>
<li><a href="Stdlib.Logic.ClassicalDescription.html">ClassicalDescription</a></li>
<li><a href="Stdlib.Logic.ClassicalEpsilon.html">ClassicalEpsilon</a></li>
<li><a href="Stdlib.Logic.ClassicalFacts.html">ClassicalFacts</a></li>
<li><a href="Stdlib.Logic.ClassicalUniqueChoice.html">ClassicalUniqueChoice</a></li>
<li><a href="Stdlib.Logic.Classical_Pred_Type.html">Classical_Pred_Type</a></li>
<li><a href="Stdlib.Logic.Classical_Prop.html">Classical_Prop</a></li>
<li><a href="Stdlib.Logic.ConstructiveEpsilon.html">ConstructiveEpsilon</a></li>
<li><a href="Stdlib.Logic.Decidable.html">Decidable</a></li>
<li><a href="Stdlib.Logic.Description.html">Description</a></li>
<li><a href="Stdlib.Logic.Diaconescu.html">Diaconescu</a></li>
<li><a href="Stdlib.Logic.Epsilon.html">Epsilon</a></li>
<li><a href="Stdlib.Logic.Eqdep.html">Eqdep</a></li>
<li><a href="Stdlib.Logic.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="Stdlib.Logic.Eqdep_dec.html">Eqdep_dec</a></li>
<li><a href="Stdlib.Logic.ExtensionalFunctionRepresentative.html">ExtensionalFunctionRepresentative</a></li>
<li><a href="Stdlib.Logic.ExtensionalityFacts.html">ExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></li>
<li><a href="Stdlib.Logic.HLevels.html">HLevels</a></li>
<li><a href="Stdlib.Logic.Hurkens.html">Hurkens</a></li>
<li><a href="Stdlib.Logic.IndefiniteDescription.html">IndefiniteDescription</a></li>
<li><a href="Stdlib.Logic.JMeq.html">JMeq</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevance.html">ProofIrrelevance</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevanceFacts.html">ProofIrrelevanceFacts</a></li>
<li><a href="Stdlib.Logic.PropExtensionality.html">PropExtensionality</a></li>
<li><a href="Stdlib.Logic.PropExtensionalityFacts.html">PropExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.PropFacts.html">PropFacts</a></li>
<li><a href="Stdlib.Logic.RelationalChoice.html">RelationalChoice</a></li>
<li><a href="Stdlib.Logic.SetIsType.html">SetIsType</a></li>
<li><a href="Stdlib.Logic.SetoidChoice.html">SetoidChoice</a></li>
<li><a href="Stdlib.Logic.StrictProp.html">StrictProp</a></li>
<li><a href="Stdlib.Logic.WKL.html">WKL</a></li>
<li><a href="Stdlib.Logic.WeakFan.html">WeakFan</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.MSets"><summary>MSets</summary>
          <ul>
          <li><a href="Stdlib.MSets.MSetAVL.html">MSetAVL</a></li>
<li><a href="Stdlib.MSets.MSetDecide.html">MSetDecide</a></li>
<li><a href="Stdlib.MSets.MSetEqProperties.html">MSetEqProperties</a></li>
<li><a href="Stdlib.MSets.MSetFacts.html">MSetFacts</a></li>
<li><a href="Stdlib.MSets.MSetGenTree.html">MSetGenTree</a></li>
<li><a href="Stdlib.MSets.MSetInterface.html">MSetInterface</a></li>
<li><a href="Stdlib.MSets.MSetList.html">MSetList</a></li>
<li><a href="Stdlib.MSets.MSetPositive.html">MSetPositive</a></li>
<li><a href="Stdlib.MSets.MSetProperties.html">MSetProperties</a></li>
<li><a href="Stdlib.MSets.MSetRBT.html">MSetRBT</a></li>
<li><a href="Stdlib.MSets.MSetToFiniteSet.html">MSetToFiniteSet</a></li>
<li><a href="Stdlib.MSets.MSetWeakList.html">MSetWeakList</a></li>
<li><a href="Stdlib.MSets.MSets.html">MSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.NArith"><summary>NArith</summary>
          <ul>
          <li><a href="Stdlib.NArith.BinNat.html">BinNat</a></li>
<li><a href="Stdlib.NArith.BinNatDef.html">BinNatDef</a></li>
<li><a href="Stdlib.NArith.NArith.html">NArith</a></li>
<li><a href="Stdlib.NArith.NArith_base.html">NArith_base</a></li>
<li><a href="Stdlib.NArith.Ndec.html">Ndec</a></li>
<li><a href="Stdlib.NArith.Ndiv_def.html">Ndiv_def</a></li>
<li><a href="Stdlib.NArith.Ngcd_def.html">Ngcd_def</a></li>
<li><a href="Stdlib.NArith.Nnat.html">Nnat</a></li>
<li><a href="Stdlib.NArith.Nsqrt_def.html">Nsqrt_def</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Abstract.CyclicAxioms.html">CyclicAxioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.DoubleType.html">DoubleType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.NZCyclic.html">NZCyclic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Cyclic63.html">Cyclic63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Ring63.html">Ring63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63.html">Sint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63.html">Uint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer"><summary>Integer</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Integer.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Abstract.ZAdd.html">ZAdd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAddOrder.html">ZAddOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAxioms.html">ZAxioms</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBase.html">ZBase</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBits.html">ZBits</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivEucl.html">ZDivEucl</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivFloor.html">ZDivFloor</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivTrunc.html">ZDivTrunc</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZGcd.html">ZGcd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLcm.html">ZLcm</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLt.html">ZLt</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMaxMin.html">ZMaxMin</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMul.html">ZMul</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMulOrder.html">ZMulOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZParity.html">ZParity</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZPow.html">ZPow</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZProperties.html">ZProperties</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZSgnAbs.html">ZSgnAbs</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Binary.ZBinary.html">ZBinary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.NatPairs"><summary>NatPairs</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.NatPairs.ZNatPairs.html">ZNatPairs</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.NatInt"><summary>NatInt</summary>
          <ul>
          <li><a href="Stdlib.Numbers.NatInt.NZAdd.html">NZAdd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAddOrder.html">NZAddOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAxioms.html">NZAxioms</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBase.html">NZBase</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBits.html">NZBits</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDiv.html">NZDiv</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDomain.html">NZDomain</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZGcd.html">NZGcd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZLog.html">NZLog</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMul.html">NZMul</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMulOrder.html">NZMulOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZOrder.html">NZOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZParity.html">NZParity</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZPow.html">NZPow</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZProperties.html">NZProperties</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZSqrt.html">NZSqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural"><summary>Natural</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Natural.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Abstract.NAdd.html">NAdd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAddOrder.html">NAddOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAxioms.html">NAxioms</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBase.html">NBase</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBits.html">NBits</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDefOps.html">NDefOps</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv.html">NDiv</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv0.html">NDiv0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NGcd.html">NGcd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NIso.html">NIso</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm.html">NLcm</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm0.html">NLcm0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLog.html">NLog</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMaxMin.html">NMaxMin</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMulOrder.html">NMulOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NOrder.html">NOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NParity.html">NParity</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NPow.html">NPow</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NProperties.html">NProperties</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSqrt.html">NSqrt</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NStrongRec.html">NStrongRec</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSub.html">NSub</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Binary.NBinary.html">NBinary</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Numbers.AltBinNotations.html">AltBinNotations</a></li>
<li><a href="Stdlib.Numbers.BinNums.html">BinNums</a></li>
<li><a href="Stdlib.Numbers.DecimalFacts.html">DecimalFacts</a></li>
<li><a href="Stdlib.Numbers.DecimalN.html">DecimalN</a></li>
<li><a href="Stdlib.Numbers.DecimalNat.html">DecimalNat</a></li>
<li><a href="Stdlib.Numbers.DecimalPos.html">DecimalPos</a></li>
<li><a href="Stdlib.Numbers.DecimalQ.html">DecimalQ</a></li>
<li><a href="Stdlib.Numbers.DecimalR.html">DecimalR</a></li>
<li><a href="Stdlib.Numbers.DecimalString.html">DecimalString</a></li>
<li><a href="Stdlib.Numbers.DecimalZ.html">DecimalZ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalFacts.html">HexadecimalFacts</a></li>
<li><a href="Stdlib.Numbers.HexadecimalN.html">HexadecimalN</a></li>
<li><a href="Stdlib.Numbers.HexadecimalNat.html">HexadecimalNat</a></li>
<li><a href="Stdlib.Numbers.HexadecimalPos.html">HexadecimalPos</a></li>
<li><a href="Stdlib.Numbers.HexadecimalQ.html">HexadecimalQ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalR.html">HexadecimalR</a></li>
<li><a href="Stdlib.Numbers.HexadecimalString.html">HexadecimalString</a></li>
<li><a href="Stdlib.Numbers.HexadecimalZ.html">HexadecimalZ</a></li>
<li><a href="Stdlib.Numbers.NaryFunctions.html">NaryFunctions</a></li>
<li><a href="Stdlib.Numbers.NumPrelude.html">NumPrelude</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.PArith"><summary>PArith</summary>
          <ul>
          <li><a href="Stdlib.PArith.BinPos.html">BinPos</a></li>
<li><a href="Stdlib.PArith.BinPosDef.html">BinPosDef</a></li>
<li><a href="Stdlib.PArith.PArith.html">PArith</a></li>
<li><a href="Stdlib.PArith.POrderedType.html">POrderedType</a></li>
<li><a href="Stdlib.PArith.Pnat.html">Pnat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Stdlib.Program.Basics.html">Basics</a></li>
<li><a href="Stdlib.Program.Combinators.html">Combinators</a></li>
<li><a href="Stdlib.Program.Equality.html">Equality</a></li>
<li><a href="Stdlib.Program.Program.html">Program</a></li>
<li><a href="Stdlib.Program.Subset.html">Subset</a></li>
<li><a href="Stdlib.Program.Syntax.html">Syntax</a></li>
<li><a href="Stdlib.Program.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Program.Utils.html">Utils</a></li>
<li><a href="Stdlib.Program.Wf.html">Wf</a></li>
<li><a href="Stdlib.Program.WfExtensionality.html">WfExtensionality</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.QArith"><summary>QArith</summary>
          <ul>
          <li><a href="Stdlib.QArith.QArith.html">QArith</a></li>
<li><a href="Stdlib.QArith.QArith_base.html">QArith_base</a></li>
<li><a href="Stdlib.QArith.QOrderedType.html">QOrderedType</a></li>
<li><a href="Stdlib.QArith.Qabs.html">Qabs</a></li>
<li><a href="Stdlib.QArith.Qcabs.html">Qcabs</a></li>
<li><a href="Stdlib.QArith.Qcanon.html">Qcanon</a></li>
<li><a href="Stdlib.QArith.Qfield.html">Qfield</a></li>
<li><a href="Stdlib.QArith.Qminmax.html">Qminmax</a></li>
<li><a href="Stdlib.QArith.Qpower.html">Qpower</a></li>
<li><a href="Stdlib.QArith.Qreduction.html">Qreduction</a></li>
<li><a href="Stdlib.QArith.Qring.html">Qring</a></li>
<li><a href="Stdlib.QArith.Qround.html">Qround</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals"><summary>Reals</summary>
          <ul>
          <li><details id="Stdlib.Reals.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Reals.Abstract.ConstructiveAbs.html">ConstructiveAbs</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLUB.html">ConstructiveLUB</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLimits.html">ConstructiveLimits</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveMinMax.html">ConstructiveMinMax</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructivePower.html">ConstructivePower</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveReals.html">ConstructiveReals</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveRealsMorphisms.html">ConstructiveRealsMorphisms</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveSum.html">ConstructiveSum</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals.Cauchy"><summary>Cauchy</summary>
          <ul>
          <li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyAbs.html">ConstructiveCauchyAbs</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyReals.html">ConstructiveCauchyReals</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyRealsMult.html">ConstructiveCauchyRealsMult</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveExtra.html">ConstructiveExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveRcomplete.html">ConstructiveRcomplete</a></li>
<li><a href="Stdlib.Reals.Cauchy.PosExtra.html">PosExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.QExtra.html">QExtra</a></li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Reals.Alembert.html">Alembert</a></li>
<li><a href="Stdlib.Reals.AltSeries.html">AltSeries</a></li>
<li><a href="Stdlib.Reals.ArithProp.html">ArithProp</a></li>
<li><a href="Stdlib.Reals.Binomial.html">Binomial</a></li>
<li><a href="Stdlib.Reals.Cauchy_prod.html">Cauchy_prod</a></li>
<li><a href="Stdlib.Reals.ClassicalConstructiveReals.html">ClassicalConstructiveReals</a></li>
<li><a href="Stdlib.Reals.ClassicalDedekindReals.html">ClassicalDedekindReals</a></li>
<li><a href="Stdlib.Reals.Cos_plus.html">Cos_plus</a></li>
<li><a href="Stdlib.Reals.Cos_rel.html">Cos_rel</a></li>
<li><a href="Stdlib.Reals.DiscrR.html">DiscrR</a></li>
<li><a href="Stdlib.Reals.Exp_prop.html">Exp_prop</a></li>
<li><a href="Stdlib.Reals.Integration.html">Integration</a></li>
<li><a href="Stdlib.Reals.MVT.html">MVT</a></li>
<li><a href="Stdlib.Reals.Machin.html">Machin</a></li>
<li><a href="Stdlib.Reals.NewtonInt.html">NewtonInt</a></li>
<li><a href="Stdlib.Reals.Nsatz.html">Nsatz</a></li>
<li><a href="Stdlib.Reals.PSeries_reg.html">PSeries_reg</a></li>
<li><a href="Stdlib.Reals.PartSum.html">PartSum</a></li>
<li><a href="Stdlib.Reals.Qreals.html">Qreals</a></li>
<li><a href="Stdlib.Reals.RIneq.html">RIneq</a></li>
<li><a href="Stdlib.Reals.RList.html">RList</a></li>
<li><a href="Stdlib.Reals.ROrderedType.html">ROrderedType</a></li>
<li><a href="Stdlib.Reals.R_Ifp.html">R_Ifp</a></li>
<li><a href="Stdlib.Reals.R_sqr.html">R_sqr</a></li>
<li><a href="Stdlib.Reals.R_sqrt.html">R_sqrt</a></li>
<li><a href="Stdlib.Reals.Ranalysis.html">Ranalysis</a></li>
<li><a href="Stdlib.Reals.Ranalysis1.html">Ranalysis1</a></li>
<li><a href="Stdlib.Reals.Ranalysis2.html">Ranalysis2</a></li>
<li><a href="Stdlib.Reals.Ranalysis3.html">Ranalysis3</a></li>
<li><a href="Stdlib.Reals.Ranalysis4.html">Ranalysis4</a></li>
<li><a href="Stdlib.Reals.Ranalysis5.html">Ranalysis5</a></li>
<li><a href="Stdlib.Reals.Ranalysis_reg.html">Ranalysis_reg</a></li>
<li><a href="Stdlib.Reals.Ratan.html">Ratan</a></li>
<li><a href="Stdlib.Reals.Raxioms.html">Raxioms</a></li>
<li><a href="Stdlib.Reals.Rbase.html">Rbase</a></li>
<li><a href="Stdlib.Reals.Rbasic_fun.html">Rbasic_fun</a></li>
<li><a href="Stdlib.Reals.Rcomplete.html">Rcomplete</a></li>
<li><a href="Stdlib.Reals.Rdefinitions.html">Rdefinitions</a></li>
<li><a href="Stdlib.Reals.Rderiv.html">Rderiv</a></li>
<li><a href="Stdlib.Reals.Reals.html">Reals</a></li>
<li><a href="Stdlib.Reals.Rfunctions.html">Rfunctions</a></li>
<li><a href="Stdlib.Reals.Rgeom.html">Rgeom</a></li>
<li><a href="Stdlib.Reals.RiemannInt.html">RiemannInt</a></li>
<li><a href="Stdlib.Reals.RiemannInt_SF.html">RiemannInt_SF</a></li>
<li><a href="Stdlib.Reals.Rlimit.html">Rlimit</a></li>
<li><a href="Stdlib.Reals.Rlogic.html">Rlogic</a></li>
<li><a href="Stdlib.Reals.Rminmax.html">Rminmax</a></li>
<li><a href="Stdlib.Reals.Rpow_def.html">Rpow_def</a></li>
<li><a href="Stdlib.Reals.Rpower.html">Rpower</a></li>
<li><a href="Stdlib.Reals.Rprod.html">Rprod</a></li>
<li><a href="Stdlib.Reals.Rregisternames.html">Rregisternames</a></li>
<li><a href="Stdlib.Reals.Rseries.html">Rseries</a></li>
<li><a href="Stdlib.Reals.Rsigma.html">Rsigma</a></li>
<li><a href="Stdlib.Reals.Rsqrt_def.html">Rsqrt_def</a></li>
<li><a href="Stdlib.Reals.Rtopology.html">Rtopology</a></li>
<li><a href="Stdlib.Reals.Rtrigo.html">Rtrigo</a></li>
<li><a href="Stdlib.Reals.Rtrigo1.html">Rtrigo1</a></li>
<li><a href="Stdlib.Reals.Rtrigo_alt.html">Rtrigo_alt</a></li>
<li><a href="Stdlib.Reals.Rtrigo_calc.html">Rtrigo_calc</a></li>
<li><a href="Stdlib.Reals.Rtrigo_def.html">Rtrigo_def</a></li>
<li><a href="Stdlib.Reals.Rtrigo_facts.html">Rtrigo_facts</a></li>
<li><a href="Stdlib.Reals.Rtrigo_fun.html">Rtrigo_fun</a></li>
<li><a href="Stdlib.Reals.Rtrigo_reg.html">Rtrigo_reg</a></li>
<li><a href="Stdlib.Reals.Runcountable.html">Runcountable</a></li>
<li><a href="Stdlib.Reals.SeqProp.html">SeqProp</a></li>
<li><a href="Stdlib.Reals.SeqSeries.html">SeqSeries</a></li>
<li><a href="Stdlib.Reals.SplitAbsolu.html">SplitAbsolu</a></li>
<li><a href="Stdlib.Reals.SplitRmult.html">SplitRmult</a></li>
<li><a href="Stdlib.Reals.Sqrt_reg.html">Sqrt_reg</a></li>
<li><a href="Stdlib.Reals.Zfloor.html">Zfloor</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Stdlib.Relations.Operators_Properties.html">Operators_Properties</a></li>
<li><a href="Stdlib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
<li><a href="Stdlib.Relations.Relation_Operators.html">Relation_Operators</a></li>
<li><a href="Stdlib.Relations.Relations.html">Relations</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Stdlib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sets"><summary>Sets</summary>
          <ul>
          <li><a href="Stdlib.Sets.Classical_sets.html">Classical_sets</a></li>
<li><a href="Stdlib.Sets.Constructive_sets.html">Constructive_sets</a></li>
<li><a href="Stdlib.Sets.Cpo.html">Cpo</a></li>
<li><a href="Stdlib.Sets.Ensembles.html">Ensembles</a></li>
<li><a href="Stdlib.Sets.Finite_sets.html">Finite_sets</a></li>
<li><a href="Stdlib.Sets.Finite_sets_facts.html">Finite_sets_facts</a></li>
<li><a href="Stdlib.Sets.Image.html">Image</a></li>
<li><a href="Stdlib.Sets.Infinite_sets.html">Infinite_sets</a></li>
<li><a href="Stdlib.Sets.Integers.html">Integers</a></li>
<li><a href="Stdlib.Sets.Multiset.html">Multiset</a></li>
<li><a href="Stdlib.Sets.Partial_Order.html">Partial_Order</a></li>
<li><a href="Stdlib.Sets.Permut.html">Permut</a></li>
<li><a href="Stdlib.Sets.Powerset.html">Powerset</a></li>
<li><a href="Stdlib.Sets.Powerset_Classical_facts.html">Powerset_Classical_facts</a></li>
<li><a href="Stdlib.Sets.Powerset_facts.html">Powerset_facts</a></li>
<li><a href="Stdlib.Sets.Relations_1.html">Relations_1</a></li>
<li><a href="Stdlib.Sets.Relations_1_facts.html">Relations_1_facts</a></li>
<li><a href="Stdlib.Sets.Relations_2.html">Relations_2</a></li>
<li><a href="Stdlib.Sets.Relations_2_facts.html">Relations_2_facts</a></li>
<li><a href="Stdlib.Sets.Relations_3.html">Relations_3</a></li>
<li><a href="Stdlib.Sets.Relations_3_facts.html">Relations_3_facts</a></li>
<li><a href="Stdlib.Sets.Uniset.html">Uniset</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sorting"><summary>Sorting</summary>
          <ul>
          <li><a href="Stdlib.Sorting.CPermutation.html">CPermutation</a></li>
<li><a href="Stdlib.Sorting.Heap.html">Heap</a></li>
<li><a href="Stdlib.Sorting.Mergesort.html">Mergesort</a></li>
<li><a href="Stdlib.Sorting.PermutEq.html">PermutEq</a></li>
<li><a href="Stdlib.Sorting.PermutSetoid.html">PermutSetoid</a></li>
<li><a href="Stdlib.Sorting.Permutation.html">Permutation</a></li>
<li><a href="Stdlib.Sorting.SetoidList.html">SetoidList</a></li>
<li><a href="Stdlib.Sorting.SetoidPermutation.html">SetoidPermutation</a></li>
<li><a href="Stdlib.Sorting.Sorted.html">Sorted</a></li>
<li><a href="Stdlib.Sorting.Sorting.html">Sorting</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Streams"><summary>Streams</summary>
          <ul>
          <li><a href="Stdlib.Streams.StreamMemo.html">StreamMemo</a></li>
<li><a href="Stdlib.Streams.Streams.html">Streams</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Stdlib.Strings.Ascii.html">Ascii</a></li>
<li><a href="Stdlib.Strings.BinaryString.html">BinaryString</a></li>
<li><a href="Stdlib.Strings.Byte.html">Byte</a></li>
<li><a href="Stdlib.Strings.HexString.html">HexString</a></li>
<li><a href="Stdlib.Strings.OctalString.html">OctalString</a></li>
<li><a href="Stdlib.Strings.PString.html">PString</a></li>
<li><a href="Stdlib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Stdlib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="Stdlib.Strings.String.html">String</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Structures"><summary>Structures</summary>
          <ul>
          <li><a href="Stdlib.Structures.BoolOrder.html">BoolOrder</a></li>
<li><a href="Stdlib.Structures.DecidableType.html">DecidableType</a></li>
<li><a href="Stdlib.Structures.DecidableTypeEx.html">DecidableTypeEx</a></li>
<li><a href="Stdlib.Structures.Equalities.html">Equalities</a></li>
<li><a href="Stdlib.Structures.EqualitiesFacts.html">EqualitiesFacts</a></li>
<li><a href="Stdlib.Structures.GenericMinMax.html">GenericMinMax</a></li>
<li><a href="Stdlib.Structures.OrderedType.html">OrderedType</a></li>
<li><a href="Stdlib.Structures.OrderedTypeAlt.html">OrderedTypeAlt</a></li>
<li><a href="Stdlib.Structures.OrderedTypeEx.html">OrderedTypeEx</a></li>
<li><a href="Stdlib.Structures.Orders.html">Orders</a></li>
<li><a href="Stdlib.Structures.OrdersAlt.html">OrdersAlt</a></li>
<li><a href="Stdlib.Structures.OrdersEx.html">OrdersEx</a></li>
<li><a href="Stdlib.Structures.OrdersFacts.html">OrdersFacts</a></li>
<li><a href="Stdlib.Structures.OrdersLists.html">OrdersLists</a></li>
<li><a href="Stdlib.Structures.OrdersTac.html">OrdersTac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Unicode"><summary>Unicode</summary>
          <ul>
          <li><a href="Stdlib.Unicode.Utf8.html">Utf8</a></li>
<li><a href="Stdlib.Unicode.Utf8_core.html">Utf8_core</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Vectors"><summary>Vectors</summary>
          <ul>
          <li><a href="Stdlib.Vectors.Bvector.html">Bvector</a></li>
<li><a href="Stdlib.Vectors.Fin.html">Fin</a></li>
<li><a href="Stdlib.Vectors.FinFun.html">FinFun</a></li>
<li><a href="Stdlib.Vectors.Vector.html">Vector</a></li>
<li><a href="Stdlib.Vectors.VectorDef.html">VectorDef</a></li>
<li><a href="Stdlib.Vectors.VectorEq.html">VectorEq</a></li>
<li><a href="Stdlib.Vectors.VectorSpec.html">VectorSpec</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Wellfounded"><summary>Wellfounded</summary>
          <ul>
          <li><a href="Stdlib.Wellfounded.Disjoint_Union.html">Disjoint_Union</a></li>
<li><a href="Stdlib.Wellfounded.Inclusion.html">Inclusion</a></li>
<li><a href="Stdlib.Wellfounded.Inverse_Image.html">Inverse_Image</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Exponentiation.html">Lexicographic_Exponentiation</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Product.html">Lexicographic_Product</a></li>
<li><a href="Stdlib.Wellfounded.List_Extension.html">List_Extension</a></li>
<li><a href="Stdlib.Wellfounded.Transitive_Closure.html">Transitive_Closure</a></li>
<li><a href="Stdlib.Wellfounded.Union.html">Union</a></li>
<li><a href="Stdlib.Wellfounded.Well_Ordering.html">Well_Ordering</a></li>
<li><a href="Stdlib.Wellfounded.Wellfounded.html">Wellfounded</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ZArith"><summary>ZArith</summary>
          <ul>
          <li><a href="Stdlib.ZArith.BinInt.html">BinInt</a></li>
<li><a href="Stdlib.ZArith.BinIntDef.html">BinIntDef</a></li>
<li><a href="Stdlib.ZArith.Int.html">Int</a></li>
<li><a href="Stdlib.ZArith.Wf_Z.html">Wf_Z</a></li>
<li><a href="Stdlib.ZArith.ZArith.html">ZArith</a></li>
<li><a href="Stdlib.ZArith.ZArith_base.html">ZArith_base</a></li>
<li><a href="Stdlib.ZArith.ZArith_dec.html">ZArith_dec</a></li>
<li><a href="Stdlib.ZArith.Zabs.html">Zabs</a></li>
<li><a href="Stdlib.ZArith.Zbitwise.html">Zbitwise</a></li>
<li><a href="Stdlib.ZArith.Zbool.html">Zbool</a></li>
<li><a href="Stdlib.ZArith.Zcompare.html">Zcompare</a></li>
<li><a href="Stdlib.ZArith.Zcomplements.html">Zcomplements</a></li>
<li><a href="Stdlib.ZArith.Zdiv.html">Zdiv</a></li>
<li><a href="Stdlib.ZArith.Zdiv_facts.html">Zdiv_facts</a></li>
<li><a href="Stdlib.ZArith.Zeuclid.html">Zeuclid</a></li>
<li><a href="Stdlib.ZArith.Zeven.html">Zeven</a></li>
<li><a href="Stdlib.ZArith.Zgcd_alt.html">Zgcd_alt</a></li>
<li><a href="Stdlib.ZArith.Zhints.html">Zhints</a></li>
<li><a href="Stdlib.ZArith.Zmax.html">Zmax</a></li>
<li><a href="Stdlib.ZArith.Zmin.html">Zmin</a></li>
<li><a href="Stdlib.ZArith.Zminmax.html">Zminmax</a></li>
<li><a href="Stdlib.ZArith.Zmisc.html">Zmisc</a></li>
<li><a href="Stdlib.ZArith.Znat.html">Znat</a></li>
<li><a href="Stdlib.ZArith.Znumtheory.html">Znumtheory</a></li>
<li><a href="Stdlib.ZArith.Zorder.html">Zorder</a></li>
<li><a href="Stdlib.ZArith.Zpow_alt.html">Zpow_alt</a></li>
<li><a href="Stdlib.ZArith.Zpow_def.html">Zpow_def</a></li>
<li><a href="Stdlib.ZArith.Zpow_facts.html">Zpow_facts</a></li>
<li><a href="Stdlib.ZArith.Zpower.html">Zpower</a></li>
<li><a href="Stdlib.ZArith.Zquot.html">Zquot</a></li>
<li><a href="Stdlib.ZArith.Zwf.html">Zwf</a></li>
<li><a href="Stdlib.ZArith.auxiliary.html">auxiliary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.btauto"><summary>btauto</summary>
          <ul>
          <li><a href="Stdlib.btauto.Algebra.html">Algebra</a></li>
<li><a href="Stdlib.btauto.Btauto.html">Btauto</a></li>
<li><a href="Stdlib.btauto.Reflect.html">Reflect</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Stdlib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Stdlib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInt.html">ExtrHaskellNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInteger.html">ExtrHaskellNatInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatNum.html">ExtrHaskellNatNum</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellString.html">ExtrHaskellString</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInt.html">ExtrHaskellZInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInteger.html">ExtrHaskellZInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZNum.html">ExtrHaskellZNum</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlFloats.html">ExtrOCamlFloats</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlInt63.html">ExtrOCamlInt63</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPArray.html">ExtrOCamlPArray</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPString.html">ExtrOCamlPString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlChar.html">ExtrOcamlChar</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlIntConv.html">ExtrOcamlIntConv</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatBigInt.html">ExtrOcamlNatBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatInt.html">ExtrOcamlNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNativeString.html">ExtrOcamlNativeString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlString.html">ExtrOcamlString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZBigInt.html">ExtrOcamlZBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZInt.html">ExtrOcamlZInt</a></li>
<li><a href="Stdlib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.funind"><summary>funind</summary>
          <ul>
          <li><a href="Stdlib.funind.FunInd.html">FunInd</a></li>
<li><a href="Stdlib.funind.Recdef.html">Recdef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.micromega"><summary>micromega</summary>
          <ul>
          <li><a href="Stdlib.micromega.DeclConstant.html">DeclConstant</a></li>
<li><a href="Stdlib.micromega.DeclConstantZ.html">DeclConstantZ</a></li>
<li><a href="Stdlib.micromega.Env.html">Env</a></li>
<li><a href="Stdlib.micromega.EnvRing.html">EnvRing</a></li>
<li><a href="Stdlib.micromega.Fourier.html">Fourier</a></li>
<li><a href="Stdlib.micromega.Fourier_util.html">Fourier_util</a></li>
<li><a href="Stdlib.micromega.Lia.html">Lia</a></li>
<li><a href="Stdlib.micromega.Lqa.html">Lqa</a></li>
<li><a href="Stdlib.micromega.Lra.html">Lra</a></li>
<li><a href="Stdlib.micromega.OrderedRing.html">OrderedRing</a></li>
<li><a href="Stdlib.micromega.Psatz.html">Psatz</a></li>
<li><a href="Stdlib.micromega.QMicromega.html">QMicromega</a></li>
<li><a href="Stdlib.micromega.RMicromega.html">RMicromega</a></li>
<li><a href="Stdlib.micromega.Refl.html">Refl</a></li>
<li><a href="Stdlib.micromega.RingMicromega.html">RingMicromega</a></li>
<li><a href="Stdlib.micromega.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.micromega.VarMap.html">VarMap</a></li>
<li><a href="Stdlib.micromega.ZArith_hints.html">ZArith_hints</a></li>
<li><a href="Stdlib.micromega.ZCoeff.html">ZCoeff</a></li>
<li><a href="Stdlib.micromega.ZMicromega.html">ZMicromega</a></li>
<li><a href="Stdlib.micromega.Zify.html">Zify</a></li>
<li><a href="Stdlib.micromega.ZifyBool.html">ZifyBool</a></li>
<li><a href="Stdlib.micromega.ZifyClasses.html">ZifyClasses</a></li>
<li><a href="Stdlib.micromega.ZifyComparison.html">ZifyComparison</a></li>
<li><a href="Stdlib.micromega.ZifyInst.html">ZifyInst</a></li>
<li><a href="Stdlib.micromega.ZifyN.html">ZifyN</a></li>
<li><a href="Stdlib.micromega.ZifyNat.html">ZifyNat</a></li>
<li><a href="Stdlib.micromega.ZifyPow.html">ZifyPow</a></li>
<li><a href="Stdlib.micromega.ZifySint63.html">ZifySint63</a></li>
<li><a href="Stdlib.micromega.ZifyUint63.html">ZifyUint63</a></li>
<li><a href="Stdlib.micromega.Ztac.html">Ztac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.nsatz"><summary>nsatz</summary>
          <ul>
          <li><a href="Stdlib.nsatz.NsatzTactic.html">NsatzTactic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.omega"><summary>omega</summary>
          <ul>
          <li><a href="Stdlib.omega.OmegaLemmas.html">OmegaLemmas</a></li>
<li><a href="Stdlib.omega.PreOmega.html">PreOmega</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.rtauto"><summary>rtauto</summary>
          <ul>
          <li><a href="Stdlib.rtauto.Bintree.html">Bintree</a></li>
<li><a href="Stdlib.rtauto.Rtauto.html">Rtauto</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.setoid_ring"><summary>setoid_ring</summary>
          <ul>
          <li><a href="Stdlib.setoid_ring.Algebra_syntax.html">Algebra_syntax</a></li>
<li><a href="Stdlib.setoid_ring.ArithRing.html">ArithRing</a></li>
<li><a href="Stdlib.setoid_ring.BinList.html">BinList</a></li>
<li><a href="Stdlib.setoid_ring.Cring.html">Cring</a></li>
<li><a href="Stdlib.setoid_ring.Field.html">Field</a></li>
<li><a href="Stdlib.setoid_ring.Field_tac.html">Field_tac</a></li>
<li><a href="Stdlib.setoid_ring.Field_theory.html">Field_theory</a></li>
<li><a href="Stdlib.setoid_ring.InitialRing.html">InitialRing</a></li>
<li><a href="Stdlib.setoid_ring.Integral_domain.html">Integral_domain</a></li>
<li><a href="Stdlib.setoid_ring.NArithRing.html">NArithRing</a></li>
<li><a href="Stdlib.setoid_ring.Ncring.html">Ncring</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_initial.html">Ncring_initial</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_polynom.html">Ncring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_tac.html">Ncring_tac</a></li>
<li><a href="Stdlib.setoid_ring.RealField.html">RealField</a></li>
<li><a href="Stdlib.setoid_ring.Ring.html">Ring</a></li>
<li><a href="Stdlib.setoid_ring.Ring_base.html">Ring_base</a></li>
<li><a href="Stdlib.setoid_ring.Ring_polynom.html">Ring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ring_tac.html">Ring_tac</a></li>
<li><a href="Stdlib.setoid_ring.Ring_theory.html">Ring_theory</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Q.html">Rings_Q</a></li>
<li><a href="Stdlib.setoid_ring.Rings_R.html">Rings_R</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Z.html">Rings_Z</a></li>
<li><a href="Stdlib.setoid_ring.ZArithRing.html">ZArithRing</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Stdlib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Stdlib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Stdlib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Stdlib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Stdlib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Stdlib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Stdlib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi"><summary>elpi</summary>
          <ul>
          <li><details id="elpi.apps"><summary>apps</summary>
          <ul>
          <li><details id="elpi.apps.NES"><summary>NES</summary>
          <ul>
          <li><details id="elpi.apps.NES.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.NES.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.NES.NES.html">NES</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.coercion"><summary>coercion</summary>
          <ul>
          <li><a href="elpi.apps.coercion.coercion.html">coercion</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.cs"><summary>cs</summary>
          <ul>
          <li><a href="elpi.apps.cs.cs.html">cs</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive"><summary>derive</summary>
          <ul>
          <li><details id="elpi.apps.derive.derive"><summary>derive</summary>
          <ul>
          <li><a href="elpi.apps.derive.derive.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="elpi.apps.derive.derive.bcongr.html">bcongr</a></li>
<li><a href="elpi.apps.derive.derive.cast.html">cast</a></li>
<li><a href="elpi.apps.derive.derive.eq.html">eq</a></li>
<li><a href="elpi.apps.derive.derive.eqK.html">eqK</a></li>
<li><a href="elpi.apps.derive.derive.eqOK.html">eqOK</a></li>
<li><a href="elpi.apps.derive.derive.eqType_ast.html">eqType_ast</a></li>
<li><a href="elpi.apps.derive.derive.eqb.html">eqb</a></li>
<li><a href="elpi.apps.derive.derive.eqbOK.html">eqbOK</a></li>
<li><a href="elpi.apps.derive.derive.eqb_core_defs.html">eqb_core_defs</a></li>
<li><a href="elpi.apps.derive.derive.eqbcorrect.html">eqbcorrect</a></li>
<li><a href="elpi.apps.derive.derive.eqcorrect.html">eqcorrect</a></li>
<li><a href="elpi.apps.derive.derive.experimental.html">experimental</a></li>
<li><a href="elpi.apps.derive.derive.fields.html">fields</a></li>
<li><a href="elpi.apps.derive.derive.idx2inv.html">idx2inv</a></li>
<li><a href="elpi.apps.derive.derive.induction.html">induction</a></li>
<li><a href="elpi.apps.derive.derive.invert.html">invert</a></li>
<li><a href="elpi.apps.derive.derive.isK.html">isK</a></li>
<li><a href="elpi.apps.derive.derive.legacy.html">legacy</a></li>
<li><a href="elpi.apps.derive.derive.lens.html">lens</a></li>
<li><a href="elpi.apps.derive.derive.lens_laws.html">lens_laws</a></li>
<li><a href="elpi.apps.derive.derive.map.html">map</a></li>
<li><a href="elpi.apps.derive.derive.param1.html">param1</a></li>
<li><a href="elpi.apps.derive.derive.param1_congr.html">param1_congr</a></li>
<li><a href="elpi.apps.derive.derive.param1_functor.html">param1_functor</a></li>
<li><a href="elpi.apps.derive.derive.param1_trivial.html">param1_trivial</a></li>
<li><a href="elpi.apps.derive.derive.param2.html">param2</a></li>
<li><a href="elpi.apps.derive.derive.projK.html">projK</a></li>
<li><a href="elpi.apps.derive.derive.std.html">std</a></li>
<li><a href="elpi.apps.derive.derive.tag.html">tag</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.derive.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.derive.derive.html">derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.eltac"><summary>eltac</summary>
          <ul>
          <li><a href="elpi.apps.eltac.apply.html">apply</a></li>
<li><a href="elpi.apps.eltac.assumption.html">assumption</a></li>
<li><a href="elpi.apps.eltac.case.html">case</a></li>
<li><a href="elpi.apps.eltac.clear.html">clear</a></li>
<li><a href="elpi.apps.eltac.constructor.html">constructor</a></li>
<li><a href="elpi.apps.eltac.cycle.html">cycle</a></li>
<li><a href="elpi.apps.eltac.discriminate.html">discriminate</a></li>
<li><a href="elpi.apps.eltac.fail.html">fail</a></li>
<li><a href="elpi.apps.eltac.generalize.html">generalize</a></li>
<li><a href="elpi.apps.eltac.injection.html">injection</a></li>
<li><a href="elpi.apps.eltac.intro.html">intro</a></li>
<li><a href="elpi.apps.eltac.rewrite.html">rewrite</a></li>
<li><a href="elpi.apps.eltac.tactics.html">tactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.locker"><summary>locker</summary>
          <ul>
          <li><details id="elpi.apps.locker.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.locker.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.locker.locker.html">locker</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.rbuild"><summary>rbuild</summary>
          <ul>
          <li><details id="elpi.apps.rbuild.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.rbuild.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.rbuild.rbuild.html">rbuild</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.tc"><summary>tc</summary>
          <ul>
          <li><details id="elpi.apps.tc.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.tc.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.tc.add_commands.html">add_commands</a></li>
<li><a href="elpi.apps.tc.db.html">db</a></li>
<li><a href="elpi.apps.tc.tc.html">tc</a></li>
<li><a href="elpi.apps.tc.wip.html">wip</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi.core"><summary>core</summary>
          <ul>
          <li><a href="elpi.core.Bool.html">Bool</a></li>
<li><a href="elpi.core.ListDef.html">ListDef</a></li>
<li><a href="elpi.core.Morphisms.html">Morphisms</a></li>
<li><a href="elpi.core.PosDef.html">PosDef</a></li>
<li><a href="elpi.core.PrimFloat.html">PrimFloat</a></li>
<li><a href="elpi.core.PrimInt63.html">PrimInt63</a></li>
<li><a href="elpi.core.PrimString.html">PrimString</a></li>
<li><a href="elpi.core.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="elpi.core.RelationClasses.html">RelationClasses</a></li>
<li><a href="elpi.core.Setoid.html">Setoid</a></li>
<li><a href="elpi.core.Uint63Axioms.html">Uint63Axioms</a></li>
<li><a href="elpi.core.ssrbool.html">ssrbool</a></li>
<li><a href="elpi.core.ssreflect.html">ssreflect</a></li>
<li><a href="elpi.core.ssrfun.html">ssrfun</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.elpi.html">elpi</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_elpi"><summary>elpi_elpi</summary>
          <ul>
          <li><a href="elpi_elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_examples"><summary>elpi_examples</summary>
          <ul>
          <li><a href="elpi_examples.example_abs_evars.html">example_abs_evars</a></li>
<li><a href="elpi_examples.example_curry_howard_tactics.html">example_curry_howard_tactics</a></li>
<li><a href="elpi_examples.example_data_base.html">example_data_base</a></li>
<li><a href="elpi_examples.example_fuzzer.html">example_fuzzer</a></li>
<li><a href="elpi_examples.example_generalize.html">example_generalize</a></li>
<li><a href="elpi_examples.example_import_projections.html">example_import_projections</a></li>
<li><a href="elpi_examples.example_record_expansion.html">example_record_expansion</a></li>
<li><a href="elpi_examples.example_record_to_sigma.html">example_record_to_sigma</a></li>
<li><a href="elpi_examples.example_reduction_surgery.html">example_reduction_surgery</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_HOAS.html">tutorial_coq_elpi_HOAS</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_command.html">tutorial_coq_elpi_command</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_tactic.html">tutorial_coq_elpi_tactic</a></li>
<li><a href="elpi_examples.tutorial_elpi_lang.html">tutorial_elpi_lang</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp"><summary>mathcomp</summary>
          <ul>
          <li><details id="mathcomp.algebra"><summary>algebra</summary>
          <ul>
          <li><a href="mathcomp.algebra.all_algebra.html">all_algebra</a></li>
<li><a href="mathcomp.algebra.archimedean.html">archimedean</a></li>
<li><a href="mathcomp.algebra.countalg.html">countalg</a></li>
<li><a href="mathcomp.algebra.finalg.html">finalg</a></li>
<li><a href="mathcomp.algebra.fraction.html">fraction</a></li>
<li><a href="mathcomp.algebra.intdiv.html">intdiv</a></li>
<li><a href="mathcomp.algebra.interval.html">interval</a></li>
<li><a href="mathcomp.algebra.interval_inference.html">interval_inference</a></li>
<li><a href="mathcomp.algebra.matrix.html">matrix</a></li>
<li><a href="mathcomp.algebra.mxalgebra.html">mxalgebra</a></li>
<li><a href="mathcomp.algebra.mxpoly.html">mxpoly</a></li>
<li><a href="mathcomp.algebra.mxred.html">mxred</a></li>
<li><a href="mathcomp.algebra.poly.html">poly</a></li>
<li><a href="mathcomp.algebra.polyXY.html">polyXY</a></li>
<li><a href="mathcomp.algebra.polydiv.html">polydiv</a></li>
<li><a href="mathcomp.algebra.qpoly.html">qpoly</a></li>
<li><a href="mathcomp.algebra.rat.html">rat</a></li>
<li><a href="mathcomp.algebra.ring_quotient.html">ring_quotient</a></li>
<li><a href="mathcomp.algebra.sesquilinear.html">sesquilinear</a></li>
<li><a href="mathcomp.algebra.spectral.html">spectral</a></li>
<li><a href="mathcomp.algebra.ssralg.html">ssralg</a></li>
<li><a href="mathcomp.algebra.ssrint.html">ssrint</a></li>
<li><a href="mathcomp.algebra.ssrnum.html">ssrnum</a></li>
<li><a href="mathcomp.algebra.vector.html">vector</a></li>
<li><a href="mathcomp.algebra.zmodp.html">zmodp</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis"><summary>analysis</summary>
          <ul>
          <li><details id="mathcomp.analysis.homotopy_theory"><summary>homotopy_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.homotopy_theory.continuous_path.html">continuous_path</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.homotopy.html">homotopy</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.wedge_sigT.html">wedge_sigT</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.lebesgue_integral_theory"><summary>lebesgue_integral_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_Rintegral.html">lebesgue_Rintegral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integrable.html">lebesgue_integrable</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral.html">lebesgue_integral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_definition.html">lebesgue_integral_definition</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_differentiation.html">lebesgue_integral_differentiation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_dominated_convergence.html">lebesgue_integral_dominated_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_fubini.html">lebesgue_integral_fubini</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_monotone_convergence.html">lebesgue_integral_monotone_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_nonneg.html">lebesgue_integral_nonneg</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_under.html">lebesgue_integral_under</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.measurable_fun_approximation.html">measurable_fun_approximation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.simple_functions.html">simple_functions</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.measure_theory"><summary>measure_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.measure_theory.counting_measure.html">counting_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.dirac_measure.html">dirac_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_function.html">measurable_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_structure.html">measurable_structure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure.html">measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_extension.html">measure_extension</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_function.html">measure_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_negligible.html">measure_negligible</a></li>
<li><a href="mathcomp.analysis.measure_theory.probability_measure.html">probability_measure</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.normedtype_theory"><summary>normedtype_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.normedtype_theory.complete_normed_module.html">complete_normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.ereal_normedtype.html">ereal_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.matrix_normedtype.html">matrix_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normed_module.html">normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normedtype.html">normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.num_normedtype.html">num_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.pseudometric_normed_Zmodule.html">pseudometric_normed_Zmodule</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.urysohn.html">urysohn</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.vitali_lemma.html">vitali_lemma</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis.showcase.pnt.html">pnt</a></li>
<li><a href="mathcomp.analysis.showcase.summability.html">summability</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.topology_theory"><summary>topology_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.topology_theory.bool_topology.html">bool_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.compact.html">compact</a></li>
<li><a href="mathcomp.analysis.topology_theory.connected.html">connected</a></li>
<li><a href="mathcomp.analysis.topology_theory.discrete_topology.html">discrete_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.matrix_topology.html">matrix_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.nat_topology.html">nat_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.num_topology.html">num_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.one_point_compactification.html">one_point_compactification</a></li>
<li><a href="mathcomp.analysis.topology_theory.order_topology.html">order_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.product_topology.html">product_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.pseudometric_structure.html">pseudometric_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.quotient_topology.html">quotient_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.separation_axioms.html">separation_axioms</a></li>
<li><a href="mathcomp.analysis.topology_theory.sigT_topology.html">sigT_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subspace_topology.html">subspace_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subtype_topology.html">subtype_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.supremum_topology.html">supremum_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology.html">topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology_structure.html">topology_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.uniform_structure.html">uniform_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.weak_topology.html">weak_topology</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis.all_analysis.html">all_analysis</a></li>
<li><a href="mathcomp.analysis.borel_hierarchy.html">borel_hierarchy</a></li>
<li><a href="mathcomp.analysis.cantor.html">cantor</a></li>
<li><a href="mathcomp.analysis.charge.html">charge</a></li>
<li><a href="mathcomp.analysis.convex.html">convex</a></li>
<li><a href="mathcomp.analysis.derive.html">derive</a></li>
<li><a href="mathcomp.analysis.ereal.html">ereal</a></li>
<li><a href="mathcomp.analysis.ess_sup_inf.html">ess_sup_inf</a></li>
<li><a href="mathcomp.analysis.esum.html">esum</a></li>
<li><a href="mathcomp.analysis.exp.html">exp</a></li>
<li><a href="mathcomp.analysis.ftc.html">ftc</a></li>
<li><a href="mathcomp.analysis.function_spaces.html">function_spaces</a></li>
<li><a href="mathcomp.analysis.gauss_integral.html">gauss_integral</a></li>
<li><a href="mathcomp.analysis.hoelder.html">hoelder</a></li>
<li><a href="mathcomp.analysis.kernel.html">kernel</a></li>
<li><a href="mathcomp.analysis.landau.html">landau</a></li>
<li><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></li>
<li><a href="mathcomp.analysis.lebesgue_stieltjes_measure.html">lebesgue_stieltjes_measure</a></li>
<li><a href="mathcomp.analysis.measurable_realfun.html">measurable_realfun</a></li>
<li><a href="mathcomp.analysis.numfun.html">numfun</a></li>
<li><a href="mathcomp.analysis.pi_irrational.html">pi_irrational</a></li>
<li><a href="mathcomp.analysis.probability.html">probability</a></li>
<li><a href="mathcomp.analysis.realfun.html">realfun</a></li>
<li><a href="mathcomp.analysis.sequences.html">sequences</a></li>
<li><a href="mathcomp.analysis.trigo.html">trigo</a></li>
<li><a href="mathcomp.analysis.tvs.html">tvs</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis_stdlib"><summary>analysis_stdlib</summary>
          <ul>
          <li><details id="mathcomp.analysis_stdlib.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis_stdlib.showcase.uniform_bigO.html">uniform_bigO</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis_stdlib.Rstruct_topology.html">Rstruct_topology</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.bigenough"><summary>bigenough</summary>
          <ul>
          <li><a href="mathcomp.bigenough.bigenough.html">bigenough</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.classical"><summary>classical</summary>
          <ul>
          <li><a href="mathcomp.classical.all_classical.html">all_classical</a></li>
<li><a href="mathcomp.classical.boolp.html">boolp</a></li>
<li><a href="mathcomp.classical.cardinality.html">cardinality</a></li>
<li><a href="mathcomp.classical.classical_orders.html">classical_orders</a></li>
<li><a href="mathcomp.classical.classical_sets.html">classical_sets</a></li>
<li><a href="mathcomp.classical.contra.html">contra</a></li>
<li><a href="mathcomp.classical.filter.html">filter</a></li>
<li><a href="mathcomp.classical.fsbigop.html">fsbigop</a></li>
<li><a href="mathcomp.classical.functions.html">functions</a></li>
<li><a href="mathcomp.classical.internal_Eqdep_dec.html">internal_Eqdep_dec</a></li>
<li><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></li>
<li><a href="mathcomp.classical.set_interval.html">set_interval</a></li>
<li><a href="mathcomp.classical.unstable.html">unstable</a></li>
<li><a href="mathcomp.classical.wochoice.html">wochoice</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.experimental_reals"><summary>experimental_reals</summary>
          <ul>
          <li><a href="mathcomp.experimental_reals.discrete.html">discrete</a></li>
<li><a href="mathcomp.experimental_reals.distr.html">distr</a></li>
<li><a href="mathcomp.experimental_reals.realseq.html">realseq</a></li>
<li><a href="mathcomp.experimental_reals.realsum.html">realsum</a></li>
<li><a href="mathcomp.experimental_reals.xfinmap.html">xfinmap</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.field"><summary>field</summary>
          <ul>
          <li><a href="mathcomp.field.algC.html">algC</a></li>
<li><a href="mathcomp.field.algebraics_fundamentals.html">algebraics_fundamentals</a></li>
<li><a href="mathcomp.field.algnum.html">algnum</a></li>
<li><a href="mathcomp.field.all_field.html">all_field</a></li>
<li><a href="mathcomp.field.closed_field.html">closed_field</a></li>
<li><a href="mathcomp.field.cyclotomic.html">cyclotomic</a></li>
<li><a href="mathcomp.field.falgebra.html">falgebra</a></li>
<li><a href="mathcomp.field.fieldext.html">fieldext</a></li>
<li><a href="mathcomp.field.finfield.html">finfield</a></li>
<li><a href="mathcomp.field.galois.html">galois</a></li>
<li><a href="mathcomp.field.qfpoly.html">qfpoly</a></li>
<li><a href="mathcomp.field.separable.html">separable</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.fingroup"><summary>fingroup</summary>
          <ul>
          <li><a href="mathcomp.fingroup.action.html">action</a></li>
<li><a href="mathcomp.fingroup.all_fingroup.html">all_fingroup</a></li>
<li><a href="mathcomp.fingroup.automorphism.html">automorphism</a></li>
<li><a href="mathcomp.fingroup.fingroup.html">fingroup</a></li>
<li><a href="mathcomp.fingroup.gproduct.html">gproduct</a></li>
<li><a href="mathcomp.fingroup.morphism.html">morphism</a></li>
<li><a href="mathcomp.fingroup.perm.html">perm</a></li>
<li><a href="mathcomp.fingroup.presentation.html">presentation</a></li>
<li><a href="mathcomp.fingroup.quotient.html">quotient</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.finmap"><summary>finmap</summary>
          <ul>
          <li><a href="mathcomp.finmap.finmap.html">finmap</a></li>
<li><a href="mathcomp.finmap.multiset.html">multiset</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals"><summary>reals</summary>
          <ul>
          <li><a href="mathcomp.reals.all_reals.html">all_reals</a></li>
<li><a href="mathcomp.reals.constructive_ereal.html">constructive_ereal</a></li>
<li><a href="mathcomp.reals.prodnormedzmodule.html">prodnormedzmodule</a></li>
<li><a href="mathcomp.reals.real_interval.html">real_interval</a></li>
<li><a href="mathcomp.reals.reals.html">reals</a></li>
<li><a href="mathcomp.reals.signed.html">signed</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals_stdlib"><summary>reals_stdlib</summary>
          <ul>
          <li><a href="mathcomp.reals_stdlib.Rstruct.html">Rstruct</a></li>
<li><a href="mathcomp.reals_stdlib.nsatz_realtype.html">nsatz_realtype</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.solvable"><summary>solvable</summary>
          <ul>
          <li><a href="mathcomp.solvable.abelian.html">abelian</a></li>
<li><a href="mathcomp.solvable.all_solvable.html">all_solvable</a></li>
<li><a href="mathcomp.solvable.alt.html">alt</a></li>
<li><a href="mathcomp.solvable.burnside_app.html">burnside_app</a></li>
<li><a href="mathcomp.solvable.center.html">center</a></li>
<li><a href="mathcomp.solvable.commutator.html">commutator</a></li>
<li><a href="mathcomp.solvable.cyclic.html">cyclic</a></li>
<li><a href="mathcomp.solvable.extraspecial.html">extraspecial</a></li>
<li><a href="mathcomp.solvable.extremal.html">extremal</a></li>
<li><a href="mathcomp.solvable.finmodule.html">finmodule</a></li>
<li><a href="mathcomp.solvable.frobenius.html">frobenius</a></li>
<li><a href="mathcomp.solvable.gfunctor.html">gfunctor</a></li>
<li><a href="mathcomp.solvable.gseries.html">gseries</a></li>
<li><a href="mathcomp.solvable.hall.html">hall</a></li>
<li><a href="mathcomp.solvable.jordanholder.html">jordanholder</a></li>
<li><a href="mathcomp.solvable.maximal.html">maximal</a></li>
<li><a href="mathcomp.solvable.nilpotent.html">nilpotent</a></li>
<li><a href="mathcomp.solvable.pgroup.html">pgroup</a></li>
<li><a href="mathcomp.solvable.primitive_action.html">primitive_action</a></li>
<li><a href="mathcomp.solvable.sylow.html">sylow</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.ssreflect"><summary>ssreflect</summary>
          <ul>
          <li><a href="mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></li>
<li><a href="mathcomp.ssreflect.bigop.html">bigop</a></li>
<li><a href="mathcomp.ssreflect.binomial.html">binomial</a></li>
<li><a href="mathcomp.ssreflect.choice.html">choice</a></li>
<li><a href="mathcomp.ssreflect.div.html">div</a></li>
<li><a href="mathcomp.ssreflect.eqtype.html">eqtype</a></li>
<li><a href="mathcomp.ssreflect.finfun.html">finfun</a></li>
<li><a href="mathcomp.ssreflect.fingraph.html">fingraph</a></li>
<li><a href="mathcomp.ssreflect.finset.html">finset</a></li>
<li><a href="mathcomp.ssreflect.fintype.html">fintype</a></li>
<li><a href="mathcomp.ssreflect.generic_quotient.html">generic_quotient</a></li>
<li><a href="mathcomp.ssreflect.order.html">order</a></li>
<li><a href="mathcomp.ssreflect.path.html">path</a></li>
<li><a href="mathcomp.ssreflect.prime.html">prime</a></li>
<li><a href="mathcomp.ssreflect.seq.html">seq</a></li>
<li><a href="mathcomp.ssreflect.ssrAC.html">ssrAC</a></li>
<li><a href="mathcomp.ssreflect.ssrbool.html">ssrbool</a></li>
<li><a href="mathcomp.ssreflect.ssreflect.html">ssreflect</a></li>
<li><a href="mathcomp.ssreflect.ssrfun.html">ssrfun</a></li>
<li><a href="mathcomp.ssreflect.ssrmatching.html">ssrmatching</a></li>
<li><a href="mathcomp.ssreflect.ssrnat.html">ssrnat</a></li>
<li><a href="mathcomp.ssreflect.ssrnotations.html">ssrnotations</a></li>
<li><a href="mathcomp.ssreflect.tuple.html">tuple</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.ssrnum</h1>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> ssreflect</span><span class="id"> ssrfun</span><span class="id"> ssrbool</span><span class="id"> ssrnotations</span><span class="id"> eqtype</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> ssrnat</span><span class="id"> seq</span><span class="id"> choice</span><span class="id"> ssrAC</span><span class="id"> div</span><span class="id"> fintype</span><span class="id"> path</span><span class="id"> bigop</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> order</span><span class="id"> finset</span><span class="id"> fingroup</span><span class="id"> ssralg</span><span class="id"> poly</span>.<br/>
<br/>
<pre class="ssrdoc">
                           Number structures

NB: See CONTRIBUTING.md for an introduction to HB concepts and commands.

This file defines some classes to manipulate number structures, i.e,
structures with an order and a norm. To use this file, insert
"Import Num.Theory." before your scripts. You can also "Import Num.Def."
to enjoy shorter notations (e.g., minr instead of Num.min, lerif instead
of Num.leif, etc.).

This file defines the following number structures:

 porderZmodType == join of Order.POrder and GRing.Zmodule
                   The HB class is called POrderedZmodule.
 semiNormedZmodType == Zmodule with a semi-norm
                       The HB class is called SemiNormedZmodule.
 normedZmodType == Zmodule with a norm
                   The HB class is called NormedZmodule.
  numDomainType == Integral domain with an order and a norm
                   The HB class is called NumDomain.
   numFieldType == Field with an order and a norm
                   The HB class is called NumField.
numClosedFieldType == Partially ordered Closed Field with conjugation
                   The HB class is called ClosedField.
 realDomainType == Num domain where all elements are positive or negative
                   The HB class is called RealDomain.
  realFieldType == Num Field where all elements are positive or negative
                   The HB class is called RealField.
        rcfType == A Real Field with the real closed axiom
                   The HB class is called RealClosedField.

The ordering symbols and notations (&lt;, &lt;=, &gt;, &gt;=, _ &lt;= _ ?= iff _,
_ &lt; _ ?&lt;= if _, &gt;=&lt;, and &gt;&lt;) and lattice operations (meet and join)
defined in order.v are redefined for the ring_display in the ring_scope
(%R). 0-ary ordering symbols for the ring_display have the suffix "%R",
e.g., &lt;%R. All the other ordering notations are the same as order.v.

Over these structures, we have the following operations:
            `|x| == norm of x
        Num.sg x == sign of x: equal to 0 iff x = 0, to 1 iff x &gt; 0, and
                    to -1 in all other cases (including x &lt; 0)
 x \is a Num.pos &lt;=&gt; x is positive (:= x &gt; 0)
 x \is a Num.neg &lt;=&gt; x is negative (:= x &lt; 0)
x \is a Num.nneg &lt;=&gt; x is positive or 0 (:= x &gt;= 0)
x \is a Num.npos &lt;=&gt; x is negative or 0 (:= x &lt;= 0)
x \is a Num.real &lt;=&gt; x is real (:= x &gt;= 0 or x &lt; 0)
      Num.sqrt x == in a real-closed field, a positive square root of x if
                    x &gt;= 0, or 0 otherwise
For numeric algebraically closed fields we provide the generic definitions
        'i == the imaginary number (:= sqrtC (-1))
     'Re z == the real component of z
     'Im z == the imaginary component of z
       z^* == the complex conjugate of z (:= conjC z)
   sqrtC z == a nonnegative square root of z, i.e., 0 &lt;= sqrt x if 0 &lt;= x
 n.-root z == more generally, for n &gt; 0, an nth root of z, chosen with a
              minimal non-negative argument for n &gt; 1 (i.e., with a
              maximal real part subject to a nonnegative imaginary part)
              Note that n.-root (-1) is a primitive 2nth root of unity,
              an thus not equal to -1 for n odd &gt; 1 (this will be shown in
              file cyclotomic.v).

- list of prefixes :
  p : positive
  n : negative
  sp : strictly positive
  sn : strictly negative
  i : interior = in [0, 1] or ]0, 1[
  e : exterior = in [1, +oo[ or ]1; +oo[
  w : non strict (weak) monotony

Pdeg2.NumClosed : theory of the degree 2 polynomials on NumClosedField.
Pdeg2.NumClosedMonic : theory of Pdeg2.NumClosed specialized to monic
  polynomials.
Pdeg2.Real : theory of the degree 2 polynomials on RealField and rcfType.
Pdeg2.RealMonic : theory of Pdeg2.Real specialized to monic polynomials.
</pre>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;n .-root&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;n .-root&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'i&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 0</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'Re z&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> z</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'Im z&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> z</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> order_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span><span class="id"> GRing</span>.<span class="id">Theory</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> ring_display</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">disp_t</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact</span>. Qed.</div></details>
<br/>
<span class="vernacular">Module</span><span class="id"> Num</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;porderZmodType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> POrderedZmodule</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Order</span>.<span class="id">isPOrder</span><span class="id"> ring_display</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> GRing</span>.<span class="id">Zmodule</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isSemiNormed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> POrderedZmodule</span>.<span class="id">type</span>)<span class="id"> M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> GRing</span>.<span class="id">Zmodule</span><span class="id"> M</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">norm</span><span class="id"> :</span><span class="id"> M</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">ler_normD</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> norm</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> &lt;=</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> +</span><span class="id"> norm</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">normrMn</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> n,</span><span class="id"> norm</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n;</span><br/>
&nbsp;&nbsp;<span class="id">normrN</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> norm</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> norm</span><span class="id"> x;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;semiNormedZmodType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SemiNormedZmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> porderZmodType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> M</span><span class="id"> of</span><span class="id"> Zmodule_isSemiNormed</span><span class="id"> R</span><span class="id"> M</span><span class="id"> &amp;</span><span class="id"> GRing</span>.<span class="id">Zmodule</span><span class="id"> M</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> SemiNormedZmodule_isPositiveDefinite</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> POrderedZmodule</span>.<span class="id">type</span>)<span class="id"> M</span><span class="id"> of</span><span class="id"> @SemiNormedZmodule</span><span class="id"> R</span><span class="id"> M</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">normr0_eq0</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> M,</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;normedZmodType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> NormedZmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> porderZmodType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> M</span><span class="id"> of</span><span class="id"> SemiNormedZmodule_isPositiveDefinite</span><span class="id"> R</span><span class="id"> M</span><span class="id"> &amp;</span><span class="id"> SemiNormedZmodule</span><span class="id"> R</span><span class="id"> M</span><span class="id"> }</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> norm</span><span class="id"> {R</span><span class="id"> M}</span><span class="id"> x</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isNormed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> POrderedZmodule</span>.<span class="id">type</span>)<span class="id"> M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> GRing</span>.<span class="id">Zmodule</span><span class="id"> M</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">norm</span><span class="id"> :</span><span class="id"> M</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">ler_normD</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> norm</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> &lt;=</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> +</span><span class="id"> norm</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">normr0_eq0</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">normrMn</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> n,</span><span class="id"> norm</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n;</span><br/>
&nbsp;&nbsp;<span class="id">normrN</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> norm</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> norm</span><span class="id"> x;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> POrderedZmodule</span>.<span class="id">type</span>)<span class="id"> M</span><span class="id"> of</span><span class="id"> Zmodule_isNormed</span><span class="id"> R</span><span class="id"> M</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Zmodule_isSemiNormed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> M</span><span class="id"> ler_normD</span><span class="id"> normrMn</span><span class="id"> normrN</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">SemiNormedZmodule_isPositiveDefinite</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> M</span><span class="id"> normr0_eq0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NormedZmoduleExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> NormedZmodule</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> NormedZmoduleExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> NormedZmoduleExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isNumRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> GRing</span>.<span class="id">NzRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> POrderedZmodule</span><span class="id"> R</span><br/>
&nbsp;&nbsp;<span class="id">&amp;</span><span class="id"> NormedZmodule</span> (<span class="id">POrderedZmodule</span>.<span class="id">clone</span><span class="id"> R</span><span class="id"> _</span>)<span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;<span class="id">addr_gt0</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;<span class="id">ger_leVge</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">;</span><br/>
&nbsp;<span class="id">normrM</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">norm</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y};</span><br/>
&nbsp;<span class="id">ler_def</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R,</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">norm</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> ==</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>))<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;numDomainType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> NumDomain</span><span class="id"> :=</span><span class="id"> {</span><span class="id"> R</span><span class="id"> of</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">IntegralDomain</span><span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">POrderedZmodule</span><span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NormedZmodule</span> (<span class="id">POrderedZmodule</span>.<span class="id">clone</span><span class="id"> R</span><span class="id"> _</span>)<span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">isNumRing</span><span class="id"> R</span><br/>
&nbsp;&nbsp;<span class="id">}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addr_gt0</span><span class="id"> {_}</span><span class="id"> [x</span><span class="id"> y]</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> ger_leVge</span><span class="id"> {_}</span><span class="id"> [x</span><span class="id"> y]</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NumDomainExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> NumDomain</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> NumDomainExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> NumDomainExports</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Import</span><span class="id"> Def</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> normr</span><span class="id"> :=</span><span class="id"> norm</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">norm</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> ler</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'ler' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> ltr</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'ltr' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> ger</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">ge</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'ger' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">ge</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> gtr</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">gt</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'gtr' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">gt</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> lerif</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">leif</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'lerif' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">leif</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> lterif</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">lteif</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'lteif' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">lteif</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> comparabler</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">comparable</span><span class="id"> ring_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'comparabler' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">comparable</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> maxr</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">max</span><span class="id"> ring_display</span><span class="id"> _</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'maxr' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">max</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> minr</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">min</span><span class="id"> ring_display</span><span class="id"> _</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'minr' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">min</span><span class="id"> ring_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NumDomainDef</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> sgr</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> 0</span><span class="gallina-kwd"> else</span><span class="gallina-kwd"> if</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> -1</span><span class="gallina-kwd"> else</span><span class="id"> 1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rpos_pred</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> =&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rpos</span><span class="id"> :</span><span class="id"> qualifier</span><span class="id"> 0</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> x</span><span class="id"> |</span><span class="id"> Rpos_pred</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rneg_pred</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rneg</span><span class="id"> :</span><span class="id"> qualifier</span><span class="id"> 0</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> |</span><span class="id"> Rneg_pred</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rnneg_pred</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> =&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rnneg</span><span class="id"> :</span><span class="id"> qualifier</span><span class="id"> 0</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> |</span><span class="id"> Rnneg_pred</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rnpos_pred</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rnpos</span><span class="id"> :</span><span class="id"> qualifier</span><span class="id"> 0</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> |</span><span class="id"> Rnpos_pred</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> Rreal_pred</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> =&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> Rreal</span><span class="id"> :</span><span class="id"> qualifier</span><span class="id"> 0</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> |</span><span class="id"> Rreal_pred</span><span class="id"> x]</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NumDomainDef</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Def</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> Rpos_pred</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Rneg_pred</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Rnneg_pred</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Rreal_pred</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> le</span><span class="id"> :=</span><span class="id"> ler</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> lt</span><span class="id"> :=</span><span class="id"> ltr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> ge</span><span class="id"> :=</span><span class="id"> ger</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> gt</span><span class="id"> :=</span><span class="id"> gtr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> leif</span><span class="id"> :=</span><span class="id"> lerif</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> lteif</span><span class="id"> :=</span><span class="id"> lterif</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> comparable</span><span class="id"> :=</span><span class="id"> comparabler</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> sg</span><span class="id"> :=</span><span class="id"> sgr</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> max</span><span class="id"> :=</span><span class="id"> maxr</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> min</span><span class="id"> :=</span><span class="id"> minr</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> pos</span><span class="id"> :=</span><span class="id"> Rpos</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> neg</span><span class="id"> :=</span><span class="id"> Rneg</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> nneg</span><span class="id"> :=</span><span class="id"> Rnneg</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> npos</span><span class="id"> :=</span><span class="id"> Rnpos</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> real</span><span class="id"> :=</span><span class="id"> Rreal</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Import</span><span class="id"> Syntax</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Def</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">norm</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;=%R&quot;</span><span class="id"> :=</span><span class="id"> le</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;=%R&quot;</span><span class="id"> :=</span><span class="id"> ge</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;%R&quot;</span><span class="id"> :=</span><span class="id"> lt</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;%R&quot;</span><span class="id"> :=</span><span class="id"> gt</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;?=%R&quot;</span><span class="id"> :=</span><span class="id"> leif</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;?&lt;=%R&quot;</span><span class="id"> :=</span><span class="id"> lteif</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;=&lt;%R&quot;</span><span class="id"> :=</span><span class="id"> comparable</span><span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;&lt;%R&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> ~~</span> (<span class="id">comparable</span><span class="id"> x</span><span class="id"> y</span>))<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">ge</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;= y :&gt; T&quot;</span><span class="id"> :=</span> (<span class="id">&lt;=</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;= y&quot;</span> <span class="id"> :=</span> (<span class="id">le</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;= y :&gt; T&quot;</span><span class="id"> :=</span> (<span class="id">&gt;=</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt; y&quot;</span><span class="id"> :=</span> (<span class="id">gt</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt; y :&gt; T&quot;</span><span class="id"> :=</span> (<span class="id">&lt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt; y&quot;</span><span class="id"> :=</span> (<span class="id">lt</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt; y :&gt; T&quot;</span><span class="id"> :=</span> (<span class="id">&gt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">le</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y :&gt; T&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> &lt;=</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt;= y&quot;</span><span class="id"> :=</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt;= y :&gt; T&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> &gt;=</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y&quot;</span> <span class="id"> :=</span> (<span class="id">lt</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y :&gt; T&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> &lt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt; y&quot;</span> <span class="id"> :=</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt; y :&gt; T&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> &gt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt;= z&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt;= z&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt; z&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt; z&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y ?= 'iff' C&quot;</span><span class="id"> :=</span> (<span class="id">lerif</span><span class="id"> x</span><span class="id"> y</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y ?= 'iff' C :&gt; R&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> &lt;=</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y ?&lt;= 'if' C&quot;</span><span class="id"> :=</span> (<span class="id">lterif</span><span class="id"> x</span><span class="id"> y</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y ?&lt;= 'if' C :&gt; R&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> &lt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;=&lt; y&quot;</span><span class="id"> :=</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> comparable</span><span class="id"> x</span><span class="id"> y]</span><span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;=&lt; y :&gt; T&quot;</span><span class="id"> :=</span> (<span class="id">&gt;=&lt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt;=&lt; y&quot;</span><span class="id"> :=</span> (<span class="id">comparable</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;&lt; y&quot;</span><span class="id"> :=</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> ~~</span><span class="id"> comparable</span><span class="id"> x</span><span class="id"> y]</span><span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&gt;&lt; y :&gt; T&quot;</span><span class="id"> :=</span> (<span class="id">&gt;&lt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt;&lt; y&quot;</span><span class="id"> :=</span> (<span class="id">~~</span> (<span class="id">comparable</span><span class="id"> x</span><span class="id"> y</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> Order</span>.<span class="id">POCoercions</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Syntax</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ExtensionAxioms</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> numDomainType</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> real_axiom</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> archimedean_axiom</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R,</span><span class="gallina-kwd"> exists</span><span class="id"> ub,</span><span class="id"> `|x|</span><span class="id"> &lt;</span><span class="id"> ub%:R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> real_closed_axiom</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[a]</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[b]</span><span class="id"> -&gt;</span><span class="gallina-kwd"> exists2</span><span class="id"> x,</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> &amp;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ExtensionAxioms</span>.<br/>
<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;numFieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> NumField</span><span class="id"> :=</span><span class="id"> {</span><span class="id"> R</span><span class="id"> of</span><span class="id"> GRing</span>.<span class="id">UnitRing_isField</span><span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">IntegralDomain</span><span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">POrderedZmodule</span><span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">NormedZmodule</span> (<span class="id">POrderedZmodule</span>.<span class="id">clone</span><span class="id"> R</span><span class="id"> _</span>)<span class="id"> R</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">isNumRing</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NumFieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> NumField</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> NumFieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> NumFieldExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> NumField_isImaginary</span><span class="id"> R</span><span class="id"> of</span><span class="id"> NumField</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">imaginary</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">conj_op</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R};</span><br/>
&nbsp;&nbsp;<span class="id">sqrCi</span><span class="id"> :</span><span class="id"> imaginary</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 1;</span><br/>
&nbsp;&nbsp;<span class="id">normCK</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> conj_op</span><span class="id"> x;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;numClosedFieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="vernacular"> ClosedField</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> NumField_isImaginary</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> GRing</span>.<span class="vernacular">ClosedField</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> NumField</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> ClosedFieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="vernacular"> ClosedField</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedFieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="vernacular"> ClosedFieldExports</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;realDomainType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> RealDomain</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Order</span>.<span class="id">Total</span><span class="id"> ring_display</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> NumDomain</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RealDomainExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> RealDomain</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> RealDomainExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> RealDomainExports</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;realFieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> RealField</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Order</span>.<span class="id">Total</span><span class="id"> ring_display</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> NumField</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RealFieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> RealField</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> RealFieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> RealFieldExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> RealField_isClosed</span><span class="id"> R</span><span class="id"> of</span><span class="id"> RealField</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">poly_ivt_subproof</span><span class="id"> :</span><span class="id"> real_closed_axiom</span><span class="id"> R</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;rcfType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> RealClosedField</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> RealField_isClosed</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> RealField</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RealClosedFieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> RealClosedField</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> RealClosedFieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> RealClosedFieldExports</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Import</span><span class="id"> Internals</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NumDomain</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> numDomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger0_def</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler_def</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_def</span><span class="id"> -ler_def</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sub0r</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> n1_nz:</span><span class="id"> `|1</span><span class="id"> :</span><span class="id"> R|</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraNneq</span> (<span class="id">@oner_neq0</span><span class="id"> R</span>)<span class="id"> =&gt;</span><span class="id"> /normr0_eq0-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ger0_def</span><span class="id"> -</span>(<span class="id">inj_eq</span> (<span class="id">mulfI</span><span class="id"> n1_nz</span>))<span class="id"> -normrM</span><span class="id"> !mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> oner_neq0</span><span class="id"> ler01</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0r</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> eq_sym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le0r;</span><span class="id"> case/predU1P=&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> x_pos];</span><span class="id"> rewrite</span><span class="id"> ?add0r</span><span class="id"> //</span><span class="id"> le0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/predU1P=&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> y_pos];</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> ?addr0</span><span class="id"> ?addr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_rgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !lt_def</span><span class="id"> !ger0_def</span><span class="id"> normrM</span><span class="id"> mulf_eq0</span><span class="id"> negb_or</span><span class="id"> =&gt;</span><span class="id"> /andP[x_neq0</span><span class="id"> /eqP-&gt;]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> x_neq0</span> (<span class="id">inj_eq</span> (<span class="id">mulfI</span><span class="id"> x_neq0</span>)).<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> posrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> pos</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> nnegrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> nneg</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> realE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pos_divr_closed</span><span class="id"> :</span><span class="id"> divr_closed</span> (<span class="id">@pos</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|x</span><span class="id"> y</span><span class="id"> x_gt0</span><span class="id"> y_gt0];</span><span class="id"> rewrite</span><span class="id"> posrE</span><span class="id"> ?ltr01</span><span class="id"> //</span>.<br/>
<span class="id">have</span><span class="id"> [Uy|/invr_out-&gt;]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pmulr_rgt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">pmulr_rgt0</span><span class="id"> _</span><span class="id"> y_gt0</span>)<span class="id"> mulrC</span><span class="id"> divrK</span>.<br/>
Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isDivClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> Rpos_pred</span><br/>
&nbsp;&nbsp;<span class="id">pos_divr_closed</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> nneg_divr_closed</span><span class="id"> :</span><span class="id"> divr_closed</span> (<span class="id">@nneg</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> rewrite</span><span class="id"> !nnegrE</span><span class="id"> ?ler01</span><span class="id"> ?le0r</span><span class="id"> //</span><span class="id"> -!posrE</span>.<br/>
<span class="id">case/predU1P=&gt;</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> |</span><span class="id"> x_gt0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/predU1P=&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> y_gt0];</span><span class="id"> rewrite</span><span class="id"> ?invr0</span><span class="id"> ?mulr0</span><span class="id"> ?eqxx</span><span class="id"> //</span><span class="id"> orbC</span><span class="id"> rpred_div</span>.<br/>
Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isDivClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> Rnneg_pred</span><br/>
&nbsp;&nbsp;<span class="id">nneg_divr_closed</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> nneg_addr_closed</span><span class="id"> :</span><span class="id"> addr_closed</span> (<span class="id">@nneg</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split;</span><span class="id"> [apply:</span><span class="id"> lexx</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> addr_ge0]</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAddClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> Rnneg_pred</span><br/>
&nbsp;&nbsp;<span class="id">nneg_addr_closed</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> real_oppr_closed</span><span class="id"> :</span><span class="id"> oppr_closed</span> (<span class="id">@real</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> !realE</span><span class="id"> oppr_ge0</span><span class="id"> orbC</span><span class="id"> -!oppr_ge0</span><span class="id"> opprK</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isOppClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> Rreal_pred</span><br/>
&nbsp;&nbsp;<span class="id">real_oppr_closed</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> real_addr_closed</span><span class="id"> :</span><span class="id"> addr_closed</span> (<span class="id">@real</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> lexx</span>.<br/>
<span class="id">without</span><span class="id"> loss{Rx}</span><span class="id"> x_ge0:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Ry</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">case/orP:</span><span class="id"> Rx</span><span class="id"> =&gt;</span><span class="id"> [?</span><span class="id"> |</span><span class="id"> x_le0];</span><span class="id"> first</span><span class="id"> exact</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rpredN</span><span class="id"> opprD;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> ?rpredN</span><span class="id"> ?oppr_ge0</span>.<br/>
<span class="id">case/orP:</span><span class="id"> Ry</span><span class="id"> =&gt;</span><span class="id"> [y_ge0</span><span class="id"> |</span><span class="id"> y_le0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> -nnegrE</span><span class="id"> rpredD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> -[y]opprK</span><span class="id"> orbC</span><span class="id"> -oppr_ge0</span><span class="id"> opprB</span><span class="id"> !subr_ge0</span><span class="id"> ger_leVge</span><span class="id"> ?oppr_ge0</span>.<br/>
Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAddClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> Rreal_pred</span><br/>
&nbsp;&nbsp;<span class="id">real_addr_closed</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> real_divr_closed</span><span class="id"> :</span><span class="id"> divr_closed</span> (<span class="id">@real</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> ler01</span>.<br/>
<span class="id">without</span><span class="id"> loss{Rx}</span><span class="id"> x_ge0:</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">case/orP:</span><span class="id"> Rx</span><span class="id"> =&gt;</span><span class="id"> [?</span><span class="id"> |</span><span class="id"> x_le0];</span><span class="id"> first</span><span class="id"> exact</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rpredN</span><span class="id"> -mulNr;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> ?oppr_ge0</span>.<br/>
<span class="id">without</span><span class="id"> loss{Ry}</span><span class="id"> y_ge0:</span><span class="id"> y</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> -nnegrE</span><span class="id"> rpred_div</span>.<br/>
<span class="id">case/orP:</span><span class="id"> Ry</span><span class="id"> =&gt;</span><span class="id"> [?</span><span class="id"> |</span><span class="id"> y_le0];</span><span class="id"> first</span><span class="id"> exact</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rpredN</span><span class="id"> -mulrN</span><span class="id"> -invrN;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> ?oppr_ge0</span>.<br/>
Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isDivClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> Rreal_pred</span><br/>
&nbsp;&nbsp;<span class="id">real_divr_closed</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NumDomain</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_real</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> le_total</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> RealClosed</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> rcfType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poly_ivt</span><span class="id"> :</span><span class="id"> real_closed_axiom</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> poly_ivt_subproof</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> sqrtr_subproof</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists2</span><span class="id"> y,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &amp;</span> (<span class="gallina-kwd">if</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="gallina-kwd"> then</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> x</span><span class="gallina-kwd"> else</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> :</span><span class="id"> bool</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> x_ge0:</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> 0</span>.<br/>
<span class="id">have</span><span class="id"> le0x1:</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -nnegrE</span><span class="id"> rpredD</span><span class="id"> ?rpred1</span>.<br/>
<span class="id">have</span><span class="id"> [|y</span><span class="id"> /andP[y_ge0</span><span class="id"> _]]</span><span class="id"> :=</span><span class="id"> @poly_ivt</span> (<span class="id">'X^2</span><span class="id"> -</span><span class="id"> x%:P</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> le0x1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !hornerE</span><span class="id"> -subr_ge0</span><span class="id"> add0r</span><span class="id"> expr0n</span><span class="id"> sub0r</span><span class="id"> opprK</span><span class="id"> x_ge0</span><span class="id"> sqrrD</span><span class="id"> mulr1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addrAC</span><span class="id"> !addrA</span><span class="id"> addrK</span><span class="id"> -nnegrE</span><span class="id"> !rpredD</span><span class="id"> ?rpredX</span><span class="id"> ?rpred1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rootE</span><span class="id"> !hornerE</span><span class="id"> subr_eq0;</span><span class="gallina-kwd"> exists</span><span class="id"> y</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RealClosed</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Exports</span>. <span class="id">HB</span>.<span class="id">reexport</span>. <span class="vernacular">End</span><span class="vernacular"> Exports</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Internals</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> PredInstances</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> Internals</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PredInstances</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Import</span><span class="id"> ExtraDef</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> sqrtr</span><span class="id"> {R}</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> s2val</span> (<span class="id">sig2W</span> (<span class="id">@sqrtr_subproof</span><span class="id"> R</span><span class="id"> x</span>)).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ExtraDef</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> sqrt</span><span class="id"> :=</span><span class="id"> sqrtr</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Import</span><span class="id"> Theory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NumIntegralDomainTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> numDomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> semiNormedZmodType</span><span class="id"> R</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> normedZmodType</span><span class="id"> R</span>).<br/>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ler_normD</span><span class="id"> V</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">ler_normD</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addr_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> @addr_gt0</span><span class="id"> R</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> normr0_eq0</span><span class="id"> W</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> W</span>)<span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :=</span><span class="id"> @normr0_eq0</span><span class="id"> R</span><span class="id"> W</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> ger_leVge</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">@ger_leVge</span><span class="id"> R</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> normrM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> norm</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> *</span><span class="id"> y}</span><span class="id"> :=</span><span class="id"> @normrM</span><span class="id"> R</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> ler_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">`|y</span><span class="id"> -</span><span class="id"> x|</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> :=</span><span class="id"> ler_def</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> normrMn</span><span class="id"> V</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> V</span>)<span class="id"> n</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> *+</span><span class="id"> n|</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> normrMn</span><span class="id"> x</span><span class="id"> n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> normrN</span><span class="id"> V</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> `|-</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> :=</span><span class="id"> normrN</span><span class="id"> x</span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> posrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> pos</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> negrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> neg</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> nnegrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> nneg</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> nposrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> npos</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> realE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0r</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> lt_def</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> le0r</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> le0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0r_neq0</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /gt_eqF</span><span class="id"> -&gt;</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr0_neq0</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /lt_eqF</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_rgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> pmulr_rgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_rge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> !le0r</span><span class="id"> mulf_eq0</span><span class="id"> pmulr_rgt0</span><span class="id"> //</span><span class="id"> gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ler01</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ltr01</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ler0n</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -nnegrE</span><span class="id"> rpred_nat</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ler01</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ltr01</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ler0n</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr0Sn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n;</span><span class="id"> apply:</span><span class="id"> addr_gt0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr0n</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n;</span><span class="id"> apply:</span><span class="id"> ltr0Sn</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ltr0Sn</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pnatr_eq0</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> rewrite</span><span class="id"> ?mulr0n</span><span class="id"> ?eqxx</span><span class="id"> //</span><span class="id"> gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pchar_num</span><span class="id"> :</span><span class="id"> [pchar</span><span class="id"> R]</span><span class="id"> =i</span><span class="id"> pred0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> //</span><span class="id"> p</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> pnatr_eq0</span><span class="id"> andbF</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger0_def</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ger0_def</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> normr_idP</span><span class="id"> {x}</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">`|x|</span><span class="id"> =</span><span class="id"> x</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_def;</span><span class="id"> apply:</span><span class="id"> eqP</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ger0_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> normr_idP</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> normr1</span><span class="id"> :</span><span class="id"> `|1</span><span class="id"> :</span><span class="id"> R|</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ger0_norm</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> normr_nat</span><span class="id"> n</span><span class="id"> :</span><span class="id"> `|n%:R</span><span class="id"> :</span><span class="id"> R|</span><span class="id"> =</span><span class="id"> n%:R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ger0_norm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_prod</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`|\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i|</span><span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|F</span><span class="id"> i|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> norm</span><span class="id"> normrM</span><span class="id"> normr1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normrX</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> ^+</span><span class="id"> n|</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">card_ord</span><span class="id"> n</span>)<span class="id"> -!prodr_const</span><span class="id"> normr_prod</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_unit</span><span class="id"> :</span><span class="id"> {homo</span> (<span class="id">@norm</span><span class="id"> _</span> <span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> /=</span><span class="id"> /unitrP</span><span class="id"> [y</span><span class="id"> [yx</span><span class="id"> xy]];</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span><span class="id"> `|y|</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!normrM</span><span class="id"> xy</span><span class="id"> yx</span><span class="id"> normr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normrV</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> GRing</span>.<span class="id">unit,</span><span class="id"> {morph</span> (<span class="id">@norm</span><span class="id"> _</span> <span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^-1}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> ux;</span><span class="id"> apply:</span> (<span class="id">mulrI</span> (<span class="id">normr_unit</span><span class="id"> ux</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -normrM</span><span class="id"> !divrr</span><span class="id"> ?normr1</span><span class="id"> ?normr_unit</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normrN1</span><span class="id"> :</span><span class="id"> `|-1</span><span class="id"> :</span><span class="id"> R|</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:</span><span class="id"> `|-1</span><span class="id"> :</span><span class="id"> R|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normrX</span><span class="id"> -signr_odd</span><span class="id"> normr1</span>.<br/>
<span class="id">rewrite</span><span class="id"> sqrf_eq1</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP</span><span class="id"> //|];</span><span class="id"> rewrite</span><span class="id"> -ger0_def</span><span class="id"> le0r</span><span class="id"> oppr_eq0</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/</span>(<span class="id">addr_gt0</span><span class="id"> ltr01</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> subrr</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> big_real</span><span class="id"> x0</span><span class="id"> op</span><span class="id"> I</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> F</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> op</span><span class="id"> x</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real}</span><span class="id"> -&gt;</span><span class="id"> x0</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real}</span><span class="id"> -&gt;</span><span class="id"> \big[op/x0]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> comparable_bigr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sum_real</span><span class="id"> I</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real}</span><span class="id"> -&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/big_real;</span><span class="id"> [apply:</span><span class="id"> rpredD</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rpred0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prod_real</span><span class="id"> I</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real}</span><span class="id"> -&gt;</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/big_real;</span><span class="id"> [apply:</span><span class="id"> rpredM</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rpred1]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiNormedZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> semiNormedZmodType</span><span class="id"> R</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr0</span><span class="id"> :</span><span class="id"> `|0</span><span class="id"> :</span><span class="id"> V|</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> 0</span>)<span class="id"> normrMn</span><span class="id"> mulr0n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> distrC</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|v</span><span class="id"> -</span><span class="id"> w|</span><span class="id"> =</span><span class="id"> `|w</span><span class="id"> -</span><span class="id"> v|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -opprB</span><span class="id"> normrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_id</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|</span><span class="id"> `|v|</span><span class="id"> |</span><span class="id"> =</span><span class="id"> `|v|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> nz2:</span><span class="id"> 2</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pnatr_eq0</span>.<br/>
<span class="id">apply:</span> (<span class="id">mulfI</span><span class="id"> nz2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -{1}normr_nat</span><span class="id"> -normrM</span><span class="id"> mulr_natl</span><span class="id"> mulr2n</span><span class="id"> ger0_norm</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{2}normrN</span><span class="id"> -normr0</span><span class="id"> -</span>(<span class="id">subrr</span><span class="id"> v</span>)<span class="id"> ler_normD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_ge0</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> `|v|</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_def</span><span class="id"> normr_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_lt0</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_gtF//</span><span class="id"> normr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr0_norm_neq0</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">v</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contra_ltN</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> normr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr0_norm_eq0F</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">v</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /gtr0_norm_neq0/negPf-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SemiNormedZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NormedZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> normedZmodType</span><span class="id"> R</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr0P</span><span class="id"> v</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">`|v|</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">v</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> eqP</span>)<span class="id">=&gt;</span><span class="id"> [-&gt;|/normr0_eq0</span><span class="id"> //];</span><span class="id"> apply:</span><span class="id"> normr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> normr_eq0</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> sameP</span> (<span class="id">`|v|</span><span class="id"> =P</span><span class="id"> 0</span>) (<span class="id">normr0P</span><span class="id"> v</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_le0</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">v</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normr_eq0</span><span class="id"> eq_le</span><span class="id"> normr_ge0</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_gt0</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">v</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> normr_eq0</span><span class="id"> normr_ge0</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> NormedZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> normrE</span><span class="id"> :=</span> (<span class="id">normr_id,</span><span class="id"> normr0,</span><span class="id"> normr1,</span><span class="id"> normrN1,</span><span class="id"> normr_ge0,</span><span class="id"> normr_eq0,</span><br/>
&nbsp;&nbsp;<span class="id">normr_lt0,</span><span class="id"> normr_le0,</span><span class="id"> normr_gt0,</span><span class="id"> normrN</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler0_def</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler_def</span><span class="id"> sub0r</span><span class="id"> normrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler0_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0;</span><span class="id"> rewrite</span><span class="id"> -[r</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> =</span><span class="id"> r]ger0_norm</span><span class="id"> ?normrN</span><span class="id"> ?oppr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> gtr0_norm</span><span class="id"> x</span> (<span class="id">hx</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> :=</span><span class="id"> ger0_norm</span> (<span class="id">ltW</span><span class="id"> hx</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> ltr0_norm</span><span class="id"> x</span> (<span class="id">hx</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> :=</span><span class="id"> ler0_norm</span> (<span class="id">ltW</span><span class="id"> hx</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger0_le_norm</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@normr</span><span class="id"> _</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !nnegrE</span><span class="id"> =&gt;</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> !ger0_norm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr0_le_norm</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@normr</span><span class="id"> _</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !posrE</span><span class="id"> =&gt;</span><span class="id"> /ltW</span><span class="id"> x0</span><span class="id"> /ltW</span><span class="id"> y0;</span><span class="id"> exact:</span><span class="id"> ger0_le_norm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler0_ge_norm</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> npos</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@normr</span><span class="id"> _</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !nposrE</span><span class="id"> =&gt;</span><span class="id"> x0</span><span class="id"> y0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ler0_norm//</span><span class="id"> -[LHS]subr_ge0</span><span class="id"> opprK</span><span class="id"> addrC</span><span class="id"> subr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr0_ge_norm</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@normr</span><span class="id"> _</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !negrE</span><span class="id"> =&gt;</span><span class="id"> /ltW</span><span class="id"> x0</span><span class="id"> /ltW</span><span class="id"> y0;</span><span class="id"> exact:</span><span class="id"> ler0_ge_norm</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subr_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lt_def</span><span class="id"> subr_eq0</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subr_le0</span> <span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[LHS]subr_ge0</span><span class="id"> opprB</span><span class="id"> add0r</span><span class="id"> subr_ge0</span>. Qed.</div></details>
  <br/>
<span class="vernacular">Lemma</span><span class="id"> subr_lt0</span> <span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[LHS]subr_gt0</span><span class="id"> opprB</span><span class="id"> add0r</span><span class="id"> subr_gt0</span>. Qed.</div></details>
  <br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> subr_lte0</span><span class="id"> :=</span> (<span class="id">subr_le0,</span><span class="id"> subr_lt0</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> subr_gte0</span><span class="id"> :=</span> (<span class="id">subr_ge0,</span><span class="id"> subr_gt0</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> subr_cp0</span><span class="id"> :=</span> (<span class="id">subr_lte0,</span><span class="id"> subr_gte0</span>).<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comparable0r</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span>)<span class="id">%R</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comparabler0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &gt;=&lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> comparable_sym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_comparable0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &gt;=&lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /comparable</span><span class="id"> subr_ge0</span><span class="id"> subr_le0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comparablerE</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%R</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparabler0</span><span class="id"> subr_comparable0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span> <span class="id"> comparabler_trans</span><span class="id"> :</span><span class="id"> transitive</span> (<span class="id">comparable</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !comparablerE</span><span class="id"> =&gt;</span><span class="id"> xBy_real</span><span class="id"> yBz_real</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> rpredD</span><span class="id"> xBy_real</span><span class="id"> yBz_real;</span><span class="id"> rewrite</span><span class="id"> addrA</span><span class="id"> addrNK</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter01</span><span class="id"> :=</span> (<span class="id">ler01,</span><span class="id"> ltr01</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> NumIntegralDomainTheory</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,note=</span><span class="id">&quot;Use pchar_num instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> char_num</span><span class="id"> :=</span><span class="id"> pchar_num</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> ler01</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> ltr01</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> normr_idP</span><span class="id"> {R</span><span class="id"> x}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> normr0P</span><span class="id"> {R</span><span class="id"> V</span><span class="id"> v}</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ler01</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ltr01</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ler0n</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ring_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">apply:</span><span class="id"> ltr0Sn</span>)<span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> norm</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> apply:</span><span class="id"> normr_ge0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_nneg</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> `|x|</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">nneg</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> qualifE</span><span class="id"> /=</span>. Qed.</div></details>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> normr_nneg</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NumDomainOperationTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> numDomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerN2</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> :&gt;</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -subr_ge0</span><span class="id"> opprK</span><span class="id"> addrC</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> lerN2</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrN2</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> :&gt;</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> leW_nmono</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> ltrN2</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lterN2</span><span class="id"> :=</span> (<span class="id">lerN2,</span><span class="id"> ltrN2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerNr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoRL</span><span class="id"> opprK</span><span class="id"> lerN2</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrNr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoRL</span><span class="id"> opprK</span> (<span class="id">leW_nmono</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lterNr</span><span class="id"> :=</span> (<span class="id">lerNr,</span><span class="id"> ltrNr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerNl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoLR</span><span class="id"> opprK</span><span class="id"> lerN2</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrNl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoLR</span><span class="id"> opprK</span> (<span class="id">leW_nmono</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lterNl</span><span class="id"> :=</span> (<span class="id">lerNl,</span><span class="id"> ltrNl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerNr</span><span class="id"> oppr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_gt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltrNr</span><span class="id"> oppr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_gte0</span><span class="id"> :=</span> (<span class="id">oppr_ge0,</span><span class="id"> oppr_gt0</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_le0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerNl</span><span class="id"> oppr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_lt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltrNl</span><span class="id"> oppr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n0;</span><span class="id"> rewrite</span><span class="id"> -subr_lt0</span><span class="id"> -opprD</span><span class="id"> oppr_lt0</span><span class="id"> addr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_lte0</span><span class="id"> :=</span> (<span class="id">oppr_le0,</span><span class="id"> oppr_lt0</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_cp0</span><span class="id"> :=</span> (<span class="id">oppr_gte0,</span><span class="id"> oppr_lte0</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> lterNE</span><span class="id"> :=</span> (<span class="id">oppr_cp0,</span><span class="id"> lterN2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_cp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> *</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> oppr_cp0</span><span class="id"> hx</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ?oppr_cp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_cp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> *</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> *</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hx;</span><span class="id"> move:</span> (<span class="id">ltW</span><span class="id"> hx</span>)<span class="id"> =&gt;</span><span class="id"> hx';</span><span class="id"> rewrite</span><span class="id"> !ge0_cp</span><span class="id"> hx'</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> oppr_cp0</span><span class="id"> hx</span><span class="id"> //</span> (<span class="id">@lt_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ?oppr_cp0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_cp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> oppr_cp0</span><span class="id"> hx</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ?oppr_cp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_cp</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> *</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hx;</span><span class="id"> move:</span> (<span class="id">ltW</span><span class="id"> hx</span>)<span class="id"> =&gt;</span><span class="id"> hx';</span><span class="id"> rewrite</span><span class="id"> !le0_cp</span><span class="id"> //</span><span class="id"> hx'</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> oppr_cp0</span><span class="id"> hx</span><span class="id"> //</span> (<span class="id">@lt_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ?oppr_cp0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger0_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler0_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realE</span><span class="id"> orbC</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr0_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ltW/ger0_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr0_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ltW/ler0_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> \is</span><span class="id"> @real</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpred0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> real1</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> \is</span><span class="id"> @real</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpred1</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> realn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> \is</span><span class="id"> @real</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpred_nat</span>. Qed.</div></details>
<span class="id">#[local]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> real0</span><span class="id"> real1</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_leVge</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!oppr_ge0</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">ger_leVge</span><span class="id"> _</span>)<span class="id"> /[apply];</span><span class="id"> rewrite</span><span class="id"> !lerN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leVge</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparabler0</span><span class="id"> -comparable0r</span><span class="id"> =&gt;</span><span class="id"> /comparabler_trans</span><span class="id"> P/P</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_comparable</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_leVge</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realB</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realN</span><span class="id"> :</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">opp</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realBC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredBC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realD</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredD</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> ler_xor_gt</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> LerNotGt</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> :</span><span class="id"> ler_xor_gt</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span><span class="id"> y</span><span class="id"> y</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>) (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> true</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> GtrNotLe</span><span class="id"> of</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span> <span class="id"> :</span><span class="id"> ler_xor_gt</span><span class="id"> x</span><span class="id"> y</span><span class="id"> y</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> false</span><span class="id"> true</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> ltr_xor_ge</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> LtrNotGe</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span> <span class="id"> :</span><span class="id"> ltr_xor_ge</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span><span class="id"> y</span><span class="id"> y</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>) (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> false</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> GerNotLt</span><span class="id"> of</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ltr_xor_ge</span><span class="id"> x</span><span class="id"> y</span><span class="id"> y</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> true</span><span class="id"> false</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> comparer</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ComparerLt</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comparer</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span><span class="id"> y</span><span class="id"> y</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>) (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">false</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ComparerGt</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comparer</span><span class="id"> x</span><span class="id"> y</span><span class="id"> y</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ComparerEq</span><span class="id"> of</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comparer</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">true</span><span class="id"> true</span><span class="id"> true</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">ler_xor_gt</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">min</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">max</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> `|y</span><span class="id"> -</span><span class="id"> x|</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>) (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> case:</span> (<span class="id">comparable_leP</span> (<span class="id">real_leVge</span><span class="id"> xR</span><span class="id"> yR</span>))<span class="id"> =&gt;</span><span class="id"> xy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [`|x</span><span class="id"> -</span><span class="id"> y|]distrC</span><span class="id"> !ger0_norm</span><span class="id"> ?subr_cp0</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [`|y</span><span class="id"> -</span><span class="id"> x|]distrC</span><span class="id"> !gtr0_norm</span><span class="id"> ?subr_cp0</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">ltr_xor_ge</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">min</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">max</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> `|y</span><span class="id"> -</span><span class="id"> x|</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> case:</span><span class="id"> real_leP=&gt;</span><span class="id"> //;</span><span class="id"> constructor</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltNge</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> ~~</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xR</span><span class="id"> yR</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> real_leP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leNgt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> ~~</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xR</span><span class="id"> yR</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> real_leP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltgtP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">comparer</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">min</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">max</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> `|y</span><span class="id"> -</span><span class="id"> x|</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> ==</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &gt;=</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> case:</span> (<span class="id">comparable_ltgtP</span> (<span class="id">real_leVge</span><span class="id"> yR</span><span class="id"> xR</span>))<span class="id"> =&gt;</span><span class="id"> [?|?|-&gt;]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [`|y</span><span class="id"> -</span><span class="id"> x|]distrC</span><span class="id"> !gtr0_norm</span><span class="id"> ?subr_gt0//;</span><span class="id"> constructor</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [`|x</span><span class="id"> -</span><span class="id"> y|]distrC</span><span class="id"> !gtr0_norm</span><span class="id"> ?subr_gt0//;</span><span class="id"> constructor</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> subrr</span><span class="id"> normr0;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> ger0_xor_lt0</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Ger0NotLt0</span><span class="id"> of</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ger0_xor_lt0</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> false</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Ltr0NotGe0</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span> <span class="id"> :</span><span class="id"> ger0_xor_lt0</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> true</span><span class="id"> false</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> ler0_xor_gt0</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Ler0NotLe0</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> ler0_xor_gt0</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> false</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Gtr0NotGt0</span><span class="id"> of</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span> <span class="id"> :</span><span class="id"> ler0_xor_gt0</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> true</span><span class="id"> false</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> comparer0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ComparerGt0</span><span class="id"> of</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comparer0</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> false</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ComparerLt0</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> comparer0</span><span class="id"> x</span><span class="id"> x</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ComparerEq0</span><span class="id"> of</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> comparer0</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> true</span><span class="id"> true</span><span class="id"> true</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ge0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> ger0_xor_lt0</span><span class="id"> x</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">min</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> 0</span>) (<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;<span class="id">`|x|</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> `|X|]subr0;</span><span class="id"> case:</span><span class="id"> real_leP;</span><br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?subr0</span><span class="id"> ?sub0r</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_le0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> ler0_xor_gt0</span><span class="id"> x</span><br/>
&nbsp;&nbsp;(<span class="id">min</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> 0</span>) (<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;<span class="id">`|x|</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> `|X|]subr0;</span><span class="id"> case:</span><span class="id"> real_ltP;</span><br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?subr0</span><span class="id"> ?sub0r</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltgt0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">comparer0</span><span class="id"> x</span> (<span class="id">min</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> 0</span>) (<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x|</span> (<span class="id">0</span><span class="id"> ==</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> `|X|]subr0;</span><span class="id"> case:</span> (<span class="id">@real_ltgtP</span><span class="id"> 0</span><span class="id"> x</span>)<span class="id">;</span><br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?subr0</span><span class="id"> ?sub0r</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> max_real</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> comparable_maxr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> min_real</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> comparable_minr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmax_real</span><span class="id"> I</span><span class="id"> x0</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">x0</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> I,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\big[max/x0]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/big_real/max_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmin_real</span><span class="id"> I</span><span class="id"> x0</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">x0</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> I,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\big[min/x0]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/big_real/min_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_neqr_lt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> real_ltgtP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerB_real</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le_xy;</span><span class="id"> rewrite</span><span class="id"> ger0_real</span><span class="id"> //</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gerB_real</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le_xy;</span><span class="id"> rewrite</span><span class="id"> ler0_real</span><span class="id"> //</span><span class="id"> subr_le0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_real</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le_xy;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">addrNK</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> rpredDl</span><span class="id"> ?lerB_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger_real</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le_yx;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ler_real</span><span class="id"> le_yx</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger1_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ger_real-&gt;</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ler1_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ler_real-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Nreal_leF</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \notin</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yR;</span><span class="id"> apply:</span><span class="id"> contraNF=&gt;</span><span class="id"> /ler_real-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Nreal_geF</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \notin</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yR;</span><span class="id"> apply:</span><span class="id"> contraNF=&gt;</span><span class="id"> /ger_real-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Nreal_ltF</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \notin</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yR</span><span class="id"> xNR;</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> Nreal_leF</span><span class="id"> ?andbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Nreal_gtF</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \notin</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yR</span><span class="id"> xNR;</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> Nreal_geF</span><span class="id"> ?andbF</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_wlog_ler</span><span class="id"> P</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> b,</span><span class="id"> P</span><span class="id"> b</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> a</span><span class="id"> b</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> b,</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> a</span><span class="id"> b</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> a</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> a</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sP</span><span class="id"> hP</span><span class="id"> a</span><span class="id"> b</span><span class="id"> ha</span><span class="id"> hb;</span><span class="id"> wlog:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> ha</span><span class="id"> hb</span><span class="id"> /</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> [hwlog|];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> hP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">real_leP</span><span class="id"> ha</span><span class="id"> hb</span>)<span class="id">=&gt;</span><span class="id"> [/hP</span><span class="id"> //|/ltW</span><span class="id"> hba];</span><span class="id"> apply/sP/hP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_wlog_ltr</span><span class="id"> P</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> a,</span><span class="id"> P</span><span class="id"> a</span><span class="id"> a</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> b,</span> (<span class="id">P</span><span class="id"> b</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> a</span><span class="id"> b</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> b,</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> a</span><span class="id"> b</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> a</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> a</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rP</span><span class="id"> sP</span><span class="id"> hP;</span><span class="id"> apply:</span><span class="id"> real_wlog_ler=&gt;</span><span class="id"> //</span><span class="id"> a</span><span class="id"> b</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|]</span><span class="id"> //=</span><span class="id"> _</span><span class="id"> /hP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerD2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> +%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> -subr_ge0</span><span class="id"> opprD</span><span class="id"> addrAC</span><span class="id"> addNKr</span><span class="id"> addrC</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerD2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> +%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> +</span><span class="id"> x]addrC</span><span class="id"> lerD2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrD2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> +%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span> (<span class="id">leW_mono</span> (<span class="id">lerD2l</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrD2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> +%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span> (<span class="id">leW_mono</span> (<span class="id">lerD2r</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lerD2</span><span class="id"> :=</span> (<span class="id">lerD2l,</span><span class="id"> lerD2r</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> ltrD2</span><span class="id"> :=</span> (<span class="id">ltrD2l,</span><span class="id"> ltrD2r</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> lterD2</span><span class="id"> :=</span> (<span class="id">lerD2,</span><span class="id"> ltrD2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>))<span class="id"> ?lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ltD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>))<span class="id"> ?lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_leD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span> (<span class="id">@lt_le_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>))<span class="id"> ?lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span><span class="id"> ltr_leD</span><span class="id"> //</span><span class="id"> ltW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> ltz;</span><span class="id"> rewrite</span><span class="id"> lerD</span><span class="id"> //</span><span class="id"> lterN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ltB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> t</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span><span class="id"> ler_ltD</span><span class="id"> //</span><span class="id"> lterN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_leB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span><span class="id"> ltr_leD</span><span class="id"> //</span><span class="id"> lterN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> t</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lxy</span><span class="id"> lzt;</span><span class="id"> rewrite</span><span class="id"> ltrD</span><span class="id"> //</span><span class="id"> lterN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerBlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoLR</span> (<span class="id">addrK</span><span class="id"> _</span>) (<span class="id">lerD2r</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrBlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoLR</span> (<span class="id">addrK</span><span class="id"> _</span>) (<span class="id">ltrD2r</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerBrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoLR</span> (<span class="id">addrNK</span><span class="id"> _</span>) (<span class="id">lerD2r</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrBrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">monoLR</span> (<span class="id">addrNK</span><span class="id"> _</span>) (<span class="id">ltrD2r</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lerBDr</span><span class="id"> :=</span> (<span class="id">lerBlDr,</span><span class="id"> lerBrDr</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> ltrBDr</span><span class="id"> :=</span> (<span class="id">ltrBlDr,</span><span class="id"> ltrBrDr</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> lterBDr</span><span class="id"> :=</span> (<span class="id">lerBDr,</span><span class="id"> ltrBDr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerBlDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lterBDr</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrBlDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lterBDr</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerBrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerBrDr</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrBrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lterBDr</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lerBDl</span><span class="id"> :=</span> (<span class="id">lerBlDl,</span><span class="id"> lerBrDl</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> ltrBDl</span><span class="id"> :=</span> (<span class="id">ltrBlDl,</span><span class="id"> ltrBrDl</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> lterBDl</span><span class="id"> :=</span> (<span class="id">lerBDl,</span><span class="id"> ltrBDl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}[x]addr0</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}[x]addr0</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}[x]add0r</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}[x]add0r</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gerDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}[x]addr0</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gerBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerBlDl</span><span class="id"> lerDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}[x]addr0</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtrBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltrBlDl</span><span class="id"> ltrDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gerDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}[x]add0r</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}[x]add0r</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> cprD</span><span class="id"> :=</span> (<span class="id">lerDl,</span><span class="id"> lerDr,</span><span class="id"> gerDl,</span><span class="id"> gerDl,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ltrDl,</span><span class="id"> ltrDr,</span><span class="id"> gtrDl,</span><span class="id"> gtrDl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wpDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y]add0r</span><span class="id"> lerD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wpDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y]add0r</span><span class="id"> ler_ltD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pwDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y]add0r</span><span class="id"> ltr_leD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y]add0r</span><span class="id"> ltrD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wnDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[z]add0r</span><span class="id"> lerD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wnDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[z]add0r</span><span class="id"> ler_ltD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nwDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[z]add0r</span><span class="id"> ltr_leD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[z]add0r</span><span class="id"> ltrD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wpDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ler_wpDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wpDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltr_wpDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pwDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltr_pwDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltr_pDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wnDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ler_wnDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wnDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltr_wnDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nwDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltr_nwDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltr_nDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> paddr_eq0</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le0r;</span><span class="id"> case/orP=&gt;</span><span class="id"> [/eqP-&gt;|hx];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> add0r</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">gt_eqF</span><span class="id"> hx</span>)<span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> ltr_pwDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> naddr_eq0</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> lex0</span><span class="id"> ley0;</span><span class="id"> rewrite</span><span class="id"> -oppr_eq0</span><span class="id"> opprD</span><span class="id"> paddr_eq0</span><span class="id"> ?oppr_cp0</span><span class="id"> //</span><span class="id"> !oppr_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_ss_eq0</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/orP=&gt;</span><span class="id"> /andP</span><span class="id"> [];</span><span class="id"> [apply:</span><span class="id"> paddr_eq0</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> naddr_eq0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumr_ge0</span><span class="id"> I</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>))<span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_ind</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">@ler_wpDl</span><span class="id"> 0</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_sum</span><span class="id"> I</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> G</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> G</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> G</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_ind2</span><span class="id"> _</span> (<span class="id">lexx</span><span class="id"> _</span>)<span class="id"> lerD</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_sum_nat</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">F</span><span class="id"> G</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> G</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> G</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le_FG;</span><span class="id"> rewrite</span><span class="id"> !big_nat</span><span class="id"> ler_sum</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> psumr_eq0</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>)<span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">all</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span> (<span class="id">P</span><span class="id"> i</span>)<span class="id"> ==&gt;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>))<span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> r=&gt;</span><span class="id"> [|a</span><span class="id"> r</span><span class="id"> ihr</span><span class="id"> hr]</span><span class="id"> /=;</span><span class="id"> rewrite</span> (<span class="id">big_nil,</span><span class="id"> big_cons</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP=&gt;</span><span class="id"> pa</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ?paddr_eq0</span><span class="id"> ?ihr</span><span class="id"> ?hr</span><span class="id"> //</span><span class="id"> sumr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> psumr_eq0P</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> F_ge0</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> psumr_eq0</span><span class="id"> //</span><span class="id"> -big_all</span><span class="id"> big_andE</span><span class="id"> =&gt;</span><span class="id"> /forallP</span><span class="id"> hF</span><span class="id"> i</span><span class="id"> Pi</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span> (<span class="id">hF</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> implyTb</span><span class="id"> Pi</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> psumr_neq0</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>)<span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">has</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> F</span><span class="id"> i</span>))<span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> F_ge0;</span><span class="id"> rewrite</span><span class="id"> psumr_eq0//</span><span class="id"> -has_predC;</span><span class="id"> apply:</span><span class="id"> eq_has</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> Px:</span> (<span class="id">P</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> //=</span><span class="id"> lt_def</span><span class="id"> F_ge0</span><span class="id"> ?andbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> psumr_neq0P</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;&gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> F</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> psumr_neq0//</span><span class="id"> =&gt;</span><span class="id"> /hasP[x</span><span class="id"> _</span><span class="id"> ?];</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pM2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -subr_ge0</span><span class="id"> -mulrBr</span><span class="id"> pmulr_rge0</span><span class="id"> //</span><span class="id"> subr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pM2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> apply:</span><span class="id"> leW_mono</span> (<span class="id">ler_pM2l</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pM2l</span><span class="id"> :=</span> (<span class="id">ler_pM2l,</span><span class="id"> ltr_pM2l</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pM2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span><span class="id"> ler_pM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pM2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> apply:</span><span class="id"> leW_mono</span> (<span class="id">ler_pM2r</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pM2r</span><span class="id"> :=</span> (<span class="id">ler_pM2r,</span><span class="id"> ltr_pM2r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nM2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -lerN2</span><span class="id"> -!mulNr</span><span class="id"> ler_pM2l</span><span class="id"> ?oppr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nM2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> apply:</span><span class="id"> leW_nmono</span> (<span class="id">ler_nM2l</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_nM2l</span><span class="id"> :=</span> (<span class="id">ler_nM2l,</span><span class="id"> ltr_nM2l</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nM2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span><span class="id"> ler_nM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nM2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> apply:</span><span class="id"> leW_nmono</span> (<span class="id">ler_nM2r</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_nM2r</span><span class="id"> :=</span> (<span class="id">ler_nM2r,</span><span class="id"> ltr_nM2r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wpM2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le0r</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP-&gt;</span><span class="id"> y</span><span class="id"> z</span><span class="id"> |</span><span class="id"> /ler_pM2l/mono2W//];</span><span class="id"> rewrite</span><span class="id"> !mul0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wpM2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_ge0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> leyz;</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span><span class="id"> ler_wpM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wnM2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /~</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_le0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> leyz;</span><span class="id"> rewrite</span><span class="id"> -![x</span><span class="id"> *</span><span class="id"> _]mulrNN</span><span class="id"> ler_wpM2l</span><span class="id"> ?lterNE</span>. <br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wnM2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /~</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> leyz;</span><span class="id"> rewrite</span><span class="id"> -![_</span><span class="id"> *</span><span class="id"> x]mulrNN</span><span class="id"> ler_wpM2r</span><span class="id"> ?lterNE</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pM</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x1ge0</span><span class="id"> x2ge0</span><span class="id"> le_xy1</span><span class="id"> le_xy2;</span><span class="id"> have</span><span class="id"> y1ge0</span><span class="id"> :=</span><span class="id"> le_trans</span><span class="id"> x1ge0</span><span class="id"> le_xy1</span>.<br/>
<span class="id">exact:</span><span class="id"> le_trans</span> (<span class="id">ler_wpM2r</span><span class="id"> x2ge0</span><span class="id"> le_xy1</span>) (<span class="id">ler_wpM2l</span><span class="id"> y1ge0</span><span class="id"> le_xy2</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pM</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> &lt;</span><span class="id"> y1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;</span><span class="id"> y2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> &lt;</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x1ge0</span><span class="id"> x2ge0</span><span class="id"> lt_xy1</span><span class="id"> lt_xy2;</span><span class="id"> have</span><span class="id"> y1gt0</span><span class="id"> :=</span><span class="id"> le_lt_trans</span><span class="id"> x1ge0</span><span class="id"> lt_xy1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_wpM2r</span><span class="id"> x2ge0</span> (<span class="id">ltW</span><span class="id"> lt_xy1</span>)))<span class="id"> ?ltr_pM2l</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pMn2r</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> _</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -mulr_natl</span><span class="id"> -[y</span><span class="id"> *+</span><span class="id"> _]mulr_natl</span><span class="id"> ler_pM2l</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pMn2r</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/ler_pMn2r/leW_mono</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrnI</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> injective</span> ((<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/ler_pMn2r/inc_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_pMn2r</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/pmulrnI/inj_eq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_lgt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mul0rn</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ltr_pMn2r</span><span class="id"> //</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_llt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mul0rn</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ltr_pMn2r</span><span class="id"> //</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_lge0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mul0rn</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ler_pMn2r</span><span class="id"> //</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_lle0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mul0rn</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ler_pMn2r</span><span class="id"> //</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wMn2r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ltxy;</span><span class="id"> case:</span><span class="id"> n=&gt;</span><span class="id"> //</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> ltr_pMn2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wpMn2r</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {homo</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=</span><span class="id"> /</span><span class="id"> ltr_wMn2r</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wMn2r</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {homo</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> hxy</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> n=&gt;</span><span class="id"> //</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> ler_pMn2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrn_wge0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(<span class="id">ler_wMn2r</span><span class="id"> n</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrn_wle0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(<span class="id">ler_wMn2r</span><span class="id"> n</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerMn2r</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> ((<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> rewrite</span><span class="id"> ?lexx</span><span class="id"> ?eqxx</span><span class="id"> //</span><span class="id"> ler_pMn2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrMn2r</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> ((<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> rewrite</span><span class="id"> ?lexx</span><span class="id"> ?eqxx</span><span class="id"> //</span><span class="id"> ltr_pMn2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqrMn2r</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">@eq_le</span><span class="id"> _</span><span class="id"> R</span>)<span class="id"> !lerMn2r</span><span class="id"> -orb_andr</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrn_eq0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> ((<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulr_natl</span><span class="id"> mulf_eq0</span><span class="id"> pnatr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqNr</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> -addr_eq0</span><span class="id"> -mulr2n</span><span class="id"> mulrn_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrIn</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id">GRing</span>.<span class="id">natmul</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_neq0</span><span class="id"> m</span><span class="id"> n;</span><span class="id"> without</span><span class="id"> loss</span><span class="id"> /subnK</span><span class="id"> &lt;-:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IH</span><span class="id"> eq_xmn;</span><span class="id"> case/orP:</span> (<span class="id">leq_total</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> /IH-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> mulrnDr</span><span class="id"> -subr_eq0</span><span class="id"> addrK</span><span class="id"> mulrn_eq0</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;</span><span class="id"> |</span><span class="id"> /idPn]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wpMn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {homo</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xge0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /subnK</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> mulrnDr</span><span class="id"> ler_wpDl</span><span class="id"> ?mulrn_wge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wnMn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {homo</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xle0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> hmn</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -lerN2</span><span class="id"> -!mulNrn</span><span class="id"> ler_wpMn2l</span><span class="id"> //</span><span class="id"> oppr_cp0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrn_wgt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> pmulrn_lgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrn_wlt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> pmulrn_llt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pMn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> leqP</span><span class="id"> =&gt;</span><span class="id"> hmn;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler_wpMn2l</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">subnK</span> (<span class="id">ltnW</span><span class="id"> hmn</span>))<span class="id"> mulrnDr</span><span class="id"> gerDr</span><span class="id"> lt_geF</span><span class="id"> //</span><span class="id"> mulrn_wgt0</span><span class="id"> //</span><span class="id"> subn_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pMn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> apply:</span><span class="id"> leW_mono</span> (<span class="id">ler_pMn2l</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nMn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xlt0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -lerN2</span><span class="id"> -!mulNrn</span><span class="id"> ler_pMn2l//</span><span class="id"> oppr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nMn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">natmul</span><span class="id"> R</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> apply:</span><span class="id"> leW_nmono</span> (<span class="id">ler_nMn2l</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nat</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">m%:R</span><span class="id"> &lt;=</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler_pMn2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nat</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">m%:R</span><span class="id"> &lt;</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr_pMn2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_nat</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">m%:R</span><span class="id"> ==</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> ==</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">inj_eq</span> (<span class="id">mulrIn</span><span class="id"> _</span>))<span class="id"> ?oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pnatr_eq1</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eqr_nat</span><span class="id"> 1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lern0</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[0]/0%:R</span><span class="id"> ler_nat</span><span class="id"> leqn0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrn0</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[0]/0%:R</span><span class="id"> ltr_nat</span><span class="id"> ltn0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler1n</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ler_nat</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr1n</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ltr_nat</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> lern1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> 1</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ler_nat</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltrn1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ltr_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrN10</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppr_lt0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> lerN10</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppr_le0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr10</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_gtF</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ler10</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr0N1</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> -1</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_gtF</span><span class="id"> //</span><span class="id"> lerN10</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ler0N1</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> -1</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> //</span><span class="id"> ltrN10</span>. Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `mulrn_wgt0` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_rgt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrn_wgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_rlt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> x</span>)<span class="id"> ltr_pMn2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_rge0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> x</span>)<span class="id"> ler_pMn2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulrn_rle0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> x</span>)<span class="id"> ler_pMn2l</span><span class="id"> ?leqn0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulrn_rgt0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> x</span>)<span class="id"> ltr_nMn2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulrn_rge0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> x</span>)<span class="id"> ler_nMn2l</span><span class="id"> ?leqn0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulrn_rle0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0n</span><span class="id"> x</span>)<span class="id"> ler_nMn2l</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_rlt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -[LHS]oppr_gt0</span><span class="id"> -mulrN</span><span class="id"> pmulr_rgt0</span><span class="id"> //</span><span class="id"> oppr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_rle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -[LHS]oppr_ge0</span><span class="id"> -mulrN</span><span class="id"> pmulr_rge0</span><span class="id"> //</span><span class="id"> oppr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_lgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> pmulr_rgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_lge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> pmulr_rge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_llt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> pmulr_rlt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmulr_lle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> pmulr_rle0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_rgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -mulrNN</span><span class="id"> pmulr_rgt0</span><span class="id"> lterNE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_rge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -mulrNN</span><span class="id"> pmulr_rge0</span><span class="id"> lterNE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_rlt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -mulrNN</span><span class="id"> pmulr_rlt0</span><span class="id"> lterNE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_rle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> -mulrNN</span><span class="id"> pmulr_rle0</span><span class="id"> lterNE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_lgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> nmulr_rgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_lge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> nmulr_rge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_llt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> nmulr_rlt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmulr_lle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> nmulr_rle0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_ge0</span><span class="id"> y_ge0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0</span><span class="id"> x</span>)<span class="id"> ler_wpM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0</span><span class="id"> y_le0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0</span><span class="id"> x</span>)<span class="id"> ler_wnM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_ge0_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0</span><span class="id"> y_le0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0</span><span class="id"> x</span>)<span class="id"> ler_wpM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_le0_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0</span><span class="id"> y_le0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulr0</span><span class="id"> x</span>)<span class="id"> ler_wnM2l</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0</span><span class="id"> y_gt0;</span><span class="id"> rewrite</span><span class="id"> pmulr_rgt0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_ge0_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> ltxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|y0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> ltxx</span><span class="id"> andbC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/idP/andP=&gt;</span><span class="id"> [|_];</span><span class="id"> rewrite</span><span class="id"> pmulr_rgt0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodr_ge0</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E</span><span class="id"> i</span>)<span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Ege0;</span><span class="id"> rewrite</span><span class="id"> -nnegrE</span><span class="id"> rpred_prod</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodr_gt0</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> E</span><span class="id"> i</span>)<span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Ege0;</span><span class="id"> rewrite</span><span class="id"> -posrE</span><span class="id"> rpred_prod</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_prod</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E1</span><span class="id"> E2</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> E2</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E2</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> leE12;</span><span class="id"> elim/</span>(<span class="id">big_load</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>))<span class="id">:</span><span class="id"> _</span>.<br/>
<span class="id">elim/big_rec2:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span><span class="id"> x2</span><span class="id"> x1</span><span class="id"> /leE12/andP[le0Ei</span><span class="id"> leEi12]</span><span class="id"> [x1ge0</span><span class="id"> le_x12]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_ge0</span><span class="id"> //</span><span class="id"> ler_pM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_prod</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E1</span><span class="id"> E2</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has</span><span class="id"> P</span><span class="id"> r</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> E2</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E2</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> i</span><span class="id"> r</span><span class="id"> IHr;</span><span class="id"> rewrite</span><span class="id"> !big_cons;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> {IHr}//</span><span class="id"> Pi</span><span class="id"> _</span><span class="id"> ltE12</span>.<br/>
<span class="id">have</span><span class="id"> /andP[le0E1i</span><span class="id"> ltE12i]</span><span class="id"> :=</span><span class="id"> ltE12</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> set</span><span class="id"> E2r</span><span class="id"> :=</span><span class="id"> \prod_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> E2</span><span class="id"> j</span>.<br/>
<span class="id">apply:</span><span class="id"> le_lt_trans</span> (_<span class="id"> :</span><span class="id"> E1</span><span class="id"> i</span><span class="id"> *</span><span class="id"> E2r</span><span class="id"> &lt;</span><span class="id"> E2</span><span class="id"> i</span><span class="id"> *</span><span class="id"> E2r</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_wpM2l</span><span class="id"> ?ler_prod</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> /ltE12/andP[-&gt;</span><span class="id"> /ltW]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltr_pM2r</span><span class="id"> ?prodr_gt0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> /ltE12/andP[le0E1j</span><span class="id"> /le_lt_trans-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_prod_nat</span> (<span class="id">E1</span><span class="id"> E2</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">n</span><span class="id"> m</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> E2</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> \prod_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> E2</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> lt_mn</span><span class="id"> ltE12;</span><span class="id"> rewrite</span><span class="id"> !big_nat</span><span class="id"> ltr_prod</span><span class="id"> {ltE12}//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/hasP;</span><span class="gallina-kwd"> exists</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> ?mem_index_iota</span><span class="id"> leqnn</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_neq0</span><span class="id"> xR;</span><span class="id"> case:</span><span class="id"> real_ltgtP</span><span class="id"> x_neq0</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> hx</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !realE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nmulr_rge0</span><span class="id"> //</span><span class="id"> nmulr_rle0</span><span class="id"> //</span><span class="id"> orbC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> pmulr_rge0</span><span class="id"> //</span><span class="id"> pmulr_rle0</span><span class="id"> //</span><span class="id"> orbC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realrM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y_neq0</span><span class="id"> yR;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> realMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realM</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realrMn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_neq0;</span><span class="id"> rewrite</span><span class="id"> -mulr_natl</span><span class="id"> realMr</span><span class="id"> ?realn</span><span class="id"> ?pnatr_eq0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger_pMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mul1r</span><span class="id"> ler_pM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr_pMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mul1r</span><span class="id"> ltr_pM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger_pMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mulr1</span><span class="id"> ler_pM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr_pMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mulr1</span><span class="id"> ltr_pM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mul1r</span><span class="id"> ler_pM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mul1r</span><span class="id"> ltr_pM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mulr1</span><span class="id"> ler_pM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mulr1</span><span class="id"> ltr_pM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mul1r</span><span class="id"> ler_nM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mul1r</span><span class="id"> ltr_nM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mulr1</span><span class="id"> ler_nM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mulr1</span><span class="id"> ltr_nM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mul1r</span><span class="id"> ler_nM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mul1r</span><span class="id"> ltr_nM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mulr1</span><span class="id"> ler_nM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mulr1</span><span class="id"> ltr_nM2l</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_peMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mul1r</span><span class="id"> ler_wpM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_neMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mul1r</span><span class="id"> ler_wnM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_peMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mulr1</span><span class="id"> ler_wpM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_neMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mulr1</span><span class="id"> ler_wnM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_piMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mul1r</span><span class="id"> ler_wpM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_niMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mul1r</span><span class="id"> ler_wnM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_piMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hy</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> -{2}[y]mulr1</span><span class="id"> ler_wpM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_niMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hx</span><span class="id"> hy;</span><span class="id"> rewrite</span><span class="id"> -{1}[y]mulr1</span><span class="id"> ler_wnM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_ile1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> y</span>)<span class="id"> ?ler_piMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_ilt1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> y</span>)<span class="id"> ?ler_piMl</span><span class="id"> //</span><span class="id"> ltW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_ilte1</span><span class="id"> :=</span> (<span class="id">mulr_ile1,</span><span class="id"> mulr_ilt1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_ege1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> le1x</span><span class="id"> le1y;</span><span class="id"> rewrite</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> y</span>)<span class="id"> ?ler_peMl</span><span class="id"> //</span> (<span class="id">le_trans</span><span class="id"> ler01</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_egt1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> le1x</span><span class="id"> lt1y;</span><span class="id"> rewrite</span> (<span class="id">@lt_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> y</span>)<span class="id"> //</span><span class="id"> ltr_pMl</span><span class="id"> //</span> (<span class="id">lt_trans</span><span class="id"> ltr01</span>).<br/>
Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> mulr_egte1</span><span class="id"> :=</span> (<span class="id">mulr_ege1,</span><span class="id"> mulr_egt1</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_cp1</span><span class="id"> :=</span> (<span class="id">mulr_ilte1,</span><span class="id"> mulr_egte1</span>).<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_gt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x^-1</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [ux</span><span class="id"> |</span><span class="id"> nux]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_out</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> /ltr_pM2r</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> mul0r</span> (<span class="id">mulrV,</span><span class="id"> mulVr</span>)<span class="id"> ?ltr01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x^-1</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !le0r</span><span class="id"> invr_gt0</span><span class="id"> invr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_lt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -oppr_cp0</span><span class="id"> -invrN</span><span class="id"> invr_gt0</span><span class="id"> oppr_cp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_le0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -oppr_cp0</span><span class="id"> -invrN</span><span class="id"> invr_ge0</span><span class="id"> oppr_cp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> invr_gte0</span><span class="id"> :=</span> (<span class="id">invr_ge0,</span><span class="id"> invr_gt0</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> invr_lte0</span><span class="id"> :=</span> (<span class="id">invr_le0,</span><span class="id"> invr_lt0</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_ge0</span><span class="id"> y_ge0;</span><span class="id"> rewrite</span><span class="id"> mulr_ge0</span><span class="id"> ?invr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divr_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0</span><span class="id"> y_gt0;</span><span class="id"> rewrite</span><span class="id"> pmulr_rgt0</span><span class="id"> ?invr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realV</span><span class="id"> :</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> -nnegrE</span><span class="id"> rpredX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realX</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_gt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lt0r</span><span class="id"> expf_eq0</span><span class="id"> =&gt;</span><span class="id"> /andP[/negPf-&gt;</span><span class="id"> /exprn_ge0-&gt;];</span><span class="id"> rewrite</span><span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> exprn_gte0</span><span class="id"> :=</span> (<span class="id">exprn_ge0,</span><span class="id"> exprn_gt0</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_ile1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge0</span><span class="id"> xle1;</span><span class="id"> elim:</span><span class="id"> n=&gt;</span><span class="id"> [|*];</span><span class="id"> rewrite</span><span class="id"> ?expr0</span><span class="id"> //</span><span class="id"> exprS</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_ile1</span><span class="id"> ?exprn_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_ilt1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge0</span><span class="id"> xlt1</span>.<br/>
<span class="id">case:</span><span class="id"> n;</span><span class="id"> [by</span><span class="id"> rewrite</span><span class="id"> eqxx</span><span class="id"> ltxx</span><span class="id"> |</span><span class="id"> elim=&gt;</span><span class="id"> [|n</span><span class="id"> ihn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr1]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mulr_ilt1</span><span class="id"> //</span><span class="id"> exprn_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> exprn_ilte1</span><span class="id"> :=</span> (<span class="id">exprn_ile1,</span><span class="id"> exprn_ilt1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_ege1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_ge1;</span><span class="id"> elim:</span><span class="id"> n=&gt;</span><span class="id"> [|n</span><span class="id"> ihn];</span><span class="id"> rewrite</span><span class="id"> ?expr0</span><span class="id"> //</span><span class="id"> exprS</span><span class="id"> mulr_ege1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_egt1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xgt1;</span><span class="id"> case:</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span><span class="id"> ltxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> elim=&gt;</span><span class="id"> [|n</span><span class="id"> ihn];</span><span class="id"> rewrite</span><span class="id"> ?expr1//</span><span class="id"> exprS</span><span class="id"> mulr_egt1</span><span class="id"> //</span><span class="id"> exprn_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> exprn_egte1</span><span class="id"> :=</span> (<span class="id">exprn_ege1,</span><span class="id"> exprn_egt1</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> exprn_cp1</span><span class="id"> :=</span> (<span class="id">exprn_ilte1,</span><span class="id"> exprn_egte1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_iXnr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> n</span><span class="id"> //</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> ler_piMr</span><span class="id"> //</span><span class="id"> exprn_ile1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_iXnr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n=&gt;</span><span class="id"> [|[|n]]</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr0</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> /lt_gtF</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> x1;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> gtr_pMr</span><span class="id"> //</span><span class="id"> ?exprn_ilt1</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_iXnr</span><span class="id"> :=</span> (<span class="id">ler_iXnr,</span><span class="id"> ltr_iXnr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_eXnr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> _</span><span class="id"> x_ge1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> ler_peMr</span><span class="id"> ?</span>(<span class="id">le_trans</span><span class="id"> _</span><span class="id"> x_ge1</span>)<span class="id"> //</span><span class="id"> exprn_ege1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_eXnr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_ge1;</span><span class="id"> case:</span><span class="id"> n=&gt;</span><span class="id"> [|[|n]]</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr0</span><span class="id"> lt_gtF</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> ltr_pMr</span><span class="id"> ?</span>(<span class="id">lt_trans</span><span class="id"> _</span><span class="id"> x_ge1</span>)<span class="id"> ?exprn_egt1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_eXnr</span><span class="id"> :=</span> (<span class="id">ler_eXnr,</span><span class="id"> ltr_eXnr</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> lter_Xnr</span><span class="id"> :=</span> (<span class="id">lter_iXnr,</span><span class="id"> lter_eXnr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wiXn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> GRing</span>.<span class="id">exp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge0</span><span class="id"> xle1</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /=</span><span class="id"> hmn</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">subnK</span><span class="id"> hmn</span>)<span class="id"> exprD</span><span class="id"> ler_piMl</span><span class="id"> ?</span>(<span class="id">exprn_ge0,</span><span class="id"> exprn_ile1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_weXn2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> GRing</span>.<span class="id">exp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge1</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /=</span><span class="id"> hmn;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">subnK</span><span class="id"> hmn</span>)<span class="id"> exprD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_peMl</span><span class="id"> ?</span>(<span class="id">exprn_ge0,</span><span class="id"> exprn_ege1</span>)<span class="id"> //</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> xge1</span>)<span class="id"> ?ler01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ieexprn_weq1</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> ((<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xle0;</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr0</span><span class="id"> eqxx</span>.<br/>
<span class="id">case:</span> (<span class="id">@real_ltgtP</span><span class="id"> x</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> do</span><span class="id"> ?by</span><span class="id"> rewrite</span><span class="id"> ?ger0_real</span>.<br/>
<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt1;</span><span class="id"> rewrite</span><span class="id"> 1?lt_eqF</span><span class="id"> //</span><span class="id"> exprn_ilt1</span>.<br/>
<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt1;</span><span class="id"> rewrite</span><span class="id"> 1?gt_eqF</span><span class="id"> //</span><span class="id"> exprn_egt1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move-&gt;;</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ieexprIn</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id">GRing</span>.<span class="id">exp</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0</span><span class="id"> x_neq1</span><span class="id"> m</span><span class="id"> n;</span><span class="id"> without</span><span class="id"> loss</span><span class="id"> /subnK</span><span class="id"> &lt;-:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IH</span><span class="id"> eq_xmn;</span><span class="id"> case/orP:</span> (<span class="id">leq_total</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> /IH-&gt;</span>.<br/>
<span class="id">case:</span><span class="id"> {m}</span>(<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> m</span><span class="id"> /eqP/idPn[];</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="id"> ^+</span><span class="id"> n]mul1r</span><span class="id"> exprD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">inj_eq</span> (<span class="id">mulIf</span><span class="id"> _</span>))<span class="id"> ?ieexprn_weq1</span><span class="id"> ?ltW</span><span class="id"> //</span><span class="id"> expf_neq0</span><span class="id"> ?gt_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_iXn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> GRing</span>.<span class="id">exp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xgt0</span><span class="id"> xlt1;</span><span class="id"> apply:</span> (<span class="id">le_nmono</span> (<span class="id">inj_nhomo_lt</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/ler_wiXn2l;</span><span class="id"> exact/ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> ieexprIn;</span><span class="id"> rewrite</span><span class="id"> ?lt_eqF</span><span class="id"> ?ltr_cpable</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_iXn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> GRing</span>.<span class="id">exp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">n</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xgt0</span><span class="id"> xlt1;</span><span class="id"> apply:</span> (<span class="id">leW_nmono</span> (<span class="id">ler_iXn2l</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_iXn2l</span><span class="id"> :=</span> (<span class="id">ler_iXn2l,</span><span class="id"> ltr_iXn2l</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_eXn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> GRing</span>.<span class="id">exp</span><span class="id"> x</span><span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xgt1;</span><span class="id"> apply:</span> (<span class="id">le_mono</span> (<span class="id">inj_homo_lt</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> ler_weXn2l;</span><span class="id"> rewrite</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> ieexprIn;</span><span class="id"> rewrite</span><span class="id"> ?gt_eqF</span><span class="id"> ?gtr_cpable</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> lt_trans</span><span class="id"> xgt1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_eXn2l</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span> (<span class="id">GRing</span>.<span class="id">exp</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> m</span><span class="id"> n</span><span class="id"> /</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> m</span><span class="id"> &lt;</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xgt1;</span><span class="id"> apply:</span> (<span class="id">leW_mono</span> (<span class="id">ler_eXn2l</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_eXn2l</span><span class="id"> :=</span> (<span class="id">ler_eXn2l,</span><span class="id"> ltr_eXn2l</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrXn2r</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge0</span><span class="id"> xlty;</span><span class="id"> case:</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
<span class="id">elim=&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?[_</span><span class="id"> ^+</span><span class="id"> _</span>.<span class="id">+2]exprS</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span>))<span class="id"> ?ler_wpM2l</span><span class="id"> ?ltr_pM2r</span><span class="id"> ?IHn</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprn_gt0</span><span class="id"> //</span> (<span class="id">le_lt_trans</span><span class="id"> xge0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerXn2r</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;</span><span class="id"> ,</span><span class="id"> {homo</span> (<span class="id">@GRing</span>.<span class="id">exp</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=</span><span class="id"> x0</span><span class="id"> y0</span><span class="id"> xy;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">expr0,</span><span class="id"> exprS</span>)<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span>))<span class="id"> ?ler_wpM2l</span><span class="id"> ?ler_wpM2r</span><span class="id"> ?exprn_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lterXn2r</span><span class="id"> :=</span> (<span class="id">lerXn2r,</span><span class="id"> ltrXn2r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_wpXn2r</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;</span><span class="id"> ,</span><span class="id"> {homo</span> (<span class="id">@GRing</span>.<span class="id">exp</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=</span><span class="id"> x0</span><span class="id"> y0</span><span class="id"> hxy;</span><span class="id"> rewrite</span><span class="id"> ltrXn2r</span><span class="id"> //</span><span class="id"> -lt0n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pXn2r</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;</span><span class="id"> ,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">exp</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> _</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !qualifE</span><span class="id"> /=</span><span class="id"> =&gt;</span> <span class="id"> x_ge0</span><span class="id"> y_ge0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nzx]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mul0r</span><span class="id"> exprn_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -subr_ge0</span><span class="id"> subrXX</span><span class="id"> pmulr_lge0</span><span class="id"> ?subr_ge0</span><span class="id"> //=</span><span class="id"> big_ord_recr</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> subnn</span><span class="id"> expr0</span><span class="id"> mul1r</span><span class="id"> /=</span><span class="id"> ltr_pwDr</span><span class="id"> //</span><span class="id"> ?exprn_gt0</span><span class="id"> ?lt0r</span><span class="id"> ?nzx</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sumr_ge0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulr_ge0</span><span class="id"> ?exprn_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pXn2r</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;</span><span class="id"> ,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">exp</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x_ge0</span><span class="id"> y_ge0;</span><span class="id"> rewrite</span><span class="id"> !lt_neqAle</span><span class="id"> !eq_le</span><span class="id"> !ler_pXn2r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pXn2r</span><span class="id"> :=</span> (<span class="id">ler_pXn2r,</span><span class="id"> ltr_pXn2r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pexpIrn</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;,</span><span class="id"> injective</span> ((<span class="id">@GRing</span>.<span class="id">exp</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> n</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> apply:</span><span class="id"> inc_inj_in</span> (<span class="id">ler_pXn2r</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_le1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> -{1}[1]</span>(<span class="id">expr1n</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ler_pXn2r</span><span class="id"> //</span><span class="id"> [_</span><span class="id"> \in</span><span class="id"> _]ler01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_lt1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> -{1}[1]</span>(<span class="id">expr1n</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ltr_pXn2r</span><span class="id"> //</span><span class="id"> [_</span><span class="id"> \in</span><span class="id"> _]ler01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> expr_lte1</span><span class="id"> :=</span> (<span class="id">expr_le1,</span><span class="id"> expr_lt1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_ge1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> -{1}[1]</span>(<span class="id">expr1n</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ler_pXn2r</span><span class="id"> //</span><span class="id"> [_</span><span class="id"> \in</span><span class="id"> _]ler01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_gt1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> -{1}[1]</span>(<span class="id">expr1n</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> ltr_pXn2r</span><span class="id"> //</span><span class="id"> [_</span><span class="id"> \in</span><span class="id"> _]ler01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> expr_gte1</span><span class="id"> :=</span> (<span class="id">expr_ge1,</span><span class="id"> expr_gt1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pexpr_eq1</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> !eq_le</span><span class="id"> expr_le1</span><span class="id"> //</span><span class="id"> expr_ge1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pexprn_eq1</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> ?eqxx</span><span class="id"> //</span><span class="id"> pexpr_eq1</span><span class="id"> ?gtn_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqrXn2</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ngt0</span><span class="id"> xge0</span><span class="id"> yge0;</span><span class="id"> rewrite</span> (<span class="id">inj_in_eq</span> (<span class="id">pexpIrn</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrp_eq1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/pexpr_eq1-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrn_eq1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sqrrN</span><span class="id"> -oppr_ge0</span><span class="id"> -eqr_oppLR</span><span class="id"> =&gt;</span><span class="id"> /sqrp_eq1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_sqr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ler_pXn2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_sqr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ltr_pXn2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pV2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> |</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x]</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /andP</span><span class="id"> [ux</span><span class="id"> hx]</span><span class="id"> /andP</span><span class="id"> [uy</span><span class="id"> hy]</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ler_pM2l</span><span class="id"> hx</span>)<span class="id"> -</span>(<span class="id">ler_pM2r</span><span class="id"> hy</span>)<span class="id"> !</span>(<span class="id">divrr,</span><span class="id"> mulrVK</span>)<span class="id"> ?unitf_gt0</span><span class="id"> //</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nV2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> |</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0]</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /andP</span><span class="id"> [ux</span><span class="id"> hx]</span><span class="id"> /andP</span><span class="id"> [uy</span><span class="id"> hy]</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ler_nM2l</span><span class="id"> hx</span>)<span class="id"> -</span>(<span class="id">ler_nM2r</span><span class="id"> hy</span>)<span class="id"> !</span>(<span class="id">divrr,</span><span class="id"> mulrVK</span>)<span class="id"> ?unitf_lt0</span><span class="id"> //</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pV2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> |</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x]</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> leW_nmono_in</span><span class="id"> ler_pV2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nV2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> |</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0]</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> leW_nmono_in</span><span class="id"> ler_nV2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_gt1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x^-1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Ux</span><span class="id"> xgt0;</span><span class="id"> rewrite</span><span class="id"> -{1}[1]invr1</span><span class="id"> ltr_pV2</span><span class="id"> ?inE</span><span class="id"> ?unitr1</span><span class="id"> ?ltr01</span><span class="id"> ?Ux</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_ge1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x^-1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Ux</span><span class="id"> xgt0;</span><span class="id"> rewrite</span><span class="id"> -{1}[1]invr1</span><span class="id"> ler_pV2</span><span class="id"> ?inE</span><span class="id"> ?unitr1</span><span class="id"> ?ltr01</span><span class="id"> //</span><span class="id"> Ux</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> invr_gte1</span><span class="id"> :=</span> (<span class="id">invr_ge1,</span><span class="id"> invr_gt1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_le1</span><span class="id"> x</span> (<span class="id">ux</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>) (<span class="id">hx</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x^-1</span><span class="id"> &lt;=</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -invr_ge1</span><span class="id"> ?invr_gt0</span><span class="id"> ?unitrV</span><span class="id"> //</span><span class="id"> invrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_lt1</span><span class="id"> x</span> (<span class="id">ux</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>) (<span class="id">hx</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -invr_gt1</span><span class="id"> ?invr_gt0</span><span class="id"> ?unitrV</span><span class="id"> //</span><span class="id"> invrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> invr_lte1</span><span class="id"> :=</span> (<span class="id">invr_le1,</span><span class="id"> invr_lt1</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> invr_cp1</span><span class="id"> :=</span> (<span class="id">invr_gte1,</span><span class="id"> invr_lte1</span>).<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_min</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span> (<span class="id">Order</span>.<span class="id">min</span><span class="id"> m</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> Order</span>.<span class="id">min</span><span class="id"> m%:R</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !minElt</span><span class="id"> ltr_nat</span><span class="id"> /Order</span>.<span class="id">lt/=</span><span class="id"> -fun_if</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_max</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span> (<span class="id">Order</span>.<span class="id">max</span><span class="id"> m</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> Order</span>.<span class="id">max</span><span class="id"> m%:R</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !maxElt</span><span class="id"> ltr_nat</span><span class="id"> /Order</span>.<span class="id">lt/=</span><span class="id"> -fun_if</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_min_max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> +</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /min</span><span class="id"> /max;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_max_min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> +</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> addr_min_max</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minr_to_max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> -</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="id"> +</span><span class="id"> y]addr_min_max</span><span class="id"> addrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxr_to_min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> -</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="id"> +</span><span class="id"> y]addr_max_min</span><span class="id"> addrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_oppr_max</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xr</span><span class="id"> yr;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fun_if,</span><span class="id"> if_arg</span>)<span class="id"> ltrN2;</span><span class="id"> case:</span><span class="id"> real_ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_oppr_min</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xr</span><span class="id"> yr;</span><span class="id"> rewrite</span><span class="id"> -[RHS]opprK</span><span class="id"> real_oppr_max</span><span class="id"> ?realN//</span><span class="id"> !opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_addr_minl</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real,</span><span class="id"> @left_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> min}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> zr;</span><span class="id"> case:</span> (<span class="id">@real_leP</span> (_<span class="id"> +</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?realD//;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> lterD2;</span><span class="id"> case:</span><span class="id"> real_leP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_addr_minr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real,</span><span class="id"> @right_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> min}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> zr;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">addrC</span><span class="id"> x</span>)<span class="id"> real_addr_minl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_addr_maxl</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real,</span><span class="id"> @left_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> max}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> zr;</span><span class="id"> case:</span> (<span class="id">@real_leP</span> (_<span class="id"> +</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?realD//;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> lterD2;</span><span class="id"> case:</span><span class="id"> real_leP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_addr_maxr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real</span><span class="id"> &amp;</span><span class="id"> real,</span><span class="id"> @right_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> max}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> zr;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">addrC</span><span class="id"> x</span>)<span class="id"> real_addr_maxl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minr_pMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> min</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> min</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [|x_gt0||-&gt;]//</span><span class="id"> :=</span><span class="id"> comparableP</span><span class="id"> x;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mul0r</span><span class="id"> minxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fun_if,</span><span class="id"> if_arg</span>)<span class="id"> lter_pM2l//;</span><span class="id"> case:</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxr_pMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> max</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> max</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [|x_gt0||-&gt;]//</span><span class="id"> :=</span><span class="id"> comparableP</span><span class="id"> x;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mul0r</span><span class="id"> maxxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fun_if,</span><span class="id"> if_arg</span>)<span class="id"> lter_pM2l//;</span><span class="id"> case:</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_maxr_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span><span class="id"> max</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> min</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x0</span><span class="id"> yr</span><span class="id"> zr;</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> *</span><span class="id"> _]opprK</span><span class="id"> -mulrN</span><span class="id"> real_oppr_max//</span><span class="id"> -mulNr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> minr_pMr</span><span class="id"> ?oppr_ge0//</span><span class="id"> !</span>(<span class="id">mulNr,</span><span class="id"> mulrN,</span><span class="id"> opprK</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_minr_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> <span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span><span class="id"> min</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> max</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x0</span><span class="id"> yr</span><span class="id"> zr;</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> *</span><span class="id"> _]opprK</span><span class="id"> -mulrN</span><span class="id"> real_oppr_min//</span><span class="id"> -mulNr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> maxr_pMr</span><span class="id"> ?oppr_ge0//</span><span class="id"> !</span>(<span class="id">mulNr,</span><span class="id"> mulrN,</span><span class="id"> opprK</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minr_pMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> min</span><span class="id"> y</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> min</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> minr_pMr</span><span class="id"> //</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxr_pMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> max</span><span class="id"> y</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> max</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> maxr_pMr</span><span class="id"> //</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_minr_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">min</span><span class="id"> y</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> max</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> real_minr_nMr</span><span class="id"> //</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_maxr_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">max</span><span class="id"> y</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> min</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> real_maxr_nMr</span><span class="id"> //</span><span class="id"> ![_</span><span class="id"> *</span><span class="id"> x]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_maxrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> max</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_real;</span><span class="id"> rewrite</span><span class="id"> /max</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> real_ge0P</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [/ge0_cp</span><span class="id"> []</span><span class="id"> |</span><span class="id"> /lt0_cp</span><span class="id"> []];</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">@real_leP</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?realN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_maxNr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> max</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_real;</span><span class="id"> rewrite</span><span class="id"> comparable_maxC</span><span class="id"> ?real_maxrN</span><span class="id"> ?real_comparable</span><span class="id"> ?realN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_minrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> min</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_real;</span><span class="id"> rewrite</span><span class="id"> -[LHS]opprK</span><span class="id"> real_oppr_min</span><span class="id"> ?opprK</span><span class="id"> ?real_maxNr</span><span class="id"> ?realN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_minNr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> <span class="id"> min</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_real;</span><span class="id"> rewrite</span><span class="id"> -[LHS]opprK</span><span class="id"> real_oppr_min</span><span class="id"> ?opprK</span><span class="id"> ?real_maxrN</span><span class="id"> ?realN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> RealDomainArgExtremum</span>.<br/>
<br/>
<span class="vernacular">Context</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> finType}</span> (<span class="id">i0</span><span class="id"> :</span><span class="id"> I</span>).<br/>
<span class="vernacular">Context</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">Pi0</span><span class="id"> :</span><span class="id"> P</span><span class="id"> i0</span>).<br/>
<span class="vernacular">Hypothesis</span><span class="id"> F_real</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> real}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_arg_minP</span><span class="id"> :</span><span class="id"> extremum_spec</span><span class="id"> &lt;=%R</span><span class="id"> P</span><span class="id"> F</span><span class="id"> [arg</span><span class="id"> min_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> i0</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> comparable_arg_minP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span><span class="id"> j</span><span class="id"> iP</span><span class="id"> jP;</span><span class="id"> rewrite</span><span class="id"> real_comparable</span><span class="id"> ?F_real</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_arg_maxP</span><span class="id"> :</span><span class="id"> extremum_spec</span><span class="id"> &gt;=%R</span><span class="id"> P</span><span class="id"> F</span><span class="id"> [arg</span><span class="id"> max_</span>(<span class="id">i</span><span class="id"> &gt;</span><span class="id"> i0</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> comparable_arg_maxP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span><span class="id"> j</span><span class="id"> iP</span><span class="id"> jP;</span><span class="id"> rewrite</span><span class="id"> real_comparable</span><span class="id"> ?F_real</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RealDomainArgExtremum</span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case/real_ge0P=&gt;</span><span class="id"> hx</span><span class="id"> //;</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">ltW</span><span class="id"> hx</span>))<span class="id"> //</span><span class="id"> oppr_ge0</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NormedZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> semiNormedZmodType</span><span class="id"> R</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">u</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_real</span><span class="id"> v</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> \is</span><span class="id"> real</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/ger0_real</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> normr_real</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_norm_sum</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">G</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">`|\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> G</span><span class="id"> i|</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|G</span><span class="id"> i|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/big_rec2:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> y</span><span class="id"> x</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">lerD2l</span><span class="id"> `|G</span><span class="id"> i|</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> le_trans;</span><span class="id"> apply:</span><span class="id"> ler_normD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_normB</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|v</span><span class="id"> -</span><span class="id"> w|</span><span class="id"> &lt;=</span><span class="id"> `|v|</span><span class="id"> +</span><span class="id"> `|w|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> ?normrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distD</span><span class="id"> u</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|v</span><span class="id"> -</span><span class="id"> w|</span><span class="id"> &lt;=</span><span class="id"> `|v</span><span class="id"> -</span><span class="id"> u|</span><span class="id"> +</span><span class="id"> `|u</span><span class="id"> -</span><span class="id"> w|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> addrA</span><span class="id"> addrNK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerB_normD</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> -</span><span class="id"> `|w|</span><span class="id"> &lt;=</span><span class="id"> `|v</span><span class="id"> +</span><span class="id"> w|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1}[v]</span>(<span class="id">addrK</span><span class="id"> w</span>)<span class="id"> lterBDl</span> (<span class="id">le_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> addrC</span><span class="id"> normrN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerB_dist</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|v|</span><span class="id"> -</span><span class="id"> `|w|</span><span class="id"> &lt;=</span><span class="id"> `|v</span><span class="id"> -</span><span class="id"> w|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[`|w|]normrN</span><span class="id"> lerB_normD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_dist_dist</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|</span><span class="id"> `|v|</span><span class="id"> -</span><span class="id"> `|w|</span><span class="id"> |</span><span class="id"> &lt;=</span><span class="id"> `|v</span><span class="id"> -</span><span class="id"> w|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [||_|_]</span><span class="id"> //</span><span class="id"> :=</span><span class="id"> @real_leP</span><span class="id"> `|v|</span><span class="id"> `|w|;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerB_dist</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> distrC</span><span class="id"> lerB_dist</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_dist_normD</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> `|</span><span class="id"> `|v|</span><span class="id"> -</span><span class="id"> `|w|</span><span class="id"> |</span><span class="id"> &lt;=</span><span class="id"> `|v</span><span class="id"> +</span><span class="id"> w|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[w]opprK</span><span class="id"> normrN</span><span class="id"> ler_dist_dist</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_nnorml</span><span class="id"> v</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|v|</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> //;</span><span class="id"> apply/</span>(<span class="id">lt_le_trans</span><span class="id"> h</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_nnorml</span><span class="id"> v</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|v|</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> le_gtF</span><span class="id"> //;</span><span class="id"> apply/</span>(<span class="id">le_trans</span><span class="id"> h</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_nnormr</span><span class="id"> :=</span> (<span class="id">ler_nnorml,</span><span class="id"> ltr_nnorml</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NormedZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">norm</span><span class="id"> _</span><span class="id"> \is</span><span class="id"> real</span>))<span class="id"> =&gt;</span><span class="id"> apply:</span><span class="id"> normr_real</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_norml</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">`|x|</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR;</span><span class="id"> wlog</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> xR</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [hwlog|]</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">xR</span>)<span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">@real_leVge</span><span class="id"> 0</span>)<span class="id"> /orP</span><span class="id"> [|/hwlog-&gt;|hx]</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[x]opprK</span><span class="id"> normrN</span><span class="id"> lerN2</span><span class="id"> andbC</span><span class="id"> lerNl</span><span class="id"> hwlog</span><span class="id"> ?realN</span><span class="id"> ?oppr_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> ger0_norm</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [le_xy|]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> andbF</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> x_ge0</span>)<span class="id"> //</span><span class="id"> oppr_le0</span> (<span class="id">le_trans</span><span class="id"> x_ge0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_normlP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> reflect</span> ((<span class="id">-x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)) (<span class="id">`|x|</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Rx;</span><span class="id"> rewrite</span><span class="id"> real_ler_norml</span><span class="id"> //</span><span class="id"> lerNl;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> andP</span>)<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> []</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> real_ler_normlP</span><span class="id"> {x</span><span class="id"> y}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_eqr_norml</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -y</span>))<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx</span>.<br/>
<span class="id">apply/idP/idP=&gt;</span><span class="id"> [|/andP[/pred2P[]-&gt;</span><span class="id"> /ger0_norm/eqP]];</span><span class="id"> rewrite</span><span class="id"> ?normrE</span><span class="id"> //</span>.<br/>
<span class="id">case:</span><span class="id"> real_le0P</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> 1?eqr_oppLR</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> exy</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> exy</span><span class="id"> ?oppr_le0</span><span class="id"> eqxx</span><span class="id"> orbT</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> hx=&gt;</span><span class="id"> /ltW;</span><span class="id"> rewrite</span><span class="id"> exy</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_eqr_norm2</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> `|y|</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> real_eqr_norml</span><span class="id"> //</span><span class="id"> normrE</span><span class="id"> andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> real_le0P;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> opprK</span><span class="id"> orbC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_norml</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx;</span><span class="id"> wlog</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> Rx</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [hwlog|]</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">Rx</span>)<span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">@real_leVge</span><span class="id"> 0</span>)<span class="id"> /orP</span><span class="id"> [|/hwlog-&gt;|hx]</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[x]opprK</span><span class="id"> normrN</span><span class="id"> ltrN2</span><span class="id"> andbC</span><span class="id"> ltrNl</span><span class="id"> hwlog</span><span class="id"> ?realN</span><span class="id"> ?oppr_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> ger0_norm</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [le_xy|]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> andbF</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> x_ge0</span>)<span class="id"> //</span><span class="id"> oppr_lt0</span> (<span class="id">le_lt_trans</span><span class="id"> x_ge0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> real_lter_norml</span><span class="id"> :=</span> (<span class="id">real_ler_norml,</span><span class="id"> real_ltr_norml</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_normlP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> reflect</span> ((<span class="id">-x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)) (<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Rx;</span><span class="id"> rewrite</span><span class="id"> real_ltr_norml</span><span class="id"> //</span><span class="id"> ltrNl;</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">@andP</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> case</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> real_ltr_normlP</span><span class="id"> {x</span><span class="id"> y}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_normr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> `|y|</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ry</span>.<br/>
<span class="id">have</span><span class="id"> [xR|xNR]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?Nreal_leF</span><span class="id"> ?realN</span>.<br/>
<span class="id">rewrite</span><span class="id"> real_leNgt</span><span class="id"> ?real_ltr_norml</span><span class="id"> //</span><span class="id"> negb_and</span><span class="id"> -?real_leNgt</span><span class="id"> ?realN</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> orbC</span><span class="id"> lerNr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_normr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> `|y|</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ry</span>.<br/>
<span class="id">have</span><span class="id"> [xR|xNR]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?Nreal_ltF</span><span class="id"> ?realN</span>.<br/>
<span class="id">rewrite</span><span class="id"> real_ltNge</span><span class="id"> ?real_ler_norml</span><span class="id"> //</span><span class="id"> negb_and</span><span class="id"> -?real_ltNge</span><span class="id"> ?realN</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> orbC</span><span class="id"> ltrNr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> real_lter_normr</span><span class="id"> :=</span> (<span class="id">real_ler_normr,</span><span class="id"> real_ltr_normr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_normlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> case/real_ltr_normlP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltrNnormlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> case/real_ltr_normlP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ltrNl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_normlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> case/real_ler_normlP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_lerNnormlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> case/real_ler_normlP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> lerNl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_distl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Rxy;</span><span class="id"> rewrite</span><span class="id"> real_lter_norml</span><span class="id"> //</span><span class="id"> !lterBDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_distl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Rxy;</span><span class="id"> rewrite</span><span class="id"> real_lter_norml</span><span class="id"> //</span><span class="id"> !lterBDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> real_lter_distl</span><span class="id"> :=</span> (<span class="id">real_ler_distl,</span><span class="id"> real_ltr_distl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_distlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> real_ltr_distl</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_distlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> real_ler_distl</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_distlCDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realBC</span> (<span class="id">distrC</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /real_ltr_distlDr;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_distlCDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realBC</span><span class="id"> distrC</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /real_ler_distlDr;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_distlBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/real_ltr_distlDr;</span><span class="id"> rewrite</span><span class="id"> ltrBlDr;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_distlBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/real_ler_distlDr;</span><span class="id"> rewrite</span><span class="id"> lerBlDr;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltr_distlCBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realBC</span><span class="id"> distrC</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /real_ltr_distlBl;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ler_distlCBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realBC</span><span class="id"> distrC</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /real_ler_distlBl;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `ger0_def` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_norm_id</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_def</span>. Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `ler0_def` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_normN</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler0_def</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> eqr_norm_idVN</span><span class="id"> :=</span><span class="id"> =^~</span> (<span class="id">ger0_def,</span><span class="id"> ler0_def</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_even_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR</span><span class="id"> even_n;</span><span class="id"> have</span><span class="id"> [/exprn_ge0</span><span class="id"> -&gt;</span><span class="id"> //|x_lt0]</span><span class="id"> :=</span><span class="id"> real_ge0P</span><span class="id"> xR</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[x]opprK</span><span class="id"> -mulN1r</span><span class="id"> exprMn</span><span class="id"> -signr_odd</span> (<span class="id">negPf</span><span class="id"> even_n</span>)<span class="id"> expr0</span><span class="id"> mul1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprn_ge0</span><span class="id"> ?oppr_ge0</span><span class="id"> ?ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_even_gt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> ||</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR</span><span class="id"> n_even;</span><span class="id"> rewrite</span><span class="id"> lt0r</span><span class="id"> real_exprn_even_ge0</span><span class="id"> ?expf_eq0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> andbT</span><span class="id"> negb_and</span><span class="id"> lt0n</span><span class="id"> negbK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_even_le0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR</span><span class="id"> n_even;</span><span class="id"> rewrite</span><span class="id"> !real_leNgt</span><span class="id"> ?rpred0</span><span class="id"> ?rpredX</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> real_exprn_even_gt0</span><span class="id"> //</span><span class="id"> negb_or</span><span class="id"> negbK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_even_lt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xR</span><span class="id"> n_even;</span><span class="id"> rewrite</span><span class="id"> le_gtF</span><span class="id"> //</span><span class="id"> real_exprn_even_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_odd_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/real_ge0P</span><span class="id"> =&gt;</span><span class="id"> [x_ge0|x_lt0]</span><span class="id"> n_odd;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprn_ge0</span>.<br/>
<span class="id">apply:</span><span class="id"> negbTE;</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> //</span>.<br/>
<span class="id">case:</span><span class="id"> n</span><span class="id"> n_odd</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> /=</span><span class="id"> n_even;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> pmulr_llt0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> real_exprn_even_gt0</span><span class="id"> ?ler0_real</span><span class="id"> ?ltW</span><span class="id"> //</span> (<span class="id">lt_eqF</span><span class="id"> x_lt0</span>)<span class="id"> ?orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_odd_gt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xR</span><span class="id"> n_odd;</span><span class="id"> rewrite</span><span class="id"> !lt0r</span><span class="id"> expf_eq0</span><span class="id"> real_exprn_odd_ge0;</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> n_odd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_odd_le0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xR</span><span class="id"> n_odd;</span><span class="id"> rewrite</span><span class="id"> !real_leNgt</span><span class="id"> ?rpred0</span><span class="id"> ?rpredX</span><span class="id"> //</span><span class="id"> real_exprn_odd_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_exprn_odd_lt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xR</span><span class="id"> n_odd;</span><span class="id"> rewrite</span><span class="id"> !real_ltNge</span><span class="id"> ?rpred0</span><span class="id"> ?rpredX</span><span class="id"> //</span><span class="id"> real_exprn_odd_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realEsqr</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_def</span><span class="id"> normrX</span><span class="id"> eqf_sqr</span><span class="id"> -ger0_def</span><span class="id"> -ler0_def</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_normK</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Rx;</span><span class="id"> rewrite</span><span class="id"> -normrX</span><span class="id"> ger0_norm</span><span class="id"> -?realEsqr</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_sign</span><span class="id"> s</span><span class="id"> :</span><span class="id"> `|</span>(<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> s</span><span class="id"> :</span><span class="id"> R|</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normrX</span><span class="id"> normrN1</span><span class="id"> expr1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normrMsign</span><span class="id"> s</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|</span>(<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> s</span><span class="id"> *</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normrM</span><span class="id"> normr_sign</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_gt0</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> ~~</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b;</span><span class="id"> rewrite</span> (<span class="id">ltr01,</span><span class="id"> ltr0N1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_lt0</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> ?</span>(<span class="id">ltrN10,</span><span class="id"> ltr10</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_ge0</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> ~~</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le0r</span><span class="id"> signr_eq0</span><span class="id"> signr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_le0</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> signr_eq0</span><span class="id"> signr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_inj</span><span class="id"> :</span><span class="id"> injective</span> (<span class="gallina-kwd">fun</span><span class="id"> b</span><span class="id"> :</span><span class="id"> bool</span><span class="id"> =&gt;</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> can_inj</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> 0</span><span class="id"> &gt;=</span><span class="id"> x</span>)<span class="id"> signr_le0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_def</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *+</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sg;</span><span class="id"> do</span><span class="id"> 2!case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> neqr0_sign</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> =</span><span class="id"> sgr</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgr_def</span> <span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gtr0_sg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> /sg</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> lt_gtF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr0_sg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_lt0;</span><span class="id"> rewrite</span><span class="id"> /sg</span><span class="id"> x_lt0</span><span class="id"> lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr0</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sgr</span><span class="id"> eqxx</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sgr1</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gtr0_sg</span><span class="id"> //</span><span class="id"> ltr01</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sgrN1</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">-1</span>)<span class="id"> =</span><span class="id"> -1</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr0_sg</span><span class="id"> //</span><span class="id"> ltrN10</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> sgrE</span><span class="id"> :=</span> (<span class="id">sgr0,</span><span class="id"> sgr1,</span><span class="id"> sgrN1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqr_sg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgr_def</span><span class="id"> exprMn_n</span><span class="id"> sqrr_sign</span><span class="id"> -mulnn</span><span class="id"> mulnb</span><span class="id"> andbb</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sg_eq1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /sg</span><span class="id"> eq_sym;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?mul1r</span><span class="id"> //</span><span class="id"> mulN1r</span><span class="id"> eqr_oppLR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sg_eqN1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sg</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> -1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> sg</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/sg:</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> /sg</span><span class="id"> eq_sym</span><span class="id"> eqr_oppLR</span>.<br/>
<span class="id">case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> oppr0</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?mul1r</span><span class="id"> //</span><span class="id"> mulN1r</span><span class="id"> eqr_oppLR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sqrf_eq0</span><span class="id"> sqr_sg</span><span class="id"> pnatr_eq0;</span><span class="id"> case:</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_odd</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">sg</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">sg</span><span class="id"> x</span>)<span class="id"> ^+</span> (<span class="id">odd</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sg;</span><span class="id"> do</span><span class="id"> 2!case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?expr1n</span><span class="id"> ?signr_odd</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgrMn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%:R</span><span class="id"> *</span><span class="id"> sg</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0n</span><span class="id"> sgr0</span><span class="id"> mul0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !sgr_def</span><span class="id"> mulrn_eq0</span><span class="id"> mul1r</span><span class="id"> pmulrn_llt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_nat</span><span class="id"> n</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> n%:R</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgrMn</span><span class="id"> sgr1</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_id</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">sg</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> sg</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fun_if</span><span class="id"> sg</span>)<span class="id"> !sgrE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_lt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /sg;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> _]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?ltrN10</span><span class="id"> //</span><span class="id"> lt_gtF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_le0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sgr</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !le_eqVlt</span><span class="id"> sgr_eq0</span><span class="id"> sgr_lt0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realEsign</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/real_ge0P;</span><span class="id"> rewrite</span> (<span class="id">mul1r,</span><span class="id"> mulN1r</span>)<span class="id"> ?opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realNEsign</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Rx;</span><span class="id"> rewrite</span><span class="id"> -normrN</span><span class="id"> -oppr_lt0</span><span class="id"> -realEsign</span><span class="id"> ?rpredN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_normrEsign</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">xR</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {3}[x]realEsign</span><span class="id"> //</span><span class="id"> signrMK</span>. Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `realEsign` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Lemma</span><span class="id"> real_mulr_sign_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/realEsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mulr_Nsign_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/realNEsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realEsg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> sgr</span><span class="id"> x</span><span class="id"> *</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xR;</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> ]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normr0</span><span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /neqr0_sign</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> -realEsign</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_sg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|sg</span><span class="id"> x|</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgr_def</span><span class="id"> -mulr_natr</span><span class="id"> normrMsign</span><span class="id"> normr_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> `|x|</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sg</span><span class="id"> le_gtF</span><span class="id"> //</span><span class="id"> normr_eq0</span><span class="id"> mulrb</span><span class="id"> if_neg</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_nat_r</span><span class="id"> m</span><span class="id"> n</span><span class="id"> C</span><span class="id"> :</span> (<span class="id">m%:R</span><span class="id"> &lt;=</span><span class="id"> n%:R</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /leif</span><span class="id"> !ler_nat</span><span class="id"> eqr_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leifBLR</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> C</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /leif</span><span class="id"> !eq_le</span><span class="id"> lerBlDr</span><span class="id"> lerBrDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leifBRL</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> C</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -leifBLR</span><span class="id"> opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leifD</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> C1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> C2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y2</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C2</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x1</span><span class="id"> +</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> +</span><span class="id"> y2</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C1</span><span class="id"> &amp;&amp;</span><span class="id"> C2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mono_leif</span> (<span class="id">C</span><span class="id"> :=</span><span class="id"> C1</span>) (<span class="id">lerD2r</span><span class="id"> x2</span>)).<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mono_leif</span> (<span class="id">C</span><span class="id"> :=</span><span class="id"> C2</span>) (<span class="id">lerD2l</span><span class="id"> y1</span>)).<br/>
<span class="id">exact:</span><span class="id"> leif_trans</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> C</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E1</span><span class="id"> E2</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> E2</span><span class="id"> i</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E2</span><span class="id"> i</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> [forall</span> (<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id">,</span><span class="id"> C</span><span class="id"> i]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> leE12;</span><span class="id"> rewrite</span><span class="id"> -big_andE</span>.<br/>
<span class="id">elim/big_rec3:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Ci</span><span class="id"> m2</span><span class="id"> m1</span><span class="id"> /leE12];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /leif</span><span class="id"> lexx</span><span class="id"> eqxx</span>.<br/>
<span class="id">exact:</span><span class="id"> leifD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_0_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> C</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E</span><span class="id"> i</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> [forall</span> (<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id">,</span><span class="id"> C</span><span class="id"> i]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/leif_sum;</span><span class="id"> rewrite</span><span class="id"> big1_eq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leif_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xR;</span><span class="id"> rewrite</span><span class="id"> ger0_def</span><span class="id"> eq_sym;</span><span class="id"> apply:</span><span class="id"> leif_eq;</span><span class="id"> rewrite</span><span class="id"> real_ler_norm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_pM</span><span class="id"> x1</span><span class="id"> x2</span><span class="id"> y1</span><span class="id"> y2</span><span class="id"> C1</span><span class="id"> C2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y2</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C2</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">y1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span><span class="id"> C1</span><span class="id"> &amp;&amp;</span><span class="id"> C2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x1_ge0</span><span class="id"> x2_ge0</span><span class="id"> le_xy1</span><span class="id"> le_xy2;</span><span class="id"> have</span><span class="id"> [y_0</span><span class="id"> |</span><span class="id"> ]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> _</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/leifP;</span><span class="id"> rewrite</span><span class="id"> y_0</span><span class="id"> /=</span><span class="id"> mulf_eq0</span><span class="id"> !eq_le</span><span class="id"> x1_ge0</span><span class="id"> x2_ge0</span><span class="id"> !andbT</span>.<br/>
&nbsp;&nbsp;<span class="id">move/eqP:</span><span class="id"> y_0;</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/pred2P=&gt;</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span> (<span class="id">le_xy1,</span><span class="id"> le_xy2</span>)<span class="id"> ?orbT</span>.<br/>
<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> mulf_eq0</span><span class="id"> =&gt;</span><span class="id"> /norP[y1nz</span><span class="id"> y2nz]</span>.<br/>
<span class="id">have</span><span class="id"> y1_gt0:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> y1nz</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> le_xy1</span>).<br/>
<span class="id">have</span><span class="id"> [x2_0</span><span class="id"> |</span><span class="id"> x2nz]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x2</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/leifP;</span><span class="id"> rewrite</span><span class="id"> -le_xy2</span><span class="id"> x2_0</span><span class="id"> eq_sym</span> (<span class="id">negPf</span><span class="id"> y2nz</span>)<span class="id"> andbF</span><span class="id"> mulr0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_gt0</span><span class="id"> //</span><span class="id"> lt_def</span><span class="id"> y2nz</span><span class="id"> -x2_0</span><span class="id"> le_xy2</span>.<br/>
<span class="id">have:=</span><span class="id"> le_xy2;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> -&gt;</span><span class="id"> _]</span>(<span class="id">mono_leif</span> (<span class="id">ler_pM2l</span><span class="id"> y1_gt0</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leif_trans;</span><span class="id"> rewrite</span> (<span class="id">mono_leif</span> (<span class="id">ler_pM2r</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> lt_def</span><span class="id"> x2nz</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_nM</span><span class="id"> x1</span><span class="id"> x2</span><span class="id"> y1</span><span class="id"> y2</span><span class="id"> C1</span><span class="id"> C2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">y1</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y2</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y2</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C2</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">y1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span><span class="id"> C1</span><span class="id"> &amp;&amp;</span><span class="id"> C2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -!oppr_ge0</span><span class="id"> -mulrNN</span><span class="id"> -[x1</span><span class="id"> *</span><span class="id"> x2]mulrNN</span><span class="id"> =&gt;</span><span class="id"> y1le0</span><span class="id"> y2le0</span><span class="id"> le_xy1</span><span class="id"> le_xy2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leif_pM</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span> (<span class="id">nmono_leif</span><span class="id"> lerN2</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_pprod</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> C</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E1</span><span class="id"> E2</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E1</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E1</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> E2</span><span class="id"> i</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> C</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> pi</span><span class="id"> E</span><span class="id"> :=</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">pi</span><span class="id"> E1</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> E2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">pi</span><span class="id"> E2</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span><span class="id"> [forall</span> (<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id">,</span><span class="id"> C</span><span class="id"> i]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> E1_ge0</span><span class="id"> leE12</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -big_andE;</span><span class="id"> elim/</span>(<span class="id">big_load</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>))<span class="id">:</span><span class="id"> _</span>.<br/>
<span class="id">elim/big_rec3:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Ci</span><span class="id"> m2</span><span class="id"> m1</span><span class="id"> Pi</span><span class="id"> [m1ge0</span><span class="id"> le_m12]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> apply/leifP;</span><span class="id"> rewrite</span><span class="id"> orbT</span>.<br/>
<span class="id">have</span><span class="id"> Ei_ge0</span><span class="id"> :=</span><span class="id"> E1_ge0</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_ge0</span>.<br/>
<span class="id">congr</span> (<span class="id">leif</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">:</span> (<span class="id">leif_pM</span><span class="id"> Ei_ge0</span><span class="id"> m1ge0</span> (<span class="id">leE12</span><span class="id"> i</span><span class="id"> Pi</span>)<span class="id"> le_m12</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span><span class="id"> -!orbA;</span><span class="id"> congr</span> (_<span class="id"> ||</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !orb_andr</span><span class="id"> orbA</span><span class="id"> orbb</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_lteifr0</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> subr_lte0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_lteif0r</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> subr_gte0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> subr_lteif0</span><span class="id"> :=</span> (<span class="id">subr_lteifr0,</span><span class="id"> subr_lteif0r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif01</span><span class="id"> C</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter01</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifNl</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterNl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifNr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif0Nr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span> (<span class="id">oppr_ge0,</span><span class="id"> oppr_gt0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifNr0</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span> (<span class="id">oppr_le0,</span><span class="id"> oppr_lt0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifN2</span><span class="id"> C</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> :&gt;</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lteif_oppE</span><span class="id"> :=</span> (<span class="id">lteif0Nr,</span><span class="id"> lteifNr0,</span><span class="id"> lteifN2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifD2l</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> +%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifD2r</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> +%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterD2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lteifD2</span><span class="id"> :=</span> (<span class="id">lteifD2l,</span><span class="id"> lteifD2r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifBlDr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterBDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifBrDr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterBDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lteifBDr</span><span class="id"> :=</span> (<span class="id">lteifBlDr,</span><span class="id"> lteifBrDr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifBlDl</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterBDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteifBrDl</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lterBDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lteifBDl</span><span class="id"> :=</span> (<span class="id">lteifBlDl,</span><span class="id"> lteifBrDl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_pM2l</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_pM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_pM2r</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_pM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_nM2l</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /~</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_nM2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_nM2r</span><span class="id"> C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%R^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /~</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_nM2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_nnormr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> ~~</span><span class="id"> C</span><span class="id"> -&gt;</span> (<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_nnormr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_lteifNE</span><span class="id"> x</span><span class="id"> y</span><span class="id"> C</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> ~~</span><span class="id"> C</span><span class="id"> =</span><span class="id"> ~~</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> comparable_lteifNE</span><span class="id"> ?real_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_lteif_norml</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> ((<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> real_lter_norml</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_lteif_normr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">y</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> &lt;</span><span class="id"> `|y|</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> real_lter_normr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_lteif_distl</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> real_lter_distl</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leif_mean_square_scaled</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> *+</span><span class="id"> 2]add0r</span><span class="id"> -leifBRL</span><span class="id"> addrAC</span><span class="id"> -sqrrB</span><span class="id"> -subr_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -sqrf_eq0</span><span class="id"> eq_sym;</span><span class="id"> apply:</span><span class="id"> leif_eq;</span><span class="id"> rewrite</span><span class="id"> -realEsqr</span><span class="id"> rpredB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leif_AGM2_scaled</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 4</span><span class="id"> &lt;=</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> sqrrD</span><span class="id"> addrAC</span> (<span class="id">mulrnDr</span><span class="id"> _</span><span class="id"> 2</span>)<span class="id"> -leifBLR</span><span class="id"> addrK</span>.<br/>
<span class="id">exact:</span><span class="id"> real_leif_mean_square_scaled</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_AGM_scaled</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">n</span><span class="id"> :=</span><span class="id"> #|A|</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> A,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>) (<span class="id">E</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> &lt;=</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> ^+</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">?=</span><span class="id"> iff</span><span class="id"> [forall</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> A,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="gallina-kwd"> in</span><span class="id"> A,</span><span class="id"> E</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> E</span><span class="id"> j]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [m</span><span class="id"> leAm]</span><span class="id"> :=</span><span class="id"> ubnP</span><span class="id"> #|A|;</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> m</span><span class="id"> IHm</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> leAm</span><span class="id"> E</span><span class="id"> n</span><span class="id"> *</span><span class="id"> =&gt;</span><span class="id"> Ege0</span>.<br/>
<span class="id">apply/leifP;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [/forall_inP-Econstant</span><span class="id"> |</span><span class="id"> Enonconstant]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [i</span><span class="id"> /=</span><span class="id"> Ai</span><span class="id"> |</span><span class="id"> A0]</span><span class="id"> :=</span><span class="id"> pickP</span><span class="id"> [in</span><span class="id"> A];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [n]eq_card0</span><span class="id"> ?big_pred0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> /eqfun_inP-E_i</span><span class="id"> :=</span><span class="id"> Econstant</span><span class="id"> i</span><span class="id"> Ai;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eq_bigr</span><span class="id"> _</span><span class="id"> E_i</span>)<span class="id"> sumr_const</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprMn_n</span><span class="id"> prodrMn_const</span><span class="id"> -</span>(<span class="id">eq_bigr</span><span class="id"> _</span><span class="id"> E_i</span>)<span class="id"> prodr_const</span>.<br/>
<span class="id">set</span><span class="id"> mu</span><span class="id"> :=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> E</span><span class="id"> i;</span><span class="id"> pose</span><span class="id"> En</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> E</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<span class="id">pose</span><span class="id"> cmp_mu</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> [pred</span><span class="id"> i</span><span class="id"> |</span><span class="id"> s</span><span class="id"> *</span><span class="id"> mu</span><span class="id"> &lt;</span><span class="id"> s</span><span class="id"> *</span><span class="id"> En</span><span class="id"> i]</span>.<br/>
<span class="id">have{Enonconstant}</span><span class="id"> has_cmp_mu</span><span class="id"> e</span> (<span class="id">s</span><span class="id"> :=</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> e</span>)<span class="id">:</span><span class="id"> {i</span><span class="id"> |</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> cmp_mu</span><span class="id"> s</span><span class="id"> i}</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/sig2W/exists_inP;</span><span class="id"> apply:</span><span class="id"> contraR</span><span class="id"> Enonconstant</span><span class="id"> =&gt;</span><span class="id"> /exists_inPn-mu_s_A</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> n_gt0</span><span class="id"> i:</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> A</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [n]</span>(<span class="id">cardD1</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">have{}</span><span class="id"> mu_s_A</span><span class="id"> i:</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> s</span><span class="id"> *</span><span class="id"> En</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> s</span><span class="id"> *</span><span class="id"> mu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> Ai;</span><span class="id"> rewrite</span><span class="id"> real_leNgt</span><span class="id"> ?mu_s_A</span><span class="id"> ?rpredMsign</span><span class="id"> ?ger0_real</span><span class="id"> ?Ege0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">pmulrn_lge0</span><span class="id"> _</span> (<span class="id">n_gt0</span><span class="id"> i</span><span class="id"> Ai</span>))<span class="id"> -sumrMnl</span><span class="id"> sumr_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [_</span><span class="id"> /esym/eqfun_inP]</span><span class="id"> :=</span><span class="id"> leif_sum</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> Ai</span><span class="id"> =&gt;</span><span class="id"> leif_eq</span> (<span class="id">mu_s_A</span><span class="id"> i</span><span class="id"> Ai</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sumr_const</span><span class="id"> -/n</span><span class="id"> -mulr_sumr</span><span class="id"> sumrMnl</span><span class="id"> -/mu</span><span class="id"> mulrnAr</span><span class="id"> eqxx</span><span class="id"> =&gt;</span><span class="id"> A_mu</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/forall_inP=&gt;</span><span class="id"> i</span><span class="id"> Ai;</span><span class="id"> apply/eqfun_inP=&gt;</span><span class="id"> j</span><span class="id"> Aj</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">pmulrnI</span> (<span class="id">n_gt0</span><span class="id"> i</span><span class="id"> Ai</span>))<span class="id">;</span><span class="id"> apply:</span> (<span class="id">can_inj</span> (<span class="id">signrMK</span><span class="id"> e</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !A_mu</span>.<br/>
<span class="id">have</span><span class="id"> [[i</span><span class="id"> Ai</span><span class="id"> Ei_lt_mu]</span><span class="id"> [j</span><span class="id"> Aj</span><span class="id"> Ej_gt_mu]]</span><span class="id"> :=</span> (<span class="id">has_cmp_mu</span><span class="id"> 1,</span><span class="id"> has_cmp_mu</span><span class="id"> 0</span>)<span class="id">%N</span>.<br/>
<span class="id">rewrite</span><span class="id"> {cmp_mu</span><span class="id"> has_cmp_mu}/=</span><span class="id"> !mul1r</span><span class="id"> !mulN1r</span><span class="id"> ltrN2</span><span class="gallina-kwd"> in</span><span class="id"> Ei_lt_mu</span><span class="id"> Ej_gt_mu</span>.<br/>
<span class="id">pose</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> [predD1</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> i];</span><span class="id"> pose</span><span class="id"> n'</span><span class="id"> :=</span><span class="id"> #|A'|</span>.<br/>
<span class="id">have</span><span class="id"> [Dn</span><span class="id"> n_gt0]:</span><span class="id"> n</span><span class="id"> =</span><span class="id"> n'</span>.<span class="id">+1</span><span class="id"> /\</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span> <span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [n]</span>(<span class="id">cardD1</span><span class="id"> i</span>)<span class="id"> Ai</span>.<br/>
<span class="id">have</span><span class="id"> i'j:</span><span class="id"> j</span><span class="id"> !=</span><span class="id"> i</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraTneq</span><span class="id"> Ej_gt_mu</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> lt_gtF</span>.<br/>
<span class="id">have{i'j}</span><span class="id"> A'j:</span><span class="id"> j</span><span class="id"> \in</span><span class="id"> A'</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> Aj</span><span class="id"> i'j</span>.<br/>
<span class="id">have</span><span class="id"> mu_gt0:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> mu</span><span class="id"> :=</span><span class="id"> le_lt_trans</span> (<span class="id">Ege0</span><span class="id"> i</span><span class="id"> Ai</span>)<span class="id"> Ei_lt_mu</span>.<br/>
<span class="id">rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //</span><span class="id"> big_andbC</span> (<span class="id">bigD1</span><span class="id"> j</span>)<span class="id"> //=</span><span class="id"> mulrA;</span><span class="id"> set</span><span class="id"> pi</span><span class="id"> :=</span><span class="id"> \prod_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_pi]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> pi</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr0</span><span class="id"> exprn_gt0</span>.<br/>
<span class="id">have{nz_pi}</span><span class="id"> pi_gt0:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> pi</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> nz_pi</span><span class="id"> prodr_ge0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /andP[/andP[_</span><span class="id"> /Ege0]]</span>.<br/>
<span class="id">rewrite</span><span class="id"> -/</span>(<span class="id">En</span><span class="id"> i</span>)<span class="id"> -/</span>(<span class="id">En</span><span class="id"> j</span>)<span class="id">;</span><span class="id"> pose</span><span class="id"> E'</span><span class="id"> :=</span><span class="id"> [eta</span><span class="id"> En</span><span class="gallina-kwd"> with</span><span class="id"> j</span><span class="id"> |-&gt;</span><span class="id"> En</span><span class="id"> i</span><span class="id"> +</span><span class="id"> En</span><span class="id"> j</span><span class="id"> -</span><span class="id"> mu]</span>.<br/>
<span class="id">have</span><span class="id"> E'ge0</span><span class="id"> k:</span><span class="id"> k</span><span class="id"> \in</span><span class="id"> A'</span><span class="id"> -&gt;</span><span class="id"> E'</span><span class="id"> k</span><span class="id"> *+</span><span class="id"> n'</span><span class="id"> &gt;=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">case/andP=&gt;</span><span class="id"> /=</span><span class="id"> _</span><span class="id"> Ak;</span><span class="id"> apply:</span><span class="id"> mulrn_wge0;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> Ege0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subr_ge0</span><span class="id"> ler_wpDl</span><span class="id"> ?Ege0</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="id">rewrite</span><span class="id"> -/n</span><span class="id"> Dn</span><span class="gallina-kwd"> in</span><span class="id"> leAm;</span><span class="id"> have{leAm</span><span class="id"> IHm</span><span class="id"> E'ge0}:</span><span class="id"> _</span><span class="id"> &lt;=</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> IHm</span><span class="id"> _</span><span class="id"> leAm</span><span class="id"> _</span><span class="id"> E'ge0</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;:</span><span class="id"> \sum_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> A'</span>)<span class="id"> E'</span><span class="id"> k</span><span class="id"> =</span><span class="id"> mu</span><span class="id"> *+</span><span class="id"> n'</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">addrI</span><span class="id"> mu</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrS</span><span class="id"> -Dn</span><span class="id"> -sumrMnl</span> (<span class="id">bigD1</span><span class="id"> i</span><span class="id"> Ai</span>)<span class="id"> big_andbC</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">bigD1</span><span class="id"> j</span><span class="id"> A'j</span>)<span class="id"> /=</span><span class="id"> addrCA</span><span class="id"> eqxx</span><span class="id"> !addrA</span><span class="id"> subrK;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /andP[_</span><span class="id"> /negPf-&gt;]</span>.<br/>
<span class="id">rewrite</span><span class="id"> prodrMn_const</span><span class="id"> exprMn_n</span><span class="id"> -/n'</span><span class="id"> ler_pMn2r</span><span class="id"> ?expn_gt0;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">n'</span>).<br/>
<span class="id">have</span><span class="id"> -&gt;:</span><span class="id"> \prod_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> A'</span>)<span class="id"> E'</span><span class="id"> k</span><span class="id"> =</span><span class="id"> E'</span><span class="id"> j</span><span class="id"> *</span><span class="id"> pi</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> j</span>)<span class="id"> //=;</span><span class="id"> congr</span><span class="id"> *%R;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /andP[_</span><span class="id"> /negPf-&gt;]</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">ler_pM2l</span><span class="id"> mu_gt0</span>)<span class="id"> -exprS</span><span class="id"> -Dn</span><span class="id"> mulrA;</span><span class="id"> apply:</span><span class="id"> lt_le_trans</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pM2r</span><span class="id"> //=</span><span class="id"> eqxx</span><span class="id"> -addrA</span><span class="id"> mulrDr</span><span class="id"> mulrC</span><span class="id"> -ltrBlDl</span><span class="id"> -mulrBl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ltr_pM2r</span><span class="id"> ?subr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poly_disk_bound</span><span class="id"> p</span><span class="id"> b</span><span class="id"> :</span><span class="id"> {ub</span><span class="id"> |</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> `|x|</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> `|p</span>.<span class="id">[x]|</span><span class="id"> &lt;=</span><span class="id"> ub}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">exists</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> &lt;</span><span class="id"> size</span><span class="id"> p</span>)<span class="id"> `|p`_j|</span><span class="id"> *</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> j</span>)<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> le_x_b</span>.<br/>
<span class="id">rewrite</span><span class="id"> horner_coef</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_sum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> ?ler_sum</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> normrM</span><span class="id"> normrX</span><span class="id"> ler_wpM2l</span><span class="id"> ?lerXn2r</span><span class="id"> ?unfold_in</span><span class="id"> //=</span>.<br/>
<span class="id">exact:</span><span class="id"> le_trans</span> (<span class="id">normr_ge0</span><span class="id"> x</span>)<span class="id"> le_x_b</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> NumDomainOperationTheory</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> lerN2</span><span class="id"> ltrN2</span><span class="id"> normr_real</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">_%:R</span><span class="id"> \is</span><span class="id"> real</span>))<span class="id"> =&gt;</span><span class="id"> apply:</span><span class="id"> realn</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">0</span><span class="id"> \is</span><span class="id"> real</span>))<span class="id"> =&gt;</span><span class="id"> apply:</span><span class="id"> real0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">1</span><span class="id"> \is</span><span class="id"> real</span>))<span class="id"> =&gt;</span><span class="id"> apply:</span><span class="id"> real1</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> ler_sqr</span><span class="id"> {R}</span><span class="id"> [x</span><span class="id"> y]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> ltr_sqr</span><span class="id"> {R}</span><span class="id"> [x</span><span class="id"> y]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> signr_inj</span><span class="id"> {R}</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> real_ler_normlP</span><span class="id"> {R</span><span class="id"> x</span><span class="id"> y}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> real_ltr_normlP</span><span class="id"> {R</span><span class="id"> x</span><span class="id"> y}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NumDomainMonotonyTheoryForReals</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> order_scope</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> R'</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">D</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R'</span>) (<span class="id">f'</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> w</span><span class="id"> :</span><span class="id"> R'</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mono</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> mf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xR</span><span class="id"> yR</span><span class="id"> /=;</span><span class="id"> have</span><span class="id"> [lt_xy</span><span class="id"> |</span><span class="id"> le_yx]</span><span class="id"> :=</span><span class="id"> real_leP</span><span class="id"> xR</span><span class="id"> yR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW_homo</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?mf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_nmono</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> mf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xR</span><span class="id"> yR</span><span class="id"> /=;</span><span class="id"> have</span><span class="id"> [lt_xy|le_yx]</span><span class="id"> :=</span><span class="id"> real_ltP</span><span class="id"> xR</span><span class="id"> yR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?mf</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW_nhomo</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mono_in</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> D</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> D</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real]</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Dmf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /andP[hx</span><span class="id"> xR]</span><span class="id"> /andP[hy</span><span class="id"> yR]</span><span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [lt_xy|le_yx]</span><span class="id"> :=</span><span class="id"> real_leP</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">ltW_homo_in</span><span class="id"> Dmf</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?Dmf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_nmono_in</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> D</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> D</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real]</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Dmf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /andP[hx</span><span class="id"> xR]</span><span class="id"> /andP[hy</span><span class="id"> yR]</span><span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [lt_xy|le_yx]</span><span class="id"> :=</span><span class="id"> real_ltP</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">ltW_nhomo_in</span><span class="id"> Dmf</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?Dmf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realn_mono</span><span class="id"> :</span><span class="id"> {homo</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> mf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xR</span><span class="id"> yR</span><span class="id"> /=;</span><span class="id"> have</span><span class="id"> [lt_xy</span><span class="id"> |</span><span class="id"> le_yx]</span><span class="id"> :=</span><span class="id"> real_leP</span><span class="id"> xR</span><span class="id"> yR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW_homo</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?mf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realn_nmono</span><span class="id"> :</span><span class="id"> {homo</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> mf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xR</span><span class="id"> yR</span><span class="id"> /=;</span><span class="id"> have</span><span class="id"> [lt_xy|le_yx]</span><span class="id"> :=</span><span class="id"> real_ltP</span><span class="id"> xR</span><span class="id"> yR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?mf</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW_nhomo</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realn_mono_in</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> D</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">}}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> D</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real]</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Dmf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /andP[hx</span><span class="id"> xR]</span><span class="id"> /andP[hy</span><span class="id"> yR]</span><span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [lt_xy|le_yx]</span><span class="id"> :=</span><span class="id"> real_leP</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">ltW_homo_in</span><span class="id"> Dmf</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?Dmf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realn_nmono_in</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> D</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">}}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [pred</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> D</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real]</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Dmf</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /andP[hx</span><span class="id"> xR]</span><span class="id"> /andP[hy</span><span class="id"> yR]</span><span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> [lt_xy|le_yx]</span><span class="id"> :=</span><span class="id"> real_ltP</span><span class="id"> xR</span><span class="id"> yR;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">ltW_nhomo_in</span><span class="id"> Dmf</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?Dmf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> NumDomainMonotonyTheoryForReals</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinGroup</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> GroupScope</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">gT</span><span class="id"> :</span><span class="id"> finGroupType</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> G</span><span class="id"> :</span><span class="id"> {group</span><span class="id"> gT}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natrG_gt0</span><span class="id"> G</span><span class="id"> :</span><span class="id"> #|G|%:R</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr0n</span><span class="id"> cardG_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natrG_neq0</span><span class="id"> G</span><span class="id"> :</span><span class="id"> #|G|%:R</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> natrG_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_indexg_gt0</span><span class="id"> G</span><span class="id"> B</span><span class="id"> :</span><span class="id"> #|G</span><span class="id"> :</span><span class="id"> B|%:R</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr0n</span><span class="id"> indexg_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_indexg_neq0</span><span class="id"> G</span><span class="id"> B</span><span class="id"> :</span><span class="id"> #|G</span><span class="id"> :</span><span class="id"> B|%:R</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> natr_indexg_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FinGroup</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NumFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> numFieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> F</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitf_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> eq_sym</span><span class="id"> lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitf_lt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> hx;</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lef_pV2</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> hx</span><span class="id"> hy</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ler_pV2</span><span class="id"> ?inE</span><span class="id"> ?unitf_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lef_nV2</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> hx</span><span class="id"> hy</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ler_nV2</span><span class="id"> ?inE</span><span class="id"> ?unitf_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltf_pV2</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> leW_nmono_in</span><span class="id"> lef_pV2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltf_nV2</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="id"> {mono</span> (<span class="id">@GRing</span>.<span class="id">inv</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> leW_nmono_in</span><span class="id"> lef_nV2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> ltef_pV2</span><span class="id"> :=</span> (<span class="id">lef_pV2,</span><span class="id"> ltf_pV2</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> ltef_nV2</span><span class="id"> :=</span> (<span class="id">lef_nV2,</span><span class="id"> ltf_nV2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_pgt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y^-1</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x^-1</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> ltf_pV2//</span><span class="id"> posrE</span><span class="id"> invr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_pge</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y^-1</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x^-1</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> lef_pV2//</span><span class="id"> posrE</span><span class="id"> invr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_ngt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y^-1</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x^-1</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> ltf_nV2//</span><span class="id"> negrE</span><span class="id"> invr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_nge</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y^-1</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x^-1</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> lef_nV2//</span><span class="id"> negrE</span><span class="id"> invr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_gt1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x^-1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> invf_pgt</span><span class="id"> ?invr1</span><span class="id"> ?posrE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_ge1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x^-1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> invf_pge</span><span class="id"> ?invr1</span><span class="id"> ?posrE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> invf_gte1</span><span class="id"> :=</span> (<span class="id">invf_ge1,</span><span class="id"> invf_gt1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_plt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x^-1</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y^-1</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> ltf_pV2//</span><span class="id"> posrE</span><span class="id"> invr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_ple</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pos</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x^-1</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y^-1</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> lef_pV2//</span><span class="id"> posrE</span><span class="id"> invr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_nlt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x^-1</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y^-1</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> ltf_nV2//</span><span class="id"> negrE</span><span class="id"> invr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_nle</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> neg</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x^-1</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y^-1</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y</span><span class="gallina-kwd"> in</span><span class="id"> LHS]invrK</span><span class="id"> lef_nV2//</span><span class="id"> negrE</span><span class="id"> invr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_le1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x^-1</span><span class="id"> &lt;=</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> -invf_ple</span><span class="id"> ?invr1</span><span class="id"> ?posrE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_lt1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x^-1</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> invf_plt</span><span class="id"> ?invr1</span><span class="id"> ?posrE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> invf_lte1</span><span class="id"> :=</span> (<span class="id">invf_le1,</span><span class="id"> invf_lt1</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> invf_cp1</span><span class="id"> :=</span> (<span class="id">invf_gte1,</span><span class="id"> invf_lte1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pdivlMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ler_pM2r</span><span class="id"> _</span><span class="id"> z</span><span class="id"> _</span><span class="id"> x</span>)<span class="id"> ?mulfVK</span><span class="id"> ?gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pdivlMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ltr_pM2r</span><span class="id"> _</span><span class="id"> z</span><span class="id"> _</span><span class="id"> x</span>)<span class="id"> ?mulfVK</span><span class="id"> ?gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pdivlMr</span><span class="id"> :=</span> (<span class="id">ler_pdivlMr,</span><span class="id"> ltr_pdivlMr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pdivrMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ler_pM2r</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> ?mulfVK</span><span class="id"> ?gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pdivrMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ltr_pM2r</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> ?mulfVK</span><span class="id"> ?gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pdivrMr</span><span class="id"> :=</span> (<span class="id">ler_pdivrMr,</span><span class="id"> ltr_pdivrMr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pdivlMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ler_pdivlMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pdivlMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ltr_pdivlMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pdivlMl</span><span class="id"> :=</span> (<span class="id">ler_pdivlMl,</span><span class="id"> ltr_pdivlMl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_pdivrMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ler_pdivrMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_pdivrMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_gt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_pdivrMl</span><span class="id"> :=</span> (<span class="id">ler_pdivrMl,</span><span class="id"> ltr_pdivrMl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ndivlMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ler_nM2r</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> ?mulfVK</span> <span class="id"> ?lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_ndivlMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ltr_nM2r</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> ?mulfVK</span><span class="id"> ?lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_ndivlMr</span><span class="id"> :=</span> (<span class="id">ler_ndivlMr,</span><span class="id"> ltr_ndivlMr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ndivrMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ler_nM2r</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> ?mulfVK</span><span class="id"> ?lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_ndivrMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@ltr_nM2r</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> ?mulfVK</span><span class="id"> ?lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_ndivrMr</span><span class="id"> :=</span> (<span class="id">ler_ndivrMr,</span><span class="id"> ltr_ndivrMr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ndivlMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ler_ndivlMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_ndivlMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ltr_ndivlMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_ndivlMl</span><span class="id"> :=</span> (<span class="id">ler_ndivlMl,</span><span class="id"> ltr_ndivlMl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ndivrMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ler_ndivrMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_ndivrMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z_lt0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ltr_ndivrMr</span><span class="id"> ?[z</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_ndivrMl</span><span class="id"> :=</span> (<span class="id">ler_ndivrMl,</span><span class="id"> ltr_ndivrMl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natf_div</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span> (<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> m%:R</span><span class="id"> /</span><span class="id"> d%:R</span><span class="id"> :&gt;</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> pchar0_natf_div;</span><span class="id"> apply:</span> (<span class="id">@pchar_num</span><span class="id"> F</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normfV</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">norm</span><span class="id"> :</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^-1}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> /=;</span><span class="id"> have</span><span class="id"> [/normrV</span><span class="id"> //|Nux]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !invr_out</span><span class="id"> //</span><span class="id"> unitfE</span><span class="id"> normr_eq0</span><span class="id"> -unitfE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normf_div</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">norm</span><span class="id"> :</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> normrM</span><span class="id"> normfV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_sg</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sg</span><span class="id"> x</span>)<span class="id">^-1</span><span class="id"> =</span><span class="id"> sgr</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fun_if</span><span class="id"> GRing</span>.<span class="id">inv</span>)<span class="id"> !</span>(<span class="id">invr0,</span><span class="id"> invrN,</span><span class="id"> invr1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgrV</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sgr</span><span class="id"> x^-1</span><span class="id"> =</span><span class="id"> sgr</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sgr</span><span class="id"> invr_eq0</span><span class="id"> invr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> splitr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 2%:R</span><span class="id"> +</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 2%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulr2n</span><span class="id"> -mulr_natr</span><span class="id"> mulfVK</span><span class="id"> //=</span><span class="id"> pnatr_eq0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_pdivlMr</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_pdivlMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_pdivrMr</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_pdivrMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_pdivlMl</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_pdivlMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_pdivrMl</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_pdivrMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_ndivlMr</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_ndivlMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_ndivrMr</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> /</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_ndivrMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_ndivlMl</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_ndivlMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_ndivrMl</span><span class="id"> C</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> z^-1</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span><span class="id"> =</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> lter_ndivrMl</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> mid</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> /</span><span class="id"> 2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> midf_le</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> mid</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">mid</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> lexy;</span><span class="id"> rewrite</span><span class="id"> ler_pdivlMr</span><span class="id"> ?ler_pdivrMr</span><span class="id"> ?ltr0Sn</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulrDr</span><span class="id"> !mulr1</span><span class="id"> !lerD2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> midf_lt</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> mid</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">mid</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ltxy;</span><span class="id"> rewrite</span><span class="id"> ltr_pdivlMr</span><span class="id"> ?ltr_pdivrMr</span><span class="id"> ?ltr0Sn</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulrDr</span><span class="id"> !mulr1</span><span class="id"> !ltrD2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> midf_lte</span><span class="id"> :=</span> (<span class="id">midf_le,</span><span class="id"> midf_lt</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_addgt0Pr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> e,</span><span class="id"> e</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">=&gt;</span><span class="id"> [lexy</span><span class="id"> e</span><span class="id"> e_gt0</span><span class="id"> |</span><span class="id"> lexye];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler_wpDr//</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> [||ltyx]//</span><span class="id"> :=</span><span class="id"> comparable_leP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@comparabler_trans</span><span class="id"> _</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> 1</span>))<span class="id">//</span><span class="id"> /Order</span>.<span class="id">comparable</span><span class="id"> ?lexye</span><span class="id"> ?ltr01//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lerDl</span><span class="id"> ler01</span><span class="id"> orbT</span>.<br/>
<span class="id">have</span><span class="id"> /midf_lt</span><span class="id"> [_]</span><span class="id"> :=</span><span class="id"> ltyx;</span><span class="id"> rewrite</span><span class="id"> le_gtF//</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@addrK</span><span class="id"> _</span><span class="id"> y</span><span class="id"> y</span>) (<span class="id">addrAC</span><span class="id"> _</span><span class="id"> _</span><span class="id"> x</span>)<span class="id"> -addrA</span><span class="id"> 2!mulrDl</span><span class="id"> -splitr</span><span class="id"> lexye//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divr_gt0//</span><span class="id"> ?ltr0n//</span><span class="id"> subr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_addgt0Pl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> e,</span><span class="id"> e</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> +</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/</span>(<span class="id">equivP</span> (<span class="id">ler_addgt0Pr</span><span class="id"> x</span><span class="id"> y</span>))<span class="id">;</span><span class="id"> split=&gt;</span><span class="id"> lexy</span><span class="id"> e</span><span class="id"> /lexy;</span><span class="id"> rewrite</span><span class="id"> addrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt_le</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> b</span>)<span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ab;</span><span class="id"> apply/ler_addgt0Pr</span><span class="id"> =&gt;</span><span class="id"> e</span><span class="id"> e_gt0;</span><span class="id"> rewrite</span><span class="id"> -lerBDr</span><span class="id"> ltW//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ab//</span><span class="id"> ltrBlDr</span><span class="id"> ltrDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt_ge</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ab;</span><span class="id"> apply/ler_addgt0Pr</span><span class="id"> =&gt;</span><span class="id"> e</span><span class="id"> e_gt0;</span><span class="id"> rewrite</span><span class="id"> ltW//</span><span class="id"> ab//</span><span class="id"> ltrDl</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leif_mean_square</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> mid</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span>) (<span class="id">y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mono_leif</span> (<span class="id">ler_pM2r</span> (<span class="id">ltr_nat</span><span class="id"> F</span><span class="id"> 0</span><span class="id"> 2</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divfK</span><span class="id"> ?pnatr_eq0</span><span class="id"> //</span><span class="id"> mulr_natr;</span><span class="id"> apply:</span><span class="id"> real_leif_mean_square_scaled</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leif_AGM2</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> mid</span><span class="id"> x</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mono_leif</span> (<span class="id">ler_pM2r</span> (<span class="id">ltr_nat</span><span class="id"> F</span><span class="id"> 0</span><span class="id"> 4</span>))).<br/>
<span class="id">rewrite</span><span class="id"> mulr_natr</span> (<span class="id">natrX</span><span class="id"> F</span><span class="id"> 2</span><span class="id"> 2</span>)<span class="id"> -exprMn</span><span class="id"> divfK</span><span class="id"> ?pnatr_eq0</span><span class="id"> //</span>.<br/>
<span class="id">exact:</span><span class="id"> real_leif_AGM2_scaled</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_AGM</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> #|A|</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> mu</span><span class="id"> :=</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> /</span><span class="id"> n%:R</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> A,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E</span><span class="id"> i}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> E</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> mu</span><span class="id"> ^+</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">?=</span><span class="id"> iff</span><span class="id"> [forall</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> A,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="gallina-kwd"> in</span><span class="id"> A,</span><span class="id"> E</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> E</span><span class="id"> j]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n</span><span class="id"> mu</span><span class="id"> Ege0;</span><span class="id"> have</span><span class="id"> [n0</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> n0</span><span class="id"> -big_andE</span><span class="id"> !</span>(<span class="id">big_pred0</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">card0_eq</span><span class="id"> n0</span>))<span class="id">;</span><span class="id"> apply/leifP</span>.<br/>
<span class="id">pose</span><span class="id"> E'</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> E</span><span class="id"> i</span><span class="id"> /</span><span class="id"> n%:R</span>.<br/>
<span class="id">have</span><span class="id"> defE'</span><span class="id"> i:</span><span class="id"> E'</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> E</span><span class="id"> i</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulr_natr</span><span class="id"> divfK</span><span class="id"> ?pnatr_eq0</span><span class="id"> -?lt0n</span>.<br/>
<span class="id">have</span><span class="id"> /leif_AGM_scaled</span> (<span class="id">i</span>)<span class="id">:</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E'</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> defE'</span><span class="id"> =&gt;</span><span class="id"> /Ege0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -/n</span><span class="id"> -mulr_suml</span> (<span class="id">eq_bigr</span><span class="id"> _</span> (<span class="id">in1W</span><span class="id"> defE'</span>))<span class="id">;</span><span class="id"> congr</span> (_<span class="id"> &lt;=</span><span class="id"> _</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 2![apply:</span><span class="id"> eq_forallb_in</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqr_pMn2r</span><span class="id"> n_gt0</span>)<span class="id"> !defE'</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> Cauchy_root_bound</span><span class="id"> p</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {b</span><span class="id"> |</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> &lt;=</span><span class="id"> b}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nz_p;</span><span class="id"> set</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> lead_coef</span><span class="id"> p;</span><span class="id"> set</span><span class="id"> n</span><span class="id"> :=</span> (<span class="id">size</span><span class="id"> p</span>).<span class="id">-1</span>.<br/>
<span class="id">have</span><span class="id"> [q</span><span class="id"> Dp]:</span><span class="id"> {q</span><span class="id"> |</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> -</span><span class="id"> q</span>.<span class="id">[x^-1]</span><span class="id"> /</span><span class="id"> x</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n}</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">-</span><span class="id"> \poly_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> p`_</span>(<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>.<span class="id">+1</span>))<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> nz_x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> hornerN</span><span class="id"> mulNr</span><span class="id"> opprK</span><span class="id"> horner_poly</span><span class="id"> mulrDl</span><span class="id"> !mulr_suml</span><span class="id"> addrC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> horner_coef</span><span class="id"> polySpred</span><span class="id"> //</span><span class="id"> big_ord_recr</span> (<span class="id">reindex_inj</span><span class="id"> rev_ord_inj</span>)<span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -/n</span><span class="id"> -lead_coefE;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr=&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprB</span><span class="id"> ?unitfE</span><span class="id"> //</span><span class="id"> -exprVn</span><span class="id"> mulrA</span><span class="id"> mulrAC</span><span class="id"> exprSr</span><span class="id"> mulrA</span>.<br/>
<span class="id">have</span><span class="id"> [b</span><span class="id"> ub_q]</span><span class="id"> :=</span><span class="id"> poly_disk_bound</span><span class="id"> q</span><span class="id"> 1;</span><span class="gallina-kwd"> exists</span> (<span class="id">b</span><span class="id"> /</span><span class="id"> `|a|</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> px0</span>.<br/>
<span class="id">have</span><span class="id"> b_ge0:</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">normr_ge0</span><span class="id"> q</span>.<span class="id">[1]</span>))<span class="id"> ?ub_q</span><span class="id"> ?normr1</span>.<br/>
<span class="id">have{b_ge0}</span><span class="id"> ba_ge0:</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> /</span><span class="id"> `|a|</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divr_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> real_leNgt</span><span class="id"> ?rpredD</span><span class="id"> ?rpred1</span><span class="id"> ?ger0_real</span><span class="id"> //</span>.<br/>
<span class="id">apply:</span><span class="id"> contraL</span><span class="id"> px0</span><span class="id"> =&gt;</span><span class="id"> lb_x;</span><span class="id"> rewrite</span><span class="id"> rootE</span>.<br/>
<span class="id">have</span><span class="id"> x_ge1:</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">ltW</span><span class="id"> lb_x</span>))<span class="id"> //</span><span class="id"> ler_wpDl</span>.<br/>
<span class="id">have</span><span class="id"> nz_x:</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normr_gt0</span> (<span class="id">lt_le_trans</span><span class="id"> ltr01</span>).<br/>
<span class="id">rewrite</span><span class="id"> {}Dp</span><span class="id"> //</span><span class="id"> mulf_neq0</span><span class="id"> ?expf_neq0</span><span class="id"> //</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span>.<br/>
<span class="id">have:</span> (<span class="id">b</span><span class="id"> /</span><span class="id"> `|a|</span>)<span class="id"> &lt;</span><span class="id"> `|x|</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">lt_trans</span><span class="id"> _</span><span class="id"> lb_x</span>)<span class="id"> //</span><span class="id"> ltr_pwDr</span><span class="id"> ?ltr01</span>.<br/>
<span class="id">apply:</span><span class="id"> contraTneq</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">canRL</span> (<span class="id">divfK</span><span class="id"> nz_x</span>))<span class="id">Dax</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?normr_gt0</span><span class="id"> ?lead_coef_eq0</span><span class="id"> //</span><span class="id"> mulrC</span><span class="id"> -normrM</span><span class="id"> -{}Dax</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_gtF</span><span class="id"> //</span><span class="id"> ub_q</span><span class="id"> //</span><span class="id"> normfV</span><span class="id"> invf_le1</span><span class="id"> ?normr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Import</span><span class="id"> GroupScope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natf_indexg</span> (<span class="id">gT</span><span class="id"> :</span><span class="id"> finGroupType</span>) (<span class="id">G</span><span class="id"> H</span><span class="id"> :</span><span class="id"> {group</span><span class="id"> gT}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">H</span><span class="id"> \subset</span><span class="id"> G</span><span class="id"> -&gt;</span><span class="id"> #|G</span><span class="id"> :</span><span class="id"> H|%:R</span><span class="id"> =</span> (<span class="id">#|G|%:R</span><span class="id"> /</span><span class="id"> #|H|%:R</span>)<span class="id">%R</span><span class="id"> :&gt;</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> sHG;</span><span class="id"> rewrite</span><span class="id"> -divgS</span><span class="id"> //</span><span class="id"> natf_div</span><span class="id"> ?cardSg</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> NumFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RealDomainTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realDomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> num_real</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> num_real</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> ler_xor_gt</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">min</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">max</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> `|y</span><span class="id"> -</span><span class="id"> x|</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>) (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_leP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> ltr_xor_ge</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">min</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">max</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> `|y</span><span class="id"> -</span><span class="id"> x|</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrgtP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">comparer</span><span class="id"> x</span><span class="id"> y</span>  (<span class="id">min</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">max</span><span class="id"> y</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> `|y</span><span class="id"> -</span><span class="id"> x|</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> &gt;=</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>) .<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltgtP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ger0_xor_lt0</span><span class="id"> x</span> (<span class="id">min</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> 0</span>) (<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x|</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ge0P</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ler0_xor_gt0</span><span class="id"> x</span> (<span class="id">min</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> 0</span>) (<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x|</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_le0P</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrgt0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comparer0</span><span class="id"> x</span> (<span class="id">min</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">min</span><span class="id"> x</span><span class="id"> 0</span>) (<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span>) (<span class="id">max</span><span class="id"> x</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;<span class="id">`|x|</span> (<span class="id">0</span><span class="id"> ==</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltgt0P</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> [&amp;&amp;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0,</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> &amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">+</span>) (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [x_gt0|x_lt0|-&gt;]</span><span class="id"> /=</span><span class="id"> :=</span><span class="id"> ltrgt0P</span><span class="id"> x;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> pmulr_rlt0</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> ltrgt0P</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nmulr_rlt0</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> ltrgt0P</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> neq0_mulr_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">+</span>) (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_neq0</span><span class="id"> y_neq0;</span><span class="id"> rewrite</span><span class="id"> mulr_lt0</span><span class="id"> x_neq0</span><span class="id"> y_neq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sign_lt0</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">b</span> (<span class="id">+</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_lt0</span><span class="id"> signr_lt0</span><span class="id"> signr_eq0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sign_norm</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -realEsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_Nsign_norm</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> real_mulr_Nsign_norm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> numEsign</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -realEsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> numNEsign</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -x</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -realNEsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normrEsign</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -real_normrEsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RealDomainTheory</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> num_real</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RealDomainOperations</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'arg' 'min_' ( i &lt; i0 | P ) F ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Order</span>.<span class="id">arg_min</span> (<span class="id">disp</span><span class="id"> :=</span><span class="id"> ring_display</span>)<span class="id"> i0</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P%B</span>) (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> F</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'arg' 'min_' ( i &lt; i0 'in' A ) F ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[arg</span><span class="id"> min_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> i0</span><span class="id"> |</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> A</span>)<span class="id"> F]</span><span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'arg' 'min_' ( i &lt; i0 ) F ]&quot;</span><span class="id"> :=</span><span class="id"> [arg</span><span class="id"> min_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> i0</span><span class="id"> |</span><span class="id"> true</span>)<span class="id"> F]</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'arg' 'max_' ( i &gt; i0 | P ) F ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">Order</span>.<span class="id">arg_max</span> (<span class="id">disp</span><span class="id"> :=</span><span class="id"> ring_display</span>)<span class="id"> i0</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P%B</span>) (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> F</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'arg' 'max_' ( i &gt; i0 'in' A ) F ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[arg</span><span class="id"> max_</span>(<span class="id">i</span><span class="id"> &gt;</span><span class="id"> i0</span><span class="id"> |</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> A</span>)<span class="id"> F]</span><span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'arg' 'max_' ( i &gt; i0 ) F ]&quot;</span><span class="id"> :=</span><span class="id"> [arg</span><span class="id"> max_</span>(<span class="id">i</span><span class="id"> &gt;</span><span class="id"> i0</span><span class="id"> |</span><span class="id"> true</span>)<span class="id"> F]</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">ring_scope</span>.<br/>
<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realDomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<span class="vernacular">Let</span><span class="id"> numR_real</span><span class="id"> :=</span><span class="id"> @num_real</span><span class="id"> R</span>.<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> numR_real</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_cp0</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>))<span class="id"> *</span><br/>
&nbsp;&nbsp;((<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> -1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>))<span class="id"> *</span><br/>
&nbsp;&nbsp;((<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[1]/</span>((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> false</span>)<span class="id"> -signrN</span><span class="id"> lt0r</span><span class="id"> leNgt</span><span class="id"> sgr_def</span>.<br/>
<span class="id">case:</span> (<span class="id">x</span><span class="id"> =P</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">eq_sym</span><span class="id"> 0</span>)<span class="id"> !signr_eq0</span><span class="id"> ltxx</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">inj_eq</span><span class="id"> signr_inj</span>)<span class="id"> eqb_id</span><span class="id"> eqbF_neg</span><span class="id"> signr_eq0</span><span class="id"> //</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> sgr_val</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><br/>
&nbsp;&nbsp;<span class="id">-&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Set</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> SgrNull</span><span class="id"> of</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> sgr_val</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> true</span><span class="id"> true</span><span class="id"> true</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">true</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span><span class="id"> 0</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> SgrPos</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> sgr_val</span><span class="id"> x</span><span class="id"> x</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> 1</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> SgrNeg</span><span class="id"> of</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> sgr_val</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">false</span><span class="id"> true</span><span class="id"> false</span><span class="id"> false</span><span class="id"> true</span><span class="id"> false</span> (<span class="id">-1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgrP</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">sgr_val</span><span class="id"> x</span><span class="id"> `|x|</span> (<span class="id">0</span><span class="id"> ==</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>) (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span><span class="id"> ==</span><span class="id"> sg</span><span class="id"> x</span>) (<span class="id">-1</span><span class="id"> ==</span><span class="id"> sg</span><span class="id"> x</span>) (<span class="id">1</span><span class="id"> ==</span><span class="id"> sg</span><span class="id"> x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)  (<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> -1</span>) (<span class="id">sg</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1</span>) (<span class="id">sg</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ![_</span><span class="id"> ==</span><span class="id"> sg</span><span class="id"> _]eq_sym</span><span class="id"> !sgr_cp0</span><span class="id"> /sg;</span><span class="id"> case:</span><span class="id"> ltrgt0P;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normrEsg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> sgrP;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mul0r,</span><span class="id"> mul1r,</span><span class="id"> mulN1r</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> numEsg</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> sgrP;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mul1r,</span><span class="id"> mul0r,</span><span class="id"> mulrNN</span>). Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `numEsg` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sg_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -numEsg</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgrM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sg</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !sgr_def</span><span class="id"> mulr_lt0</span><span class="id"> andbA</span><span class="id"> mulrnAr</span><span class="id"> mulrnAl</span><span class="id"> -mulrnA</span><span class="id"> mulnb</span><span class="id"> -negb_or</span><span class="id"> mulf_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">~~</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> signr_addb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> sg</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulrN1</span><span class="id"> sgrM</span><span class="id"> sgrN1</span><span class="id"> mulrN1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgrX</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">sg</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?sgr1</span><span class="id"> //</span><span class="id"> !exprS</span><span class="id"> sgrM</span><span class="id"> IHn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_smul</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> sg</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sg</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgrM</span><span class="id"> sgr_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_gt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sg</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[LHS]sgr_cp0</span><span class="id"> sgr_id</span><span class="id"> sgr_cp0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sgr_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sgr</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !leNgt</span><span class="id"> sgr_lt0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_norm</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> `|x|</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_norm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_norml</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_norml</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_normlP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> reflect</span> ((<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)) (<span class="id">`|x|</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_normlP</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> ler_normlP</span><span class="id"> {x</span><span class="id"> y}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_norml</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -y</span>))<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_eqr_norml</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_norm2</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> `|y|</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_eqr_norm2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_norml</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_norml</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_norml</span><span class="id"> :=</span> (<span class="id">ler_norml,</span><span class="id"> ltr_norml</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_normlP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> reflect</span> ((<span class="id">-x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)) (<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_normlP</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> ltr_normlP</span><span class="id"> {x</span><span class="id"> y}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_normlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_normlW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltrNnormlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltrNnormlW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_normlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_normlW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lerNnormlW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_lerNnormlW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_normr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> `|y|</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_normr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_normr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> `|y|</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_normr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_normr</span><span class="id"> :=</span> (<span class="id">ler_normr,</span><span class="id"> ltr_normr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span> (<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_distl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_distl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span> (<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_distl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_distl</span><span class="id"> :=</span> (<span class="id">ler_distl,</span><span class="id"> ltr_distl</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_distlC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span> (<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> e</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> distrC</span><span class="id"> ltr_distl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distlC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span> (<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> e</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> distrC</span><span class="id"> ler_distl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lter_distlC</span><span class="id"> :=</span> (<span class="id">ler_distlC,</span><span class="id"> ltr_distlC</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_distlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_distlDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_distlDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_distlCDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_distlCDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distlCDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_distlCDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_distlBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_distlBl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distlBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_distlBl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_distlCBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ltr_distlCBl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_distlCBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> e</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_ler_distlCBl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_even_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_even_ge0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_even_gt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> ||</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_even_gt0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_even_le0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_even_le0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_even_lt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ~~</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_even_lt0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_odd_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_odd_ge0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_odd_gt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_odd_gt0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_odd_le0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_odd_le0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprn_odd_lt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> odd</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> even_n;</span><span class="id"> rewrite</span><span class="id"> real_exprn_odd_lt0</span><span class="id"> ?num_real</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_norml</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_norml</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_normr</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> &lt;</span><span class="id"> `|y|</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_normr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteif_distl</span><span class="id"> C</span><span class="id"> x</span><span class="id"> y</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> e</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> e</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e</span><span class="id"> ?&lt;=</span><span class="gallina-kwd"> if</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> lter_distl</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqr_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprn_even_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqr_norm_eq1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrf_eq1</span><span class="id"> eqr_norml</span><span class="id"> ler01</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_mean_square_scaled</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_leif_mean_square_scaled</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_AGM2_scaled</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 4</span><span class="id"> &lt;=</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_leif_AGM2_scaled</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> MinMax</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_max</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span><span class="id"> real_oppr_max</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_min</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> -%R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> min</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> max</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span><span class="id"> real_oppr_min</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_minl</span><span class="id"> :</span><span class="id"> @left_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> min</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> real_addr_minl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_minr</span><span class="id"> :</span><span class="id"> @right_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> min</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> real_addr_minr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_maxl</span><span class="id"> :</span><span class="id"> @left_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> max</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> real_addr_maxl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr_maxr</span><span class="id"> :</span><span class="id"> @right_distributive</span><span class="id"> R</span><span class="id"> R</span><span class="id"> +%R</span><span class="id"> max</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> real_addr_maxr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minr_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> min</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> max</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0;</span><span class="id"> apply:</span><span class="id"> real_minr_nMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxr_nMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> max</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> min</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0;</span><span class="id"> apply:</span><span class="id"> real_maxr_nMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minr_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> min</span><span class="id"> y</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> max</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0;</span><span class="id"> apply:</span><span class="id"> real_minr_nMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxr_nMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> max</span><span class="id"> y</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> min</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_le0;</span><span class="id"> apply:</span><span class="id"> real_maxr_nMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> max</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> `|x|</span><br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_maxrN</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> maxNr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> max</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> `|x|</span><br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_maxNr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> minrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> min</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> `|x|</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_minrN</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> minNr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> min</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> `|x|</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real_minNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MinMax</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PolyBounds</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poly_itv_bound</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> {ub</span><span class="id"> |</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> `|p</span>.<span class="id">[x]|</span><span class="id"> &lt;=</span><span class="id"> ub}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [ub</span><span class="id"> le_p_ub]</span><span class="id"> :=</span><span class="id"> poly_disk_bound</span><span class="id"> p</span> (<span class="id">Num</span>.<span class="id">max</span><span class="id"> `|a|</span><span class="id"> `|b|</span>).<br/>
<span class="gallina-kwd">exists</span><span class="id"> ub</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /andP[le_a_x</span><span class="id"> le_x_b];</span><span class="id"> rewrite</span><span class="id"> le_p_ub</span><span class="id"> //</span><span class="id"> le_max</span><span class="id"> !ler_normr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [_|_]</span><span class="id"> :=</span><span class="id"> ler0P</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> ?lerN2</span><span class="id"> ?le_a_x</span><span class="id"> ?le_x_b</span><span class="id"> orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> monic_Cauchy_bound</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \is</span><span class="id"> monic</span><span class="id"> -&gt;</span><span class="id"> {b</span><span class="id"> |</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &gt;</span><span class="id"> 0}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/monicP=&gt;</span><span class="id"> mon_p;</span><span class="id"> pose</span><span class="id"> n</span><span class="id"> :=</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> -</span><span class="id"> 2</span>)<span class="id">%N</span>.<br/>
<span class="id">have</span><span class="id"> [p_le1</span><span class="id"> |</span><span class="id"> p_gt1]</span><span class="id"> :=</span><span class="id"> leqP</span> (<span class="id">size</span><span class="id"> p</span>)<span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> 0</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> _;</span><span class="id"> rewrite</span> (<span class="id">size1_polyC</span><span class="id"> p_le1</span>)<span class="id"> hornerC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[p`_0]lead_coefC</span><span class="id"> -size1_polyC</span><span class="id"> //</span><span class="id"> mon_p</span><span class="id"> ltr01</span>.<br/>
<span class="id">pose</span><span class="id"> lb</span><span class="id"> :=</span><span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>)<span class="id"> `|p`_j|;</span><span class="gallina-kwd"> exists</span> (<span class="id">lb</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> le_ub_x</span>.<br/>
<span class="id">have</span><span class="id"> x_ge1:</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x;</span><span class="id"> last</span><span class="id"> have</span><span class="id"> x_gt0</span><span class="id"> :=</span><span class="id"> lt_le_trans</span><span class="id"> ltr01</span><span class="id"> x_ge1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">lerD2l</span><span class="id"> lb</span>)<span class="id"> ler_wpDl</span><span class="id"> ?sumr_ge0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> horner_coef</span><span class="id"> -</span>(<span class="id">subnK</span><span class="id"> p_gt1</span>)<span class="id"> -/n</span><span class="id"> addnS</span><span class="id"> big_ord_recr</span><span class="id"> /=</span><span class="id"> addn1</span>.<br/>
<span class="id">rewrite</span><span class="id"> [in</span><span class="id"> p`__]subnSK</span><span class="id"> //</span><span class="id"> subn1</span><span class="id"> -lead_coefE</span><span class="id"> mon_p</span><span class="id"> mul1r</span><span class="id"> -ltrBlDl</span><span class="id"> sub0r</span>.<br/>
<span class="id">apply:</span><span class="id"> le_lt_trans</span> (_<span class="id"> :</span><span class="id"> lb</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> ltr_pM2r</span><span class="id"> ?exprn_gt0//</span><span class="id"> -</span>(<span class="id">ltrD2r</span><span class="id"> 1</span>)<span class="id"> ltr_pwDr</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sumrN</span><span class="id"> mulr_suml</span><span class="id"> ler_sum</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> le_trans</span> (<span class="id">ler_norm</span><span class="id"> _</span>)<span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> normrN</span><span class="id"> normrM</span><span class="id"> ler_wpM2l</span><span class="id"> //</span><span class="id"> normrX</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ger0_norm</span><span class="id"> ?</span>(<span class="id">ltW</span><span class="id"> x_gt0</span>)<span class="id"> //</span><span class="id"> ler_weXn2l</span><span class="id"> ?leq_ord</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> PolyBounds</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> RealDomainOperations</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RealField</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> F</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_mean_square</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> /</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> real_leif_mean_square;</span><span class="id"> apply:</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_AGM2</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span> ((<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> /</span><span class="id"> 2</span>)<span class="id">^+</span><span class="id"> 2</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> real_leif_AGM2;</span><span class="id"> apply:</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RealField</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RealClosedFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> rcfType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poly_ivt</span><span class="id"> :</span><span class="id"> real_closed_axiom</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> poly_ivt</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtr_ge0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> sqrt</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sqrt;</span><span class="id"> case:</span> (<span class="id">sig2W</span><span class="id"> _</span>). Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> sqrtr_ge0</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqr_sqrtr</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> sqrt</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /sqrt</span><span class="id"> =&gt;</span><span class="id"> a_ge0;</span><span class="id"> case:</span> (<span class="id">sig2W</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> x</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> a_ge0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler0_sqrtr</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> sqrt</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /sqrtr;</span><span class="id"> case:</span> (<span class="id">sig2W</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /=</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [//|_</span><span class="id"> /eqP//|-&gt;]</span><span class="id"> :=</span><span class="id"> ltrgt0P</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span><span class="id"> orbb</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr0_sqrtr</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> sqrt</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ltW;</span><span class="id"> apply:</span><span class="id"> ler0_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> sqrtr_spec</span><span class="id"> a</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
<span class="id">|</span><span class="id"> IsNoSqrtr</span><span class="id"> of</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> sqrtr_spec</span><span class="id"> a</span><span class="id"> a</span><span class="id"> false</span><span class="id"> true</span><span class="id"> 0</span><br/>
<span class="id">|</span><span class="id"> IsSqrtr</span><span class="id"> b</span><span class="id"> of</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> :</span><span class="id"> sqrtr_spec</span><span class="id"> a</span> (<span class="id">b</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> true</span><span class="id"> false</span><span class="id"> b</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtrP</span><span class="id"> a</span><span class="id"> :</span><span class="id"> sqrtr_spec</span><span class="id"> a</span><span class="id"> a</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> a</span>) (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">sqrt</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [a_ge0|a_lt0]</span><span class="id"> :=</span><span class="id"> ger0P</span><span class="id"> a</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1</span><span class="id"> 2}[a]sqr_sqrtr</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltr0_sqrtr</span><span class="id"> //;</span><span class="id"> constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtr_sqr</span><span class="id"> a</span><span class="id"> :</span><span class="id"> sqrt</span> (<span class="id">a</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> `|a|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :</span><span class="id"> sqrt</span> (<span class="id">a</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> `|a|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -normrX</span><span class="id"> ger0_norm</span><span class="id"> ?sqr_sqrtr</span><span class="id"> ?sqr_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> eqf_sqr</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;</span><span class="id"> //|ha]</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> sqrtr_ge0</span> (<span class="id">a</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> ha</span>)<span class="id"> oppr_ge0</span><span class="id"> normr_le0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normr0</span><span class="id"> oppr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtrM</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> sqrt</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> =</span><span class="id"> sqrt</span><span class="id"> a</span><span class="id"> *</span><span class="id"> sqrt</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">sqrtrP</span><span class="id"> a</span>)<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> {}a</span><span class="id"> a_ge0</span><span class="id"> _;</span><span class="id"> case:</span> (<span class="id">sqrtrP</span><span class="id"> b</span>)<span class="id"> =&gt;</span><span class="id"> [b_lt0</span><span class="id"> |</span><span class="id"> {}b</span><span class="id"> b_ge0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> ler0_sqrtr</span><span class="id"> //</span><span class="id"> nmulr_lle0</span><span class="id"> ?mulr_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrACA</span><span class="id"> sqrtr_sqr</span><span class="id"> ger0_norm</span><span class="id"> ?mulr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtr0</span><span class="id"> :</span><span class="id"> sqrt</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span> (<span class="id">sqrtr_sqr</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mul0r</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> normr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtr1</span><span class="id"> :</span><span class="id"> sqrt</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span> (<span class="id">sqrtr_sqr</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> normr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtr_eq0</span><span class="id"> a</span><span class="id"> :</span> (<span class="id">sqrt</span><span class="id"> a</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> sqrtrP</span><span class="id"> =&gt;</span><span class="id"> [/ltW</span><span class="id"> -&gt;|b];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="id">case:</span><span class="id"> ltrgt0P</span><span class="id"> =&gt;</span><span class="id"> [b_gt0|//|-&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mul0r</span><span class="id"> lexx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_geF</span><span class="id"> ?pmulr_rgt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtr_gt0</span><span class="id"> a</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> sqrt</span><span class="id"> a</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt0r</span><span class="id"> sqrtr_ge0</span><span class="id"> sqrtr_eq0</span><span class="id"> -ltNge</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_sqrt</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span> (<span class="id">sqrt</span><span class="id"> a</span><span class="id"> ==</span><span class="id"> sqrt</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> ==</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a_ge0</span><span class="id"> b_ge0;</span><span class="id"> apply/eqP/eqP=&gt;</span><span class="id"> [HS|-&gt;]</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span> (<span class="id">sqr_sqrtr</span><span class="id"> a_ge0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> HS</span> (<span class="id">sqr_sqrtr</span><span class="id"> b_ge0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_wsqrtr</span><span class="id"> :</span><span class="id"> {homo</span><span class="id"> @sqrt</span><span class="id"> R</span><span class="id"> :</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /=</span><span class="id"> le_ab;</span><span class="id"> case:</span> (<span class="id">boolP</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> a</span>))<span class="id">=&gt;</span><span class="id"> [pa|];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltNge;</span><span class="id"> move/ltW;</span><span class="id"> rewrite</span><span class="id"> -sqrtr_eq0;</span><span class="id"> move/eqP-&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@ler_pXn2r</span><span class="id"> R</span><span class="id"> 2</span>)<span class="id"> ?nnegrE</span><span class="id"> ?sqrtr_ge0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !sqr_sqrtr</span><span class="id"> //</span> (<span class="id">le_trans</span><span class="id"> pa</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_psqrt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @nneg</span><span class="id"> R</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> sqrt</span><span class="id"> :</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> le_mono_in</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x_gt0</span><span class="id"> y_gt0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !lt_neqAle</span><span class="id"> =&gt;</span><span class="id"> /andP[neq_xy</span><span class="id"> le_xy]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_wsqrtr</span><span class="id"> //</span><span class="id"> eqr_sqrt</span><span class="id"> //</span><span class="id"> neq_xy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_sqrt</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span> (<span class="id">sqrt</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> sqrt</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> b_ge0;</span><span class="id"> have</span><span class="id"> [a_le0|a_gt0]</span><span class="id"> :=</span><span class="id"> ler0P</span><span class="id"> a;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_psqrt</span><span class="id"> //</span><span class="id"> nnegrE</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler0_sqrtr</span><span class="id"> //</span><span class="id"> sqrtr_ge0</span> (<span class="id">le_trans</span><span class="id"> a_le0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_sqrt</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> -&gt;</span> (<span class="id">sqrt</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> sqrt</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> b_gt0;</span><span class="id"> have</span><span class="id"> [a_le0|a_gt0]</span><span class="id"> :=</span><span class="id"> ler0P</span><span class="id"> a;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">leW_mono_in</span><span class="id"> ler_psqrt</span>)<span class="id">//;</span><span class="id"> apply:</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler0_sqrtr</span><span class="id"> //</span><span class="id"> sqrtr_gt0</span><span class="id"> b_gt0</span> (<span class="id">le_lt_trans</span><span class="id"> a_le0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtrV</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> sqrt</span> (<span class="id">x^-1</span>)<span class="id"> =</span> (<span class="id">sqrt</span><span class="id"> x</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> ltrgt0P</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [x_gt0</span><span class="id"> _|-&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">invr0,</span><span class="id"> sqrtr0</span>).<br/>
<span class="id">have</span><span class="id"> sx_neq0</span><span class="id"> :</span><span class="id"> sqrt</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrtr_eq0</span><span class="id"> -ltNge</span>.<br/>
<span class="id">apply:</span> (<span class="id">mulfI</span><span class="id"> sx_neq0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -sqrtrM</span><span class="id"> !</span>(<span class="id">divff,</span><span class="id"> ltW,</span><span class="id"> sqrtr1</span>)<span class="id"> //</span><span class="id"> lt0r_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RealClosedFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;z ^*&quot;</span><span class="id"> :=</span> (<span class="id">conj_op</span><span class="id"> z</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'i&quot;</span><span class="id"> :=</span><span class="id"> imaginary</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 0</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> C</span><span class="id"> :</span><span class="id"> numClosedFieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> C</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> normCK</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x^*</span><span class="id"> :=</span><span class="id"> normCK</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> sqrCi</span><span class="id"> :</span><span class="id"> 'i</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> -1</span><span class="id"> :&gt;</span><span class="id"> C</span><span class="id"> :=</span><span class="id"> sqrCi</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulCii</span><span class="id"> :</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> 'i</span><span class="id"> =</span><span class="id"> -1</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sqrCi</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conjCK</span><span class="id"> :</span><span class="id"> involutive</span> (<span class="id">@conj_op</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> JE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x^*</span><span class="id"> =</span><span class="id"> `|x|^+2</span><span class="id"> /</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|x_neq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> invr0</span><span class="id"> mulr0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">canRL</span> (<span class="id">mulfK</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> -normCK</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> [-&gt;|x_neq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !rmorph0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !JE</span><span class="id"> normrM</span><span class="id"> normfV</span><span class="id"> exprMn</span><span class="id"> normrX</span><span class="id"> normr_id</span>.<br/>
<span class="id">rewrite</span><span class="id"> invfM</span><span class="id"> exprVn</span> (<span class="id">AC</span> (<span class="id">2*2</span>) (<span class="id">1*</span>(<span class="id">2*3</span>)<span class="id">*4</span>))<span class="id">/=</span><span class="id"> -invfM</span><span class="id"> -exprMn</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divff</span><span class="id"> ?mul1r</span><span class="id"> ?invrK</span><span class="id"> //</span><span class="id"> !expf_eq0</span><span class="id"> normr_eq0</span><span class="id"> //</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> Re2</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> z^*</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> nnegIm</span><span class="id"> z</span><span class="id"> :=</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">z^*</span><span class="id"> -</span><span class="id"> z</span>)).<br/>
<span class="vernacular">Definition</span><span class="id"> argCle</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> nnegIm</span><span class="id"> z</span><span class="id"> ==&gt;</span><span class="id"> nnegIm</span><span class="id"> y</span><span class="id"> &amp;&amp;</span> (<span class="id">Re2</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> Re2</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> rootC_spec</span><span class="id"> n</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> C</span>)<span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">RootCspec</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> C</span>)<span class="id"> of</span><span class="gallina-kwd"> if</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="gallina-kwd"> then</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="gallina-kwd"> else</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="gallina-kwd"> forall</span><span class="id"> z,</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> argCle</span><span class="id"> y</span><span class="id"> z</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> rootC_subproof</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> rootC_spec</span><span class="id"> n</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> realRe2</span><span class="id"> u</span><span class="id"> :</span><span class="id"> Re2</span><span class="id"> u</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="gallina-kwd"> by</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> realEsqr</span><span class="id"> expr2</span><span class="id"> {2}/Re2</span><span class="id"> -{2}[u]conjCK</span><span class="id"> addrC</span><span class="id"> -rmorphD</span><span class="id"> -normCK</span><span class="id"> exprn_ge0</span>.<br/>
<span class="id">have</span><span class="id"> argCle_total</span><span class="id"> :</span><span class="id"> total</span><span class="id"> argCle</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> u</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> /total</span><span class="id"> /argCle</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 2!case:</span> (<span class="id">nnegIm</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?orbT</span><span class="id"> //=</span><span class="id"> real_leVge</span>.<br/>
<span class="id">have</span><span class="id"> argCle_trans</span><span class="id"> :</span><span class="id"> transitive</span><span class="id"> argCle</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> u</span><span class="id"> v</span><span class="id"> w</span><span class="id"> /implyP</span><span class="id"> geZuv</span><span class="id"> /implyP</span><span class="id"> geZvw;</span><span class="id"> apply/implyP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/geZvw/andP=&gt;</span><span class="id"> /geZuv/andP[-&gt;</span><span class="id"> geRuv]</span><span class="id"> /le_trans-&gt;</span>.<br/>
<span class="id">pose</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> 'X^n</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> *+</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>))<span class="id">%:P;</span><span class="id"> have</span><span class="id"> [r0</span><span class="id"> Dp]</span><span class="id"> :=</span><span class="id"> closed_field_poly_normal</span><span class="id"> p</span>.<br/>
<span class="id">have</span><span class="id"> sz_p</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> n</span>.<span class="id">+1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_polyDl</span><span class="id"> ?size_polyXn</span><span class="id"> //</span><span class="id"> ltnS</span><span class="id"> size_polyN</span><span class="id"> size_polyC</span><span class="id"> mulrn_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> posnP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> negP</span>.<br/>
<span class="id">pose</span><span class="id"> r</span><span class="id"> :=</span><span class="id"> sort</span><span class="id"> argCle</span><span class="id"> r0;</span><span class="id"> have</span><span class="id"> r_arg:</span><span class="id"> sorted</span><span class="id"> argCle</span><span class="id"> r</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> sort_sorted</span>.<br/>
<span class="id">have{}</span><span class="id"> Dp:</span><span class="id"> p</span><span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">z</span><span class="id"> &lt;-</span><span class="id"> r</span>) (<span class="id">'X</span><span class="id"> -</span><span class="id"> z%:P</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> Dp</span><span class="id"> lead_coefE</span><span class="id"> sz_p</span><span class="id"> coefB</span><span class="id"> coefXn</span><span class="id"> coefC</span><span class="id"> -mulrb</span><span class="id"> -mulrnA</span><span class="id"> mulnb</span><span class="id"> lt0n</span><span class="id"> andNb</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subr0</span><span class="id"> eqxx</span><span class="id"> scale1r;</span><span class="id"> apply/esym/perm_big;</span><span class="id"> rewrite</span><span class="id"> perm_sort</span>.<br/>
<span class="id">have</span><span class="id"> mem_rP</span><span class="id"> z:</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> reflect</span> (<span class="id">z</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> \in</span><span class="id"> r</span>).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -root_prod_XsubC</span><span class="id"> -Dp</span><span class="id"> rootE</span><span class="id"> !hornerE</span><span class="id"> n_gt0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subr_eq0;</span><span class="id"> apply:</span><span class="id"> eqP</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> r`_0</span><span class="id"> =&gt;</span><span class="id"> [|z</span><span class="id"> n_gt0</span><span class="id"> /</span>(<span class="id">mem_rP</span><span class="id"> z</span><span class="id"> n_gt0</span>)<span class="id"> r_z]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> sz_r:</span><span class="id"> size</span><span class="id"> r</span><span class="id"> =</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> succn_inj;</span><span class="id"> rewrite</span><span class="id"> -sz_p</span><span class="id"> Dp</span><span class="id"> size_prod_XsubC</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> posnP</span><span class="id"> =&gt;</span><span class="id"> [n0</span><span class="id"> |</span><span class="id"> n_gt0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> nth_default</span><span class="id"> //</span><span class="id"> sz_r</span><span class="id"> n0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/mem_rP=&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> mem_nth</span><span class="id"> ?sz_r</span>.<br/>
<span class="id">case:</span><span class="id"> {Dp</span><span class="id"> mem_rP}r</span><span class="id"> r_z</span><span class="id"> r_arg</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> y</span><span class="id"> r1</span><span class="id"> /[1!inE]</span><span class="id"> /predU1P[-&gt;</span><span class="id"> _|r1z]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/implyP=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> lexx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/</span>(<span class="id">order_path_min</span><span class="id"> argCle_trans</span>)<span class="id">/allP-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> nthroot</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> let:</span><span class="id"> RootCspec</span><span class="id"> y</span><span class="id"> _</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> rootC_subproof</span><span class="id"> n</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> y</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;n .-root&quot;</span><span class="id"> :=</span> (<span class="id">nthroot</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sqrtC</span><span class="id"> :=</span><span class="id"> 2</span>.<span class="id">-root</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> Re_lock</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> tt</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> Im_lock</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> tt</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> Re</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> locked_with</span><span class="id"> Re_lock</span> ((<span class="id">z</span><span class="id"> +</span><span class="id"> z^*</span>)<span class="id"> /</span><span class="id"> 2%:R</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> Im</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> locked_with</span><span class="id"> Im_lock</span> (<span class="id">'i</span><span class="id"> *</span> (<span class="id">z^*</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> /</span><span class="id"> 2%:R</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'Re z&quot;</span><span class="id"> :=</span> (<span class="id">Re</span><span class="id"> z</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'Im z&quot;</span><span class="id"> :=</span> (<span class="id">Im</span><span class="id"> z</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReE</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 'Re</span><span class="id"> z</span><span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> z^*</span>)<span class="id"> /</span><span class="id"> 2%:R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ['Re</span><span class="id"> _]unlock</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ImE</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> =</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">z^*</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> /</span><span class="id"> 2%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ['Im</span><span class="id"> _]unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> nz2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pnatr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normCKC</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x^*</span><span class="id"> *</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normCK</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_conjC_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x^*</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normCK</span><span class="id"> exprn_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_conjC_gt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x^*</span> )<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|x_neq0]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -normCK</span><span class="id"> exprn_gt0</span><span class="id"> ?normr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_conjC_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> x^*</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normCK</span><span class="id"> expf_eq0</span><span class="id"> normr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conjC_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x^*</span> )<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">wlog</span><span class="id"> suffices:</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x^*</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IH;</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> /IH;</span><span class="id"> rewrite</span><span class="id"> ?conjCK</span>.<br/>
<span class="id">rewrite</span><span class="id"> [in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> -&gt;</span><span class="id"> _]le0r</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;</span><span class="id"> |</span><span class="id"> x_gt0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">pmulr_rge0</span><span class="id"> _</span><span class="id"> x_gt0</span>)<span class="id"> mul_conjC_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conjC_nat</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span>)<span class="id">^*</span><span class="id"> =</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorph_nat</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> conjC0</span><span class="id"> :</span><span class="id"> 0^*</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorph0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> conjC1</span><span class="id"> :</span><span class="id"> 1^*</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorph1</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> conjCN1</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id">^*</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorphN1</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> conjC_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^*</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> fmorph_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invC_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x^-1</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> ^-</span><span class="id"> 2</span><span class="id"> *</span><span class="id"> x^*</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nx_x]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> conjC0</span><span class="id"> mulr0</span><span class="id"> invr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normCK</span><span class="id"> invfM</span><span class="id"> divfK</span><span class="id"> ?conjC_eq0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> CrealE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>)<span class="id"> =</span> (<span class="id">x^*</span><span class="id"> ==</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> realEsqr</span><span class="id"> ger0_def</span><span class="id"> normrX</span><span class="id"> normCK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> /mulfI/inj_eq-&gt;</span><span class="id"> //]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> !eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> CrealP</span><span class="id"> {x}</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">x^*</span><span class="id"> =</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> CrealE;</span><span class="id"> apply:</span><span class="id"> eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conj_Creal</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x^*</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/CrealP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conj_normC</span><span class="id"> z</span><span class="id"> :</span><span class="id"> `|z|^*</span><span class="id"> =</span><span class="id"> `|z|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> conj_Creal</span><span class="id"> ?normr_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> CrealJ</span><span class="id"> :</span><span class="id"> {mono</span> (<span class="id">@conj_op</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">homo_mono1</span><span class="id"> conjCK</span>)<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> xreal;</span><span class="id"> rewrite</span><span class="id"> conj_Creal</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> geC0_conj</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x^*</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ger0_real/CrealP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> geC0_unit_exp</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_ge0;</span><span class="id"> rewrite</span><span class="id"> pexpr_eq1</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Ltac</span><span class="id"> case_rootC</span><span class="id"> :=</span><span class="id"> rewrite</span><span class="id"> /nthroot;</span><span class="id"> case:</span> (<span class="id">rootC_subproof</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root0C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case_rootC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootCK</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> cancel</span><span class="id"> n</span>.<span class="id">-root</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> _</span><span class="id"> x;</span><span class="id"> case_rootC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> root1C</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">@rootCK</span><span class="id"> 1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC0</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> root0C</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> rootCK</span><span class="id"> n_gt0</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> expf_eq0</span><span class="id"> n_gt0</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_inj</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> injective</span><span class="id"> n</span>.<span class="id">-root</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/rootCK/can_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_rootC</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/rootC_inj/inj_eq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_eq0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">rootC0</span><span class="id"> n</span>)<span class="id"> eqr_rootC</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nonRealCi</span><span class="id"> :</span> (<span class="id">'i</span><span class="id"> :</span><span class="id"> C</span>)<span class="id"> \isn't</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> realEsqr</span><span class="id"> sqrCi</span><span class="id"> oppr_ge0</span><span class="id"> lt_geF</span><span class="id"> ?ltr01</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> neq0Ci</span><span class="id"> :</span><span class="id"> 'i</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> C</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> nonRealCi</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normCi</span><span class="id"> :</span><span class="id"> `|'i|</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> C</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@pexpr_eq1</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 2</span>)<span class="id"> //</span><span class="id"> -normrX</span><span class="id"> sqrCi</span><span class="id"> normrN1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invCi</span><span class="id"> :</span><span class="id"> 'i^-1</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 'i</span><span class="id"> :&gt;</span><span class="id"> C</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -div1r</span><span class="id"> -[1]opprK</span><span class="id"> -sqrCi</span><span class="id"> mulNr</span><span class="id"> mulfK</span><span class="id"> ?neq0Ci</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conjCi</span><span class="id"> :</span><span class="id"> 'i^*</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 'i</span><span class="id"> :&gt;</span><span class="id"> C</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -invCi</span><span class="id"> invC_norm</span><span class="id"> normCi</span><span class="id"> expr1n</span><span class="id"> invr1</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Crect</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">ReE,</span><span class="id"> ImE</span>)<span class="id"> 2!mulrA</span><span class="id"> mulCii</span><span class="id"> mulN1r</span><span class="id"> opprB</span><span class="id"> -mulrDl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addrACA</span><span class="id"> subrr</span><span class="id"> addr0</span><span class="id"> mulrDl</span><span class="id"> -splitr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqCP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> &lt;-&gt;</span> (<span class="id">'Re</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 'Re</span><span class="id"> y</span>)<span class="id"> /\</span> (<span class="id">'Im</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 'Im</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|[eqRe</span><span class="id"> eqIm]];</span><span class="id"> rewrite</span><span class="id"> [x]Crect</span><span class="id"> [y]Crect</span><span class="id"> eqRe</span><span class="id"> eqIm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">'Re</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 'Re</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">'Im</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 'Im</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP/</span>(<span class="id">andPP</span><span class="id"> eqP</span><span class="id"> eqP</span>)<span class="id"> =&gt;</span><span class="id"> /eqCP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Creal_Re</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ReE</span><span class="id"> CrealE</span><span class="id"> fmorph_div</span><span class="id"> rmorph_nat</span><span class="id"> rmorphD</span><span class="id"> /=</span><span class="id"> conjCK</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Creal_Im</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Im</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> ImE</span><span class="id"> CrealE</span><span class="id"> fmorph_div</span><span class="id"> rmorph_nat</span><span class="id"> rmorphM</span><span class="id"> /=</span><span class="id"> rmorphB</span><span class="id"> conjCK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> conjCi</span><span class="id"> -opprB</span><span class="id"> mulrNN</span>.<br/>
Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> Creal_Re</span><span class="id"> Creal_Im</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> Re_is_additive</span><span class="id"> :</span><span class="id"> additive</span><span class="id"> Re</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !ReE</span><span class="id"> rmorphB</span><span class="id"> addrACA</span><span class="id"> -opprD</span><span class="id"> mulrBl</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> C</span><span class="id"> C</span><span class="id"> Re</span><span class="id"> Re_is_additive</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> Im_is_additive</span><span class="id"> :</span><span class="id"> additive</span><span class="id"> Im</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !ImE</span><span class="id"> rmorphB</span><span class="id"> opprD</span><span class="id"> addrACA</span><span class="id"> -opprD</span><span class="id"> mulrBr</span><span class="id"> mulrBl</span>.<br/>
Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> C</span><span class="id"> C</span><span class="id"> Im</span><span class="id"> Im_is_additive</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Creal_ImP</span><span class="id"> z</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">'Im</span><span class="id"> z</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">z</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> ImE</span><span class="id"> CrealE</span><span class="id"> -subr_eq0</span><span class="id"> -</span>(<span class="id">can_eq</span> (<span class="id">mulKf</span><span class="id"> neq0Ci</span>))<span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">can_eq</span> (<span class="id">divfK</span><span class="id"> nz2</span>))<span class="id"> mul0r;</span><span class="id"> apply:</span><span class="id"> eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Creal_ReP</span><span class="id"> z</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">'Re</span><span class="id"> z</span><span class="id"> =</span><span class="id"> z</span>) (<span class="id">z</span><span class="id"> \in</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span> (<span class="id">sameP</span> (<span class="id">Creal_ImP</span><span class="id"> z</span>)<span class="id"> eqP</span>)<span class="id"> -</span>(<span class="id">can_eq</span> (<span class="id">mulKf</span><span class="id"> neq0Ci</span>))<span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">inj_eq</span> (<span class="id">addrI</span> (<span class="id">'Re</span><span class="id"> z</span>)))<span class="id"> addr0</span><span class="id"> -Crect</span><span class="id"> eq_sym;</span><span class="id"> apply:</span><span class="id"> eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReMl</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> {morph</span><span class="id"> Re</span><span class="id"> :</span><span class="id"> z</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Rx</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !ReE</span><span class="id"> rmorphM</span><span class="id"> /=</span> (<span class="id">conj_Creal</span><span class="id"> Rx</span>)<span class="id"> -mulrDr</span><span class="id"> -mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReMr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> {morph</span><span class="id"> Re</span><span class="id"> :</span><span class="id"> z</span><span class="id"> /</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Rx</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ReMl</span><span class="id"> //</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ImMl</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> {morph</span><span class="id"> Im</span><span class="id"> :</span><span class="id"> z</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Rx</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !ImE</span><span class="id"> rmorphM</span><span class="id"> /=</span> (<span class="id">conj_Creal</span><span class="id"> Rx</span>)<span class="id"> -mulrBr</span><span class="id"> mulrCA</span><span class="id"> !mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ImMr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> {morph</span><span class="id"> Im</span><span class="id"> :</span><span class="id"> z</span><span class="id"> /</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Rx</span><span class="id"> z</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ImMl</span><span class="id"> //</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Re_i</span><span class="id"> :</span><span class="id"> 'Re</span><span class="id"> 'i</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ReE</span><span class="id"> conjCi</span><span class="id"> subrr</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Im_i</span><span class="id"> :</span><span class="id"> 'Im</span><span class="id"> 'i</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> ImE</span><span class="id"> conjCi</span><span class="id"> -opprD</span><span class="id"> mulrN</span><span class="id"> -mulr2n</span><span class="id"> mulrnAr</span><span class="id"> mulCii</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulNrn</span><span class="id"> opprK</span><span class="id"> divff</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Re_conj</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 'Re</span><span class="id"> z^*</span><span class="id"> =</span><span class="id"> 'Re</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !ReE</span><span class="id"> addrC</span><span class="id"> conjCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Im_conj</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 'Im</span><span class="id"> z^*</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 'Im</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !ImE</span><span class="id"> -mulNr</span><span class="id"> -mulrN</span><span class="id"> opprB</span><span class="id"> conjCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Re_rect</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> 'Re</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> raddfD</span><span class="id"> /=</span> (<span class="id">Creal_ReP</span><span class="id"> x</span><span class="id"> Rx</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ReMr</span><span class="id"> //</span><span class="id"> Re_i</span><span class="id"> mul0r</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Im_rect</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> 'Im</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> raddfD</span><span class="id"> /=</span> (<span class="id">Creal_ImP</span><span class="id"> x</span><span class="id"> Rx</span>)<span class="id"> add0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ImMr</span><span class="id"> //</span><span class="id"> Im_i</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conjC_rect</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">^*</span><span class="id"> =</span><span class="id"> x</span><span class="id"> -</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rmorphD</span><span class="id"> rmorphM</span><span class="id"> /=</span><span class="id"> conjCi</span><span class="id"> mulNr</span><span class="id"> !conj_Creal</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addC_rect</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x1</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y1</span>)<span class="id"> +</span> (<span class="id">x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y2</span>)<span class="id"> =</span><span class="id"> x1</span><span class="id"> +</span><span class="id"> x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">y1</span><span class="id"> +</span><span class="id"> y2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrACA</span><span class="id"> -mulrDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppC_rect</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>) <span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> -opprD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subC_rect</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x1</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y1</span>)<span class="id"> -</span> (<span class="id">x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y2</span>)<span class="id"> =</span><span class="id"> x1</span><span class="id"> -</span><span class="id"> x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">y1</span><span class="id"> -</span><span class="id"> y2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppC_rect</span><span class="id"> addC_rect</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulC_rect</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span> (<span class="id">x1</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y1</span>)<span class="id"> *</span> (<span class="id">x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y2</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> -</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">x1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> +</span><span class="id"> x2</span><span class="id"> *</span><span class="id"> y1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mulrDl</span><span class="id"> !mulrDr</span> (<span class="id">AC</span> (<span class="id">2*2</span>) (<span class="id">1*4*</span>(<span class="id">2*3</span>)))<span class="id">/=</span><span class="id"> mulrACA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -expr2</span><span class="id"> sqrCi</span><span class="id"> mulN1r</span><span class="id"> -!mulrA</span><span class="id"> [_</span><span class="id"> *</span> (<span class="id">'i</span><span class="id"> *</span><span class="id"> _</span>)<span class="id">]mulrCA</span><span class="id"> [_</span><span class="id"> *</span><span class="id"> y1]mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ImM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 'Im</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> y</span><span class="id"> +</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]Crect</span><span class="id"> [y</span><span class="gallina-kwd"> in</span><span class="id"> LHS]Crect</span><span class="id"> mulC_rect</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">Im_rect,</span><span class="id"> rpredB,</span><span class="id"> rpredD,</span><span class="id"> rpredM</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ImMil</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Im</span> (<span class="id">'i</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> 'Re</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ImM</span><span class="id"> Re_i</span><span class="id"> Im_i</span><span class="id"> mul0r</span><span class="id"> mulr1</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReMil</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Re</span> (<span class="id">'i</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> 'Im</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ImMil</span><span class="id"> mulrA</span><span class="id"> mulCii</span><span class="id"> mulN1r</span><span class="id"> raddfN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReMir</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Re</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> 'i</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> 'Im</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ReMil</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ImMir</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Im</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> 'i</span>)<span class="id"> =</span><span class="id"> 'Re</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> ImMil</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 'Re</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> -</span><span class="id"> 'Im</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ImMil</span><span class="id"> mulrCA</span><span class="id"> ImM</span><span class="id"> ImMil</span><span class="id"> ReMil</span><span class="id"> mulNr</span><span class="id"> ['Im</span><span class="id"> _</span><span class="id"> *</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC2_rect</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> normCK</span><span class="id"> rmorphD</span><span class="id"> rmorphM</span><span class="id"> /=</span><span class="id"> conjCi</span><span class="id"> !conj_Creal</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mulNr</span><span class="id"> -subr_sqr</span><span class="id"> exprMn</span><span class="id"> sqrCi</span><span class="id"> mulN1r</span><span class="id"> opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC2_Re_Im</span><span class="id"> z</span><span class="id"> :</span><span class="id"> `|z|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 'Re</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normC2_rect</span><span class="id"> -?Crect</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invC_Crect</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">^-1</span> <span class="id"> =</span> (<span class="id">x^*</span><span class="id"> -</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y^*</span>)<span class="id"> /</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> invC_norm</span><span class="id"> mulrC</span><span class="id"> !rmorphE</span><span class="id"> rmorphM</span><span class="id"> /=</span><span class="id"> conjCi</span><span class="id"> mulNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invC_rect</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">^-1</span> <span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> /</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> invC_Crect</span><span class="id"> normC2_rect</span><span class="id"> ?conj_Creal</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ImV</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Im</span><span class="id"> x^-1</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 'Im</span><span class="id"> x</span><span class="id"> /</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]Crect</span><span class="id"> invC_rect//</span><span class="id"> ImMr</span><span class="id"> ?</span>(<span class="id">rpredV,</span><span class="id"> rpredD,</span><span class="id"> rpredX</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrN</span><span class="id"> Im_rect</span><span class="id"> ?rpredN//</span><span class="id"> -normC2_rect//</span><span class="id"> -Crect</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ReV</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'Re</span><span class="id"> x^-1</span><span class="id"> =</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> /</span><span class="id"> `|x|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [x</span><span class="gallina-kwd"> in</span><span class="id"> LHS]Crect</span><span class="id"> invC_rect//</span><span class="id"> ReMr</span><span class="id"> ?</span>(<span class="id">rpredV,</span><span class="id"> rpredD,</span><span class="id"> rpredX</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrN</span><span class="id"> Re_rect</span><span class="id"> ?rpredN//</span><span class="id"> -normC2_rect//</span><span class="id"> -Crect</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rectC_mulr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> *</span><span class="id"> z</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> mulrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rectC_mull</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> *</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDr</span><span class="id"> mulrCA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divC_Crect</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x1</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y1</span>)<span class="id"> /</span> (<span class="id">x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y2</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="id">x1</span><span class="id"> *</span><span class="id"> x2^*</span><span class="id"> +</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2^*</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">x2^*</span><span class="id"> *</span><span class="id"> y1</span><span class="id"> -</span><span class="id"> x1</span><span class="id"> *</span><span class="id"> y2^*</span>))<span class="id"> /</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y2|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> invC_Crect//</span><span class="id"> -mulrN</span><span class="id"> [_</span><span class="id"> /</span><span class="id"> _]rectC_mulr</span><span class="id"> mulC_rect</span><span class="id"> !mulrA</span><span class="id"> -mulrBl</span>.<br/>
<span class="id">rewrite</span><span class="id"> [_</span><span class="id"> *</span><span class="id"> _</span><span class="id"> *</span><span class="id"> y1]mulrAC</span><span class="id"> -mulrDl</span><span class="id"> mulrA</span><span class="id"> -mulrDl</span><span class="id"> !</span>(<span class="id">mulrN,</span><span class="id"> mulNr</span>)<span class="id"> opprK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [-</span><span class="id"> _</span><span class="id"> +</span><span class="id"> _]addrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divC_rect</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x1</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y1</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><span class="id"> y2</span><span class="id"> \is</span><span class="id"> real</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x1</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y1</span>)<span class="id"> /</span> (<span class="id">x2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y2</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> +</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span> (<span class="id">x2</span><span class="id"> *</span><span class="id"> y1</span><span class="id"> -</span><span class="id"> x1</span><span class="id"> *</span><span class="id"> y2</span>))<span class="id"> /</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x2</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y2</span><span class="id"> ^+</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> divC_Crect</span><span class="id"> normC2_rect</span><span class="id"> ?conj_Creal</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Im_div</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 'Im</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">'Re</span><span class="id"> y</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> x</span><span class="id"> -</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> y</span>)<span class="id"> /</span><span class="id"> `|y|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ImM</span><span class="id"> ImV</span><span class="id"> ReV</span><span class="id"> mulrA</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> +</span><span class="id"> X]mulrAC</span><span class="id"> -mulrDl</span><span class="id"> mulrN</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Re_div</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 'Re</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">'Re</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> +</span><span class="id"> 'Im</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> y</span>)<span class="id"> /</span><span class="id"> `|y|</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ReM</span><span class="id"> ImV</span><span class="id"> ReV</span><span class="id"> !mulrA</span><span class="id"> -mulrBl</span><span class="id"> mulrN</span><span class="id"> opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_normC_Re_Creal</span><span class="id"> z</span><span class="id"> :</span><span class="id"> `|'Re</span><span class="id"> z|</span><span class="id"> &lt;=</span><span class="id"> `|z|</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">z</span><span class="id"> \is</span><span class="id"> real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mono_in_leif</span><span class="id"> ler_sqr</span>)<span class="id">;</span><span class="id"> try</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> qualifE</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> [`|'Re</span><span class="id"> _|</span><span class="id"> ^+</span><span class="id"> 2]normCK</span><span class="id"> conj_Creal</span><span class="id"> //</span><span class="id"> normC2_Re_Im</span><span class="id"> -expr2</span>.<br/>
<span class="id">rewrite</span><span class="id"> addrC</span><span class="id"> -leifBLR</span><span class="id"> subrr</span> (<span class="id">sameP</span> (<span class="id">Creal_ImP</span><span class="id"> _</span>)<span class="id"> eqP</span>)<span class="id"> -sqrf_eq0</span><span class="id"> eq_sym</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leif_eq;</span><span class="id"> rewrite</span><span class="id"> -realEsqr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_Re_Creal</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 'Re</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> `|z|</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> ubRe:</span><span class="id"> 'Re</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> `|'Re</span><span class="id"> z|</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> 'Re</span><span class="id"> z</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ger0_def</span><span class="id"> eq_sym;</span><span class="id"> apply/leif_eq/real_ler_norm</span>.<br/>
<span class="id">congr</span> (_<span class="id"> &lt;=</span><span class="id"> _</span><span class="id"> ?=</span><span class="id"> iff</span><span class="id"> _</span>)<span class="id">:</span> (<span class="id">leif_trans</span><span class="id"> ubRe</span> (<span class="id">leif_normC_Re_Creal</span><span class="id"> z</span>)).<br/>
<span class="id">apply/andP/idP=&gt;</span><span class="id"> [[zRge0</span><span class="id"> /Creal_ReP</span><span class="id"> &lt;-</span><span class="id"> //]</span><span class="id"> |</span><span class="id"> z_ge0]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> Rz</span><span class="id"> :=</span><span class="id"> ger0_real</span><span class="id"> z_ge0;</span><span class="id"> rewrite</span> (<span class="id">Creal_ReP</span><span class="id"> _</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqC_semipolar</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`|x|</span><span class="id"> =</span><span class="id"> `|y|</span><span class="id"> -&gt;</span><span class="id"> 'Re</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eq_norm</span><span class="id"> eq_Re</span><span class="id"> sign_Im</span>.<br/>
<span class="id">rewrite</span><span class="id"> [x]Crect</span><span class="id"> [y]Crect</span><span class="id"> eq_Re;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> congr1</span> (<span class="gallina-kwd">fun</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> eq_norm</span>.<br/>
<span class="id">rewrite</span><span class="id"> !normC2_Re_Im</span><span class="id"> eq_Re</span> (<span class="id">can_eq</span> (<span class="id">addKr</span><span class="id"> _</span>))<span class="id"> eqf_sqr</span><span class="id"> =&gt;</span><span class="id"> /pred2P[]</span><span class="id"> //</span><span class="id"> eq_Im</span>.<br/>
<span class="id">rewrite</span><span class="id"> eq_Im</span><span class="id"> mulNr</span><span class="id"> -expr2</span><span class="id"> oppr_ge0</span><span class="id"> real_exprn_even_le0</span><span class="id"> //=</span><span class="gallina-kwd"> in</span><span class="id"> sign_Im</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_Im</span> (<span class="id">eqP</span><span class="id"> sign_Im</span>)<span class="id"> oppr0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> argCleP</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span><span class="id"> y</span><span class="id"> /\</span><span class="id"> 'Re</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> 'Re</span><span class="id"> y</span>) (<span class="id">argCle</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">suffices</span><span class="id"> dIm</span><span class="id"> x:</span><span class="id"> nnegIm</span><span class="id"> x</span><span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /argCle</span><span class="id"> !dIm</span><span class="id"> !</span>(<span class="id">ImE,</span><span class="id"> ReE</span>)<span class="id"> ler_pM2r</span><span class="id"> ?invr_gt0</span><span class="id"> ?ltr0n</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> implyP</span>)<span class="id"> =&gt;</span><span class="id"> geZyz</span><span class="id"> /geZyz/andP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">ImE</span><span class="id"> x</span>)<span class="id"> pmulr_lge0</span><span class="id"> ?invr_gt0</span><span class="id"> ?ltr0n</span><span class="id"> //;</span><span class="id"> congr</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> _</span><span class="id"> *</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_Re_max</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 'Re</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> yn_x</span><span class="id"> leI0y;</span><span class="id"> case_rootC=&gt;</span><span class="id"> z</span><span class="id"> /=</span><span class="id"> _</span><span class="id"> /</span>(_<span class="id"> y</span><span class="id"> n_gt0</span><span class="id"> yn_x</span>)<span class="id">/argCleP[]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> neg_unity_root</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 1</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="gallina-kwd"> exists2</span><span class="id"> w</span><span class="id"> :</span><span class="id"> C,</span><span class="id"> w</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> &amp;</span><span class="id"> 'Re</span><span class="id"> w</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n_gt1;</span><span class="id"> have</span><span class="id"> [|w</span><span class="id"> /eqP</span><span class="id"> pw_0]</span><span class="id"> :=</span><span class="id"> closed_rootP</span> (<span class="id">\poly_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>) (<span class="id">1</span><span class="id"> :</span><span class="id"> C</span>))<span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> size_poly_eq</span><span class="id"> ?oner_eq0</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">subnKC</span><span class="id"> n_gt1</span>).<br/>
<span class="id">rewrite</span><span class="id"> horner_poly</span> (<span class="id">eq_bigr</span><span class="id"> _</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> mul1r</span><span class="id"> _</span>))<span class="gallina-kwd"> in</span><span class="id"> pw_0</span>.<br/>
<span class="id">have</span><span class="id"> wn1:</span><span class="id"> w</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> subrX1</span><span class="id"> pw_0</span><span class="id"> mulr0</span>.<br/>
<span class="id">suffices</span><span class="id"> /existsP[i</span><span class="id"> ltRwi0]:</span><span class="id"> [exists</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'I_n,</span><span class="id"> 'Re</span> (<span class="id">w</span><span class="id"> ^+</span><span class="id"> i</span>)<span class="id"> &lt;</span><span class="id"> 0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">w</span><span class="id"> ^+</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> exprAC</span><span class="id"> wn1</span><span class="id"> expr1n</span>.<br/>
<span class="id">apply:</span><span class="id"> contra_eqT</span> (<span class="id">congr1</span><span class="id"> Re</span><span class="id"> pw_0</span>)<span class="id"> =&gt;</span><span class="id"> /existsPn</span><span class="id"> geRw0</span>.<br/>
<span class="id">rewrite</span><span class="id"> raddf_sum</span><span class="id"> raddf0</span><span class="id"> /=</span> (<span class="id">bigD1</span> (<span class="id">Ordinal</span> (<span class="id">ltnW</span><span class="id"> n_gt1</span>)))<span class="id"> //=</span>.<br/>
<span class="id">rewrite</span> (<span class="id">Creal_ReP</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> ?rpred1</span><span class="id"> //</span><span class="id"> gt_eqF</span><span class="id"> ?ltr_wpDr</span><span class="id"> ?ltr01</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> sumr_ge0</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> real_leNgt</span><span class="id"> ?rpred0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Im_rootC_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 1</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> n_gt1;</span><span class="id"> have</span><span class="id"> n_gt0</span><span class="id"> :=</span><span class="id"> ltnW</span><span class="id"> n_gt1</span>.<br/>
<span class="id">apply:</span><span class="id"> wlog_neg;</span><span class="id"> rewrite</span><span class="id"> -real_ltNge</span><span class="id"> ?rpred0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> ltIy0</span>.<br/>
<span class="id">suffices</span><span class="id"> [z</span><span class="id"> zn_x</span><span class="id"> leI0z]:</span><span class="gallina-kwd"> exists2</span><span class="id"> z,</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> &gt;=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /y;</span><span class="id"> case_rootC</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> y1</span><span class="id"> _</span><span class="id"> /</span>(_<span class="id"> z</span><span class="id"> n_gt0</span><span class="id"> zn_x</span>)<span class="id">/argCleP[]</span>.<br/>
<span class="id">have</span><span class="id"> [w</span><span class="id"> wn1</span><span class="id"> ltRw0]</span><span class="id"> :=</span><span class="id"> neg_unity_root</span><span class="id"> n_gt1</span>.<br/>
<span class="id">wlog</span><span class="id"> leRI0yw:</span><span class="id"> w</span><span class="id"> wn1</span><span class="id"> ltRw0</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> w</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> IHw;</span><span class="id"> have:</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> *</span><span class="id"> 'Im</span><span class="id"> w</span><span class="id"> \is</span><span class="id"> real</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rpredM</span>.<br/>
&nbsp;&nbsp;<span class="id">case/real_ge0P=&gt;</span><span class="id"> [|/ltW</span><span class="id"> leRIyw0];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> IHw</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">IHw</span><span class="id"> w^*</span> )<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?Re_conj</span><span class="id"> ?Im_conj</span><span class="id"> ?mulrN</span><span class="id"> ?oppr_ge0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rmorphXn</span><span class="id"> wn1</span><span class="id"> rmorph1</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">w</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprMn</span><span class="id"> wn1</span><span class="id"> mul1r</span><span class="id"> rootCK</span>.<br/>
<span class="id">rewrite</span><span class="id"> [w]Crect</span><span class="id"> [y]Crect</span><span class="id"> mulC_rect</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> Im_rect</span><span class="id"> ?rpredD</span><span class="id"> ?rpredN</span><span class="id"> 1?rpredM</span><span class="id"> //</span><span class="id"> addr_ge0</span><span class="id"> //</span><span class="id"> ltW</span><span class="id"> ?nmulr_rgt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_lt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> n_gt1;</span><span class="id"> have</span><span class="id"> n_gt0</span><span class="id"> :=</span><span class="id"> ltnW</span><span class="id"> n_gt1</span>.<br/>
<span class="id">apply:</span><span class="id"> negbTE;</span><span class="id"> apply:</span><span class="id"> wlog_neg</span><span class="id"> =&gt;</span><span class="id"> /negbNE</span><span class="id"> lt0y;</span><span class="id"> rewrite</span><span class="id"> le_gtF</span><span class="id"> //</span>.<br/>
<span class="id">have</span><span class="id"> Rx:</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[x]</span>(<span class="id">rootCK</span><span class="id"> n_gt0</span>)<span class="id"> rpredX</span><span class="id"> //</span><span class="id"> ltr0_real</span>.<br/>
<span class="id">have</span><span class="id"> Re_y:</span><span class="id"> 'Re</span><span class="id"> y</span><span class="id"> =</span><span class="id"> y</span><span class="gallina-kwd"> by</span><span class="id"> apply/Creal_ReP;</span><span class="id"> rewrite</span><span class="id"> ltr0_real</span>.<br/>
<span class="id">have</span><span class="id"> [z</span><span class="id"> zn_x</span><span class="id"> leR0z]:</span><span class="gallina-kwd"> exists2</span><span class="id"> z,</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> 'Re</span><span class="id"> z</span><span class="id"> &gt;=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [w</span><span class="id"> wn1</span><span class="id"> ltRw0]</span><span class="id"> :=</span><span class="id"> neg_unity_root</span><span class="id"> n_gt1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">w</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprMn</span><span class="id"> wn1</span><span class="id"> mul1r</span><span class="id"> rootCK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ReMr</span><span class="id"> ?ltr0_real</span><span class="id"> //</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> nmulr_lgt0</span>.<br/>
<span class="id">without</span><span class="id"> loss</span><span class="id"> leI0z:</span><span class="id"> z</span><span class="id"> zn_x</span><span class="id"> leR0z</span><span class="id"> /</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> &gt;=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> IHz;</span><span class="id"> have:</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> real</span><span class="gallina-kwd"> by</span><span class="id"> []</span>.<br/>
&nbsp;&nbsp;<span class="id">case/real_ge0P=&gt;</span><span class="id"> [|/ltW</span><span class="id"> leIz0];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> IHz</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">IHz</span><span class="id"> z^*</span> )<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?Re_conj</span><span class="id"> ?Im_conj</span><span class="id"> ?oppr_ge0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rmorphXn</span><span class="id"> /=</span><span class="id"> zn_x</span><span class="id"> conj_Creal</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> le_trans</span><span class="id"> leR0z</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -Re_y</span><span class="id"> ?rootC_Re_max</span><span class="id"> ?ltr0_real</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_ge0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> n_gt0</span>.<br/>
<span class="id">apply/idP/idP=&gt;</span><span class="id"> [/</span>(<span class="id">exprn_ge0</span><span class="id"> n</span>)<span class="id"> |</span><span class="id"> x_ge0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rootCK</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">ge_leif</span> (<span class="id">leif_Re_Creal</span><span class="id"> y</span>)).<br/>
<span class="id">have</span><span class="id"> Ray:</span><span class="id"> `|y|</span><span class="id"> \is</span><span class="id"> real</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> normr_real</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">Creal_ReP</span><span class="id"> _</span><span class="id"> Ray</span>)<span class="id"> rootC_Re_max</span><span class="id"> ?</span>(<span class="id">Creal_ImP</span><span class="id"> _</span><span class="id"> Ray</span>)<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -normrX</span><span class="id"> rootCK</span><span class="id"> //</span><span class="id"> ger0_norm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_gt0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> !lt0r</span><span class="id"> rootC_ge0</span><span class="id"> ?rootC_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_le0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n_gt1;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> rootC_lt0</span><span class="id"> //</span><span class="id"> orbF</span><span class="id"> rootC_eq0</span><span class="id"> 1?ltnW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_rootCl</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg,</span><span class="id"> {mono</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x</span><span class="id"> x_ge0</span><span class="id"> y;</span><span class="id"> have</span><span class="id"> [y_ge0</span><span class="id"> |</span><span class="id"> not_y_ge0]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ler_pXn2r</span><span class="id"> n_gt0</span>)<span class="id"> ?qualifE</span><span class="id"> /=</span><span class="id"> ?rootC_ge0</span><span class="id"> ?rootCK</span>.<br/>
<span class="id">rewrite</span> (<span class="id">contraNF</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> ?rootC_ge0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">contraNF</span> (<span class="id">le_trans</span><span class="id"> x_ge0</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_rootC</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x_ge0</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> ler_rootCl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_rootCl</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg,</span><span class="id"> {mono</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x</span><span class="id"> x_ge0</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !lt_def</span><span class="id"> ler_rootCl</span><span class="id"> ?eqr_rootC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_rootC</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/ler_rootC/leW_mono_in</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprCK</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x_ge0;</span><span class="id"> apply/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqrXn2</span><span class="id"> n_gt0</span>)<span class="id"> ?rootC_ge0</span><span class="id"> ?exprn_ge0</span><span class="id"> ?rootCK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> norm_rootC</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|n</span>.<span class="id">-root</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !root0C</span><span class="id"> normr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqrXn2</span><span class="id"> n_gt0</span>)<span class="id"> ?rootC_ge0</span><span class="id"> //</span><span class="id"> -normrX</span><span class="id"> !rootCK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootCX</span><span class="id"> n</span><span class="id"> x</span><span class="id"> k</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> k</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x_ge0;</span><span class="id"> apply/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqrXn2</span><span class="id"> n_gt0</span>)<span class="id"> ?</span>(<span class="id">exprn_ge0,</span><span class="id"> rootC_ge0</span>)<span class="id"> //</span><span class="id"> 1?exprAC</span><span class="id"> !rootCK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC1</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/</span>(<span class="id">rootCX</span><span class="id"> 0</span>)<span class="id">/</span>(_<span class="id"> ler01</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootCpX</span><span class="id"> n</span><span class="id"> x</span><span class="id"> k</span><span class="id"> :</span> (<span class="id">k</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> k</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> k_gt0;</span><span class="id"> [rewrite</span><span class="id"> !root0C</span><span class="id"> expr0n</span><span class="id"> gtn_eqF</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rootCX]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootCV</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x^-1</span><span class="id"> =</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_ge0;</span><span class="id"> have</span><span class="id"> [-&gt;|n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !root0C</span><span class="id"> invr0</span>.<br/>
<span class="id">apply/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqrXn2</span><span class="id"> n_gt0</span>)<span class="id"> ?</span>(<span class="id">invr_ge0,</span><span class="id"> rootC_ge0</span>)<span class="id"> //</span><span class="id"> !exprVn</span><span class="id"> !rootCK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_eq1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">rootC1</span><span class="id"> n_gt0</span>)<span class="id"> eqr_rootC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_ge1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">rootC1</span><span class="id"> n_gt0</span>)<span class="id"> ler_rootCl</span><span class="id"> //</span><span class="id"> qualifE</span><span class="id"> /=</span><span class="id"> ler01</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_gt1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> !lt_def</span><span class="id"> rootC_eq1</span><span class="id"> ?rootC_ge1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_le1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x_ge0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">rootC1</span><span class="id"> n_gt0</span>)<span class="id"> ler_rootCl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootC_lt1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n_gt0</span><span class="id"> x_ge0;</span><span class="id"> rewrite</span><span class="id"> !lt_neqAle</span><span class="id"> rootC_eq1</span><span class="id"> ?rootC_le1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootCMl</span><span class="id"> n</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> *</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le0r</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;</span><span class="id"> |</span><span class="id"> x_gt0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mul0r,</span><span class="id"> rootC0</span>).<br/>
<span class="id">have</span><span class="id"> [|</span><span class="id"> n_gt1</span><span class="id"> |</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> ltngtP</span><span class="id"> n</span><span class="id"> 1;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !root1C</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> !root0C</span><span class="id"> mul0r</span>.<br/>
<span class="id">have</span><span class="id"> [x_ge0</span><span class="id"> n_gt0]</span><span class="id"> :=</span> (<span class="id">ltW</span><span class="id"> x_gt0,</span><span class="id"> ltnW</span><span class="id"> n_gt1</span>).<br/>
<span class="id">have</span><span class="id"> nx_gt0:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rootC_gt0</span>.<br/>
<span class="id">have</span><span class="id"> Rnx:</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> real</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_real</span><span class="id"> ?ltW</span>.<br/>
<span class="id">apply:</span><span class="id"> eqC_semipolar;</span><span class="id"> last</span><span class="id"> 1</span><span class="id"> first;</span><span class="id"> try</span><span class="id"> apply/eqP</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ImMl</span><span class="id"> //</span><span class="id"> !</span>(<span class="id">Im_rootC_ge0,</span><span class="id"> mulr_ge0,</span><span class="id"> rootC_ge0</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqrXn2</span><span class="id"> n_gt0</span>)<span class="id"> //</span><span class="id"> -!normrX</span><span class="id"> exprMn</span><span class="id"> !rootCK</span>.<br/>
<span class="id">rewrite</span><span class="id"> eq_le;</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> rootC_Re_max</span><span class="id"> ?exprMn</span><span class="id"> ?rootCK</span><span class="id"> ?ImMl</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_ge0</span><span class="id"> ?Im_rootC_ge0</span><span class="id"> ?ltW</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[n</span>.<span class="id">-root</span><span class="id"> _]</span>(<span class="id">mulVKf</span> (<span class="id">negbT</span> (<span class="id">gt_eqF</span><span class="id"> nx_gt0</span>)))<span class="id"> !</span>(<span class="id">ReMl</span><span class="id"> Rnx</span>)<span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> ler_pM2l</span><span class="id"> //</span><span class="id"> rootC_Re_max</span><span class="id"> ?exprMn</span><span class="id"> ?exprVn</span><span class="id"> ?rootCK</span><span class="id"> ?mulKf</span><span class="id"> ?gt_eqF</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ImMl</span><span class="id"> ?rpredV</span><span class="id"> //</span><span class="id"> mulr_ge0</span><span class="id"> ?invr_ge0</span><span class="id"> ?Im_rootC_ge0</span><span class="id"> ?ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rootCMr</span><span class="id"> n</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> n</span>.<span class="id">-root</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> z</span><span class="id"> *</span><span class="id"> n</span>.<span class="id">-root</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_ge0;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> rootCMl</span><span class="id"> //</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> imaginaryCE</span><span class="id"> :</span><span class="id"> 'i</span><span class="id"> =</span><span class="id"> sqrtC</span> (<span class="id">-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> :</span><span class="id"> sqrtC</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 'i</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrCi</span><span class="id"> rootCK</span><span class="id"> //</span><span class="id"> subrr</span>.<br/>
<span class="id">rewrite</span><span class="id"> subr_sqr</span><span class="id"> mulf_eq0</span><span class="id"> subr_eq0</span><span class="id"> addr_eq0;</span><span class="id"> have</span><span class="id"> [//|_/=</span><span class="id"> /eqP</span><span class="id"> sCN1E]</span><span class="id"> :=</span><span class="id"> eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> @Im_rootC_ge0</span><span class="id"> 2</span> (<span class="id">-1</span>)<span class="id"> isT;</span><span class="id"> rewrite</span><span class="id"> sCN1E</span><span class="id"> raddfN</span><span class="id"> /=</span><span class="id"> Im_i</span><span class="id"> ler0N1</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leif_rootC_AGM</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">n</span><span class="id"> :=</span><span class="id"> #|A|</span>)<span class="id"> E</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> A,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> E</span><span class="id"> i}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">n</span>.<span class="id">-root</span> (<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> &lt;=</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> /</span><span class="id"> n%:R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">?=</span><span class="id"> iff</span><span class="id"> [forall</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> A,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="gallina-kwd"> in</span><span class="id"> A,</span><span class="id"> E</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> E</span><span class="id"> j]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ege0;</span><span class="id"> have</span><span class="id"> [n0</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> n0</span><span class="id"> root0C</span><span class="id"> invr0</span><span class="id"> mulr0;</span><span class="id"> apply/leif_refl/forall_inP=&gt;</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">card0_eq</span><span class="id"> n0</span>).<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mono_in_leif</span> (<span class="id">ler_pXn2r</span><span class="id"> n_gt0</span>))<span class="id"> ?rootCK</span><span class="id"> //=;</span><span class="id"> first</span><span class="id"> 1</span><span class="id"> last</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> qualifE</span><span class="id"> /=</span><span class="id"> rootC_ge0</span><span class="id"> //</span><span class="id"> prodr_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rpred_div</span><span class="id"> ?rpred_nat</span><span class="id"> ?rpred_sum</span>.<br/>
<span class="id">exact:</span><span class="id"> leif_AGM</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtC0</span><span class="id"> :</span><span class="id"> sqrtC</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtC1</span><span class="id"> :</span><span class="id"> sqrtC</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC1</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtCK</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sqrtC</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootCK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrCK</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> sqrtC</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> exprCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> sqrtC</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC_ge0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sqrtC</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC_eq0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_gt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sqrtC</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC_gt0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_lt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sqrtC</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC_lt0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_le0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">sqrtC</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC_le0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_sqrtC</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> sqrtC</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ler_rootC</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltr_sqrtC</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> sqrtC</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> ltr_rootC</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> eqr_sqrtC</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> sqrtC</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eqr_rootC</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> sqrtC</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rootC_inj</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sqrtCM</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> sqrtC</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> rootCMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrtC_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> sqrtC</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> Num</span>.<span class="id">real</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sqrtC_ge0;</span><span class="id"> apply:</span><span class="id"> ger0_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrCK_P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">sqrtC</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> x</span>) ((<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> 'Im</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span><span class="id"> ~~</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> andP</span>)<span class="id"> =&gt;</span><span class="id"> [[leI0x</span><span class="id"> not_gt0x]</span><span class="id"> |</span><span class="id"> &lt;-];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrtC_lt0</span><span class="id"> Im_rootC_ge0</span>.<br/>
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> sqrtCK</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> eqf_sqr</span><span class="id"> =&gt;</span><span class="id"> /pred2P[]</span><span class="id"> //</span><span class="id"> defNx</span>.<br/>
<span class="id">apply:</span><span class="id"> sqrCK;</span><span class="id"> rewrite</span><span class="id"> -real_leNgt</span><span class="id"> ?rpred0</span><span class="id"> //</span><span class="gallina-kwd"> in</span><span class="id"> not_gt0x;</span><br/>
<span class="id">apply/Creal_ImP/le_anti;</span><br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> leI0x</span><span class="id"> -oppr_ge0</span><span class="id"> -raddfN</span><span class="id"> -defNx</span><span class="id"> Im_rootC_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC_def</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> sqrtC</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> x^*</span> ).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -normCK</span><span class="id"> sqrCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> norm_conjC</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x^*|</span><span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !normC_def</span><span class="id"> conjCK</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC_rect</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> real</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> 'i</span><span class="id"> *</span><span class="id"> y|</span><span class="id"> =</span><span class="id"> sqrtC</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Rx</span><span class="id"> Ry;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> normC_def</span><span class="id"> -normCK</span><span class="id"> normC2_rect</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC_Re_Im</span><span class="id"> z</span><span class="id"> :</span><span class="id"> `|z|</span><span class="id"> =</span><span class="id"> sqrtC</span> (<span class="id">'Re</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> 'Im</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normC_def</span><span class="id"> -normCK</span><span class="id"> normC2_Re_Im</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normCDeq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> +</span><span class="id"> y|</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{t</span><span class="id"> :</span><span class="id"> C</span><span class="id"> |</span><span class="id"> `|t|</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> &amp;</span> (<span class="id">x,</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> *</span><span class="id"> t,</span><span class="id"> `|y|</span><span class="id"> *</span><span class="id"> t</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> lin_xy;</span><span class="id"> apply:</span><span class="id"> sig2_eqW;</span><span class="id"> pose</span><span class="id"> u</span><span class="id"> z</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> z</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> 1</span><span class="gallina-kwd"> else</span><span class="id"> z</span><span class="id"> /</span><span class="id"> `|z|</span>.<br/>
<span class="id">have</span><span class="id"> uE</span><span class="id"> z:</span> (<span class="id">`|u</span><span class="id"> z|</span><span class="id"> =</span><span class="id"> 1</span>)<span class="id"> *</span> (<span class="id">`|z|</span><span class="id"> *</span><span class="id"> u</span><span class="id"> z</span><span class="id"> =</span><span class="id"> z</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /u;</span><span class="id"> have</span><span class="id"> [-&gt;|nz_z]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normr0</span><span class="id"> normr1</span><span class="id"> mul0r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normf_div</span><span class="id"> normr_id</span><span class="id"> mulrCA</span><span class="id"> divff</span><span class="id"> ?mulr1</span><span class="id"> ?normr_eq0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|nz_x]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span> (<span class="id">u</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> uE</span><span class="id"> ?normr0</span><span class="id"> ?mul0r</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">u</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> uE</span><span class="id"> //</span><span class="id"> /u</span> (<span class="id">negPf</span><span class="id"> nz_x</span>)<span class="id">;</span><span class="id"> congr</span> (_<span class="id"> ,</span><span class="id"> _</span>).<br/>
<span class="id">have{lin_xy}</span><span class="id"> def2xy:</span><span class="id"> `|x|</span><span class="id"> *</span><span class="id"> `|y|</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ^*</span><span class="id"> +</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^*</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/</span>(<span class="id">addrI</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> x^*</span> ))<span class="id">/</span>(<span class="id">addIr</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> y^*</span> ))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -2!{1}normCK</span><span class="id"> -sqrrD</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addrA</span><span class="id"> -addrA</span><span class="id"> -!mulrDr</span><span class="id"> -mulrDl</span><span class="id"> -rmorphD</span><span class="id"> -normCK</span><span class="id"> lin_xy</span>.<br/>
<span class="id">have</span><span class="id"> def_xy:</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y^*</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x^*</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> -[_</span><span class="id"> ==</span><span class="id"> 0]</span>(<span class="id">@expf_eq0</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">canRL</span> (<span class="id">subrK</span><span class="id"> _</span>) (<span class="id">subr_sqrDB</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> opprK</span><span class="id"> -def2xy</span><span class="id"> exprMn_n</span><span class="id"> exprMn</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrN</span> (<span class="id">@GRing</span>.<span class="id">mul</span><span class="id"> C</span>).<span class="id">[AC</span> (<span class="id">2*2</span>) (<span class="id">1*4*</span>(<span class="id">3*2</span>))<span class="id">]</span><span class="id"> -!normCK</span><span class="id"> mulNrn</span><span class="id"> addNr</span>.<br/>
<span class="id">have{def_xy</span><span class="id"> def2xy}</span><span class="id"> def_yx:</span><span class="id"> `|y</span><span class="id"> *</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x^*</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">mulIf</span><span class="id"> nz2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mulr_natr</span><span class="id"> mulrC</span><span class="id"> normrM</span><span class="id"> def2xy</span><span class="id"> def_xy</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}</span>(<span class="id">divfK</span><span class="id"> nz_x</span><span class="id"> y</span>)<span class="id"> invC_norm</span><span class="id"> mulrCA</span><span class="id"> -{}def_yx</span><span class="id"> !normrM</span><span class="id"> invfM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrCA</span><span class="id"> divfK</span><span class="id"> ?normr_eq0</span><span class="id"> //</span><span class="id"> mulrAC</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC_sum_eq</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> C</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i|</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|F</span><span class="id"> i|</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">{t</span><span class="id"> :</span><span class="id"> C</span><span class="id"> |</span><span class="id"> `|t|</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> &amp;</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> `|F</span><span class="id"> i|</span><span class="id"> *</span><span class="id"> t}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [i</span><span class="id"> /andP[Pi</span><span class="id"> nzFi]</span><span class="id"> |</span><span class="id"> F0]</span><span class="id"> :=</span><span class="id"> pickP</span><span class="id"> [pred</span><span class="id"> i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> 0];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> 1</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Pi];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normr1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/nandP:</span> (<span class="id">F0</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> [/negP[]//</span><span class="id"> |</span><span class="id"> /negbNE/eqP-&gt;];</span><span class="id"> rewrite</span><span class="id"> normr0</span><span class="id"> mul0r</span>.<br/>
<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">bigD1</span><span class="id"> i</span><span class="id"> Pi</span>)<span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> norm_sumF;</span><span class="id"> pose</span><span class="id"> Q</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> P</span><span class="id"> j</span><span class="id"> &amp;&amp;</span> (<span class="id">j</span><span class="id"> !=</span><span class="id"> i</span>).<br/>
<span class="id">rewrite</span><span class="id"> -normr_eq0</span><span class="gallina-kwd"> in</span><span class="id"> nzFi;</span><span class="id"> set</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> F</span><span class="id"> i</span><span class="id"> /</span><span class="id"> `|F</span><span class="id"> i|;</span><span class="gallina-kwd"> exists</span><span class="id"> c</span><span class="id"> =&gt;</span><span class="id"> [|j</span><span class="id"> Pj]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normrM</span><span class="id"> normfV</span><span class="id"> normr_id</span><span class="id"> divff</span>.<br/>
<span class="id">have</span><span class="id"> [Qj</span><span class="id"> |</span><span class="id"> /nandP[/negP[]//</span><span class="id"> |</span><span class="id"> /negbNE/eqP-&gt;]]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">Q</span><span class="id"> j</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> divfK</span>.<br/>
<span class="id">have:</span><span class="id"> `|F</span><span class="id"> i</span><span class="id"> +</span><span class="id"> F</span><span class="id"> j|</span><span class="id"> =</span><span class="id"> `|F</span><span class="id"> i|</span><span class="id"> +</span><span class="id"> `|F</span><span class="id"> j|</span>.<br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> [rewrite</span><span class="id"> !</span>(<span class="id">bigD1</span><span class="id"> j</span><span class="id"> Qj</span>)<span class="id"> /=;</span><span class="id"> set</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> \sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> _</span>)<span class="id"> `|_|]</span><span class="gallina-kwd"> in</span><span class="id"> norm_sumF</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> ler_normD</span><span class="id"> -</span>(<span class="id">lerD2r</span><span class="id"> z</span>)<span class="id"> -addrA</span><span class="id"> -norm_sumF</span><span class="id"> addrA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> lerD2l</span><span class="id"> ler_norm_sum</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/normCDeq=&gt;</span><span class="id"> k</span><span class="id"> _</span><span class="id"> [/</span>(<span class="id">canLR</span> (<span class="id">mulKf</span><span class="id"> nzFi</span>))<span class="id"> &lt;-];</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulrC</span> (<span class="id">F</span><span class="id"> i</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC_sum_eq1</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> C</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i|</span><span class="id"> =</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|F</span><span class="id"> i|</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> `|F</span><span class="id"> i|</span><span class="id"> =</span><span class="id"> 1</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">{t</span><span class="id"> :</span><span class="id"> C</span><span class="id"> |</span><span class="id"> `|t|</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> &amp;</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> t}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/normC_sum_eq=&gt;</span><span class="id"> t</span><span class="id"> t1</span><span class="id"> defF</span><span class="id"> normF</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> t</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> defF</span><span class="id"> //</span><span class="id"> normF</span><span class="id"> //</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normC_sum_upper</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> G</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> C</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> `|F</span><span class="id"> i|</span><span class="id"> &lt;=</span><span class="id"> G</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> G</span><span class="id"> i</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> G</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> sumF</span><span class="id"> :=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> set</span><span class="id"> sumG</span><span class="id"> :=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> _</span>)<span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> leFG</span><span class="id"> eq_sumFG</span>.<br/>
<span class="id">have</span><span class="id"> posG</span><span class="id"> i:</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> G</span><span class="id"> i</span><span class="gallina-kwd"> by</span><span class="id"> move/leFG;</span><span class="id"> apply:</span><span class="id"> le_trans</span>.<br/>
<span class="id">have</span><span class="id"> norm_sumG:</span><span class="id"> `|sumG|</span><span class="id"> =</span><span class="id"> sumG</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ger0_norm</span><span class="id"> ?sumr_ge0</span>.<br/>
<span class="id">have</span><span class="id"> norm_sumF:</span><span class="id"> `|sumF|</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|F</span><span class="id"> i|</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> ler_norm_sum</span><span class="id"> eq_sumFG</span><span class="id"> norm_sumG</span><span class="id"> -subr_ge0</span><span class="id"> -sumrB</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sumr_ge0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> subr_ge0</span><span class="id"> ?leFG</span>.<br/>
<span class="id">have</span><span class="id"> [t</span><span class="id"> _</span><span class="id"> defF]</span><span class="id"> :=</span><span class="id"> normC_sum_eq</span><span class="id"> norm_sumF</span>.<br/>
<span class="id">have</span><span class="id"> [/</span>(<span class="id">psumr_eq0P</span><span class="id"> posG</span>)<span class="id"> G0</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> |</span><span class="id"> nz_sumG]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> sumG</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> G0</span><span class="id"> //</span><span class="id"> -normr_eq0</span><span class="id"> eq_le</span><span class="id"> normr_ge0</span><span class="id"> -</span>(<span class="id">G0</span><span class="id"> i</span><span class="id"> Pi</span>)<span class="id"> leFG</span>.<br/>
<span class="id">have</span><span class="id"> t1:</span><span class="id"> t</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">mulfI</span><span class="id"> nz_sumG</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulr1</span><span class="id"> -{1}norm_sumG</span><span class="id"> -eq_sumFG</span><span class="id"> norm_sumF</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_suml</span><span class="id"> -</span>(<span class="id">eq_bigr</span><span class="id"> _</span><span class="id"> defF</span>).<br/>
<span class="id">have</span><span class="id"> /psumr_eq0P</span><span class="id"> eqFG</span><span class="id"> i:</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> G</span><span class="id"> i</span><span class="id"> -</span><span class="id"> F</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> subr_ge0</span><span class="id"> defF</span><span class="id"> //</span><span class="id"> t1</span><span class="id"> mulr1</span><span class="id"> leFG</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> i</span><span class="id"> /eqFG/</span>(<span class="id">canRL</span> (<span class="id">subrK</span><span class="id"> _</span>))<span class="id">-&gt;;</span><span class="id"> rewrite</span><span class="id"> ?add0r</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sumrB</span><span class="id"> -/sumF</span><span class="id"> eq_sumFG</span><span class="id"> subrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normCBeq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> -</span><span class="id"> `|y|</span><span class="id"> -&gt;</span><span class="id"> {t</span><span class="id"> |</span><span class="id"> `|t|</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> &amp;</span> (<span class="id">x,</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> *</span><span class="id"> t,</span><span class="id"> `|y|</span><span class="id"> *</span><span class="id"> t</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">subrK</span><span class="id"> y</span><span class="id"> x</span>)<span class="id"> -/z</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">canLR</span> (<span class="id">subrK</span><span class="id"> _</span>))<span class="id">/esym-Dx</span>.<br/>
<span class="id">have</span><span class="id"> [t</span><span class="id"> t_1</span><span class="id"> [Dz</span><span class="id"> Dy]]</span><span class="id"> :=</span><span class="id"> normCDeq</span><span class="id"> Dx</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> Dx</span><span class="id"> mulrDl</span><span class="id"> -Dz</span><span class="id"> -Dy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;n .-root&quot;</span><span class="id"> :=</span> (<span class="id">@nthroot</span><span class="id"> _</span><span class="id"> n</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> sqrtC</span><span class="id"> :=</span><span class="id"> 2</span>.<span class="id">-root</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'i&quot;</span><span class="id"> :=</span><span class="id"> imaginary</span><span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'Re z&quot;</span><span class="id"> :=</span> (<span class="id">Re</span><span class="id"> z</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'Im z&quot;</span><span class="id"> :=</span> (<span class="id">Im</span><span class="id"> z</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> conjCK</span><span class="id"> {C}</span><span class="id"> x</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sqrCK</span><span class="id"> {C}</span><span class="id"> [x]</span><span class="id"> le0x</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sqrCK_P</span><span class="id"> {C</span><span class="id"> x}</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">in_mem</span> (<span class="id">'Re</span><span class="id"> _</span>)<span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">solve</span><span class="id"> [apply:</span><span class="id"> Creal_Re]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">in_mem</span> (<span class="id">'Im</span><span class="id"> _</span>)<span class="id"> _</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">solve</span><span class="id"> [apply:</span><span class="id"> Creal_Im]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Export</span><span class="id"> Pdeg2</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NumClosed</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2NumClosed</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> numClosedFieldType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> r1</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> -</span><span class="id"> sqrtC</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<span class="vernacular">Let</span><span class="id"> r2</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> +</span><span class="id"> sqrtC</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_factor</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r1%:P</span>)<span class="id"> *</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r2%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_factor;</span><span class="id"> rewrite</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root1</span><span class="id"> :</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_root1;</span><span class="id"> rewrite</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root2</span><span class="id"> :</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_root2;</span><span class="id"> rewrite</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2NumClosed</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NumClosed</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NumClosedMonic</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> FieldMonic</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2NumClosedMonic</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> numClosedFieldType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> monicp</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \is</span><span class="id"> monic</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> r1</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> -</span><span class="id"> sqrtC</span><span class="id"> delta</span>)<span class="id"> /</span><span class="id"> 2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> r2</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> +</span><span class="id"> sqrtC</span><span class="id"> delta</span>)<span class="id"> /</span><span class="id"> 2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_factor</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r1%:P</span>)<span class="id"> *</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r2%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_factor;</span><span class="id"> rewrite</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root1</span><span class="id"> :</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_root1;</span><span class="id"> rewrite</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root2</span><span class="id"> :</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_root2;</span><span class="id"> rewrite</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtCK</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2NumClosedMonic</span>.<br/>
<span class="vernacular">End</span><span class="id"> NumClosedMonic</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Real</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2Real</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> realFieldType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealConvex</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> age0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> pneq0</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0</span><span class="id"> degp</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> aneq0</span><span class="id"> :</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> pneq0;</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0</span><span class="id"> lead_coefE</span><span class="id"> degp</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> agt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> aneq0</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> a4gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_gt0</span><span class="id"> ?ltr0n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_min</span><span class="id"> x</span><span class="id"> :</span><span class="id"> p</span>.<span class="id">[-</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id">]</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [p]deg2_poly_canonical</span><span class="id"> ?pnatr_eq0//</span><span class="id"> -/a</span><span class="id"> -/b</span><span class="id"> -/c</span><span class="id"> /delta</span><span class="id"> !hornerE/=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_pM2l//</span><span class="id"> lerD2r</span><span class="id"> addrC</span><span class="id"> mulNr</span><span class="id"> subrr</span><span class="id"> expr0n</span><span class="id"> sqr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_minE</span><span class="id"> :</span><span class="id"> p</span>.<span class="id">[-</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id">]</span><span class="id"> =</span><span class="id"> -</span><span class="id"> delta</span><span class="id"> /</span> (<span class="id">4</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [p]deg2_poly_canonical</span><span class="id"> ?pnatr_eq0//</span><span class="id"> -/a</span><span class="id"> -/b</span><span class="id"> -/c</span><span class="id"> -/delta</span><span class="id"> !hornerE/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X^+2]addrC</span><span class="id"> [in</span><span class="id"> LHS]mulNr</span><span class="id"> subrr</span><span class="id"> expr0n</span><span class="id"> add0r</span><span class="id"> mulNr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mulNr</span><span class="id"> invfM</span><span class="id"> mulrA</span><span class="id"> mulfVK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>) (<span class="id">delta</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [dlt0</span><span class="id"> x</span><span class="id"> |</span><span class="id"> /</span>(_ (<span class="id">-</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)))<span class="id">];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> deg2_poly_minE</span><span class="id"> ltr_pdivlMr//</span><span class="id"> mul0r</span><span class="id"> oppr_gt0</span>.<br/>
<span class="id">apply:</span><span class="id"> lt_le_trans</span> (<span class="id">deg2_poly_min</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> deg2_poly_minE</span><span class="id"> ltr_pdivlMr//</span><span class="id"> mul0r</span><span class="id"> oppr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>) (<span class="id">delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [dlt0</span><span class="id"> x</span><span class="id"> |</span><span class="id"> /</span>(_ (<span class="id">-</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)))<span class="id">];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> deg2_poly_minE</span><span class="id"> ler_pdivlMr//</span><span class="id"> mul0r</span><span class="id"> oppr_ge0</span>.<br/>
<span class="id">apply:</span><span class="id"> le_trans</span> (<span class="id">deg2_poly_min</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> deg2_poly_minE</span><span class="id"> ler_pdivlMr//</span><span class="id"> mul0r</span><span class="id"> oppr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealConvex</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealConcave</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> ale0</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> degpN</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> =</span><span class="id"> 3</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_polyN</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> b2a</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_1</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_2</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !coefN</span><span class="id"> mulrN</span><span class="id"> divrNN</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> deltaN</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_1</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_2</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_0</span><span class="id"> =</span><span class="id"> delta</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !coefN</span><span class="id"> sqrrN</span><span class="id"> -mulrN</span><span class="id"> opprK</span><span class="id"> mulrN</span><span class="id"> mulNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_max</span><span class="id"> x</span><span class="id"> :</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[-</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id">]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lerN2</span><span class="id"> -!hornerN</span><span class="id"> -b2a</span><span class="id"> deg2_poly_min//</span><span class="id"> coefN</span><span class="id"> oppr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_maxE</span><span class="id"> :</span><span class="id"> p</span>.<span class="id">[-</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id">]</span><span class="id"> =</span><span class="id"> -</span><span class="id"> delta</span><span class="id"> /</span> (<span class="id">4</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> [eqbRHS]mulNr</span><span class="id"> -eqr_oppLR</span><span class="id"> -hornerN</span><span class="id"> -b2a</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> deg2_poly_minE//</span><span class="id"> deltaN</span><span class="id"> coefN</span><span class="id"> mulrN</span><span class="id"> divrNN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_lt0</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">delta</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -deltaN;</span><span class="id"> apply/</span>(<span class="id">iffP</span> (<span class="id">deg2_poly_gt0</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?coefN</span><span class="id"> ?oppr_ge0//</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> gt0</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> -oppr_gt0</span><span class="id"> -hornerN</span><span class="id"> gt0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lt0</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> hornerN</span><span class="id"> oppr_gt0</span><span class="id"> lt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_le0</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>) (<span class="id">delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -deltaN;</span><span class="id"> apply/</span>(<span class="id">iffP</span> (<span class="id">deg2_poly_ge0</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?coefN</span><span class="id"> ?oppr_ge0//</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ge0</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> -oppr_ge0</span><span class="id"> -hornerN</span><span class="id"> ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le0</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> hornerN</span><span class="id"> oppr_ge0</span><span class="id"> le0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealConcave</span>.<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2Real</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealClosed</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> rcfType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealClosedConvex</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> pneq0</span><span class="id"> :</span><span class="id"> p</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -size_poly_gt0</span><span class="id"> degp</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> aneq0</span><span class="id"> :</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> pneq0;</span><span class="id"> rewrite</span><span class="id"> -lead_coef_eq0</span><span class="id"> lead_coefE</span><span class="id"> degp</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> sqa2</span><span class="id"> :</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id"> ^+</span><span class="id"> 2</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprMn</span><span class="id"> -natrX</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> nz2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> F</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pnatr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> r1</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> -</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<span class="vernacular">Let</span><span class="id"> r2</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> +</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_factor</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r1%:P</span>)<span class="id"> *</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r2%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dge0;</span><span class="id"> apply:</span><span class="id"> deg2_poly_factor;</span><span class="id"> rewrite</span><span class="id"> ?sqr_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root1</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dge0;</span><span class="id"> apply:</span><span class="id"> deg2_poly_root1;</span><span class="id"> rewrite</span><span class="id"> ?sqr_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root2</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dge0;</span><span class="id"> apply:</span><span class="id"> deg2_poly_root2;</span><span class="id"> rewrite</span><span class="id"> ?sqr_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_noroot</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>) (<span class="id">delta</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [dlt0</span><span class="id"> x</span><span class="id"> |</span><span class="id"> /</span>(_<span class="id"> r1</span>)<span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> ltgtP</span><span class="id"> aneq0</span><span class="id"> =&gt;</span><span class="id"> [agt0</span><span class="id"> _|alt0</span><span class="id"> _|//];</span><span class="id"> rewrite</span><span class="id"> rootE;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/lt0r_neq0/</span>(<span class="id">deg2_poly_gt0</span><span class="id"> degp</span> (<span class="id">ltW</span><span class="id"> alt0</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -oppr_eq0</span><span class="id"> -hornerN</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/lt0r_neq0/deg2_poly_gt0;</span><span class="id"> rewrite</span><span class="id"> ?size_polyN</span><span class="id"> ?coefN</span><span class="id"> ?oppr_ge0</span><span class="id"> ?ltW//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrrN</span><span class="id"> -mulrA</span><span class="id"> mulrNN</span><span class="id"> mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltNge;</span><span class="id"> apply:</span><span class="id"> contraNN</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> deg2_poly_root1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> age0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> agt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> aneq0</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> a2gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 2</span><span class="id"> *</span><span class="id"> a</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_gt0</span><span class="id"> ?ltr0n</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> a4gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_gt0</span><span class="id"> ?ltr0n</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> aa4gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> a</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_gt0</span><span class="id"> ?ltr0n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> xb4</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> b</span><span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>))<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> *</span> (<span class="id">4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> a</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id"> +</span><span class="id"> b</span>)<span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> a</span><span class="id"> =</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr2</span><span class="id"> mulrACA</span><span class="id"> -natrM</span><span class="id"> mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -exprMn</span><span class="id"> mulrDl</span><span class="id"> mulfVK</span><span class="id"> ?mulf_neq0</span><span class="id"> ?pnatr_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> r1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xltr1;</span><span class="id"> have</span><span class="id"> [?</span><span class="id"> |</span><span class="id"> dge0]</span><span class="id"> :=</span><span class="id"> ltP</span><span class="id"> delta</span><span class="id"> 0;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> deg2_poly_gt0</span>.<br/>
<span class="id">have</span><span class="id"> {}xltr1</span><span class="id"> :</span><span class="id"> sqrt</span><span class="id"> delta</span><span class="id"> &lt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> *</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id"> +</span><span class="id"> b</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltrNr</span><span class="id"> -ltrBrDr</span><span class="id"> addrC</span><span class="id"> -ltr_pdivlMr</span>.<br/>
<span class="id">rewrite</span><span class="id"> [p]deg2_poly_canonical//</span><span class="id"> -/a</span><span class="id"> -/b</span><span class="id"> -/c</span><span class="id"> -/delta</span><span class="id"> !hornerE/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulr_gt0//</span><span class="id"> subr_gt0</span><span class="id"> ltr_pdivrMr//</span><span class="id"> xb4</span><span class="id"> -sqrrN</span>.<br/>
<span class="id">rewrite</span><span class="id"> -ltr_sqrt</span><span class="id"> ?sqrtr_sqr</span><span class="id"> ?</span>(<span class="id">lt_le_trans</span><span class="id"> xltr1</span>)<span class="id"> ?ler_norm//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprn_gt0</span><span class="id"> ?</span>(<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> xltr1</span>)<span class="id"> ?sqrtr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r2</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xgtr2;</span><span class="id"> have</span><span class="id"> [?</span><span class="id"> |</span><span class="id"> dge0]</span><span class="id"> :=</span><span class="id"> ltP</span><span class="id"> delta</span><span class="id"> 0;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> deg2_poly_gt0</span>.<br/>
<span class="id">have</span><span class="id"> {}xgtr2</span><span class="id"> :</span><span class="id"> sqrt</span><span class="id"> delta</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>)<span class="id"> +</span><span class="id"> b</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltrBlDr</span><span class="id"> addrC</span><span class="id"> -ltr_pdivrMr</span>.<br/>
<span class="id">rewrite</span><span class="id"> [p]deg2_poly_canonical//</span><span class="id"> -/a</span><span class="id"> -/b</span><span class="id"> -/c</span><span class="id"> -/delta</span><span class="id"> !hornerE/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulr_gt0//</span><span class="id"> subr_gt0</span><span class="id"> ltr_pdivrMr//</span><span class="id"> xb4</span>.<br/>
<span class="id">rewrite</span><span class="id"> -ltr_sqrt</span><span class="id"> ?sqrtr_sqr</span><span class="id"> ?</span>(<span class="id">lt_le_trans</span><span class="id"> xgtr2</span>)<span class="id"> ?ler_norm//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprn_gt0</span><span class="id"> ?</span>(<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> xgtr2</span>)<span class="id"> ?sqrtr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_lt0m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> r2</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[r1ltx</span><span class="id"> xltr2]</span>.<br/>
<span class="id">have</span><span class="id"> [dle0</span><span class="id"> |</span><span class="id"> dgt0]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> delta</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span> (<span class="id">lt_trans</span><span class="id"> r1ltx</span><span class="id"> xltr2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /r1</span><span class="id"> /r2</span><span class="id"> ler0_sqrtr//</span><span class="id"> oppr0</span><span class="id"> ltxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> [p]deg2_poly_canonical//</span><span class="id"> !hornerE/=</span><span class="id"> -/a</span><span class="id"> -/b</span><span class="id"> -/c</span><span class="id"> -/delta</span>.<br/>
<span class="id">rewrite</span><span class="id"> pmulr_rlt0//</span><span class="id"> subr_lt0</span><span class="id"> ltr_pdivlMr//</span><span class="id"> xb4</span><span class="id"> -ltr_sqrt//</span><span class="id"> sqrtr_sqr</span><span class="id"> ltr_norml</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltrBlDr</span><span class="id"> addrC</span><span class="id"> -ltr_pdivrMr//</span><span class="id"> r1ltx</span><span class="id"> -ltrBrDr</span><span class="id"> addrC</span><span class="id"> -ltr_pdivlMr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP-&gt;|xltr1];</span><span class="id"> last</span><span class="id"> exact/ltW/deg2_poly_gt0l</span>.<br/>
<span class="id">have</span><span class="id"> [dge0|dlt0]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0</span><span class="id"> delta;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_ge0</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span> (<span class="id">rootP</span> (<span class="id">deg2_poly_root1</span><span class="id"> dge0</span>))<span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r2</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP&lt;-|xgtr2];</span><span class="id"> last</span><span class="id"> exact/ltW/deg2_poly_gt0r</span>.<br/>
<span class="id">have</span><span class="id"> [dge0|dlt0]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0</span><span class="id"> delta;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> deg2_poly_ge0</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span> (<span class="id">rootP</span> (<span class="id">deg2_poly_root2</span><span class="id"> dge0</span>))<span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_le0m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> r1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r2</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dge0;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> andb_orl</span><span class="id"> =&gt;</span><span class="id"> /orP[/andP[/eqP&lt;-</span><span class="id"> _]|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span> (<span class="id">rootP</span> (<span class="id">deg2_poly_root1</span><span class="id"> dge0</span>))<span class="id"> eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> andb_orr</span><span class="id"> =&gt;</span><span class="id"> /orP[/andP[_</span><span class="id"> /eqP-&gt;]|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span> (<span class="id">rootP</span> (<span class="id">deg2_poly_root2</span><span class="id"> dge0</span>))<span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply/ltW/deg2_poly_lt0m</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealClosedConvex</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealClosedConcave</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> r1</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> +</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<span class="vernacular">Let</span><span class="id"> r2</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> -</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> ale0</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> degpN</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id"> =</span><span class="id"> 3</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_polyN</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> aNge0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_2</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> coefN</span><span class="id"> oppr_ge0</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> deltaN</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_1</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_2</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_0</span><span class="id"> =</span><span class="id"> delta</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !coefN</span><span class="id"> sqrrN</span><span class="id"> -mulrN</span><span class="id"> opprK</span><span class="id"> mulrN</span><span class="id"> mulNr</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> r1N</span><span class="id"> :</span> (<span class="id">-</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_1</span><span class="id"> -</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_2</span>)<span class="id"> =</span><span class="id"> r1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !coefN</span><span class="id"> -opprD</span><span class="id"> mulrN</span><span class="id"> divrNN</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> r2N</span><span class="id"> :</span> (<span class="id">-</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_1</span><span class="id"> +</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> p</span>)<span class="id">`_2</span>)<span class="id"> =</span><span class="id"> r2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !coefN</span><span class="id"> mulrN</span><span class="id"> divrN</span><span class="id"> -mulNr</span><span class="id"> opprK</span><span class="id"> opprD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_lt0l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> r1</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -oppr_gt0</span><span class="id"> -hornerN</span><span class="id"> deg2_poly_gt0l//</span><span class="id"> deltaN</span><span class="id"> r1N</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_lt0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r2</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -oppr_gt0</span><span class="id"> -hornerN</span><span class="id"> deg2_poly_gt0r//</span><span class="id"> deltaN</span><span class="id"> r2N</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> r2</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -oppr_lt0</span><span class="id"> -hornerN</span><span class="id"> deg2_poly_lt0m//</span><span class="id"> deltaN</span><span class="id"> r1N</span><span class="id"> r2N</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_le0l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r1</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -oppr_ge0</span><span class="id"> -hornerN</span><span class="id"> deg2_poly_ge0l//</span><span class="id"> deltaN</span><span class="id"> r1N</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_le0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r2</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -oppr_ge0</span><span class="id"> -hornerN</span><span class="id"> deg2_poly_ge0r//</span><span class="id"> deltaN</span><span class="id"> r2N</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> r1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r2</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -oppr_le0</span><span class="id"> -hornerN</span><span class="id"> deg2_poly_le0m</span><span class="id"> ?deltaN//</span><span class="id"> r1N</span><span class="id"> r2N</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealClosedConcave</span>.<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealClosed</span>.<br/>
<span class="vernacular">End</span><span class="id"> Real</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RealMonic</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Real</span>.<br/>
<span class="vernacular">Export</span><span class="id"> FieldMonic</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealMonic</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> realFieldType</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> monicp</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \is</span><span class="id"> monic</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a1</span><span class="id"> :</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span> (<span class="id">monicP</span><span class="id"> monicp</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> lead_coefE</span><span class="id"> degp</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> a2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> *</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 2</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> a1</span><span class="id"> mulr1</span>. Qed.</div></details>
<span class="vernacular">Let</span><span class="id"> a4</span><span class="id"> :</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 4</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> a1</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_min</span><span class="id"> x</span><span class="id"> :</span><span class="id"> p</span>.<span class="id">[-</span><span class="id"> b</span><span class="id"> /</span><span class="id"> 2]</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -a2</span><span class="id"> deg2_poly_min</span><span class="id"> -/a</span><span class="id"> ?a1</span><span class="id"> ?ler01</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> deltam</span><span class="id"> :</span><span class="id"> delta</span><span class="id"> =</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> a1</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_minE</span><span class="id"> :</span><span class="id"> p</span>.<span class="id">[-</span><span class="id"> b</span><span class="id"> /</span><span class="id"> 2]</span><span class="id"> =</span><span class="id"> -</span><span class="id"> delta</span><span class="id"> /</span><span class="id"> 4</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -a2</span><span class="id"> -a4</span><span class="id"> deltam</span><span class="id"> deg2_poly_minE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>) (<span class="id">delta</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> deltam;</span><span class="id"> apply:</span><span class="id"> deg2_poly_gt0;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> a1</span><span class="id"> ler01</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>) (<span class="id">delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> deltam;</span><span class="id"> apply:</span><span class="id"> deg2_poly_ge0;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> a1</span><span class="id"> ler01</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealMonic</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pdeg2RealClosedMonic</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> rcfType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span><span class="id"> size</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 3</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> monicp</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \is</span><span class="id"> monic</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a1</span><span class="id"> :</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span> (<span class="id">monicP</span><span class="id"> monicp</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> lead_coefE</span><span class="id"> degp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> deltam</span><span class="id"> :</span><span class="id"> delta</span><span class="id"> =</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> a1</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> r1</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> -</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span><span class="id"> 2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> r2</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> +</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span><span class="id"> 2</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> nz2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> F</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pnatr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_factor</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> =</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r1%:P</span>)<span class="id"> *</span> (<span class="id">'X</span><span class="id"> -</span><span class="id"> r2%:P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dge0;</span><span class="id"> apply:</span><span class="id"> deg2_poly_factor;</span><span class="id"> rewrite</span><span class="id"> ?sqr_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root1</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dge0;</span><span class="id"> apply:</span><span class="id"> deg2_poly_root1;</span><span class="id"> rewrite</span><span class="id"> ?sqr_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_root2</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> root</span><span class="id"> p</span><span class="id"> r2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> dge0;</span><span class="id"> apply:</span><span class="id"> deg2_poly_root2;</span><span class="id"> rewrite</span><span class="id"> ?sqr_sqrtr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_noroot</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> ~~</span><span class="id"> root</span><span class="id"> p</span><span class="id"> x</span>) (<span class="id">delta</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> deltam;</span><span class="id"> apply:</span><span class="id"> deg2_poly_noroot</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> r1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> deg2_poly_gt0l;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> ?a1</span><span class="id"> ?ler01</span><span class="id"> ?mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_gt0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r2</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> deg2_poly_gt0r;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> ?a1</span><span class="id"> ?ler01</span><span class="id"> ?mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_lt0m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> r2</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> deg2_poly_lt0m;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> ?a1</span><span class="id"> ?ler01</span><span class="id"> ?mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> deg2_poly_ge0l;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> ?a1</span><span class="id"> ?ler01</span><span class="id"> ?mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_ge0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> r2</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> deg2_poly_ge0r;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -/a</span><span class="id"> ?a1</span><span class="id"> ?ler01</span><span class="id"> ?mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg2_poly_le0m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> delta</span><span class="id"> -&gt;</span><span class="id"> r1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r2</span><span class="id"> -&gt;</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> dge0</span><span class="id"> xm</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> deg2_poly_le0m;</span><span class="id"> rewrite</span><span class="id"> -/a</span><span class="id"> -/b</span><span class="id"> -/c</span><span class="id"> ?a1</span><span class="id"> ?mulr1</span><span class="id"> -/delta</span><span class="id"> ?ler01</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2RealClosedMonic</span>.<br/>
<span class="vernacular">End</span><span class="id"> RealMonic</span>.<br/>
<span class="vernacular">End</span><span class="id"> Pdeg2</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Degle2PolyRealConvex</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> 3</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg_le2_poly_delta_ge0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>)<span class="id"> -&gt;</span><span class="id"> delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> age0</span><span class="id"> pge0;</span><span class="id"> move:</span><span class="id"> degp;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP|]</span><span class="id"> degp'</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/</span>(<span class="id">Real</span>.<span class="id">deg2_poly_ge0</span><span class="id"> degp'</span><span class="id"> age0</span>).<br/>
<span class="id">have</span><span class="id"> a0</span><span class="id"> :</span><span class="id"> a</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /a</span><span class="id"> nth_default</span>.<br/>
<span class="id">rewrite</span><span class="id"> /delta</span><span class="id"> a0</span><span class="id"> mulr0</span><span class="id"> mul0r</span><span class="id"> subr0</span><span class="id"> exprn_even_le0//=</span>.<br/>
<span class="id">have</span><span class="id"> [//|/eqP</span><span class="id"> nzb]</span><span class="id"> :=</span><span class="id"> eqP;</span><span class="id"> move:</span> (<span class="id">pge0</span> ((<span class="id">-</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> c</span>)<span class="id"> /</span><span class="id"> b</span>)).<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> p</span><span class="id"> =</span><span class="id"> b</span><span class="id"> *:</span><span class="id"> 'X</span><span class="id"> +</span><span class="id"> c%:P</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/polyP</span><span class="id"> =&gt;</span><span class="id"> +</span><span class="id"> /[!coefE]</span><span class="id"> =&gt;</span><span class="id"> -[|[|i]]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !Monoid</span>.<span class="id">simpm//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nth_default//</span><span class="id"> -ltnS</span> (<span class="id">leq_trans</span><span class="id"> degp'</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !hornerE/=</span><span class="id"> mulrAC</span><span class="id"> mulfV//</span><span class="id"> mul1r</span><span class="id"> subrK</span><span class="id"> ler0N1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Degle2PolyRealConvex</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Degle2PolyRealConcave</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> 3</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg_le2_poly_delta_le0</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ale0</span><span class="id"> ple0;</span><span class="id"> rewrite</span><span class="id"> /delta</span><span class="id"> -sqrrN</span><span class="id"> -[c]opprK</span><span class="id"> mulrN</span><span class="id"> -mulNr</span><span class="id"> -[-</span>(<span class="id">4</span><span class="id"> *</span><span class="id"> a</span>)<span class="id">]mulrN</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!coefN</span><span class="id"> deg_le2_poly_delta_ge0</span><span class="id"> ?size_polyN</span><span class="id"> ?coefN</span><span class="id"> ?oppr_ge0//</span><span class="id"> =&gt;</span><span class="id"> x</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> hornerN</span><span class="id"> oppr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Degle2PolyRealConcave</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Degle2PolyRealClosedConvex</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> rcfType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> 3</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg_le2_poly_ge0</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> p</span>.<span class="id">[x]</span>)<span class="id"> -&gt;</span><span class="id"> delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [age0|alt0]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0</span><span class="id"> a;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> deg_le2_poly_delta_ge0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> pge0;</span><span class="id"> move:</span><span class="id"> degp;</span><span class="id"> rewrite</span><span class="id"> leq_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP|]</span><span class="id"> degp';</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> alt0;</span><span class="id"> rewrite</span><span class="id"> /a</span><span class="id"> nth_default</span><span class="id"> ?ltxx</span>.<br/>
<span class="id">have</span><span class="id"> [//|dge0]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> delta</span><span class="id"> 0</span>.<br/>
<span class="id">pose</span><span class="id"> r1</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> -</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<span class="id">pose</span><span class="id"> r2</span><span class="id"> :=</span> (<span class="id">-</span><span class="id"> b</span><span class="id"> +</span><span class="id"> sqrt</span><span class="id"> delta</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> a</span>).<br/>
<span class="id">pose</span><span class="id"> x0</span><span class="id"> :=</span><span class="id"> Num</span>.<span class="id">max</span> (<span class="id">r1</span><span class="id"> +</span><span class="id"> 1</span>) (<span class="id">r2</span><span class="id"> +</span><span class="id"> 1</span>).<br/>
<span class="id">move:</span> (<span class="id">pge0</span><span class="id"> x0</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">Real</span>.<span class="id">deg2_poly_factor</span><span class="id"> degp'</span> (<span class="id">ltW</span><span class="id"> dge0</span>)).<br/>
<span class="id">rewrite</span><span class="id"> !hornerE/=</span><span class="id"> -mulrA</span><span class="id"> nmulr_rge0//</span><span class="id"> leNgt</span><span class="id"> =&gt;</span><span class="id"> /negbTE&lt;-</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> mulr_gt0;</span><span class="id"> rewrite</span><span class="id"> subr_gt0</span><span class="id"> lt_max</span><span class="id"> ltrDl</span><span class="id"> ltr01</span><span class="id"> ?orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Degle2PolyRealClosedConvex</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Degle2PolyRealClosedConcave</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> rcfType</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {poly</span><span class="id"> F}</span>).<br/>
<span class="vernacular">Hypothesis</span><span class="id"> degp</span><span class="id"> :</span> (<span class="id">size</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> 3</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> p`_2</span>.<br/>
<span class="vernacular">Let</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> p`_1</span>.<br/>
<span class="vernacular">Let</span><span class="id"> c</span><span class="id"> :=</span><span class="id"> p`_0</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> delta</span><span class="id"> :=</span><span class="id"> b</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 4</span><span class="id"> *</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> deg_le2_poly_le0</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> p</span>.<span class="id">[x]</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> delta</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ple0;</span><span class="id"> rewrite</span><span class="id"> /delta</span><span class="id"> -sqrrN</span><span class="id"> -[c]opprK</span><span class="id"> mulrN</span><span class="id"> -mulNr</span><span class="id"> -[-</span>(<span class="id">4</span><span class="id"> *</span><span class="id"> a</span>)<span class="id">]mulrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!coefN</span><span class="id"> deg_le2_poly_ge0</span><span class="id"> ?size_polyN//</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> hornerN</span><span class="id"> oppr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Degle2PolyRealClosedConcave</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Theory</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> IntegralDomain_isNumRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> GRing</span>.<span class="id">IntegralDomain</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">Rle</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">Rlt</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">norm</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">normD</span>    <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rle</span> (<span class="id">norm</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)) (<span class="id">norm</span><span class="id"> x</span><span class="id"> +</span><span class="id"> norm</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">addr_gt0</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">norm_eq0</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">ger_total</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> x</span><span class="id"> y</span><span class="id"> ||</span><span class="id"> Rle</span><span class="id"> y</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">normM</span>    <span class="id"> :</span><span class="id"> {morph</span><span class="id"> norm</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y};</span><br/>
&nbsp;&nbsp;<span class="id">le_def</span>   <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">Rle</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">norm</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> ==</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">lt_def</span>   <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">Rlt</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">Rle</span><span class="id"> x</span><span class="id"> y</span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> IntegralDomain_isNumRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">Rle</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x &lt; y&quot;</span><span class="id"> :=</span> (<span class="id">Rlt</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">norm</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> ltrr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> ge0_def</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> x</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_def</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> subr_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ge0_def</span><span class="id"> -le_def</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> subr_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lt_def</span><span class="id"> subr_eq0</span><span class="id"> subr_ge0</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> lt_trans</span><span class="id"> :</span><span class="id"> transitive</span><span class="id"> Rlt</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> le_xy</span><span class="id"> le_yz</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -subr_gt0</span><span class="id"> -</span>(<span class="id">subrK</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> -addrA</span><span class="id"> addr_gt0</span><span class="id"> //</span><span class="id"> subr_gt0</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> le01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">have</span><span class="id"> n1_nz:</span><span class="id"> `|1|</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contraNneq</span> (<span class="id">@oner_neq0</span><span class="id"> R</span>)<span class="id"> =&gt;</span><span class="id"> /norm_eq0-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ge0_def</span><span class="id"> -</span>(<span class="id">inj_eq</span> (<span class="id">mulfI</span><span class="id"> n1_nz</span>))<span class="id"> -normM</span><span class="id"> !mulr1</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> lt01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 1</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> oner_neq0</span><span class="id"> le01</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> ltW</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> lerr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">have</span><span class="id"> n2:</span><span class="id"> `|2|</span><span class="id"> ==</span><span class="id"> 2</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ge0_def</span><span class="id"> ltW</span><span class="id"> ?addr_gt0</span><span class="id"> ?lt01</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> le_def</span><span class="id"> subrr</span><span class="id"> -</span>(<span class="id">inj_eq</span> (<span class="id">addrI</span><span class="id"> `|0|</span>))<span class="id"> addr0</span><span class="id"> -mulr2n</span><span class="id"> -mulr_natr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqP</span><span class="id"> n2</span>)<span class="id"> -normM</span><span class="id"> mul0r</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> le_def'</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_def;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> lerr</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> le_trans</span><span class="id"> :</span><span class="id"> transitive</span><span class="id"> Rle</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !le_def'</span><span class="id"> =&gt;</span><span class="id"> /predU1P</span><span class="id"> [-&gt;|hxy]</span><span class="id"> //</span><span class="id"> /predU1P</span><span class="id"> [&lt;-|hyz];</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ?hxy</span><span class="id"> ?</span>(<span class="id">lt_trans</span><span class="id"> hxy</span><span class="id"> hyz</span>)<span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> normrMn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> *+</span><span class="id"> n|</span><span class="id"> =</span><span class="id"> `|x|</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -mulr_natr</span><span class="id"> -[RHS]mulr_natr</span><span class="id"> normM</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -ge0_def</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ih];</span><span class="id"> [exact:</span><span class="id"> lerr</span><span class="id"> |</span><span class="id"> apply:</span> (<span class="id">le_trans</span><span class="id"> ih</span>)<span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_def</span><span class="id"> -natrB</span><span class="id"> //</span><span class="id"> subSnn</span><span class="id"> -[_%:R]subr0</span><span class="id"> -le_def</span><span class="id"> mulr1n</span><span class="id"> le01</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> normrN1</span><span class="id"> :</span><span class="id"> `|-1|</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">have:</span><span class="id"> `|-1|</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expr2</span><span class="id"> /=</span><span class="id"> -normM</span><span class="id"> mulrNN</span><span class="id"> mul1r</span><span class="id"> -[1]subr0</span><span class="id"> -le_def</span><span class="id"> le01</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sqrf_eq1</span><span class="id"> =&gt;</span><span class="id"> /predU1P</span><span class="id"> []</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -[-1]subr0</span><span class="id"> -le_def</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;:</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> -1</span><span class="id"> =</span> (<span class="id">-1</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> ||</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> -1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_def;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> lerr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> oppr_eq0</span><span class="id"> oner_eq0</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">addr_gt0</span><span class="id"> lt01</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> subrr</span><span class="id"> ltrr</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> normrN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|-</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulN1r</span><span class="id"> normM</span><span class="id"> -[RHS]mul1r</span><span class="id"> normrN1</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Order</span>.<span class="id">LtLe_isPOrder</span>.<span class="id">Build</span><span class="id"> ring_display</span><span class="id"> R</span><span class="id"> le_def'</span><span class="id"> ltrr</span><span class="id"> lt_trans</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Zmodule_isNormed</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> R</span><span class="id"> normD</span><span class="id"> norm_eq0</span><span class="id"> normrMn</span><span class="id"> normrN</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">isNumRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> addr_gt0</span><span class="id"> ger_total</span><span class="id"> normM</span><span class="id"> le_def</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> NumDomain_isReal</span><span class="id"> R</span><span class="id"> of</span><span class="id"> NumDomain</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">real</span><span class="id"> :</span><span class="id"> real_axiom</span><span class="id"> R</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> NumDomain_isReal</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> le_total</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">POrder_isTotal</span><span class="id"> ring_display</span><span class="id"> R</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">constructor=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> move:</span> (<span class="id">real</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unfold_in</span><span class="id"> /=</span><span class="id"> !ler_def</span><span class="id"> subr0</span><span class="id"> add0r</span><span class="id"> opprB</span><span class="id"> orbC</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> le_total</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> IntegralDomain_isLeReal</span><span class="id"> R</span><span class="id"> of</span><span class="id"> GRing</span>.<span class="id">IntegralDomain</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">Rle</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">Rlt</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">norm</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">le0_add</span>  <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> 0</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">le0_mul</span>  <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> 0</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">le0_anti</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rle</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">sub_ge0</span>  <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rle</span><span class="id"> 0</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> Rle</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">le0_total</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> ||</span><span class="id"> Rle</span><span class="id"> x</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">normN</span>    <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> norm</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> norm</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">ge0_norm</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">lt_def</span>   <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rlt</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span><span class="id"> Rle</span><span class="id"> x</span><span class="id"> y;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> IntegralDomain_isLeReal</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> le</span><span class="id"> :=</span><span class="id"> Rle</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> lt</span><span class="id"> :=</span><span class="id"> Rlt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">le</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x &lt; y&quot;</span><span class="id"> :=</span> (<span class="id">lt</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">norm</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Let</span><span class="id"> le0N</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sub0r</span><span class="id"> sub_ge0</span>. Qed.</div></details>
&nbsp;&nbsp;<span class="vernacular">Let</span><span class="id"> leN_total</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> \/</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/orP;</span><span class="id"> rewrite</span><span class="id"> le0N</span><span class="id"> le0_total</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Let</span><span class="id"> le00</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have:=</span><span class="id"> le0_total</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> orbb</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> lt0_add</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !lt_def</span><span class="id"> =&gt;</span><span class="id"> /andP</span><span class="id"> [x_neq0</span><span class="id"> l0x]</span><span class="id"> /andP</span><span class="id"> [y_neq0</span><span class="id"> l0y];</span><span class="id"> rewrite</span><span class="id"> le0_add</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> andbT</span><span class="id"> addr_eq0;</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> x_neq0</span><span class="id"> =&gt;</span><span class="id"> hxy</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [x]</span>(<span class="id">@le0_anti</span>)<span class="id"> //</span><span class="id"> hxy</span><span class="id"> -le0N</span><span class="id"> opprK</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> eq0_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">leN_total</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> /ge0_norm</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> Dnx</span><span class="id"> nx0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[x]opprK</span><span class="id"> -Dnx</span><span class="id"> normN</span><span class="id"> nx0</span><span class="id"> oppr0</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">`|y</span><span class="id"> -</span><span class="id"> x|</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">wlog</span><span class="id"> -&gt;:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> move/</span>(_<span class="id"> 0</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> subr0</span><span class="id"> sub_ge0</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> {x}subr0;</span><span class="id"> apply/idP/eqP=&gt;</span><span class="id"> [/ge0_norm//</span><span class="id"> |</span><span class="id"> Dy]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [//|</span><span class="id"> ny_ge0]</span><span class="id"> :=</span><span class="id"> leN_total</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -Dy</span><span class="id"> -normN</span><span class="id"> ge0_norm</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> normM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> norm</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> wlog</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IHx;</span><span class="id"> case:</span> (<span class="id">leN_total</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> /IHx//;</span><span class="id"> rewrite</span><span class="id"> mulNr</span><span class="id"> !normN</span>.<br/>
&nbsp;&nbsp;<span class="id">wlog</span><span class="id"> y_ge0</span><span class="id"> :</span><span class="id"> y</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?ge0_norm</span><span class="id"> ?le0_mul</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IHy;</span><span class="id"> case:</span> (<span class="id">leN_total</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> /IHy//;</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> !normN</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le_normD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">wlog</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IH;</span><span class="id"> case:</span> (<span class="id">leN_total</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> /IH//</span><span class="id"> /</span>(_ (<span class="id">-</span><span class="id"> y</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -opprD</span><span class="id"> !normN</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -sub_ge0</span><span class="id"> ge0_norm</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [y_ge0</span><span class="id"> |</span><span class="id"> ny_ge0]</span><span class="id"> :=</span><span class="id"> leN_total</span><span class="id"> y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ge0_norm</span><span class="id"> ?subrr</span><span class="id"> ?le0_add</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -normN</span><span class="id"> ge0_norm</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [hxy|hxy]</span><span class="id"> :=</span><span class="id"> leN_total</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ge0_norm</span><span class="id"> //</span><span class="id"> opprD</span><span class="id"> addrCA</span><span class="id"> -addrA</span><span class="id"> addKr</span><span class="id"> le0_add</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -normN</span><span class="id"> ge0_norm</span><span class="id"> //</span><span class="id"> opprK</span><span class="id"> addrCA</span><span class="id"> addrNK</span><span class="id"> le0_add</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le_total</span><span class="id"> :</span><span class="id"> total</span><span class="id"> le</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -sub_ge0</span><span class="id"> -opprB</span><span class="id"> le0N</span><span class="id"> orbC</span><span class="id"> -sub_ge0</span><span class="id"> le0_total</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> IntegralDomain_isNumRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">le_normD</span><span class="id"> lt0_add</span><span class="id"> eq0_norm</span> (<span class="id">in2W</span><span class="id"> le_total</span>)<span class="id"> normM</span><span class="id"> le_def</span><span class="id"> lt_def</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">POrder_isTotal</span>.<span class="id">Build</span><span class="id"> ring_display</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">le_total</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> IntegralDomain_isLtReal</span><span class="id"> R</span><span class="id"> of</span><span class="id"> GRing</span>.<span class="id">IntegralDomain</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">Rlt</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">Rle</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">norm</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">lt0_add</span>  <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">lt0_mul</span>  <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">lt0_ngt0</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span> <span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> ~~</span> (<span class="id">Rlt</span><span class="id"> x</span><span class="id"> 0</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">sub_gt0</span>  <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rlt</span><span class="id"> 0</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> Rlt</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">lt0_total</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> Rlt</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> ||</span><span class="id"> Rlt</span><span class="id"> x</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">normN</span>    <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> norm</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> norm</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">ge0_norm</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> Rle</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> norm</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">le_def</span>   <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> Rle</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span><span class="id"> Rlt</span><span class="id"> x</span><span class="id"> y;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> IntegralDomain_isLtReal</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> le</span><span class="id"> :=</span><span class="id"> Rle</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> lt</span><span class="id"> :=</span><span class="id"> Rlt</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x &lt; y&quot;</span><span class="id"> :=</span> (<span class="id">lt</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">le</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">norm</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> lt0N</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sub_gt0</span><span class="id"> add0r</span><span class="id"> opprK</span>. Qed.</div></details>
&nbsp;&nbsp;<span class="vernacular">Let</span><span class="id"> leN_total</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> \/</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !le_def</span><span class="id"> [_</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> x]eq_sym</span><span class="id"> oppr_eq0</span><span class="id"> -[0</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x]lt0N</span><span class="id"> opprK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/orP;</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> exact:</span><span class="id"> lt0_total</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Let</span><span class="id"> le00</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_def</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> sub_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !le_def</span><span class="id"> eq_sym</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span><span class="id"> sub_gt0</span>. Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le0_add</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !le_def</span><span class="id"> =&gt;</span><span class="id"> /predU1P</span><span class="id"> [&lt;-|x_gt0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> add0r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/predU1P=&gt;</span><span class="id"> [&lt;-|y_gt0];</span><span class="id"> rewrite</span><span class="id"> ?addr0</span><span class="id"> ?x_gt0</span><span class="id"> ?lt0_add</span><span class="id"> //</span><span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le0_mul</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !le_def</span><span class="id"> =&gt;</span><span class="id"> /predU1P</span><span class="id"> [&lt;-|x_gt0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/predU1P=&gt;</span><span class="id"> [&lt;-|y_gt0];</span><span class="id"> rewrite</span><span class="id"> ?mulr0</span><span class="id"> ?eqxx</span><span class="id"> ?lt0_mul</span><span class="id"> //</span><span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> normM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> norm</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> wlog</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IHx;</span><span class="id"> case:</span> (<span class="id">leN_total</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> /IHx//;</span><span class="id"> rewrite</span><span class="id"> mulNr</span><span class="id"> !normN</span>.<br/>
&nbsp;&nbsp;<span class="id">wlog</span><span class="id"> y_ge0</span><span class="id"> :</span><span class="id"> y</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?ge0_norm</span><span class="id"> ?le0_mul</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IHy;</span><span class="id"> case:</span> (<span class="id">leN_total</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> /IHy//;</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> !normN</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le_normD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">wlog</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> IH;</span><span class="id"> case:</span> (<span class="id">leN_total</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> /IH//</span><span class="id"> /</span>(_ (<span class="id">-</span><span class="id"> y</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -opprD</span><span class="id"> !normN</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -sub_ge0</span><span class="id"> ge0_norm</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [y_ge0</span><span class="id"> |</span><span class="id"> ny_ge0]</span><span class="id"> :=</span><span class="id"> leN_total</span><span class="id"> y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ge0_norm</span><span class="id"> ?subrr</span><span class="id"> ?le0_add</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -normN</span><span class="id"> ge0_norm</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> [hxy|hxy]</span><span class="id"> :=</span><span class="id"> leN_total</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ge0_norm</span><span class="id"> //</span><span class="id"> opprD</span><span class="id"> addrCA</span><span class="id"> -addrA</span><span class="id"> addKr</span><span class="id"> le0_add</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -normN</span><span class="id"> ge0_norm</span><span class="id"> //</span><span class="id"> opprK</span><span class="id"> addrCA</span><span class="id"> addrNK</span><span class="id"> le0_add</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> eq0_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">leN_total</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> /ge0_norm</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> //</span><span class="id"> |</span><span class="id"> Dnx</span><span class="id"> nx0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[x]opprK</span><span class="id"> -Dnx</span><span class="id"> normN</span><span class="id"> nx0</span><span class="id"> oppr0</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le_def'</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">`|y</span><span class="id"> -</span><span class="id"> x|</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">wlog</span><span class="id"> -&gt;:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> move/</span>(_<span class="id"> 0</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> subr0</span><span class="id"> sub_ge0</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> {x}subr0;</span><span class="id"> apply/idP/eqP=&gt;</span><span class="id"> [/ge0_norm//</span><span class="id"> |</span><span class="id"> Dy]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [//|</span><span class="id"> ny_ge0]</span><span class="id"> :=</span><span class="id"> leN_total</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -Dy</span><span class="id"> -normN</span><span class="id"> ge0_norm</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> lt_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> le_def;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> -sub_gt0</span><span class="id"> subrr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/idP=&gt;</span><span class="id"> lt00;</span><span class="id"> case/negP:</span> (<span class="id">lt0_ngt0</span><span class="id"> lt00</span>).<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="vernacular">Fact</span><span class="id"> le_total</span><span class="id"> :</span><span class="id"> total</span><span class="id"> le</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !le_def;</span><span class="id"> have</span><span class="id"> [-&gt;|]</span><span class="id"> //=</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/lt0_total;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">sub_gt0</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>))<span class="id"> sub0r</span><span class="id"> opprB</span><span class="id"> !sub_gt0</span><span class="id"> orbC</span>.<br/>
&nbsp;&nbsp;Qed.</div></details>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> IntegralDomain_isNumRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">le_normD</span><span class="id"> lt0_add</span><span class="id"> eq0_norm</span> (<span class="id">in2W</span><span class="id"> le_total</span>)<span class="id"> normM</span><span class="id"> le_def'</span><span class="id"> lt_def</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">POrder_isTotal</span>.<span class="id">Build</span><span class="id"> ring_display</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">le_total</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Exports</span>. <span class="id">HB</span>.<span class="id">reexport</span>. <span class="vernacular">End</span><span class="vernacular"> Exports</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Num</span>.<br/>
<span class="vernacular">Export</span><span class="id"> Num</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> Num</span>.<span class="id">Syntax</span><span class="id"> Num</span>.<span class="id">PredInstances</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/affeldt-aist/rocqnavi/">rocqnavi</a></div>
    </div>
  </div>
    </main>
</body>
</html>
