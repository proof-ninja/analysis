
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.matrix</title>
<meta name="description" content="Documentation of Coq module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.matrix" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="rocqnavi.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="rocqnavi.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="Corelib"><summary>Corelib</summary>
          <ul>
          <li><details id="Corelib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Corelib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Corelib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Corelib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Corelib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Corelib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Corelib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Corelib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Corelib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Corelib.Classes.Init.html">Init</a></li>
<li><a href="Corelib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Corelib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Corelib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Corelib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Corelib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Corelib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Corelib.Compat.Coq820.html">Coq820</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Corelib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Corelib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Corelib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Corelib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Corelib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Corelib.Init.Byte.html">Byte</a></li>
<li><a href="Corelib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Corelib.Init.Decimal.html">Decimal</a></li>
<li><a href="Corelib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Corelib.Init.Logic.html">Logic</a></li>
<li><a href="Corelib.Init.Ltac.html">Ltac</a></li>
<li><a href="Corelib.Init.Nat.html">Nat</a></li>
<li><a href="Corelib.Init.Notations.html">Notations</a></li>
<li><a href="Corelib.Init.Number.html">Number</a></li>
<li><a href="Corelib.Init.Peano.html">Peano</a></li>
<li><a href="Corelib.Init.Prelude.html">Prelude</a></li>
<li><a href="Corelib.Init.Specif.html">Specif</a></li>
<li><a href="Corelib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Corelib.Init.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Init.Tauto.html">Tauto</a></li>
<li><a href="Corelib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Corelib.Lists.ListDef.html">ListDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Corelib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Corelib.Numbers.BinNums.html">BinNums</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Corelib.Program.Basics.html">Basics</a></li>
<li><a href="Corelib.Program.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Program.Utils.html">Utils</a></li>
<li><a href="Corelib.Program.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Corelib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Corelib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Corelib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Corelib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Corelib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Corelib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Corelib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Corelib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Corelib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Corelib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Corelib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Corelib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Corelib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Corelib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Corelib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="HB"><summary>HB</summary>
          <ul>
          <li><a href="HB.structures.html">structures</a></li>
          </ul>
          </details>
          </li>
<li><details id="Ltac2"><summary>Ltac2</summary>
          <ul>
          <li><details id="Ltac2.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Ltac2.Compat.Coq818.html">Coq818</a></li>
<li><a href="Ltac2.Compat.Coq819.html">Coq819</a></li>
          </ul>
          </details>
          </li>
<li><a href="Ltac2.Array.html">Array</a></li>
<li><a href="Ltac2.Bool.html">Bool</a></li>
<li><a href="Ltac2.Char.html">Char</a></li>
<li><a href="Ltac2.Constant.html">Constant</a></li>
<li><a href="Ltac2.Constr.html">Constr</a></li>
<li><a href="Ltac2.Constructor.html">Constructor</a></li>
<li><a href="Ltac2.Control.html">Control</a></li>
<li><a href="Ltac2.Env.html">Env</a></li>
<li><a href="Ltac2.Evar.html">Evar</a></li>
<li><a href="Ltac2.FMap.html">FMap</a></li>
<li><a href="Ltac2.FSet.html">FSet</a></li>
<li><a href="Ltac2.Float.html">Float</a></li>
<li><a href="Ltac2.Fresh.html">Fresh</a></li>
<li><a href="Ltac2.Ident.html">Ident</a></li>
<li><a href="Ltac2.Ind.html">Ind</a></li>
<li><a href="Ltac2.Init.html">Init</a></li>
<li><a href="Ltac2.Int.html">Int</a></li>
<li><a href="Ltac2.Lazy.html">Lazy</a></li>
<li><a href="Ltac2.List.html">List</a></li>
<li><a href="Ltac2.Ltac1.html">Ltac1</a></li>
<li><a href="Ltac2.Ltac2.html">Ltac2</a></li>
<li><a href="Ltac2.Message.html">Message</a></li>
<li><a href="Ltac2.Meta.html">Meta</a></li>
<li><a href="Ltac2.Notations.html">Notations</a></li>
<li><a href="Ltac2.Option.html">Option</a></li>
<li><a href="Ltac2.Pattern.html">Pattern</a></li>
<li><a href="Ltac2.Printf.html">Printf</a></li>
<li><a href="Ltac2.Proj.html">Proj</a></li>
<li><a href="Ltac2.Pstring.html">Pstring</a></li>
<li><a href="Ltac2.RedFlags.html">RedFlags</a></li>
<li><a href="Ltac2.Ref.html">Ref</a></li>
<li><a href="Ltac2.Std.html">Std</a></li>
<li><a href="Ltac2.String.html">String</a></li>
<li><a href="Ltac2.TransparentState.html">TransparentState</a></li>
<li><a href="Ltac2.Uint63.html">Uint63</a></li>
<li><a href="Ltac2.Unification.html">Unification</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib"><summary>Stdlib</summary>
          <ul>
          <li><details id="Stdlib.All"><summary>All</summary>
          <ul>
          <li><a href="Stdlib.All.All.html">All</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Arith"><summary>Arith</summary>
          <ul>
          <li><a href="Stdlib.Arith.Arith.html">Arith</a></li>
<li><a href="Stdlib.Arith.Arith_base.html">Arith_base</a></li>
<li><a href="Stdlib.Arith.Between.html">Between</a></li>
<li><a href="Stdlib.Arith.Bool_nat.html">Bool_nat</a></li>
<li><a href="Stdlib.Arith.Cantor.html">Cantor</a></li>
<li><a href="Stdlib.Arith.Compare.html">Compare</a></li>
<li><a href="Stdlib.Arith.Compare_dec.html">Compare_dec</a></li>
<li><a href="Stdlib.Arith.EqNat.html">EqNat</a></li>
<li><a href="Stdlib.Arith.Euclid.html">Euclid</a></li>
<li><a href="Stdlib.Arith.Factorial.html">Factorial</a></li>
<li><a href="Stdlib.Arith.PeanoNat.html">PeanoNat</a></li>
<li><a href="Stdlib.Arith.Peano_dec.html">Peano_dec</a></li>
<li><a href="Stdlib.Arith.Wf_nat.html">Wf_nat</a></li>
<li><a href="Stdlib.Arith.Zerob.html">Zerob</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Stdlib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Stdlib.Array.PArray.html">PArray</a></li>
<li><a href="Stdlib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Stdlib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Stdlib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Stdlib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Bool"><summary>Bool</summary>
          <ul>
          <li><a href="Stdlib.Bool.Bool.html">Bool</a></li>
<li><a href="Stdlib.Bool.BoolEq.html">BoolEq</a></li>
<li><a href="Stdlib.Bool.DecBool.html">DecBool</a></li>
<li><a href="Stdlib.Bool.IfProp.html">IfProp</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Stdlib.Classes.CEquivalence.html">CEquivalence</a></li>
<li><a href="Stdlib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Stdlib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Stdlib.Classes.DecidableClass.html">DecidableClass</a></li>
<li><a href="Stdlib.Classes.EquivDec.html">EquivDec</a></li>
<li><a href="Stdlib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Stdlib.Classes.Init.html">Init</a></li>
<li><a href="Stdlib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Stdlib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Stdlib.Classes.Morphisms_Relations.html">Morphisms_Relations</a></li>
<li><a href="Stdlib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Stdlib.Classes.RelationPairs.html">RelationPairs</a></li>
<li><a href="Stdlib.Classes.SetoidClass.html">SetoidClass</a></li>
<li><a href="Stdlib.Classes.SetoidDec.html">SetoidDec</a></li>
<li><a href="Stdlib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Stdlib.Compat.AdmitAxiom.html">AdmitAxiom</a></li>
<li><a href="Stdlib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Stdlib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Stdlib.Compat.Coq820.html">Coq820</a></li>
<li><a href="Stdlib.Compat.Stdlib818.html">Stdlib818</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.FSets"><summary>FSets</summary>
          <ul>
          <li><a href="Stdlib.FSets.FMapAVL.html">FMapAVL</a></li>
<li><a href="Stdlib.FSets.FMapFacts.html">FMapFacts</a></li>
<li><a href="Stdlib.FSets.FMapFullAVL.html">FMapFullAVL</a></li>
<li><a href="Stdlib.FSets.FMapInterface.html">FMapInterface</a></li>
<li><a href="Stdlib.FSets.FMapList.html">FMapList</a></li>
<li><a href="Stdlib.FSets.FMapPositive.html">FMapPositive</a></li>
<li><a href="Stdlib.FSets.FMapWeakList.html">FMapWeakList</a></li>
<li><a href="Stdlib.FSets.FMaps.html">FMaps</a></li>
<li><a href="Stdlib.FSets.FSetAVL.html">FSetAVL</a></li>
<li><a href="Stdlib.FSets.FSetBridge.html">FSetBridge</a></li>
<li><a href="Stdlib.FSets.FSetCompat.html">FSetCompat</a></li>
<li><a href="Stdlib.FSets.FSetDecide.html">FSetDecide</a></li>
<li><a href="Stdlib.FSets.FSetEqProperties.html">FSetEqProperties</a></li>
<li><a href="Stdlib.FSets.FSetFacts.html">FSetFacts</a></li>
<li><a href="Stdlib.FSets.FSetInterface.html">FSetInterface</a></li>
<li><a href="Stdlib.FSets.FSetList.html">FSetList</a></li>
<li><a href="Stdlib.FSets.FSetPositive.html">FSetPositive</a></li>
<li><a href="Stdlib.FSets.FSetProperties.html">FSetProperties</a></li>
<li><a href="Stdlib.FSets.FSetToFiniteSet.html">FSetToFiniteSet</a></li>
<li><a href="Stdlib.FSets.FSetWeakList.html">FSetWeakList</a></li>
<li><a href="Stdlib.FSets.FSets.html">FSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Stdlib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Stdlib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Stdlib.Floats.FloatLemmas.html">FloatLemmas</a></li>
<li><a href="Stdlib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Stdlib.Floats.Floats.html">Floats</a></li>
<li><a href="Stdlib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Stdlib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Stdlib.Init.Byte.html">Byte</a></li>
<li><a href="Stdlib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Stdlib.Init.Decimal.html">Decimal</a></li>
<li><a href="Stdlib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Stdlib.Init.Logic.html">Logic</a></li>
<li><a href="Stdlib.Init.Ltac.html">Ltac</a></li>
<li><a href="Stdlib.Init.Nat.html">Nat</a></li>
<li><a href="Stdlib.Init.Notations.html">Notations</a></li>
<li><a href="Stdlib.Init.Number.html">Number</a></li>
<li><a href="Stdlib.Init.Peano.html">Peano</a></li>
<li><a href="Stdlib.Init.Prelude.html">Prelude</a></li>
<li><a href="Stdlib.Init.Specif.html">Specif</a></li>
<li><a href="Stdlib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Stdlib.Init.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Init.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Stdlib.Lists.List.html">List</a></li>
<li><a href="Stdlib.Lists.ListDec.html">ListDec</a></li>
<li><a href="Stdlib.Lists.ListDef.html">ListDef</a></li>
<li><a href="Stdlib.Lists.ListSet.html">ListSet</a></li>
<li><a href="Stdlib.Lists.ListTactics.html">ListTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Logic"><summary>Logic</summary>
          <ul>
          <li><a href="Stdlib.Logic.Adjointification.html">Adjointification</a></li>
<li><a href="Stdlib.Logic.Berardi.html">Berardi</a></li>
<li><a href="Stdlib.Logic.ChoiceFacts.html">ChoiceFacts</a></li>
<li><a href="Stdlib.Logic.Classical.html">Classical</a></li>
<li><a href="Stdlib.Logic.ClassicalChoice.html">ClassicalChoice</a></li>
<li><a href="Stdlib.Logic.ClassicalDescription.html">ClassicalDescription</a></li>
<li><a href="Stdlib.Logic.ClassicalEpsilon.html">ClassicalEpsilon</a></li>
<li><a href="Stdlib.Logic.ClassicalFacts.html">ClassicalFacts</a></li>
<li><a href="Stdlib.Logic.ClassicalUniqueChoice.html">ClassicalUniqueChoice</a></li>
<li><a href="Stdlib.Logic.Classical_Pred_Type.html">Classical_Pred_Type</a></li>
<li><a href="Stdlib.Logic.Classical_Prop.html">Classical_Prop</a></li>
<li><a href="Stdlib.Logic.ConstructiveEpsilon.html">ConstructiveEpsilon</a></li>
<li><a href="Stdlib.Logic.Decidable.html">Decidable</a></li>
<li><a href="Stdlib.Logic.Description.html">Description</a></li>
<li><a href="Stdlib.Logic.Diaconescu.html">Diaconescu</a></li>
<li><a href="Stdlib.Logic.Epsilon.html">Epsilon</a></li>
<li><a href="Stdlib.Logic.Eqdep.html">Eqdep</a></li>
<li><a href="Stdlib.Logic.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="Stdlib.Logic.Eqdep_dec.html">Eqdep_dec</a></li>
<li><a href="Stdlib.Logic.ExtensionalFunctionRepresentative.html">ExtensionalFunctionRepresentative</a></li>
<li><a href="Stdlib.Logic.ExtensionalityFacts.html">ExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></li>
<li><a href="Stdlib.Logic.HLevels.html">HLevels</a></li>
<li><a href="Stdlib.Logic.Hurkens.html">Hurkens</a></li>
<li><a href="Stdlib.Logic.IndefiniteDescription.html">IndefiniteDescription</a></li>
<li><a href="Stdlib.Logic.JMeq.html">JMeq</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevance.html">ProofIrrelevance</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevanceFacts.html">ProofIrrelevanceFacts</a></li>
<li><a href="Stdlib.Logic.PropExtensionality.html">PropExtensionality</a></li>
<li><a href="Stdlib.Logic.PropExtensionalityFacts.html">PropExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.PropFacts.html">PropFacts</a></li>
<li><a href="Stdlib.Logic.RelationalChoice.html">RelationalChoice</a></li>
<li><a href="Stdlib.Logic.SetIsType.html">SetIsType</a></li>
<li><a href="Stdlib.Logic.SetoidChoice.html">SetoidChoice</a></li>
<li><a href="Stdlib.Logic.StrictProp.html">StrictProp</a></li>
<li><a href="Stdlib.Logic.WKL.html">WKL</a></li>
<li><a href="Stdlib.Logic.WeakFan.html">WeakFan</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.MSets"><summary>MSets</summary>
          <ul>
          <li><a href="Stdlib.MSets.MSetAVL.html">MSetAVL</a></li>
<li><a href="Stdlib.MSets.MSetDecide.html">MSetDecide</a></li>
<li><a href="Stdlib.MSets.MSetEqProperties.html">MSetEqProperties</a></li>
<li><a href="Stdlib.MSets.MSetFacts.html">MSetFacts</a></li>
<li><a href="Stdlib.MSets.MSetGenTree.html">MSetGenTree</a></li>
<li><a href="Stdlib.MSets.MSetInterface.html">MSetInterface</a></li>
<li><a href="Stdlib.MSets.MSetList.html">MSetList</a></li>
<li><a href="Stdlib.MSets.MSetPositive.html">MSetPositive</a></li>
<li><a href="Stdlib.MSets.MSetProperties.html">MSetProperties</a></li>
<li><a href="Stdlib.MSets.MSetRBT.html">MSetRBT</a></li>
<li><a href="Stdlib.MSets.MSetToFiniteSet.html">MSetToFiniteSet</a></li>
<li><a href="Stdlib.MSets.MSetWeakList.html">MSetWeakList</a></li>
<li><a href="Stdlib.MSets.MSets.html">MSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.NArith"><summary>NArith</summary>
          <ul>
          <li><a href="Stdlib.NArith.BinNat.html">BinNat</a></li>
<li><a href="Stdlib.NArith.BinNatDef.html">BinNatDef</a></li>
<li><a href="Stdlib.NArith.NArith.html">NArith</a></li>
<li><a href="Stdlib.NArith.NArith_base.html">NArith_base</a></li>
<li><a href="Stdlib.NArith.Ndec.html">Ndec</a></li>
<li><a href="Stdlib.NArith.Ndiv_def.html">Ndiv_def</a></li>
<li><a href="Stdlib.NArith.Ngcd_def.html">Ngcd_def</a></li>
<li><a href="Stdlib.NArith.Nnat.html">Nnat</a></li>
<li><a href="Stdlib.NArith.Nsqrt_def.html">Nsqrt_def</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Abstract.CyclicAxioms.html">CyclicAxioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.DoubleType.html">DoubleType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.NZCyclic.html">NZCyclic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Cyclic63.html">Cyclic63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Ring63.html">Ring63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63.html">Sint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63.html">Uint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer"><summary>Integer</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Integer.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Abstract.ZAdd.html">ZAdd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAddOrder.html">ZAddOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAxioms.html">ZAxioms</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBase.html">ZBase</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBits.html">ZBits</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivEucl.html">ZDivEucl</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivFloor.html">ZDivFloor</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivTrunc.html">ZDivTrunc</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZGcd.html">ZGcd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLcm.html">ZLcm</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLt.html">ZLt</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMaxMin.html">ZMaxMin</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMul.html">ZMul</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMulOrder.html">ZMulOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZParity.html">ZParity</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZPow.html">ZPow</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZProperties.html">ZProperties</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZSgnAbs.html">ZSgnAbs</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Binary.ZBinary.html">ZBinary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.NatPairs"><summary>NatPairs</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.NatPairs.ZNatPairs.html">ZNatPairs</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.NatInt"><summary>NatInt</summary>
          <ul>
          <li><a href="Stdlib.Numbers.NatInt.NZAdd.html">NZAdd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAddOrder.html">NZAddOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAxioms.html">NZAxioms</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBase.html">NZBase</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBits.html">NZBits</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDiv.html">NZDiv</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDomain.html">NZDomain</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZGcd.html">NZGcd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZLog.html">NZLog</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMul.html">NZMul</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMulOrder.html">NZMulOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZOrder.html">NZOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZParity.html">NZParity</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZPow.html">NZPow</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZProperties.html">NZProperties</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZSqrt.html">NZSqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural"><summary>Natural</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Natural.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Abstract.NAdd.html">NAdd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAddOrder.html">NAddOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAxioms.html">NAxioms</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBase.html">NBase</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBits.html">NBits</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDefOps.html">NDefOps</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv.html">NDiv</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv0.html">NDiv0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NGcd.html">NGcd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NIso.html">NIso</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm.html">NLcm</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm0.html">NLcm0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLog.html">NLog</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMaxMin.html">NMaxMin</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMulOrder.html">NMulOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NOrder.html">NOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NParity.html">NParity</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NPow.html">NPow</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NProperties.html">NProperties</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSqrt.html">NSqrt</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NStrongRec.html">NStrongRec</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSub.html">NSub</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Binary.NBinary.html">NBinary</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Numbers.AltBinNotations.html">AltBinNotations</a></li>
<li><a href="Stdlib.Numbers.BinNums.html">BinNums</a></li>
<li><a href="Stdlib.Numbers.DecimalFacts.html">DecimalFacts</a></li>
<li><a href="Stdlib.Numbers.DecimalN.html">DecimalN</a></li>
<li><a href="Stdlib.Numbers.DecimalNat.html">DecimalNat</a></li>
<li><a href="Stdlib.Numbers.DecimalPos.html">DecimalPos</a></li>
<li><a href="Stdlib.Numbers.DecimalQ.html">DecimalQ</a></li>
<li><a href="Stdlib.Numbers.DecimalR.html">DecimalR</a></li>
<li><a href="Stdlib.Numbers.DecimalString.html">DecimalString</a></li>
<li><a href="Stdlib.Numbers.DecimalZ.html">DecimalZ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalFacts.html">HexadecimalFacts</a></li>
<li><a href="Stdlib.Numbers.HexadecimalN.html">HexadecimalN</a></li>
<li><a href="Stdlib.Numbers.HexadecimalNat.html">HexadecimalNat</a></li>
<li><a href="Stdlib.Numbers.HexadecimalPos.html">HexadecimalPos</a></li>
<li><a href="Stdlib.Numbers.HexadecimalQ.html">HexadecimalQ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalR.html">HexadecimalR</a></li>
<li><a href="Stdlib.Numbers.HexadecimalString.html">HexadecimalString</a></li>
<li><a href="Stdlib.Numbers.HexadecimalZ.html">HexadecimalZ</a></li>
<li><a href="Stdlib.Numbers.NaryFunctions.html">NaryFunctions</a></li>
<li><a href="Stdlib.Numbers.NumPrelude.html">NumPrelude</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.PArith"><summary>PArith</summary>
          <ul>
          <li><a href="Stdlib.PArith.BinPos.html">BinPos</a></li>
<li><a href="Stdlib.PArith.BinPosDef.html">BinPosDef</a></li>
<li><a href="Stdlib.PArith.PArith.html">PArith</a></li>
<li><a href="Stdlib.PArith.POrderedType.html">POrderedType</a></li>
<li><a href="Stdlib.PArith.Pnat.html">Pnat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Stdlib.Program.Basics.html">Basics</a></li>
<li><a href="Stdlib.Program.Combinators.html">Combinators</a></li>
<li><a href="Stdlib.Program.Equality.html">Equality</a></li>
<li><a href="Stdlib.Program.Program.html">Program</a></li>
<li><a href="Stdlib.Program.Subset.html">Subset</a></li>
<li><a href="Stdlib.Program.Syntax.html">Syntax</a></li>
<li><a href="Stdlib.Program.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Program.Utils.html">Utils</a></li>
<li><a href="Stdlib.Program.Wf.html">Wf</a></li>
<li><a href="Stdlib.Program.WfExtensionality.html">WfExtensionality</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.QArith"><summary>QArith</summary>
          <ul>
          <li><a href="Stdlib.QArith.QArith.html">QArith</a></li>
<li><a href="Stdlib.QArith.QArith_base.html">QArith_base</a></li>
<li><a href="Stdlib.QArith.QOrderedType.html">QOrderedType</a></li>
<li><a href="Stdlib.QArith.Qabs.html">Qabs</a></li>
<li><a href="Stdlib.QArith.Qcabs.html">Qcabs</a></li>
<li><a href="Stdlib.QArith.Qcanon.html">Qcanon</a></li>
<li><a href="Stdlib.QArith.Qfield.html">Qfield</a></li>
<li><a href="Stdlib.QArith.Qminmax.html">Qminmax</a></li>
<li><a href="Stdlib.QArith.Qpower.html">Qpower</a></li>
<li><a href="Stdlib.QArith.Qreduction.html">Qreduction</a></li>
<li><a href="Stdlib.QArith.Qring.html">Qring</a></li>
<li><a href="Stdlib.QArith.Qround.html">Qround</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals"><summary>Reals</summary>
          <ul>
          <li><details id="Stdlib.Reals.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Reals.Abstract.ConstructiveAbs.html">ConstructiveAbs</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLUB.html">ConstructiveLUB</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLimits.html">ConstructiveLimits</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveMinMax.html">ConstructiveMinMax</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructivePower.html">ConstructivePower</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveReals.html">ConstructiveReals</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveRealsMorphisms.html">ConstructiveRealsMorphisms</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveSum.html">ConstructiveSum</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals.Cauchy"><summary>Cauchy</summary>
          <ul>
          <li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyAbs.html">ConstructiveCauchyAbs</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyReals.html">ConstructiveCauchyReals</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyRealsMult.html">ConstructiveCauchyRealsMult</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveExtra.html">ConstructiveExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveRcomplete.html">ConstructiveRcomplete</a></li>
<li><a href="Stdlib.Reals.Cauchy.PosExtra.html">PosExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.QExtra.html">QExtra</a></li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Reals.Alembert.html">Alembert</a></li>
<li><a href="Stdlib.Reals.AltSeries.html">AltSeries</a></li>
<li><a href="Stdlib.Reals.ArithProp.html">ArithProp</a></li>
<li><a href="Stdlib.Reals.Binomial.html">Binomial</a></li>
<li><a href="Stdlib.Reals.Cauchy_prod.html">Cauchy_prod</a></li>
<li><a href="Stdlib.Reals.ClassicalConstructiveReals.html">ClassicalConstructiveReals</a></li>
<li><a href="Stdlib.Reals.ClassicalDedekindReals.html">ClassicalDedekindReals</a></li>
<li><a href="Stdlib.Reals.Cos_plus.html">Cos_plus</a></li>
<li><a href="Stdlib.Reals.Cos_rel.html">Cos_rel</a></li>
<li><a href="Stdlib.Reals.DiscrR.html">DiscrR</a></li>
<li><a href="Stdlib.Reals.Exp_prop.html">Exp_prop</a></li>
<li><a href="Stdlib.Reals.Integration.html">Integration</a></li>
<li><a href="Stdlib.Reals.MVT.html">MVT</a></li>
<li><a href="Stdlib.Reals.Machin.html">Machin</a></li>
<li><a href="Stdlib.Reals.NewtonInt.html">NewtonInt</a></li>
<li><a href="Stdlib.Reals.Nsatz.html">Nsatz</a></li>
<li><a href="Stdlib.Reals.PSeries_reg.html">PSeries_reg</a></li>
<li><a href="Stdlib.Reals.PartSum.html">PartSum</a></li>
<li><a href="Stdlib.Reals.Qreals.html">Qreals</a></li>
<li><a href="Stdlib.Reals.RIneq.html">RIneq</a></li>
<li><a href="Stdlib.Reals.RList.html">RList</a></li>
<li><a href="Stdlib.Reals.ROrderedType.html">ROrderedType</a></li>
<li><a href="Stdlib.Reals.R_Ifp.html">R_Ifp</a></li>
<li><a href="Stdlib.Reals.R_sqr.html">R_sqr</a></li>
<li><a href="Stdlib.Reals.R_sqrt.html">R_sqrt</a></li>
<li><a href="Stdlib.Reals.Ranalysis.html">Ranalysis</a></li>
<li><a href="Stdlib.Reals.Ranalysis1.html">Ranalysis1</a></li>
<li><a href="Stdlib.Reals.Ranalysis2.html">Ranalysis2</a></li>
<li><a href="Stdlib.Reals.Ranalysis3.html">Ranalysis3</a></li>
<li><a href="Stdlib.Reals.Ranalysis4.html">Ranalysis4</a></li>
<li><a href="Stdlib.Reals.Ranalysis5.html">Ranalysis5</a></li>
<li><a href="Stdlib.Reals.Ranalysis_reg.html">Ranalysis_reg</a></li>
<li><a href="Stdlib.Reals.Ratan.html">Ratan</a></li>
<li><a href="Stdlib.Reals.Raxioms.html">Raxioms</a></li>
<li><a href="Stdlib.Reals.Rbase.html">Rbase</a></li>
<li><a href="Stdlib.Reals.Rbasic_fun.html">Rbasic_fun</a></li>
<li><a href="Stdlib.Reals.Rcomplete.html">Rcomplete</a></li>
<li><a href="Stdlib.Reals.Rdefinitions.html">Rdefinitions</a></li>
<li><a href="Stdlib.Reals.Rderiv.html">Rderiv</a></li>
<li><a href="Stdlib.Reals.Reals.html">Reals</a></li>
<li><a href="Stdlib.Reals.Rfunctions.html">Rfunctions</a></li>
<li><a href="Stdlib.Reals.Rgeom.html">Rgeom</a></li>
<li><a href="Stdlib.Reals.RiemannInt.html">RiemannInt</a></li>
<li><a href="Stdlib.Reals.RiemannInt_SF.html">RiemannInt_SF</a></li>
<li><a href="Stdlib.Reals.Rlimit.html">Rlimit</a></li>
<li><a href="Stdlib.Reals.Rlogic.html">Rlogic</a></li>
<li><a href="Stdlib.Reals.Rminmax.html">Rminmax</a></li>
<li><a href="Stdlib.Reals.Rpow_def.html">Rpow_def</a></li>
<li><a href="Stdlib.Reals.Rpower.html">Rpower</a></li>
<li><a href="Stdlib.Reals.Rprod.html">Rprod</a></li>
<li><a href="Stdlib.Reals.Rregisternames.html">Rregisternames</a></li>
<li><a href="Stdlib.Reals.Rseries.html">Rseries</a></li>
<li><a href="Stdlib.Reals.Rsigma.html">Rsigma</a></li>
<li><a href="Stdlib.Reals.Rsqrt_def.html">Rsqrt_def</a></li>
<li><a href="Stdlib.Reals.Rtopology.html">Rtopology</a></li>
<li><a href="Stdlib.Reals.Rtrigo.html">Rtrigo</a></li>
<li><a href="Stdlib.Reals.Rtrigo1.html">Rtrigo1</a></li>
<li><a href="Stdlib.Reals.Rtrigo_alt.html">Rtrigo_alt</a></li>
<li><a href="Stdlib.Reals.Rtrigo_calc.html">Rtrigo_calc</a></li>
<li><a href="Stdlib.Reals.Rtrigo_def.html">Rtrigo_def</a></li>
<li><a href="Stdlib.Reals.Rtrigo_facts.html">Rtrigo_facts</a></li>
<li><a href="Stdlib.Reals.Rtrigo_fun.html">Rtrigo_fun</a></li>
<li><a href="Stdlib.Reals.Rtrigo_reg.html">Rtrigo_reg</a></li>
<li><a href="Stdlib.Reals.Runcountable.html">Runcountable</a></li>
<li><a href="Stdlib.Reals.SeqProp.html">SeqProp</a></li>
<li><a href="Stdlib.Reals.SeqSeries.html">SeqSeries</a></li>
<li><a href="Stdlib.Reals.SplitAbsolu.html">SplitAbsolu</a></li>
<li><a href="Stdlib.Reals.SplitRmult.html">SplitRmult</a></li>
<li><a href="Stdlib.Reals.Sqrt_reg.html">Sqrt_reg</a></li>
<li><a href="Stdlib.Reals.Zfloor.html">Zfloor</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Stdlib.Relations.Operators_Properties.html">Operators_Properties</a></li>
<li><a href="Stdlib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
<li><a href="Stdlib.Relations.Relation_Operators.html">Relation_Operators</a></li>
<li><a href="Stdlib.Relations.Relations.html">Relations</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Stdlib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sets"><summary>Sets</summary>
          <ul>
          <li><a href="Stdlib.Sets.Classical_sets.html">Classical_sets</a></li>
<li><a href="Stdlib.Sets.Constructive_sets.html">Constructive_sets</a></li>
<li><a href="Stdlib.Sets.Cpo.html">Cpo</a></li>
<li><a href="Stdlib.Sets.Ensembles.html">Ensembles</a></li>
<li><a href="Stdlib.Sets.Finite_sets.html">Finite_sets</a></li>
<li><a href="Stdlib.Sets.Finite_sets_facts.html">Finite_sets_facts</a></li>
<li><a href="Stdlib.Sets.Image.html">Image</a></li>
<li><a href="Stdlib.Sets.Infinite_sets.html">Infinite_sets</a></li>
<li><a href="Stdlib.Sets.Integers.html">Integers</a></li>
<li><a href="Stdlib.Sets.Multiset.html">Multiset</a></li>
<li><a href="Stdlib.Sets.Partial_Order.html">Partial_Order</a></li>
<li><a href="Stdlib.Sets.Permut.html">Permut</a></li>
<li><a href="Stdlib.Sets.Powerset.html">Powerset</a></li>
<li><a href="Stdlib.Sets.Powerset_Classical_facts.html">Powerset_Classical_facts</a></li>
<li><a href="Stdlib.Sets.Powerset_facts.html">Powerset_facts</a></li>
<li><a href="Stdlib.Sets.Relations_1.html">Relations_1</a></li>
<li><a href="Stdlib.Sets.Relations_1_facts.html">Relations_1_facts</a></li>
<li><a href="Stdlib.Sets.Relations_2.html">Relations_2</a></li>
<li><a href="Stdlib.Sets.Relations_2_facts.html">Relations_2_facts</a></li>
<li><a href="Stdlib.Sets.Relations_3.html">Relations_3</a></li>
<li><a href="Stdlib.Sets.Relations_3_facts.html">Relations_3_facts</a></li>
<li><a href="Stdlib.Sets.Uniset.html">Uniset</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sorting"><summary>Sorting</summary>
          <ul>
          <li><a href="Stdlib.Sorting.CPermutation.html">CPermutation</a></li>
<li><a href="Stdlib.Sorting.Heap.html">Heap</a></li>
<li><a href="Stdlib.Sorting.Mergesort.html">Mergesort</a></li>
<li><a href="Stdlib.Sorting.PermutEq.html">PermutEq</a></li>
<li><a href="Stdlib.Sorting.PermutSetoid.html">PermutSetoid</a></li>
<li><a href="Stdlib.Sorting.Permutation.html">Permutation</a></li>
<li><a href="Stdlib.Sorting.SetoidList.html">SetoidList</a></li>
<li><a href="Stdlib.Sorting.SetoidPermutation.html">SetoidPermutation</a></li>
<li><a href="Stdlib.Sorting.Sorted.html">Sorted</a></li>
<li><a href="Stdlib.Sorting.Sorting.html">Sorting</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Streams"><summary>Streams</summary>
          <ul>
          <li><a href="Stdlib.Streams.StreamMemo.html">StreamMemo</a></li>
<li><a href="Stdlib.Streams.Streams.html">Streams</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Stdlib.Strings.Ascii.html">Ascii</a></li>
<li><a href="Stdlib.Strings.BinaryString.html">BinaryString</a></li>
<li><a href="Stdlib.Strings.Byte.html">Byte</a></li>
<li><a href="Stdlib.Strings.HexString.html">HexString</a></li>
<li><a href="Stdlib.Strings.OctalString.html">OctalString</a></li>
<li><a href="Stdlib.Strings.PString.html">PString</a></li>
<li><a href="Stdlib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Stdlib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="Stdlib.Strings.String.html">String</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Structures"><summary>Structures</summary>
          <ul>
          <li><a href="Stdlib.Structures.BoolOrder.html">BoolOrder</a></li>
<li><a href="Stdlib.Structures.DecidableType.html">DecidableType</a></li>
<li><a href="Stdlib.Structures.DecidableTypeEx.html">DecidableTypeEx</a></li>
<li><a href="Stdlib.Structures.Equalities.html">Equalities</a></li>
<li><a href="Stdlib.Structures.EqualitiesFacts.html">EqualitiesFacts</a></li>
<li><a href="Stdlib.Structures.GenericMinMax.html">GenericMinMax</a></li>
<li><a href="Stdlib.Structures.OrderedType.html">OrderedType</a></li>
<li><a href="Stdlib.Structures.OrderedTypeAlt.html">OrderedTypeAlt</a></li>
<li><a href="Stdlib.Structures.OrderedTypeEx.html">OrderedTypeEx</a></li>
<li><a href="Stdlib.Structures.Orders.html">Orders</a></li>
<li><a href="Stdlib.Structures.OrdersAlt.html">OrdersAlt</a></li>
<li><a href="Stdlib.Structures.OrdersEx.html">OrdersEx</a></li>
<li><a href="Stdlib.Structures.OrdersFacts.html">OrdersFacts</a></li>
<li><a href="Stdlib.Structures.OrdersLists.html">OrdersLists</a></li>
<li><a href="Stdlib.Structures.OrdersTac.html">OrdersTac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Unicode"><summary>Unicode</summary>
          <ul>
          <li><a href="Stdlib.Unicode.Utf8.html">Utf8</a></li>
<li><a href="Stdlib.Unicode.Utf8_core.html">Utf8_core</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Vectors"><summary>Vectors</summary>
          <ul>
          <li><a href="Stdlib.Vectors.Bvector.html">Bvector</a></li>
<li><a href="Stdlib.Vectors.Fin.html">Fin</a></li>
<li><a href="Stdlib.Vectors.FinFun.html">FinFun</a></li>
<li><a href="Stdlib.Vectors.Vector.html">Vector</a></li>
<li><a href="Stdlib.Vectors.VectorDef.html">VectorDef</a></li>
<li><a href="Stdlib.Vectors.VectorEq.html">VectorEq</a></li>
<li><a href="Stdlib.Vectors.VectorSpec.html">VectorSpec</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Wellfounded"><summary>Wellfounded</summary>
          <ul>
          <li><a href="Stdlib.Wellfounded.Disjoint_Union.html">Disjoint_Union</a></li>
<li><a href="Stdlib.Wellfounded.Inclusion.html">Inclusion</a></li>
<li><a href="Stdlib.Wellfounded.Inverse_Image.html">Inverse_Image</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Exponentiation.html">Lexicographic_Exponentiation</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Product.html">Lexicographic_Product</a></li>
<li><a href="Stdlib.Wellfounded.List_Extension.html">List_Extension</a></li>
<li><a href="Stdlib.Wellfounded.Transitive_Closure.html">Transitive_Closure</a></li>
<li><a href="Stdlib.Wellfounded.Union.html">Union</a></li>
<li><a href="Stdlib.Wellfounded.Well_Ordering.html">Well_Ordering</a></li>
<li><a href="Stdlib.Wellfounded.Wellfounded.html">Wellfounded</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ZArith"><summary>ZArith</summary>
          <ul>
          <li><a href="Stdlib.ZArith.BinInt.html">BinInt</a></li>
<li><a href="Stdlib.ZArith.BinIntDef.html">BinIntDef</a></li>
<li><a href="Stdlib.ZArith.Int.html">Int</a></li>
<li><a href="Stdlib.ZArith.Wf_Z.html">Wf_Z</a></li>
<li><a href="Stdlib.ZArith.ZArith.html">ZArith</a></li>
<li><a href="Stdlib.ZArith.ZArith_base.html">ZArith_base</a></li>
<li><a href="Stdlib.ZArith.ZArith_dec.html">ZArith_dec</a></li>
<li><a href="Stdlib.ZArith.Zabs.html">Zabs</a></li>
<li><a href="Stdlib.ZArith.Zbitwise.html">Zbitwise</a></li>
<li><a href="Stdlib.ZArith.Zbool.html">Zbool</a></li>
<li><a href="Stdlib.ZArith.Zcompare.html">Zcompare</a></li>
<li><a href="Stdlib.ZArith.Zcomplements.html">Zcomplements</a></li>
<li><a href="Stdlib.ZArith.Zdiv.html">Zdiv</a></li>
<li><a href="Stdlib.ZArith.Zdiv_facts.html">Zdiv_facts</a></li>
<li><a href="Stdlib.ZArith.Zeuclid.html">Zeuclid</a></li>
<li><a href="Stdlib.ZArith.Zeven.html">Zeven</a></li>
<li><a href="Stdlib.ZArith.Zgcd_alt.html">Zgcd_alt</a></li>
<li><a href="Stdlib.ZArith.Zhints.html">Zhints</a></li>
<li><a href="Stdlib.ZArith.Zmax.html">Zmax</a></li>
<li><a href="Stdlib.ZArith.Zmin.html">Zmin</a></li>
<li><a href="Stdlib.ZArith.Zminmax.html">Zminmax</a></li>
<li><a href="Stdlib.ZArith.Zmisc.html">Zmisc</a></li>
<li><a href="Stdlib.ZArith.Znat.html">Znat</a></li>
<li><a href="Stdlib.ZArith.Znumtheory.html">Znumtheory</a></li>
<li><a href="Stdlib.ZArith.Zorder.html">Zorder</a></li>
<li><a href="Stdlib.ZArith.Zpow_alt.html">Zpow_alt</a></li>
<li><a href="Stdlib.ZArith.Zpow_def.html">Zpow_def</a></li>
<li><a href="Stdlib.ZArith.Zpow_facts.html">Zpow_facts</a></li>
<li><a href="Stdlib.ZArith.Zpower.html">Zpower</a></li>
<li><a href="Stdlib.ZArith.Zquot.html">Zquot</a></li>
<li><a href="Stdlib.ZArith.Zwf.html">Zwf</a></li>
<li><a href="Stdlib.ZArith.auxiliary.html">auxiliary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.btauto"><summary>btauto</summary>
          <ul>
          <li><a href="Stdlib.btauto.Algebra.html">Algebra</a></li>
<li><a href="Stdlib.btauto.Btauto.html">Btauto</a></li>
<li><a href="Stdlib.btauto.Reflect.html">Reflect</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Stdlib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Stdlib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInt.html">ExtrHaskellNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInteger.html">ExtrHaskellNatInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatNum.html">ExtrHaskellNatNum</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellString.html">ExtrHaskellString</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInt.html">ExtrHaskellZInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInteger.html">ExtrHaskellZInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZNum.html">ExtrHaskellZNum</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlFloats.html">ExtrOCamlFloats</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlInt63.html">ExtrOCamlInt63</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPArray.html">ExtrOCamlPArray</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPString.html">ExtrOCamlPString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlChar.html">ExtrOcamlChar</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlIntConv.html">ExtrOcamlIntConv</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatBigInt.html">ExtrOcamlNatBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatInt.html">ExtrOcamlNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNativeString.html">ExtrOcamlNativeString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlString.html">ExtrOcamlString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZBigInt.html">ExtrOcamlZBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZInt.html">ExtrOcamlZInt</a></li>
<li><a href="Stdlib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.funind"><summary>funind</summary>
          <ul>
          <li><a href="Stdlib.funind.FunInd.html">FunInd</a></li>
<li><a href="Stdlib.funind.Recdef.html">Recdef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.micromega"><summary>micromega</summary>
          <ul>
          <li><a href="Stdlib.micromega.DeclConstant.html">DeclConstant</a></li>
<li><a href="Stdlib.micromega.DeclConstantZ.html">DeclConstantZ</a></li>
<li><a href="Stdlib.micromega.Env.html">Env</a></li>
<li><a href="Stdlib.micromega.EnvRing.html">EnvRing</a></li>
<li><a href="Stdlib.micromega.Fourier.html">Fourier</a></li>
<li><a href="Stdlib.micromega.Fourier_util.html">Fourier_util</a></li>
<li><a href="Stdlib.micromega.Lia.html">Lia</a></li>
<li><a href="Stdlib.micromega.Lqa.html">Lqa</a></li>
<li><a href="Stdlib.micromega.Lra.html">Lra</a></li>
<li><a href="Stdlib.micromega.OrderedRing.html">OrderedRing</a></li>
<li><a href="Stdlib.micromega.Psatz.html">Psatz</a></li>
<li><a href="Stdlib.micromega.QMicromega.html">QMicromega</a></li>
<li><a href="Stdlib.micromega.RMicromega.html">RMicromega</a></li>
<li><a href="Stdlib.micromega.Refl.html">Refl</a></li>
<li><a href="Stdlib.micromega.RingMicromega.html">RingMicromega</a></li>
<li><a href="Stdlib.micromega.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.micromega.VarMap.html">VarMap</a></li>
<li><a href="Stdlib.micromega.ZArith_hints.html">ZArith_hints</a></li>
<li><a href="Stdlib.micromega.ZCoeff.html">ZCoeff</a></li>
<li><a href="Stdlib.micromega.ZMicromega.html">ZMicromega</a></li>
<li><a href="Stdlib.micromega.Zify.html">Zify</a></li>
<li><a href="Stdlib.micromega.ZifyBool.html">ZifyBool</a></li>
<li><a href="Stdlib.micromega.ZifyClasses.html">ZifyClasses</a></li>
<li><a href="Stdlib.micromega.ZifyComparison.html">ZifyComparison</a></li>
<li><a href="Stdlib.micromega.ZifyInst.html">ZifyInst</a></li>
<li><a href="Stdlib.micromega.ZifyN.html">ZifyN</a></li>
<li><a href="Stdlib.micromega.ZifyNat.html">ZifyNat</a></li>
<li><a href="Stdlib.micromega.ZifyPow.html">ZifyPow</a></li>
<li><a href="Stdlib.micromega.ZifySint63.html">ZifySint63</a></li>
<li><a href="Stdlib.micromega.ZifyUint63.html">ZifyUint63</a></li>
<li><a href="Stdlib.micromega.Ztac.html">Ztac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.nsatz"><summary>nsatz</summary>
          <ul>
          <li><a href="Stdlib.nsatz.NsatzTactic.html">NsatzTactic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.omega"><summary>omega</summary>
          <ul>
          <li><a href="Stdlib.omega.OmegaLemmas.html">OmegaLemmas</a></li>
<li><a href="Stdlib.omega.PreOmega.html">PreOmega</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.rtauto"><summary>rtauto</summary>
          <ul>
          <li><a href="Stdlib.rtauto.Bintree.html">Bintree</a></li>
<li><a href="Stdlib.rtauto.Rtauto.html">Rtauto</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.setoid_ring"><summary>setoid_ring</summary>
          <ul>
          <li><a href="Stdlib.setoid_ring.Algebra_syntax.html">Algebra_syntax</a></li>
<li><a href="Stdlib.setoid_ring.ArithRing.html">ArithRing</a></li>
<li><a href="Stdlib.setoid_ring.BinList.html">BinList</a></li>
<li><a href="Stdlib.setoid_ring.Cring.html">Cring</a></li>
<li><a href="Stdlib.setoid_ring.Field.html">Field</a></li>
<li><a href="Stdlib.setoid_ring.Field_tac.html">Field_tac</a></li>
<li><a href="Stdlib.setoid_ring.Field_theory.html">Field_theory</a></li>
<li><a href="Stdlib.setoid_ring.InitialRing.html">InitialRing</a></li>
<li><a href="Stdlib.setoid_ring.Integral_domain.html">Integral_domain</a></li>
<li><a href="Stdlib.setoid_ring.NArithRing.html">NArithRing</a></li>
<li><a href="Stdlib.setoid_ring.Ncring.html">Ncring</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_initial.html">Ncring_initial</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_polynom.html">Ncring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_tac.html">Ncring_tac</a></li>
<li><a href="Stdlib.setoid_ring.RealField.html">RealField</a></li>
<li><a href="Stdlib.setoid_ring.Ring.html">Ring</a></li>
<li><a href="Stdlib.setoid_ring.Ring_base.html">Ring_base</a></li>
<li><a href="Stdlib.setoid_ring.Ring_polynom.html">Ring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ring_tac.html">Ring_tac</a></li>
<li><a href="Stdlib.setoid_ring.Ring_theory.html">Ring_theory</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Q.html">Rings_Q</a></li>
<li><a href="Stdlib.setoid_ring.Rings_R.html">Rings_R</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Z.html">Rings_Z</a></li>
<li><a href="Stdlib.setoid_ring.ZArithRing.html">ZArithRing</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Stdlib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Stdlib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Stdlib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Stdlib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Stdlib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Stdlib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Stdlib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi"><summary>elpi</summary>
          <ul>
          <li><details id="elpi.apps"><summary>apps</summary>
          <ul>
          <li><details id="elpi.apps.NES"><summary>NES</summary>
          <ul>
          <li><details id="elpi.apps.NES.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.NES.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.NES.NES.html">NES</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.coercion"><summary>coercion</summary>
          <ul>
          <li><a href="elpi.apps.coercion.coercion.html">coercion</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.cs"><summary>cs</summary>
          <ul>
          <li><a href="elpi.apps.cs.cs.html">cs</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive"><summary>derive</summary>
          <ul>
          <li><details id="elpi.apps.derive.derive"><summary>derive</summary>
          <ul>
          <li><a href="elpi.apps.derive.derive.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="elpi.apps.derive.derive.bcongr.html">bcongr</a></li>
<li><a href="elpi.apps.derive.derive.cast.html">cast</a></li>
<li><a href="elpi.apps.derive.derive.eq.html">eq</a></li>
<li><a href="elpi.apps.derive.derive.eqK.html">eqK</a></li>
<li><a href="elpi.apps.derive.derive.eqOK.html">eqOK</a></li>
<li><a href="elpi.apps.derive.derive.eqType_ast.html">eqType_ast</a></li>
<li><a href="elpi.apps.derive.derive.eqb.html">eqb</a></li>
<li><a href="elpi.apps.derive.derive.eqbOK.html">eqbOK</a></li>
<li><a href="elpi.apps.derive.derive.eqb_core_defs.html">eqb_core_defs</a></li>
<li><a href="elpi.apps.derive.derive.eqbcorrect.html">eqbcorrect</a></li>
<li><a href="elpi.apps.derive.derive.eqcorrect.html">eqcorrect</a></li>
<li><a href="elpi.apps.derive.derive.experimental.html">experimental</a></li>
<li><a href="elpi.apps.derive.derive.fields.html">fields</a></li>
<li><a href="elpi.apps.derive.derive.idx2inv.html">idx2inv</a></li>
<li><a href="elpi.apps.derive.derive.induction.html">induction</a></li>
<li><a href="elpi.apps.derive.derive.invert.html">invert</a></li>
<li><a href="elpi.apps.derive.derive.isK.html">isK</a></li>
<li><a href="elpi.apps.derive.derive.legacy.html">legacy</a></li>
<li><a href="elpi.apps.derive.derive.lens.html">lens</a></li>
<li><a href="elpi.apps.derive.derive.lens_laws.html">lens_laws</a></li>
<li><a href="elpi.apps.derive.derive.map.html">map</a></li>
<li><a href="elpi.apps.derive.derive.param1.html">param1</a></li>
<li><a href="elpi.apps.derive.derive.param1_congr.html">param1_congr</a></li>
<li><a href="elpi.apps.derive.derive.param1_functor.html">param1_functor</a></li>
<li><a href="elpi.apps.derive.derive.param1_trivial.html">param1_trivial</a></li>
<li><a href="elpi.apps.derive.derive.param2.html">param2</a></li>
<li><a href="elpi.apps.derive.derive.projK.html">projK</a></li>
<li><a href="elpi.apps.derive.derive.std.html">std</a></li>
<li><a href="elpi.apps.derive.derive.tag.html">tag</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.derive.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.derive.derive.html">derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.eltac"><summary>eltac</summary>
          <ul>
          <li><a href="elpi.apps.eltac.apply.html">apply</a></li>
<li><a href="elpi.apps.eltac.assumption.html">assumption</a></li>
<li><a href="elpi.apps.eltac.case.html">case</a></li>
<li><a href="elpi.apps.eltac.clear.html">clear</a></li>
<li><a href="elpi.apps.eltac.constructor.html">constructor</a></li>
<li><a href="elpi.apps.eltac.cycle.html">cycle</a></li>
<li><a href="elpi.apps.eltac.discriminate.html">discriminate</a></li>
<li><a href="elpi.apps.eltac.fail.html">fail</a></li>
<li><a href="elpi.apps.eltac.generalize.html">generalize</a></li>
<li><a href="elpi.apps.eltac.injection.html">injection</a></li>
<li><a href="elpi.apps.eltac.intro.html">intro</a></li>
<li><a href="elpi.apps.eltac.rewrite.html">rewrite</a></li>
<li><a href="elpi.apps.eltac.tactics.html">tactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.locker"><summary>locker</summary>
          <ul>
          <li><details id="elpi.apps.locker.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.locker.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.locker.locker.html">locker</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.rbuild"><summary>rbuild</summary>
          <ul>
          <li><details id="elpi.apps.rbuild.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.rbuild.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.rbuild.rbuild.html">rbuild</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.tc"><summary>tc</summary>
          <ul>
          <li><details id="elpi.apps.tc.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.tc.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.tc.add_commands.html">add_commands</a></li>
<li><a href="elpi.apps.tc.db.html">db</a></li>
<li><a href="elpi.apps.tc.tc.html">tc</a></li>
<li><a href="elpi.apps.tc.wip.html">wip</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi.core"><summary>core</summary>
          <ul>
          <li><a href="elpi.core.Bool.html">Bool</a></li>
<li><a href="elpi.core.ListDef.html">ListDef</a></li>
<li><a href="elpi.core.Morphisms.html">Morphisms</a></li>
<li><a href="elpi.core.PosDef.html">PosDef</a></li>
<li><a href="elpi.core.PrimFloat.html">PrimFloat</a></li>
<li><a href="elpi.core.PrimInt63.html">PrimInt63</a></li>
<li><a href="elpi.core.PrimString.html">PrimString</a></li>
<li><a href="elpi.core.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="elpi.core.RelationClasses.html">RelationClasses</a></li>
<li><a href="elpi.core.Setoid.html">Setoid</a></li>
<li><a href="elpi.core.Uint63Axioms.html">Uint63Axioms</a></li>
<li><a href="elpi.core.ssrbool.html">ssrbool</a></li>
<li><a href="elpi.core.ssreflect.html">ssreflect</a></li>
<li><a href="elpi.core.ssrfun.html">ssrfun</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.elpi.html">elpi</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_elpi"><summary>elpi_elpi</summary>
          <ul>
          <li><a href="elpi_elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_examples"><summary>elpi_examples</summary>
          <ul>
          <li><a href="elpi_examples.example_abs_evars.html">example_abs_evars</a></li>
<li><a href="elpi_examples.example_curry_howard_tactics.html">example_curry_howard_tactics</a></li>
<li><a href="elpi_examples.example_data_base.html">example_data_base</a></li>
<li><a href="elpi_examples.example_fuzzer.html">example_fuzzer</a></li>
<li><a href="elpi_examples.example_generalize.html">example_generalize</a></li>
<li><a href="elpi_examples.example_import_projections.html">example_import_projections</a></li>
<li><a href="elpi_examples.example_record_expansion.html">example_record_expansion</a></li>
<li><a href="elpi_examples.example_record_to_sigma.html">example_record_to_sigma</a></li>
<li><a href="elpi_examples.example_reduction_surgery.html">example_reduction_surgery</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_HOAS.html">tutorial_coq_elpi_HOAS</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_command.html">tutorial_coq_elpi_command</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_tactic.html">tutorial_coq_elpi_tactic</a></li>
<li><a href="elpi_examples.tutorial_elpi_lang.html">tutorial_elpi_lang</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp"><summary>mathcomp</summary>
          <ul>
          <li><details id="mathcomp.algebra"><summary>algebra</summary>
          <ul>
          <li><a href="mathcomp.algebra.all_algebra.html">all_algebra</a></li>
<li><a href="mathcomp.algebra.archimedean.html">archimedean</a></li>
<li><a href="mathcomp.algebra.countalg.html">countalg</a></li>
<li><a href="mathcomp.algebra.finalg.html">finalg</a></li>
<li><a href="mathcomp.algebra.fraction.html">fraction</a></li>
<li><a href="mathcomp.algebra.intdiv.html">intdiv</a></li>
<li><a href="mathcomp.algebra.interval.html">interval</a></li>
<li><a href="mathcomp.algebra.interval_inference.html">interval_inference</a></li>
<li><a href="mathcomp.algebra.matrix.html">matrix</a></li>
<li><a href="mathcomp.algebra.mxalgebra.html">mxalgebra</a></li>
<li><a href="mathcomp.algebra.mxpoly.html">mxpoly</a></li>
<li><a href="mathcomp.algebra.mxred.html">mxred</a></li>
<li><a href="mathcomp.algebra.poly.html">poly</a></li>
<li><a href="mathcomp.algebra.polyXY.html">polyXY</a></li>
<li><a href="mathcomp.algebra.polydiv.html">polydiv</a></li>
<li><a href="mathcomp.algebra.qpoly.html">qpoly</a></li>
<li><a href="mathcomp.algebra.rat.html">rat</a></li>
<li><a href="mathcomp.algebra.ring_quotient.html">ring_quotient</a></li>
<li><a href="mathcomp.algebra.sesquilinear.html">sesquilinear</a></li>
<li><a href="mathcomp.algebra.spectral.html">spectral</a></li>
<li><a href="mathcomp.algebra.ssralg.html">ssralg</a></li>
<li><a href="mathcomp.algebra.ssrint.html">ssrint</a></li>
<li><a href="mathcomp.algebra.ssrnum.html">ssrnum</a></li>
<li><a href="mathcomp.algebra.vector.html">vector</a></li>
<li><a href="mathcomp.algebra.zmodp.html">zmodp</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis"><summary>analysis</summary>
          <ul>
          <li><details id="mathcomp.analysis.homotopy_theory"><summary>homotopy_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.homotopy_theory.continuous_path.html">continuous_path</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.homotopy.html">homotopy</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.wedge_sigT.html">wedge_sigT</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.lebesgue_integral_theory"><summary>lebesgue_integral_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_Rintegral.html">lebesgue_Rintegral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integrable.html">lebesgue_integrable</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral.html">lebesgue_integral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_definition.html">lebesgue_integral_definition</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_differentiation.html">lebesgue_integral_differentiation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_dominated_convergence.html">lebesgue_integral_dominated_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_fubini.html">lebesgue_integral_fubini</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_monotone_convergence.html">lebesgue_integral_monotone_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_nonneg.html">lebesgue_integral_nonneg</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_under.html">lebesgue_integral_under</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.measurable_fun_approximation.html">measurable_fun_approximation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.simple_functions.html">simple_functions</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.measure_theory"><summary>measure_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.measure_theory.counting_measure.html">counting_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.dirac_measure.html">dirac_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_function.html">measurable_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_structure.html">measurable_structure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure.html">measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_extension.html">measure_extension</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_function.html">measure_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_negligible.html">measure_negligible</a></li>
<li><a href="mathcomp.analysis.measure_theory.probability_measure.html">probability_measure</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.normedtype_theory"><summary>normedtype_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.normedtype_theory.complete_normed_module.html">complete_normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.ereal_normedtype.html">ereal_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.matrix_normedtype.html">matrix_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normed_module.html">normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normedtype.html">normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.num_normedtype.html">num_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.pseudometric_normed_Zmodule.html">pseudometric_normed_Zmodule</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.urysohn.html">urysohn</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.vitali_lemma.html">vitali_lemma</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis.showcase.pnt.html">pnt</a></li>
<li><a href="mathcomp.analysis.showcase.summability.html">summability</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.topology_theory"><summary>topology_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.topology_theory.bool_topology.html">bool_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.compact.html">compact</a></li>
<li><a href="mathcomp.analysis.topology_theory.connected.html">connected</a></li>
<li><a href="mathcomp.analysis.topology_theory.discrete_topology.html">discrete_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.matrix_topology.html">matrix_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.nat_topology.html">nat_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.num_topology.html">num_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.one_point_compactification.html">one_point_compactification</a></li>
<li><a href="mathcomp.analysis.topology_theory.order_topology.html">order_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.product_topology.html">product_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.pseudometric_structure.html">pseudometric_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.quotient_topology.html">quotient_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.separation_axioms.html">separation_axioms</a></li>
<li><a href="mathcomp.analysis.topology_theory.sigT_topology.html">sigT_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subspace_topology.html">subspace_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subtype_topology.html">subtype_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.supremum_topology.html">supremum_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology.html">topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology_structure.html">topology_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.uniform_structure.html">uniform_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.weak_topology.html">weak_topology</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis.all_analysis.html">all_analysis</a></li>
<li><a href="mathcomp.analysis.borel_hierarchy.html">borel_hierarchy</a></li>
<li><a href="mathcomp.analysis.cantor.html">cantor</a></li>
<li><a href="mathcomp.analysis.charge.html">charge</a></li>
<li><a href="mathcomp.analysis.convex.html">convex</a></li>
<li><a href="mathcomp.analysis.derive.html">derive</a></li>
<li><a href="mathcomp.analysis.ereal.html">ereal</a></li>
<li><a href="mathcomp.analysis.ess_sup_inf.html">ess_sup_inf</a></li>
<li><a href="mathcomp.analysis.esum.html">esum</a></li>
<li><a href="mathcomp.analysis.exp.html">exp</a></li>
<li><a href="mathcomp.analysis.ftc.html">ftc</a></li>
<li><a href="mathcomp.analysis.function_spaces.html">function_spaces</a></li>
<li><a href="mathcomp.analysis.gauss_integral.html">gauss_integral</a></li>
<li><a href="mathcomp.analysis.hoelder.html">hoelder</a></li>
<li><a href="mathcomp.analysis.kernel.html">kernel</a></li>
<li><a href="mathcomp.analysis.landau.html">landau</a></li>
<li><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></li>
<li><a href="mathcomp.analysis.lebesgue_stieltjes_measure.html">lebesgue_stieltjes_measure</a></li>
<li><a href="mathcomp.analysis.measurable_realfun.html">measurable_realfun</a></li>
<li><a href="mathcomp.analysis.numfun.html">numfun</a></li>
<li><a href="mathcomp.analysis.pi_irrational.html">pi_irrational</a></li>
<li><a href="mathcomp.analysis.probability.html">probability</a></li>
<li><a href="mathcomp.analysis.realfun.html">realfun</a></li>
<li><a href="mathcomp.analysis.sequences.html">sequences</a></li>
<li><a href="mathcomp.analysis.trigo.html">trigo</a></li>
<li><a href="mathcomp.analysis.tvs.html">tvs</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis_stdlib"><summary>analysis_stdlib</summary>
          <ul>
          <li><details id="mathcomp.analysis_stdlib.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis_stdlib.showcase.uniform_bigO.html">uniform_bigO</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis_stdlib.Rstruct_topology.html">Rstruct_topology</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.bigenough"><summary>bigenough</summary>
          <ul>
          <li><a href="mathcomp.bigenough.bigenough.html">bigenough</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.classical"><summary>classical</summary>
          <ul>
          <li><a href="mathcomp.classical.all_classical.html">all_classical</a></li>
<li><a href="mathcomp.classical.boolp.html">boolp</a></li>
<li><a href="mathcomp.classical.cardinality.html">cardinality</a></li>
<li><a href="mathcomp.classical.classical_orders.html">classical_orders</a></li>
<li><a href="mathcomp.classical.classical_sets.html">classical_sets</a></li>
<li><a href="mathcomp.classical.contra.html">contra</a></li>
<li><a href="mathcomp.classical.filter.html">filter</a></li>
<li><a href="mathcomp.classical.fsbigop.html">fsbigop</a></li>
<li><a href="mathcomp.classical.functions.html">functions</a></li>
<li><a href="mathcomp.classical.internal_Eqdep_dec.html">internal_Eqdep_dec</a></li>
<li><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></li>
<li><a href="mathcomp.classical.set_interval.html">set_interval</a></li>
<li><a href="mathcomp.classical.unstable.html">unstable</a></li>
<li><a href="mathcomp.classical.wochoice.html">wochoice</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.experimental_reals"><summary>experimental_reals</summary>
          <ul>
          <li><a href="mathcomp.experimental_reals.discrete.html">discrete</a></li>
<li><a href="mathcomp.experimental_reals.distr.html">distr</a></li>
<li><a href="mathcomp.experimental_reals.realseq.html">realseq</a></li>
<li><a href="mathcomp.experimental_reals.realsum.html">realsum</a></li>
<li><a href="mathcomp.experimental_reals.xfinmap.html">xfinmap</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.field"><summary>field</summary>
          <ul>
          <li><a href="mathcomp.field.algC.html">algC</a></li>
<li><a href="mathcomp.field.algebraics_fundamentals.html">algebraics_fundamentals</a></li>
<li><a href="mathcomp.field.algnum.html">algnum</a></li>
<li><a href="mathcomp.field.all_field.html">all_field</a></li>
<li><a href="mathcomp.field.closed_field.html">closed_field</a></li>
<li><a href="mathcomp.field.cyclotomic.html">cyclotomic</a></li>
<li><a href="mathcomp.field.falgebra.html">falgebra</a></li>
<li><a href="mathcomp.field.fieldext.html">fieldext</a></li>
<li><a href="mathcomp.field.finfield.html">finfield</a></li>
<li><a href="mathcomp.field.galois.html">galois</a></li>
<li><a href="mathcomp.field.qfpoly.html">qfpoly</a></li>
<li><a href="mathcomp.field.separable.html">separable</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.fingroup"><summary>fingroup</summary>
          <ul>
          <li><a href="mathcomp.fingroup.action.html">action</a></li>
<li><a href="mathcomp.fingroup.all_fingroup.html">all_fingroup</a></li>
<li><a href="mathcomp.fingroup.automorphism.html">automorphism</a></li>
<li><a href="mathcomp.fingroup.fingroup.html">fingroup</a></li>
<li><a href="mathcomp.fingroup.gproduct.html">gproduct</a></li>
<li><a href="mathcomp.fingroup.morphism.html">morphism</a></li>
<li><a href="mathcomp.fingroup.perm.html">perm</a></li>
<li><a href="mathcomp.fingroup.presentation.html">presentation</a></li>
<li><a href="mathcomp.fingroup.quotient.html">quotient</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.finmap"><summary>finmap</summary>
          <ul>
          <li><a href="mathcomp.finmap.finmap.html">finmap</a></li>
<li><a href="mathcomp.finmap.multiset.html">multiset</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals"><summary>reals</summary>
          <ul>
          <li><a href="mathcomp.reals.all_reals.html">all_reals</a></li>
<li><a href="mathcomp.reals.constructive_ereal.html">constructive_ereal</a></li>
<li><a href="mathcomp.reals.prodnormedzmodule.html">prodnormedzmodule</a></li>
<li><a href="mathcomp.reals.real_interval.html">real_interval</a></li>
<li><a href="mathcomp.reals.reals.html">reals</a></li>
<li><a href="mathcomp.reals.signed.html">signed</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals_stdlib"><summary>reals_stdlib</summary>
          <ul>
          <li><a href="mathcomp.reals_stdlib.Rstruct.html">Rstruct</a></li>
<li><a href="mathcomp.reals_stdlib.nsatz_realtype.html">nsatz_realtype</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.solvable"><summary>solvable</summary>
          <ul>
          <li><a href="mathcomp.solvable.abelian.html">abelian</a></li>
<li><a href="mathcomp.solvable.all_solvable.html">all_solvable</a></li>
<li><a href="mathcomp.solvable.alt.html">alt</a></li>
<li><a href="mathcomp.solvable.burnside_app.html">burnside_app</a></li>
<li><a href="mathcomp.solvable.center.html">center</a></li>
<li><a href="mathcomp.solvable.commutator.html">commutator</a></li>
<li><a href="mathcomp.solvable.cyclic.html">cyclic</a></li>
<li><a href="mathcomp.solvable.extraspecial.html">extraspecial</a></li>
<li><a href="mathcomp.solvable.extremal.html">extremal</a></li>
<li><a href="mathcomp.solvable.finmodule.html">finmodule</a></li>
<li><a href="mathcomp.solvable.frobenius.html">frobenius</a></li>
<li><a href="mathcomp.solvable.gfunctor.html">gfunctor</a></li>
<li><a href="mathcomp.solvable.gseries.html">gseries</a></li>
<li><a href="mathcomp.solvable.hall.html">hall</a></li>
<li><a href="mathcomp.solvable.jordanholder.html">jordanholder</a></li>
<li><a href="mathcomp.solvable.maximal.html">maximal</a></li>
<li><a href="mathcomp.solvable.nilpotent.html">nilpotent</a></li>
<li><a href="mathcomp.solvable.pgroup.html">pgroup</a></li>
<li><a href="mathcomp.solvable.primitive_action.html">primitive_action</a></li>
<li><a href="mathcomp.solvable.sylow.html">sylow</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.ssreflect"><summary>ssreflect</summary>
          <ul>
          <li><a href="mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></li>
<li><a href="mathcomp.ssreflect.bigop.html">bigop</a></li>
<li><a href="mathcomp.ssreflect.binomial.html">binomial</a></li>
<li><a href="mathcomp.ssreflect.choice.html">choice</a></li>
<li><a href="mathcomp.ssreflect.div.html">div</a></li>
<li><a href="mathcomp.ssreflect.eqtype.html">eqtype</a></li>
<li><a href="mathcomp.ssreflect.finfun.html">finfun</a></li>
<li><a href="mathcomp.ssreflect.fingraph.html">fingraph</a></li>
<li><a href="mathcomp.ssreflect.finset.html">finset</a></li>
<li><a href="mathcomp.ssreflect.fintype.html">fintype</a></li>
<li><a href="mathcomp.ssreflect.generic_quotient.html">generic_quotient</a></li>
<li><a href="mathcomp.ssreflect.order.html">order</a></li>
<li><a href="mathcomp.ssreflect.path.html">path</a></li>
<li><a href="mathcomp.ssreflect.prime.html">prime</a></li>
<li><a href="mathcomp.ssreflect.seq.html">seq</a></li>
<li><a href="mathcomp.ssreflect.ssrAC.html">ssrAC</a></li>
<li><a href="mathcomp.ssreflect.ssrbool.html">ssrbool</a></li>
<li><a href="mathcomp.ssreflect.ssreflect.html">ssreflect</a></li>
<li><a href="mathcomp.ssreflect.ssrfun.html">ssrfun</a></li>
<li><a href="mathcomp.ssreflect.ssrmatching.html">ssrmatching</a></li>
<li><a href="mathcomp.ssreflect.ssrnat.html">ssrnat</a></li>
<li><a href="mathcomp.ssreflect.ssrnotations.html">ssrnotations</a></li>
<li><a href="mathcomp.ssreflect.tuple.html">tuple</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.matrix</h1>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> ssreflect</span><span class="id"> ssrbool</span><span class="id"> ssrfun</span><span class="id"> eqtype</span><span class="id"> ssrnat</span><span class="id"> seq</span><span class="id"> choice</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> fintype</span><span class="id"> finfun</span><span class="id"> finset</span><span class="id"> fingroup</span><span class="id"> perm</span><span class="id"> order</span><span class="id"> div</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> prime</span><span class="id"> binomial</span><span class="id"> ssralg</span><span class="id"> countalg</span><span class="id"> finalg</span><span class="id"> zmodp</span><span class="id"> bigop</span>.<br/>
<br/>
<pre class="ssrdoc">
Basic concrete linear algebra : definition of type for matrices, and all
basic matrix operations including determinant, trace and support for block
decomposition. Matrices are represented by a row-major list of their
coefficients but this implementation is hidden by three levels of wrappers
(Matrix/Finfun/Tuple) so the matrix type should be treated as abstract and
handled using only the operations described below:
  'M[R]_(m, n) == the type of m rows by n columns matrices with
  'M_(m, n)       coefficients in R; the [R] is optional and is usually
                  omitted.
 'M[R]_n, 'M_n == the type of n x n square matrices.
'rV[R]_n, 'rV_n == the type of 1 x n row vectors.
'cV[R]_n, 'cV_n == the type of n x 1 column vectors.
 \matrix_(i &lt; m, j &lt; n) Expr(i, j) ==
                  the m x n matrix with general coefficient Expr(i, j),
                  with i : 'I_m and j : 'I_n. the &lt; m bound can be omitted
                  if it is equal to n, though usually both bounds are
                  omitted as they can be inferred from the context.
 \row_(j &lt; n) Expr(j), \col_(i &lt; m) Expr(i)
                  the row / column vectors with general term Expr; the
                  parentheses can be omitted along with the bound.
\matrix_(i &lt; m) RowExpr(i) ==
                  the m x n matrix with row i given by RowExpr(i) : 'rV_n.
         A i j == the coefficient of matrix A : 'M_(m, n) in column j of
                  row i, where i : 'I_m, and j : 'I_n (via the coercion
                  fun_of_matrix : matrix &gt;-&gt; Funclass).
    const_mx a == the constant matrix whose entries are all a (dimensions
                  should be determined by context).
    map_mx f A == the pointwise image of A by f, i.e., the matrix Af
                  congruent to A with Af i j = f (A i j) for all i and j.
    map2_mx f A B == the pointwise image of A and B by f, i.e., the matrix
                    ABf congruent to A with ABf i j = f (A i j) (B i j)
                    for all i and j.
           A^T == the matrix transpose of A.
       row i A == the i'th row of A (this is a row vector).
       col j A == the j'th column of A (a column vector).
      row' i A == A with the i'th row spliced out.
      col' i A == A with the j'th column spliced out.
  xrow i1 i2 A == A with rows i1 and i2 interchanged.
  xcol j1 j2 A == A with columns j1 and j2 interchanged.
  row_perm s A == A : 'M_(m, n) with rows permuted by s : 'S_m.
  col_perm s A == A : 'M_(m, n) with columns permuted by s : 'S_n.
  row_mx Al Ar == the row block matrix &lt;Al Ar&gt; obtained by concatenating
                  two matrices Al and Ar of the same height.
  col_mx Au Ad == the column block matrix / Au \ (Au and Ad must have the
                  same width).            \ Ad /
block_mx Aul Aur Adl Adr == the block matrix / Aul Aur \
                                             \ Adl Adr /
\mxblock_(i &lt; m, j &lt; n) B i j
               == the block matrix of type 'M_(\sum_i p_ i, \sum_j q_ j)
                            / (B 0 0)  (B 0 j)  (B 0 n) \
                            |   ...       ...       ...   |
                            | (B i 0)  (B i j)  (B i n) |
                            |   ...       ...       ...   |
                            \ (B m 0)  (B m j)  (B m n) /
                  where each block (B i j) has type 'M_(p_ i, q_ j).
\mxdiag_(i &lt; n) B i == the block square matrix of type 'M_(\sum_i p_ i)
                               / (B 0)      0      \
                               |     ...     ...   |
                               |  0    (B i)    0  |
                               |   ...     ...     |
                               \      0      (B n) /
                       where each block (B i) has type 'M_(p_ i).
 \mxrow_(j &lt; n) B j ==  the block matrix of type 'M_(m, \sum_j q_ j).
                                &lt; (B 0) ... (B n) &gt;
                        where each block (B j) has type 'M_(m, q_ j).
 \mxcol_(i &lt; m) B i ==  the block matrix of type 'M_(\sum_i p_ i, n)
                                     / (B 0) \
                                     |  ...  |
                                     \ (B m) /
                        where each block (B i) has type 'M(p_ i, n).
  [l|r]submx A == the left/right submatrices of a row block matrix A.
                  Note that the type of A, 'M_(m, n1 + n2) indicates how A
                  should be decomposed.
  [u|d]submx A == the up/down submatrices of a column block matrix A.
[u|d][l|r]submx A == the upper left, etc submatrices of a block matrix A.
 submxblock A i j == the block submatrix of type 'M_(p_ i, q_ j) of A.
                     The type of A, 'M_(\sum_i p_ i, \sum_i q_ i)
                     indicates how A should be decomposed.
                     There is no analogous for mxdiag since one can use
                     submxblock A i i to extract a diagonal block.
  submxrow A j == the submatrix of type 'M_(m, q_ j) of A. The type of A,
                  'M_(m, \sum_j q_ j) indicates how A should be decomposed.
  submxrow A j == the submatrix of type 'M_(p_ i, n) of A. The type of A,
                  'M_(\sum_i p_ i, n) indicates how A should be decomposed.
   mxsub f g A == generic reordered submatrix, given by functions f and g
                  which specify which subset of rows and columns to take
                  and how to reorder them, e.g. picking f and g to be
                  increasing yields traditional submatrices.
               := \matrix_(i, j) A (f i) (g i)
    rowsub f A := mxsub f id A
    colsub g A := mxsub id g A
castmx eq_mn A == A : 'M_(m, n) cast to 'M_(m', n') using the equation
                  pair eq_mn : (m = m') * (n = n'). This is the usual
                  workaround for the syntactic limitations of dependent
                  types in Coq, and can be used to introduce a block
                  decomposition. It simplifies to A when eq_mn is the
                  pair (erefl m, erefl n) (using rewrite /castmx /=).
conform_mx B A == A if A and B have the same dimensions, else B.
       mxvec A == a row vector of width m * n holding all the entries of
                  the m x n matrix A.
mxvec_index i j == the index of A i j in mxvec A.
      vec_mx v == the inverse of mxvec, reshaping a vector of width m * n
                  back into into an m x n rectangular matrix.
In 'M[R]_(m, n), R can be any type, but 'M[R]_(m, n) inherits the eqType,
choiceType, countType, finType, nmodType, and zmodType structures from R;
'M[R]_(m, n) also forms a natural lmodType R when R is a pzRingType.
Square matrices of type 'M[R]_n (resp. non-trivial square matrices of type
'M[R]_n.+1) inherit the pz(Semi)RingType (resp. nz(Semi)RingType) structure
from R; indeed they then have an algebra structure (lalgType R, or algType
R if R is a comNzRingType, or even unitAlgType if R is a comUnitRingType).
  We thus provide separate syntax for the general matrix multiplication,
and other operations for matrices over a pzRingType R:
        A *m B == the matrix product of A and B; the width of A must be
                  equal to the height of B.
          a%:M == the scalar matrix with a's on the main diagonal; in
                  particular 1%:M denotes the identity matrix, and is
                  equal to 1%R when n is of the form n'.+1 (e.g., n &gt;= 1).
is_scalar_mx A &lt;=&gt; A is a scalar matrix (A = a%:M for some A).
     diag_mx d == the diagonal matrix whose main diagonal is d : 'rV_n.
 is_diag_mx A &lt;=&gt; A is a diagonal matrix:  forall i j, i != j -&gt; A i j = 0
 is_trig_mx A &lt;=&gt; A is a triangular matrix: forall i j, i &lt; j -&gt; A i j = 0
  delta_mx i j == the matrix with a 1 in row i, column j and 0 elsewhere.
      pid_mx r == the partial identity matrix with 1s only on the r first
                  coefficients of the main diagonal; the dimensions of
                  pid_mx r are determined by the context, and pid_mx r can
                  be rectangular.
    copid_mx r == the complement to 1%:M of pid_mx r: a square diagonal
                  matrix with 1s on all but the first r coefficients on
                  its main diagonal.
     perm_mx s == the n x n permutation matrix for s : 'S_n.
tperm_mx i1 i2 == the permutation matrix that exchanges i1 i2 : 'I_n.
  is_perm_mx A == A is a permutation matrix.
    lift0_mx A == the 1 + n square matrix block_mx 1 0 0 A when A : 'M_n.
         \tr A == the trace of a square matrix A.
        \det A == the determinant of A, using the Leibnitz formula.
cofactor i j A == the i, j cofactor of A (the signed i, j minor of A),
        \adj A == the adjugate matrix of A (\adj A i j = cofactor j i A).
  A \in unitmx == A is invertible (R must be a comUnitRingType).
       invmx A == the inverse matrix of A if A \in unitmx A, otherwise A.
A \is a mxOver S == the matrix A has its coefficients in S.
      comm_mx A B := A *m B = B *m A
     comm_mxb A B := A *m B == B *m A
all_comm_mx As fs := all2rel comm_mxb fs
The following operations provide a correspondence between linear functions
and matrices:
    lin1_mx f == the m x n matrix that emulates via right product
                 a (linear) function f : 'rV_m -&gt; 'rV_n on ROW VECTORS
     lin_mx f == the (m1 * n1) x (m2 * n2) matrix that emulates, via the
                 right multiplication on the mxvec encodings, a linear
                 function f : 'M_(m1, n1) -&gt; 'M_(m2, n2)
lin_mul_row u := lin1_mx (mulmx u \o vec_mx) (applies a row-encoded
                 function to the row-vector u).
      mulmx A == partially applied matrix multiplication (mulmx A B is
                 displayed as A *m B), with, for A : 'M_(m, n), a
                 canonical {linear 'M_(n, p) -&gt; 'M(m, p}} structure.
     mulmxr A == self-simplifying right-hand matrix multiplication, i.e.,
                 mulmxr A B simplifies to B *m A, with, for A : 'M_(n, p),
                 a canonical {linear 'M_(m, n) -&gt; 'M(m, p}} structure.
  lin_mulmx A := lin_mx (mulmx A).
 lin_mulmxr A := lin_mx (mulmxr A).
We also extend any finType structure of R to 'M[R]_(m, n), and define:
    {'GL_n[R]} == the finGroupType of units of 'M[R]_n.-1.+1.
     'GL_n[R]  == the general linear group of all matrices in {'GL_n(R)}.
     'GL_n(p)  == 'GL_n['F_p], the general linear group of a prime field.
      GLval u  == the coercion of u : {'GL_n(R)} to a matrix.
  In addition to the lemmas relevant to these definitions, this file also
proves several classic results, including :
- The determinant is a multilinear alternate form.
- The Laplace determinant expansion formulas: expand_det_[row|col].
- The Cramer rule : mul_mx_adj &amp; mul_adj_mx.
Vandermonde m a == the 'M[R]_(m, n) Vandermonde matrix, given a : 'rV_n
                   /         1          ...           1              \
                   |      (a 0 0)       ...      (a 0 (n - 1))       |
                   |    (a 0 0 ^+ 2)    ...    (a 0 (n - 1) ^+ 2)    |
                   |        ...                      ...             |
                   \ (a 0 0 ^+ (m - 1)) ... (a 0 (n - 1) ^+ (m - 1)) /
                := \matrix_(i &lt; m, j &lt; n) a 0 j ^+ i.
Finally, as an example of the use of block products, we program and prove
the correctness of a classical linear algebra algorithm:
  cormen_lup A == the triangular decomposition (L, U, P) of a nontrivial
                  square matrix A into a lower triagular matrix L with 1s
                  on the main diagonal, an upper matrix U, and a
                  permutation matrix P, such that P * A = L * U.
This is example only; we use a different, more precise algorithm to
develop the theory of matrix ranks and row spaces in mxalgebra.v
</pre>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> GroupScope</span>.<br/>
<span class="vernacular">Import</span><span class="id"> GRing</span>.<span class="id">Theory</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' n&quot;</span>     (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;''M_' n&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''rV_' n&quot;</span>    (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;''rV_' n&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''cV_' n&quot;</span>    (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;''cV_' n&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' ( n )&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' ( m , n )&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;''M_' ( m ,  n )&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M[' R ]_ n&quot;</span>    (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''rV[' R ]_ n&quot;</span>   (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''cV[' R ]_ n&quot;</span>   (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M[' R ]_ ( n )&quot;</span>     (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M[' R ]_ ( m , n )&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8</span>). <br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\matrix_ i E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\matrix_ i  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\matrix_ ( i &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\matrix_ ( i , j ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\matrix_ ( i ,  j )  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\matrix[ k ]_ ( i , j ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\matrix[ k ]_ ( i ,  j )  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\matrix_ ( i &lt; m , j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> m,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\matrix_ ( i , j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\row_ j E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\row_ j  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\row_ ( j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\col_ j E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\col_ j  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\col_ ( j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxblock_ ( i , j ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\mxblock_ ( i ,  j )  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxblock_ ( i &lt; m , j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> m,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxblock_ ( i , j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> i,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxrow_ j E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\mxrow_ j  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxrow_ ( j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxcol_ j E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\mxcol_ j  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxcol_ ( j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxdiag_ j E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;\mxdiag_ j  E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxdiag_ ( j &lt; n ) E&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> E</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 36,</span><span class="id"> j,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 50</span>). <br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x %:M&quot;</span>   (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;x %:M&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;A *m B&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 40,</span><span class="id"> left</span><span class="id"> associativity,</span><span class="id"> format</span> <span class="id">&quot;A  *m  B&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^T&quot;</span>    (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;A ^T&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\tr A&quot;</span>   (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> A</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;\tr  A&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\det A&quot;</span>  (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> A</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;\det  A&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\adj A&quot;</span>  (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> A</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;\adj  A&quot;</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> simp</span><span class="id"> :=</span> (<span class="id">Monoid</span>.<span class="id">Theory</span>.<span class="id">simpm,</span><span class="id"> oppr0</span>).<br/>
<br/>
<pre class="ssrdoc">
(****************************Type Definition*********************************
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixDef</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>.<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> matrix</span><span class="id"> :</span><span class="id"> predArgType</span><span class="id"> :=</span><span class="id"> Matrix</span><span class="id"> of</span><span class="id"> {ffun</span><span class="id"> 'I_m</span><span class="id"> *</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mx_val</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> let:</span><span class="id"> Matrix</span><span class="id"> g</span><span class="id"> :=</span><span class="id"> A</span><span class="gallina-kwd"> in</span><span class="id"> g</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> [isNew</span><span class="gallina-kwd"> for</span><span class="id"> mx_val]</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> fun_of_matrix</span><span class="id"> A</span> (<span class="id">i</span><span class="id"> :</span><span class="id"> 'I_m</span>) (<span class="id">j</span><span class="id"> :</span><span class="id"> 'I_n</span>)<span class="id"> :=</span><span class="id"> mx_val</span><span class="id"> A</span> (<span class="id">i,</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Coercion</span><span class="id"> fun_of_matrix</span><span class="id"> :</span><span class="id"> matrix</span><span class="id"> &gt;-&gt;</span><span class="id"> Funclass</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixDef</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> matrix_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><br/>
<span class="vernacular">Definition</span><span class="id"> matrix_of_fun</span><span class="id"> R</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">k</span><span class="id"> :</span><span class="id"> unit</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> 'I_m</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">@Matrix</span><span class="id"> R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> [ffun</span><span class="id"> ij</span><span class="id"> =&gt;</span><span class="id"> F</span><span class="id"> ij</span>.<span class="id">1</span><span class="id"> ij</span>.<span class="id">2]</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> matrix_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> matrix_of_fun</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixDef2</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>.<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> F</span><span class="id"> :</span><span class="id"> 'I_m</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxE</span><span class="id"> k</span><span class="id"> F</span><span class="id"> :</span><span class="id"> matrix_of_fun</span><span class="id"> k</span><span class="id"> F</span><span class="id"> =2</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> /fun_of_matrix</span><span class="id"> /=</span><span class="id"> ffunE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> matrixP</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> matrix</span><span class="id"> R</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> A</span><span class="id"> =2</span><span class="id"> B</span><span class="id"> &lt;-&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /fun_of_matrix;</span><span class="id"> split=&gt;</span><span class="id"> [/=</span><span class="id"> eqAB</span><span class="id"> |</span><span class="id"> -&gt;</span><span class="id"> //]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/val_inj/ffunP=&gt;</span><span class="id"> [[i</span><span class="id"> j]];</span><span class="id"> apply:</span><span class="id"> eqAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mx</span><span class="id"> k</span><span class="id"> F1</span><span class="id"> F2</span><span class="id"> :</span> (<span class="id">F1</span><span class="id"> =2</span><span class="id"> F2</span>)<span class="id"> -&gt;</span><span class="id"> matrix_of_fun</span><span class="id"> k</span><span class="id"> F1</span><span class="id"> =</span><span class="id"> matrix_of_fun</span><span class="id"> k</span><span class="id"> F2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eq_F;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eq_F</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixDef2</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_mx</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> k}</span><span class="id"> [F1]</span><span class="id"> F2</span><span class="id"> eq_F12</span>.<br/>
<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> matrix</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''M[' R ]_ ( m , n )&quot;</span><span class="id"> :=</span> (<span class="id">matrix</span><span class="id"> R</span><span class="id"> m</span><span class="id"> n</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id">:</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''rV[' R ]_ n&quot;</span><span class="id"> :=</span><span class="id"> 'M[R]_</span>(<span class="id">1,</span><span class="id"> n</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''cV[' R ]_ n&quot;</span><span class="id"> :=</span><span class="id"> 'M[R]_</span>(<span class="id">n,</span><span class="id"> 1</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''M[' R ]_ n&quot;</span><span class="id"> :=</span><span class="id"> 'M[R]_</span>(<span class="id">n,</span><span class="id"> n</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''M[' R ]_ ( n )&quot;</span><span class="id"> :=</span><span class="id"> 'M[R]_n</span> (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''M_' ( m , n )&quot;</span><span class="id"> :=</span><span class="id"> 'M[_]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''rV_' n&quot;</span><span class="id"> :=</span><span class="id"> 'M_</span>(<span class="id">1,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''cV_' n&quot;</span><span class="id"> :=</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> 1</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''M_' n&quot;</span><span class="id"> :=</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''M_' ( n )&quot;</span><span class="id"> :=</span><span class="id"> 'M_n</span> (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\matrix[ k ]_ ( i , j ) E&quot;</span><span class="id"> :=</span> (<span class="id">matrix_of_fun</span><span class="id"> k</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> E</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\matrix_ ( i &lt; m , j &lt; n ) E&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">@matrix_of_fun</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> matrix_key</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> E</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\matrix_ ( i , j &lt; n ) E&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\matrix_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> E</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\matrix_ ( i , j ) E&quot;</span><span class="id"> :=</span> (<span class="id">\matrix_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> _,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\matrix_ ( i &lt; m ) E&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\matrix_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> m,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> @fun_of_matrix</span><span class="id"> _</span><span class="id"> 1</span><span class="id"> _</span><span class="id"> E</span><span class="id"> 0</span><span class="id"> j</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\matrix_ i E&quot;</span><span class="id"> :=</span> (<span class="id">\matrix_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\col_ ( i &lt; n ) E&quot;</span><span class="id"> :=</span> (<span class="id">@matrix_of_fun</span><span class="id"> _</span><span class="id"> n</span><span class="id"> 1</span><span class="id"> matrix_key</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> E</span>))<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\col_ i E&quot;</span><span class="id"> :=</span> (<span class="id">\col_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\row_ ( j &lt; n ) E&quot;</span><span class="id"> :=</span> (<span class="id">@matrix_of_fun</span><span class="id"> _</span><span class="id"> 1</span><span class="id"> n</span><span class="id"> matrix_key</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> E</span>))<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\row_ j E&quot;</span><span class="id"> :=</span> (<span class="id">\row_</span>(<span class="id">j</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> eqType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> [Equality</span><span class="id"> of</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> choiceType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> [Choice</span><span class="id"> of</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> countType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> [Countable</span><span class="id"> of</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> [Finite</span><span class="id"> of</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> card_mx</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">#|{:</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id">}|</span><span class="id"> =</span><span class="id"> #|F|</span><span class="id"> ^</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>))<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> card_sub</span><span class="id"> card_ffun</span><span class="id"> card_prod</span><span class="id"> !card_ord</span>. Qed.</div></details>
<br/>
<pre class="ssrdoc">
(****** Matrix structural operations (transpose, permutation, blocks) *******
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixStructural</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> const_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> const_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> \matrix[const_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> a</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> const_mx</span><span class="id"> {m</span><span class="id"> n}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> castmx</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">eq_mn</span><span class="id"> :</span> (<span class="id">m</span><span class="id"> =</span><span class="id"> m'</span>)<span class="id"> *</span> (<span class="id">n</span><span class="id"> =</span><span class="id"> n'</span>))<span class="id"> A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span><span class="id"> erefl</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> =</span><span class="id"> m'</span><span class="id"> :=</span><span class="id"> eq_mn</span>.<span class="id">1</span><span class="gallina-kwd"> return</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">let:</span><span class="id"> erefl</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> =</span><span class="id"> n'</span><span class="id"> :=</span><span class="id"> eq_mn</span>.<span class="id">2</span><span class="gallina-kwd"> return</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n'</span>)<span class="gallina-kwd"> in</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> conform_mx</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> B</span><span class="id"> A</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> m</span><span class="id"> =P</span><span class="id"> m',</span><span class="id"> n</span><span class="id"> =P</span><span class="id"> n'</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ReflectT</span><span class="id"> eq_m,</span><span class="id"> ReflectT</span><span class="id"> eq_n</span><span class="id"> =&gt;</span><span class="id"> castmx</span> (<span class="id">eq_m,</span><span class="id"> eq_n</span>)<span class="id"> A</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _,</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> B</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> trmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> trmx</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix[trmx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span><span class="id"> j</span><span class="id"> i</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> row_perm_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> row_perm</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_m</span>)<span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix[row_perm_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span> (<span class="id">s</span><span class="id"> i</span>)<span class="id"> j</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> col_perm_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> col_perm</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix[col_perm_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span><span class="id"> i</span> (<span class="id">s</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :=</span><span class="id"> row_perm</span> (<span class="id">tperm</span><span class="id"> i1</span><span class="id"> i2</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> :=</span><span class="id"> col_perm</span> (<span class="id">tperm</span><span class="id"> j1</span><span class="id"> j2</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> row</span><span class="id"> i0</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \row_j</span><span class="id"> A</span><span class="id"> i0</span><span class="id"> j</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> col</span><span class="id"> j0</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \col_i</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j0</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> row'</span><span class="id"> i0</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span> (<span class="id">lift</span><span class="id"> i0</span><span class="id"> i</span>)<span class="id"> j</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> col'</span><span class="id"> j0</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span><span class="id"> i</span> (<span class="id">lift</span><span class="id"> j0</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> m',</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> n'</span>)<span class="id"> A</span> (<span class="id">f</span><span class="id"> i</span>) (<span class="id">g</span><span class="id"> j</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> colsub</span><span class="id"> g</span><span class="id"> :=</span> (<span class="id">mxsub</span><span class="id"> id</span><span class="id"> g</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> id</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmx_const</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">eq_mn</span><span class="id"> :</span> (<span class="id">m</span><span class="id"> =</span><span class="id"> m'</span>)<span class="id"> *</span> (<span class="id">n</span><span class="id"> =</span><span class="id"> n'</span>))<span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span><span class="id"> eq_mn</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> eq_mn;</span><span class="id"> case:</span><span class="id"> m'</span><span class="id"> /;</span><span class="id"> case:</span><span class="id"> n'</span><span class="id"> /</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_const</span><span class="id"> a</span><span class="id"> :</span><span class="id"> trmx</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_perm_const</span><span class="id"> s</span><span class="id"> a</span><span class="id"> :</span><span class="id"> row_perm</span><span class="id"> s</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_perm_const</span><span class="id"> s</span><span class="id"> a</span><span class="id"> :</span><span class="id"> col_perm</span><span class="id"> s</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> xrow_const</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> a</span><span class="id"> :</span><span class="id"> xrow</span><span class="id"> i1</span><span class="id"> i2</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_perm_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> xcol_const</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> a</span><span class="id"> :</span><span class="id"> xcol</span><span class="id"> j1</span><span class="id"> j2</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> col_perm_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowP</span> (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV[R]_n</span>)<span class="id"> :</span><span class="id"> u</span><span class="id"> 0</span><span class="id"> =1</span><span class="id"> v</span><span class="id"> 0</span><span class="id"> &lt;-&gt;</span><span class="id"> u</span><span class="id"> =</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [eq_uv</span><span class="id"> |</span><span class="id"> -&gt;</span><span class="id"> //];</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> ord1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowK</span><span class="id"> u_</span><span class="id"> i0</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i0</span> (<span class="id">\matrix_i</span><span class="id"> u_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> u_</span><span class="id"> i0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_matrixP</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> =</span><span class="id"> row</span><span class="id"> i</span><span class="id"> B</span>)<span class="id"> &lt;-&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [eqAB</span><span class="id"> |</span><span class="id"> -&gt;</span><span class="id"> //];</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/rowP/</span>(_<span class="id"> j</span>)<span class="id">:</span> (<span class="id">eqAB</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> colP</span> (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'cV[R]_m</span>)<span class="id"> :</span><span class="id"> u^~</span><span class="id"> 0</span><span class="id"> =1</span><span class="id"> v^~</span><span class="id"> 0</span><span class="id"> &lt;-&gt;</span><span class="id"> u</span><span class="id"> =</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [eq_uv</span><span class="id"> |</span><span class="id"> -&gt;</span><span class="id"> //];</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> ord1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_const</span><span class="id"> i0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i0</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_const</span><span class="id"> j0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> col</span><span class="id"> j0</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row'_const</span><span class="id"> i0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> row'</span><span class="id"> i0</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col'_const</span><span class="id"> j0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> col'</span><span class="id"> j0</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_perm1</span><span class="id"> A</span><span class="id"> :</span><span class="id"> col_perm</span><span class="id"> 1</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> perm1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_perm1</span><span class="id"> A</span><span class="id"> :</span><span class="id"> row_perm</span><span class="id"> 1</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> perm1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_permM</span><span class="id"> s</span><span class="id"> t</span><span class="id"> A</span><span class="id"> :</span><span class="id"> col_perm</span> (<span class="id">s</span><span class="id"> *</span><span class="id"> t</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> col_perm</span><span class="id"> s</span> (<span class="id">col_perm</span><span class="id"> t</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> permM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_permM</span><span class="id"> s</span><span class="id"> t</span><span class="id"> A</span><span class="id"> :</span><span class="id"> row_perm</span> (<span class="id">s</span><span class="id"> *</span><span class="id"> t</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> row_perm</span><span class="id"> s</span> (<span class="id">row_perm</span><span class="id"> t</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> permM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_row_permC</span><span class="id"> s</span><span class="id"> t</span><span class="id"> A</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col_perm</span><span class="id"> s</span> (<span class="id">row_perm</span><span class="id"> t</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row_perm</span><span class="id"> t</span> (<span class="id">col_perm</span><span class="id"> s</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowEsub</span><span class="id"> i</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">fun=&gt;</span><span class="id"> i</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> colEsub</span><span class="id"> j</span><span class="id"> :</span><span class="id"> col</span><span class="id"> j</span><span class="id"> =</span><span class="id"> colsub</span> (<span class="id">fun=&gt;</span><span class="id"> j</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row'Esub</span><span class="id"> i</span><span class="id"> :</span><span class="id"> row'</span><span class="id"> i</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">lift</span><span class="id"> i</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> col'Esub</span><span class="id"> j</span><span class="id"> :</span><span class="id"> col'</span><span class="id"> j</span><span class="id"> =</span><span class="id"> colsub</span> (<span class="id">lift</span><span class="id"> j</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_permEsub</span><span class="id"> s</span><span class="id"> :</span><span class="id"> row_perm</span><span class="id"> s</span><span class="id"> =</span><span class="id"> rowsub</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_perm</span><span class="id"> /mxsub</span><span class="id"> !unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_permEsub</span><span class="id"> s</span><span class="id"> :</span><span class="id"> col_perm</span><span class="id"> s</span><span class="id"> =</span><span class="id"> colsub</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /col_perm</span><span class="id"> /mxsub</span><span class="id"> !unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> xrowEsub</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span><span class="id"> xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">tperm</span><span class="id"> i1</span><span class="id"> i2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_permEsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> xcolEsub</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> :</span><span class="id"> xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> =</span><span class="id"> colsub</span> (<span class="id">tperm</span><span class="id"> j1</span><span class="id"> j2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> col_permEsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_id</span><span class="id"> :</span><span class="id"> mxsub</span><span class="id"> id</span><span class="id"> id</span><span class="id"> =1</span><span class="id"> id</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> f'</span><span class="id"> g</span><span class="id"> g'</span><span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> f'</span><span class="id"> -&gt;</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> g'</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">@mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> mxsub</span><span class="id"> f'</span><span class="id"> g'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eq_f</span><span class="id"> eq_g</span><span class="id"> A;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eq_f</span><span class="id"> eq_g</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_rowsub</span><span class="id"> m'</span> (<span class="id">f</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> 'I_m'</span><span class="id"> -&gt;</span><span class="id"> 'I_m</span>)<span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> f'</span><span class="id"> -&gt;</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> rowsub</span><span class="id"> f'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_mxsub;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_colsub</span><span class="id"> n'</span> (<span class="id">g</span><span class="id"> g'</span><span class="id"> :</span><span class="id"> 'I_n'</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span>)<span class="id"> :</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> g'</span><span class="id"> -&gt;</span><span class="id"> colsub</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> colsub</span><span class="id"> g'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_mxsub;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_eq_id</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> id</span><span class="id"> -&gt;</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> id</span><span class="id"> -&gt;</span><span class="id"> mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> id</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fid</span><span class="id"> gid</span><span class="id"> A;</span><span class="id"> rewrite</span> (<span class="id">eq_mxsub</span><span class="id"> fid</span><span class="id"> gid</span>)<span class="id"> mxsub_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_eq_colsub</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> id</span><span class="id"> -&gt;</span><span class="id"> @mxsub</span><span class="id"> _</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> colsub</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f_id;</span><span class="id"> apply:</span><span class="id"> eq_mxsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_eq_rowsub</span><span class="id"> m'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> id</span><span class="id"> -&gt;</span><span class="id"> @mxsub</span><span class="id"> m'</span><span class="id"> _</span><span class="id"> f</span><span class="id"> g</span><span class="id"> =1</span><span class="id"> rowsub</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eq_mxsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_ffunl</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> @mxsub</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">finfun</span><span class="id"> f</span>)<span class="id"> g</span><span class="id"> =1</span><span class="id"> mxsub</span><span class="id"> f</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eq_mxsub</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> ffunE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_ffunr</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> @mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span> (<span class="id">finfun</span><span class="id"> g</span>)<span class="id"> =1</span><span class="id"> mxsub</span><span class="id"> f</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eq_mxsub</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> ffunE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_ffun</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> @mxsub</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">finfun</span><span class="id"> f</span>) (<span class="id">finfun</span><span class="id"> g</span>)<span class="id"> =1</span><span class="id"> mxsub</span><span class="id"> f</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> mxsub_ffunl</span><span class="id"> mxsub_ffunr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_const</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> a</span><span class="id"> :</span><span class="id"> @mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> colsub</span><span class="id"> g</span><span class="id"> :=</span> (<span class="id">mxsub</span><span class="id"> id</span><span class="id"> g</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> id</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^T&quot;</span><span class="id"> :=</span> (<span class="id">trmx</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmx_id</span><span class="id"> m</span><span class="id"> n</span><span class="id"> erefl_mn</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> castmx</span><span class="id"> erefl_mn</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> erefl_mn</span><span class="id"> =&gt;</span><span class="id"> e_m</span><span class="id"> e_n;</span><span class="id"> rewrite</span><span class="id"> [e_m]eq_axiomK</span><span class="id"> [e_n]eq_axiomK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmx_comp</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span><span class="id"> m3</span><span class="id"> n3</span> (<span class="id">eq_m1</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> m2</span>) (<span class="id">eq_n1</span><span class="id"> :</span><span class="id"> n1</span><span class="id"> =</span><span class="id"> n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">eq_m2</span><span class="id"> :</span><span class="id"> m2</span><span class="id"> =</span><span class="id"> m3</span>) (<span class="id">eq_n2</span><span class="id"> :</span><span class="id"> n2</span><span class="id"> =</span><span class="id"> n3</span>)<span class="id"> A</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span> (<span class="id">eq_m2,</span><span class="id"> eq_n2</span>) (<span class="id">castmx</span> (<span class="id">eq_m1,</span><span class="id"> eq_n1</span>)<span class="id"> A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> castmx</span> (<span class="id">etrans</span><span class="id"> eq_m1</span><span class="id"> eq_m2,</span><span class="id"> etrans</span><span class="id"> eq_n1</span><span class="id"> eq_n2</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> m2</span><span class="id"> /</span><span class="id"> eq_m1</span><span class="id"> eq_m2;</span><span class="id"> case:</span><span class="id"> m3</span><span class="id"> /;</span><span class="id"> case:</span><span class="id"> n2</span><span class="id"> /</span><span class="id"> eq_n1</span><span class="id"> eq_n2;</span><span class="id"> case:</span><span class="id"> n3</span><span class="id"> /</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmxK</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span> (<span class="id">eq_m</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> m2</span>) (<span class="id">eq_n</span><span class="id"> :</span><span class="id"> n1</span><span class="id"> =</span><span class="id"> n2</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cancel</span> (<span class="id">castmx</span> (<span class="id">eq_m,</span><span class="id"> eq_n</span>)) (<span class="id">castmx</span> (<span class="id">esym</span><span class="id"> eq_m,</span><span class="id"> esym</span><span class="id"> eq_n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> m2</span><span class="id"> /</span><span class="id"> eq_m;</span><span class="id"> case:</span><span class="id"> n2</span><span class="id"> /</span><span class="id"> eq_n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmxKV</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span> (<span class="id">eq_m</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> m2</span>) (<span class="id">eq_n</span><span class="id"> :</span><span class="id"> n1</span><span class="id"> =</span><span class="id"> n2</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cancel</span> (<span class="id">castmx</span> (<span class="id">esym</span><span class="id"> eq_m,</span><span class="id"> esym</span><span class="id"> eq_n</span>)) (<span class="id">castmx</span> (<span class="id">eq_m,</span><span class="id"> eq_n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> m2</span><span class="id"> /</span><span class="id"> eq_m;</span><span class="id"> case:</span><span class="id"> n2</span><span class="id"> /</span><span class="id"> eq_n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmx_sym</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span> (<span class="id">eq_m</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> m2</span>) (<span class="id">eq_n</span><span class="id"> :</span><span class="id"> n1</span><span class="id"> =</span><span class="id"> n2</span>)<span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A1</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">eq_m,</span><span class="id"> eq_n</span>)<span class="id"> A2</span><span class="id"> -&gt;</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">esym</span><span class="id"> eq_m,</span><span class="id"> esym</span><span class="id"> eq_n</span>)<span class="id"> A1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/</span>(<span class="id">canLR</span> (<span class="id">castmxK</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_castmx</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span> (<span class="id">eq_mn</span><span class="id"> eq_mn'</span><span class="id"> :</span> (<span class="id">m1</span><span class="id"> =</span><span class="id"> m2</span>)<span class="id"> *</span> (<span class="id">n1</span><span class="id"> =</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span><span class="id"> eq_mn</span><span class="id"> =1</span><span class="id"> castmx</span><span class="id"> eq_mn'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> eq_mn</span><span class="id"> eq_mn'</span><span class="id"> =&gt;</span><span class="id"> [em</span><span class="id"> en]</span><span class="id"> [em'</span><span class="id"> en']</span><span class="id"> A</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">canRL</span> (<span class="id">castmxKV</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> castmx_comp</span><span class="id"> castmx_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmxE</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span> (<span class="id">eq_mn</span><span class="id"> :</span> (<span class="id">m1</span><span class="id"> =</span><span class="id"> m2</span>)<span class="id"> *</span> (<span class="id">n1</span><span class="id"> =</span><span class="id"> n2</span>))<span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span><span class="id"> eq_mn</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span> (<span class="id">cast_ord</span> (<span class="id">esym</span><span class="id"> eq_mn</span>.<span class="id">1</span>)<span class="id"> i</span>) (<span class="id">cast_ord</span> (<span class="id">esym</span><span class="id"> eq_mn</span>.<span class="id">2</span>)<span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> [case:</span><span class="id"> eq_mn;</span><span class="id"> case:</span><span class="id"> m2</span><span class="id"> /;</span><span class="id"> case:</span><span class="id"> n2</span><span class="id"> /]</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conform_mx_id</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">B</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> conform_mx</span><span class="id"> B</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /conform_mx;</span><span class="id"> do</span><span class="id"> 2!case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> castmx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nonconform_mx</span><span class="id"> m</span><span class="id"> m'</span><span class="id"> n</span><span class="id"> n'</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>)) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">m</span><span class="id"> !=</span><span class="id"> m'</span>)<span class="id"> ||</span> (<span class="id">n</span><span class="id"> !=</span><span class="id"> n'</span>)<span class="id"> -&gt;</span><span class="id"> conform_mx</span><span class="id"> B</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /conform_mx;</span><span class="id"> do</span><span class="id"> 2!case:</span><span class="id"> eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conform_castmx</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span><span class="id"> m3</span><span class="id"> n3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e_mn</span><span class="id"> :</span> (<span class="id">m2</span><span class="id"> =</span><span class="id"> m3</span>)<span class="id"> *</span> (<span class="id">n2</span><span class="id"> =</span><span class="id"> n3</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> A</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">conform_mx</span><span class="id"> B</span> (<span class="id">castmx</span><span class="id"> e_mn</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> conform_mx</span><span class="id"> B</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> do</span><span class="id"> [case:</span><span class="id"> e_mn;</span><span class="id"> case:</span><span class="id"> m3</span><span class="id"> /;</span><span class="id"> case:</span><span class="id"> n3</span><span class="id"> /]</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmxK</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> cancel</span> (<span class="id">@trmx</span><span class="id"> m</span><span class="id"> n</span>) (<span class="id">@trmx</span><span class="id"> n</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_inj</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> injective</span> (<span class="id">@trmx</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> can_inj</span> (<span class="id">@trmxK</span><span class="id"> m</span><span class="id"> n</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_cast</span><span class="id"> m1</span><span class="id"> n1</span><span class="id"> m2</span><span class="id"> n2</span> (<span class="id">eq_mn</span><span class="id"> :</span> (<span class="id">m1</span><span class="id"> =</span><span class="id"> m2</span>)<span class="id"> *</span> (<span class="id">n1</span><span class="id"> =</span><span class="id"> n2</span>))<span class="id"> A</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">castmx</span><span class="id"> eq_mn</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">eq_mn</span>.<span class="id">2,</span><span class="id"> eq_mn</span>.<span class="id">1</span>)<span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eq_mn</span><span class="id"> =&gt;</span><span class="id"> eq_m</span><span class="id"> eq_n;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> castmxE</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_conform</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>)) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">conform_mx</span><span class="id"> B</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> conform_mx</span><span class="id"> B^T</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /conform_mx;</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> eqP;</span><span class="id"> rewrite</span><span class="id"> ?mxE//</span><span class="id"> =&gt;</span><span class="id"> en</span><span class="id"> em</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> trmx_cast</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_row_perm</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">row_perm</span><span class="id"> s</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> col_perm</span><span class="id"> s</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_col_perm</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">col_perm</span><span class="id"> s</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> row_perm</span><span class="id"> s</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_xrow</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> xcol</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> tr_row_perm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_xcol</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j1</span><span class="id"> j2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> xrow</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> tr_col_perm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_id</span><span class="id"> n</span><span class="id"> i</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> 'rV_n</span>)<span class="id"> :</span><span class="id"> row</span><span class="id"> i</span><span class="id"> V</span><span class="id"> =</span><span class="id"> V</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> [i]ord1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_id</span><span class="id"> n</span><span class="id"> j</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> 'cV_n</span>)<span class="id"> :</span><span class="id"> col</span><span class="id"> j</span><span class="id"> V</span><span class="id"> =</span><span class="id"> V</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> [j]ord1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_eq</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i1</span><span class="id"> A1</span><span class="id"> =</span><span class="id"> row</span><span class="id"> i2</span><span class="id"> A2</span><span class="id"> -&gt;</span><span class="id"> A1</span><span class="id"> i1</span><span class="id"> =1</span><span class="id"> A2</span><span class="id"> i2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/rowP=&gt;</span><span class="id"> eqA12</span><span class="id"> j;</span><span class="id"> have</span><span class="id"> /[!mxE]</span><span class="id"> :=</span><span class="id"> eqA12</span><span class="id"> j</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_eq</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> j1</span><span class="id"> j2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> j1</span><span class="id"> A1</span><span class="id"> =</span><span class="id"> col</span><span class="id"> j2</span><span class="id"> A2</span><span class="id"> -&gt;</span><span class="id"> A1^~</span><span class="id"> j1</span><span class="id"> =1</span><span class="id"> A2^~</span><span class="id"> j2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/colP=&gt;</span><span class="id"> eqA12</span><span class="id"> i;</span><span class="id"> have</span><span class="id"> /[!mxE]</span><span class="id"> :=</span><span class="id"> eqA12</span><span class="id"> i</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row'_eq</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i0</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row'</span><span class="id"> i0</span><span class="id"> A</span><span class="id"> =</span><span class="id"> row'</span><span class="id"> i0</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> predC1</span><span class="id"> i0,</span><span class="id"> A</span><span class="id"> =2</span><span class="id"> B}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /matrixP</span><span class="id"> eqAB'</span><span class="id"> i</span><span class="id"> /[!inE]/[1!eq_sym]/unlift_some[i'</span><span class="id"> -&gt;</span><span class="id"> _]</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> /[!mxE]</span><span class="id"> :=</span><span class="id"> eqAB'</span><span class="id"> i'</span><span class="id"> j</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col'_eq</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j0</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col'</span><span class="id"> j0</span><span class="id"> A</span><span class="id"> =</span><span class="id"> col'</span><span class="id"> j0</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> {in</span><span class="id"> predC1</span><span class="id"> j0,</span><span class="id"> A</span><span class="id"> i</span><span class="id"> =1</span><span class="id"> B</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /matrixP</span><span class="id"> eqAB'</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!inE]/[1!eq_sym]/unlift_some[j'</span><span class="id"> -&gt;</span><span class="id"> _]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span> <span class="id"> /[!mxE]</span><span class="id"> :=</span><span class="id"> eqAB'</span><span class="id"> i</span><span class="id"> j'</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_row</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i0</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">row</span><span class="id"> i0</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> col</span><span class="id"> i0</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_row'</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i0</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">row'</span><span class="id"> i0</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> col'</span><span class="id"> i0</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_col</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j0</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">col</span><span class="id"> j0</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> row</span><span class="id"> j0</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_col'</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j0</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">col'</span><span class="id"> j0</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> row'</span><span class="id"> j0</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_comp</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span><br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_m2</span><span class="id"> -&gt;</span><span class="id"> 'I_m1</span>) (<span class="id">f'</span><span class="id"> :</span><span class="id"> 'I_m3</span><span class="id"> -&gt;</span><span class="id"> 'I_m2</span>)<br/>
&nbsp;&nbsp;(<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n2</span><span class="id"> -&gt;</span><span class="id"> 'I_n1</span>) (<span class="id">g'</span><span class="id"> :</span><span class="id"> 'I_n3</span><span class="id"> -&gt;</span><span class="id"> 'I_n2</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsub</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> f'</span>) (<span class="id">g</span><span class="id"> \o</span><span class="id"> g'</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> mxsub</span><span class="id"> f'</span><span class="id"> g'</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowsub_comp</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_m2</span><span class="id"> -&gt;</span><span class="id"> 'I_m1</span>) (<span class="id">f'</span><span class="id"> :</span><span class="id"> 'I_m3</span><span class="id"> -&gt;</span><span class="id"> 'I_m2</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rowsub</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> f'</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> rowsub</span><span class="id"> f'</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> colsub_comp</span><span class="id"> m</span><span class="id"> n</span><span class="id"> n2</span><span class="id"> n3</span><br/>
&nbsp;&nbsp;(<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n2</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span>) (<span class="id">g'</span><span class="id"> :</span><span class="id"> 'I_n3</span><span class="id"> -&gt;</span><span class="id"> 'I_n2</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">colsub</span> (<span class="id">g</span><span class="id"> \o</span><span class="id"> g'</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> colsub</span><span class="id"> g'</span> (<span class="id">colsub</span><span class="id"> g</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsubrc</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> n2</span><span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span><span class="id"> =</span><span class="id"> rowsub</span><span class="id"> f</span> (<span class="id">colsub</span><span class="id"> g</span><span class="id"> A</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsubcr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> n2</span><span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span><span class="id"> =</span><span class="id"> colsub</span><span class="id"> g</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowsub_cast</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">eq_m</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> m2</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rowsub</span> (<span class="id">cast_ord</span><span class="id"> eq_m</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">esym</span><span class="id"> eq_m,</span><span class="id"> erefl</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> eq_m</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> apply:</span> (<span class="id">mxsub_eq_id</span> (<span class="id">cast_ord_id</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> colsub_cast</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">eq_n</span><span class="id"> :</span><span class="id"> n1</span><span class="id"> =</span><span class="id"> n2</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">colsub</span> (<span class="id">cast_ord</span><span class="id"> eq_n</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">erefl,</span><span class="id"> esym</span><span class="id"> eq_n</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> eq_n</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> apply:</span> (<span class="id">mxsub_eq_id</span><span class="id"> _</span> (<span class="id">cast_ord_id</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_cast</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">eq_m</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> m2</span>) (<span class="id">eq_n</span><span class="id"> :</span><span class="id"> n1</span><span class="id"> =</span><span class="id"> n2</span>)<span class="id"> A</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsub</span> (<span class="id">cast_ord</span><span class="id"> eq_m</span>) (<span class="id">cast_ord</span><span class="id"> eq_n</span>)<span class="id"> A</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">esym</span><span class="id"> eq_m,</span><span class="id"> esym</span><span class="id"> eq_n</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxsubrc</span><span class="id"> rowsub_cast</span><span class="id"> colsub_cast</span><span class="id"> castmx_comp/=</span><span class="id"> etrans_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> castmxEsub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">eq_mn</span><span class="id"> :</span> (<span class="id">m1</span><span class="id"> =</span><span class="id"> m2</span>)<span class="id"> *</span> (<span class="id">n1</span><span class="id"> =</span><span class="id"> n2</span>))<span class="id"> A</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span><span class="id"> eq_mn</span><span class="id"> A</span><span class="id"> =</span><span class="id"> mxsub</span> (<span class="id">cast_ord</span> (<span class="id">esym</span><span class="id"> eq_mn</span>.<span class="id">1</span>)) (<span class="id">cast_ord</span> (<span class="id">esym</span><span class="id"> eq_mn</span>.<span class="id">2</span>))<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxsub_cast</span><span class="id"> !esymK;</span><span class="id"> case:</span><span class="id"> eq_mn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_mxsub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> mxsub</span><span class="id"> g</span><span class="id"> f</span><span class="id"> A^T</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> m2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxsub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_m2</span><span class="id"> -&gt;</span><span class="id"> 'I_m1</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n2</span><span class="id"> -&gt;</span><span class="id"> 'I_n1</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row</span> (<span class="id">f</span><span class="id"> i</span>) (<span class="id">colsub</span><span class="id"> g</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !rowEsub</span><span class="id"> -!mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxsub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_m2</span><span class="id"> -&gt;</span><span class="id"> 'I_m1</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n2</span><span class="id"> -&gt;</span><span class="id"> 'I_n1</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;<span class="id">col</span><span class="id"> i</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> col</span> (<span class="id">g</span><span class="id"> i</span>) (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !colEsub</span><span class="id"> -!mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_rowsub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_m2</span><span class="id"> -&gt;</span><span class="id"> 'I_m1</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row</span> (<span class="id">f</span><span class="id"> i</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> row_mxsub</span><span class="id"> mxsub_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_colsub</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n2</span><span class="id"> -&gt;</span><span class="id"> 'I_n1</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> i</span> (<span class="id">colsub</span><span class="id"> g</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> col</span> (<span class="id">g</span><span class="id"> i</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mxsub</span><span class="id"> mxsub_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Ltac</span><span class="id"> split_mxE</span><span class="id"> :=</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> ![rewrite</span><span class="id"> mxE</span><span class="id"> |</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CutPaste</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> row_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> row_mx</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[row_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> split</span><span class="id"> j</span><span class="gallina-kwd"> with</span><span class="id"> inl</span><span class="id"> j1</span><span class="id"> =&gt;</span><span class="id"> A1</span><span class="id"> i</span><span class="id"> j1</span><span class="id"> |</span><span class="id"> inr</span><span class="id"> j2</span><span class="id"> =&gt;</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j2</span><span class="gallina-kwd"> end</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> col_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> col_mx</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[col_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> split</span><span class="id"> i</span><span class="gallina-kwd"> with</span><span class="id"> inl</span><span class="id"> i1</span><span class="id"> =&gt;</span><span class="id"> A1</span><span class="id"> i1</span><span class="id"> j</span><span class="id"> |</span><span class="id"> inr</span><span class="id"> i2</span><span class="id"> =&gt;</span><span class="id"> A2</span><span class="id"> i2</span><span class="id"> j</span><span class="gallina-kwd"> end</span>.<br/>
<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> lsubmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> lsubmx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[lsubmx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span><span class="id"> i</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> rsubmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> rsubmx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[rsubmx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span><span class="id"> i</span> (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> usubmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> usubmx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[usubmx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i</span>)<span class="id"> j</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> dsubmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> dsubmx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[dsubmx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i</span>)<span class="id"> j</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxEl</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> i</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> A1</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxE</span> (<span class="id">unsplitK</span> (<span class="id">inl</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxKl</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> lsubmx</span> (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> A1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> row_mxEl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxEr</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> i</span> (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxE</span> (<span class="id">unsplitK</span> (<span class="id">inr</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxKr</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> rsubmx</span> (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> A2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> row_mxEr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> hsubmxK</span><span class="id"> A</span><span class="id"> :</span><span class="id"> row_mx</span> (<span class="id">lsubmx</span><span class="id"> A</span>) (<span class="id">rsubmx</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!mxE];</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> /[!mxE]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxEu</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> col_mx</span><span class="id"> A1</span><span class="id"> A2</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> A1</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxE</span> (<span class="id">unsplitK</span> (<span class="id">inl</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxKu</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> usubmx</span> (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> A1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> col_mxEu</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxEd</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> col_mx</span><span class="id"> A1</span><span class="id"> A2</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxE</span> (<span class="id">unsplitK</span> (<span class="id">inr</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxKd</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> dsubmx</span> (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> A2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> col_mxEd</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lsubmxEsub</span><span class="id"> :</span><span class="id"> lsubmx</span><span class="id"> =</span><span class="id"> colsub</span> (<span class="id">lshift</span><span class="id"> _</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /lsubmx</span><span class="id"> /mxsub</span><span class="id"> !unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rsubmxEsub</span><span class="id"> :</span><span class="id"> rsubmx</span><span class="id"> =</span><span class="id"> colsub</span> (<span class="id">@rshift</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /rsubmx</span><span class="id"> /mxsub</span><span class="id"> !unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> usubmxEsub</span><span class="id"> :</span><span class="id"> usubmx</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">lshift</span><span class="id"> _</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /usubmx</span><span class="id"> /mxsub</span><span class="id"> !unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsubmxEsub</span> <span class="id"> :</span><span class="id"> dsubmx</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">@rshift</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dsubmx</span><span class="id"> /mxsub</span><span class="id"> !unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> B1</span><span class="id"> B2</span><span class="id"> :</span><span class="id"> row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> row_mx</span><span class="id"> B1</span><span class="id"> B2</span><span class="id"> -&gt;</span><span class="id"> A1</span><span class="id"> =</span><span class="id"> B1</span><span class="id"> /\</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> B2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqAB;</span><span class="id"> move:</span> (<span class="id">congr1</span><span class="id"> lsubmx</span><span class="id"> eqAB</span>) (<span class="id">congr1</span><span class="id"> rsubmx</span><span class="id"> eqAB</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">row_mxKl,</span><span class="id"> row_mxKr</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_col_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> B1</span><span class="id"> B2</span><span class="id"> :</span><span class="id"> col_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> col_mx</span><span class="id"> B1</span><span class="id"> B2</span><span class="id"> -&gt;</span><span class="id"> A1</span><span class="id"> =</span><span class="id"> B1</span><span class="id"> /\</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> B2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqAB;</span><span class="id"> move:</span> (<span class="id">congr1</span><span class="id"> usubmx</span><span class="id"> eqAB</span>) (<span class="id">congr1</span><span class="id"> dsubmx</span><span class="id"> eqAB</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">col_mxKu,</span><span class="id"> col_mxKd</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mx_const</span><span class="id"> a</span><span class="id"> :</span><span class="id"> row_mx</span> (<span class="id">const_mx</span><span class="id"> a</span>) (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mx_const</span><span class="id"> a</span><span class="id"> :</span><span class="id"> col_mx</span> (<span class="id">const_mx</span><span class="id"> a</span>) (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_usubmx</span><span class="id"> A</span><span class="id"> i</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i</span> (<span class="id">usubmx</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> congr</span> (<span class="id">A</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/val_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_dsubmx</span><span class="id"> A</span><span class="id"> i</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i</span> (<span class="id">dsubmx</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> congr</span> (<span class="id">A</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/val_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_lsubmx</span><span class="id"> A</span><span class="id"> i</span><span class="id"> :</span><span class="id"> col</span><span class="id"> i</span> (<span class="id">lsubmx</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> col</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> i</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> congr</span> (<span class="id">A</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/val_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_rsubmx</span><span class="id"> A</span><span class="id"> i</span><span class="id"> :</span><span class="id"> col</span><span class="id"> i</span> (<span class="id">rsubmx</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> col</span> (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> i</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> congr</span> (<span class="id">A</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/val_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CutPaste</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_thin_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,0</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,n</span>))<span class="id"> :</span><span class="id"> row_mx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE;</span><span class="id"> case:</span><span class="id"> splitP=&gt;</span><span class="id"> [|k</span><span class="id"> H];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span><span class="id"> fun_of_matrix;</span><span class="id"> exact:</span><span class="id"> val_inj</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_flat_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">0,n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,n</span>))<span class="id"> :</span><span class="id"> col_mx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE;</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> [|k</span><span class="id"> H];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span><span class="id"> fun_of_matrix;</span><span class="id"> exact:</span><span class="id"> val_inj</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_lsub</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span> (<span class="id">lsubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> usubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_rsub</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span> (<span class="id">rsubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> dsubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_row_mx</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> col_mx</span><span class="id"> A1^T</span><span class="id"> A2^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> row_mx</span><span class="id"> A1^T</span><span class="id"> A2^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_usub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">usubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> lsubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_dsub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">dsubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> rsubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> vsubmxK</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> col_mx</span> (<span class="id">usubmx</span><span class="id"> A</span>) (<span class="id">dsubmx</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> tr_col_mx</span><span class="id"> trmx_usub</span><span class="id"> trmx_dsub</span><span class="id"> hsubmxK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cast_row_mx</span><span class="id"> m</span><span class="id"> m'</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">eq_m</span><span class="id"> :</span><span class="id"> m</span><span class="id"> =</span><span class="id"> m'</span>)<span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span> (<span class="id">eq_m,</span><span class="id"> erefl</span><span class="id"> _</span>) (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> row_mx</span> (<span class="id">castmx</span> (<span class="id">eq_m,</span><span class="id"> erefl</span><span class="id"> n1</span>)<span class="id"> A1</span>) (<span class="id">castmx</span> (<span class="id">eq_m,</span><span class="id"> erefl</span><span class="id"> n2</span>)<span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> m'</span><span class="id"> /</span><span class="id"> eq_m</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cast_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> n'</span> (<span class="id">eq_n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> =</span><span class="id"> n'</span>)<span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span> (<span class="id">erefl</span><span class="id"> _,</span><span class="id"> eq_n</span>) (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> col_mx</span> (<span class="id">castmx</span> (<span class="id">erefl</span><span class="id"> m1,</span><span class="id"> eq_n</span>)<span class="id"> A1</span>) (<span class="id">castmx</span> (<span class="id">erefl</span><span class="id"> m2,</span><span class="id"> eq_n</span>)<span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n'</span><span class="id"> /</span><span class="id"> eq_n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxA</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>)) (<span class="id">A3</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n3</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> cast</span><span class="id"> :=</span> (<span class="id">erefl</span><span class="id"> m,</span><span class="id"> esym</span> (<span class="id">addnA</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span>))<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">row_mx</span><span class="id"> A1</span> (<span class="id">row_mx</span><span class="id"> A2</span><span class="id"> A3</span>)<span class="id"> =</span><span class="id"> castmx</span><span class="id"> cast</span> (<span class="id">row_mx</span> (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> A3</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">canRL</span> (<span class="id">castmxKV</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="id">rewrite</span><span class="id"> castmxE</span><span class="id"> !mxE</span><span class="id"> cast_ord_id;</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> j1</span><span class="id"> /=</span><span class="id"> def_j</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span> (<span class="id">j</span><span class="id"> &lt;</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>)<span class="id"> &amp;&amp;</span> (<span class="id">j</span><span class="id"> &lt;</span><span class="id"> n1</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> def_j</span><span class="id"> lshift_subproof</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> def_j;</span><span class="id"> do</span><span class="id"> 2![case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> ?</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?mxE]</span><span class="id"> =&gt;</span><span class="id"> /ord_inj-&gt;</span>.<br/>
<span class="id">case:</span><span class="id"> splitP</span><span class="id"> def_j</span><span class="id"> =&gt;</span><span class="id"> j2</span><span class="id"> -&gt;{j}</span><span class="id"> def_j</span><span class="id"> /[!mxE]</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span><span class="id"> ~~</span> (<span class="id">j2</span><span class="id"> &lt;</span><span class="id"> n1</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -leqNgt</span><span class="id"> def_j</span><span class="id"> leq_addr</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span><span class="id"> j1</span><span class="id"> &lt;</span><span class="id"> n2</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">ltn_add2l</span><span class="id"> n1</span>)<span class="id"> -def_j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> def_j;</span><span class="id"> do</span><span class="id"> 2![case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> ?</span><span class="id"> -&gt;]</span><span class="id"> =&gt;</span><span class="id"> /addnI/val_inj-&gt;</span>.<br/>
<span class="id">have:</span><span class="id"> ~~</span> (<span class="id">j1</span><span class="id"> &lt;</span><span class="id"> n2</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -leqNgt</span><span class="id"> -</span>(<span class="id">leq_add2l</span><span class="id"> n1</span>)<span class="id"> -def_j</span><span class="id"> leq_addr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> def_j</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> ?</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> addnA</span><span class="id"> =&gt;</span><span class="id"> /addnI/val_inj-&gt;</span>.<br/>
Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> row_mxAx</span><span class="id"> :=</span><span class="id"> row_mxA</span>. <br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">A3</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> cast</span><span class="id"> :=</span> (<span class="id">esym</span> (<span class="id">addnA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span>)<span class="id">,</span><span class="id"> erefl</span><span class="id"> n</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">col_mx</span><span class="id"> A1</span> (<span class="id">col_mx</span><span class="id"> A2</span><span class="id"> A3</span>)<span class="id"> =</span><span class="id"> castmx</span><span class="id"> cast</span> (<span class="id">col_mx</span> (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> A3</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_cast</span><span class="id"> !tr_col_mx</span><span class="id"> -row_mxA</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> col_mxAx</span><span class="id"> :=</span><span class="id"> col_mxA</span>. <br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_row_mx</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> i0</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i0</span> (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">row</span><span class="id"> i0</span><span class="id"> A1</span>) (<span class="id">row</span><span class="id"> i0</span><span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!mxE];</span><span class="id"> case:</span> (<span class="id">split</span><span class="id"> j</span>)<span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> /[1!mxE]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> j0</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> j0</span> (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">col</span><span class="id"> j0</span><span class="id"> A1</span>) (<span class="id">col</span><span class="id"> j0</span><span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">tr_col,</span><span class="id"> tr_col_mx,</span><span class="id"> row_row_mx</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row'_row_mx</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> i0</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row'</span><span class="id"> i0</span> (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">row'</span><span class="id"> i0</span><span class="id"> A1</span>) (<span class="id">row'</span><span class="id"> i0</span><span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!mxE];</span><span class="id"> case:</span> (<span class="id">split</span><span class="id"> j</span>)<span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> /[1!mxE]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col'_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> j0</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col'</span><span class="id"> j0</span> (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">col'</span><span class="id"> j0</span><span class="id"> A1</span>) (<span class="id">col'</span><span class="id"> j0</span><span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">tr_col',</span><span class="id"> tr_col_mx,</span><span class="id"> row'_row_mx</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> colKl</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> j1</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j1</span>) (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> col</span><span class="id"> j1</span><span class="id"> A1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">row_mxEl,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> colKr</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> j2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span> (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j2</span>) (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> col</span><span class="id"> j2</span><span class="id"> A2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">row_mxEr,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowKu</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i1</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i1</span>) (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> row</span><span class="id"> i1</span><span class="id"> A1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">col_mxEu,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowKd</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i2</span>) (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> row</span><span class="id"> i2</span><span class="id"> A2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">col_mxEd,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col'Kl</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> j1</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>.<span class="id">+1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col'</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j1</span>) (<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">col'</span><span class="id"> j1</span><span class="id"> A1</span>)<span class="id"> A2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> /=</span><span class="id"> j;</span><span class="id"> symmetry;</span><span class="id"> rewrite</span><span class="id"> 2!mxE;</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> -</span>(<span class="id">row_mxEl</span><span class="id"> _</span><span class="id"> A2</span>)<span class="id">;</span><span class="id"> congr</span> (<span class="id">row_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> ord_inj</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">row_mxEr</span><span class="id"> A1</span>)<span class="id">;</span><span class="id"> congr</span> (<span class="id">row_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> ord_inj</span><span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /bump</span><span class="id"> -ltnS</span><span class="id"> -addSn</span><span class="id"> ltn_addr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row'Ku</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i1</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1</span>.<span class="id">+1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row'</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i1</span>) (<span class="id">@col_mx</span><span class="id"> m1</span>.<span class="id">+1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A1</span><span class="id"> A2</span>)<span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">row'</span><span class="id"> i1</span><span class="id"> A1</span>)<span class="id"> A2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> tr_col_mx</span><span class="id"> !</span>(<span class="id">@tr_row'</span><span class="id"> _</span>.<span class="id">+1</span>) (<span class="id">@tr_col_mx</span><span class="id"> _</span>.<span class="id">+1</span>)<span class="id"> col'Kl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx'_cast</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> +</span><span class="id"> n</span>.<span class="id">-1</span>)<span class="id">%N</span><span class="id"> =</span> (<span class="id">m</span><span class="id"> +</span><span class="id"> n</span>).<span class="id">-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> j</span><span class="id"> /ltn_predK</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> addnS</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col'Kr</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> j2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col'</span> (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j2</span>) (<span class="id">@row_mx</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> A1</span><span class="id"> A2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> castmx</span> (<span class="id">erefl</span><span class="id"> m,</span><span class="id"> mx'_cast</span><span class="id"> n1</span><span class="id"> j2</span>) (<span class="id">row_mx</span><span class="id"> A1</span> (<span class="id">col'</span><span class="id"> j2</span><span class="id"> A2</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> symmetry;</span><span class="id"> rewrite</span><span class="id"> castmxE</span><span class="id"> mxE</span><span class="id"> cast_ord_id</span>.<br/>
<span class="id">case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> /=</span><span class="id"> def_j</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mxE</span><span class="id"> -</span>(<span class="id">row_mxEl</span><span class="id"> _</span><span class="id"> A2</span>)<span class="id">;</span><span class="id"> congr</span> (<span class="id">row_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> ord_inj</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> def_j</span><span class="id"> /bump</span><span class="id"> leqNgt</span><span class="id"> ltn_addr</span>.<br/>
<span class="id">rewrite</span><span class="id"> 2!mxE</span><span class="id"> -</span>(<span class="id">row_mxEr</span><span class="id"> A1</span>)<span class="id">;</span><span class="id"> congr</span> (<span class="id">row_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> ord_inj</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> def_j</span><span class="id"> /bump</span><span class="id"> leq_add2l</span><span class="id"> addnCA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row'Kd</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row'</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i2</span>) (<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> castmx</span> (<span class="id">mx'_cast</span><span class="id"> m1</span><span class="id"> i2,</span><span class="id"> erefl</span><span class="id"> n</span>) (<span class="id">col_mx</span><span class="id"> A1</span> (<span class="id">row'</span><span class="id"> i2</span><span class="id"> A2</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_cast</span><span class="id"> !</span>(<span class="id">tr_row',</span><span class="id"> tr_col_mx</span>)<span class="id"> col'Kr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Block</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">col_mx</span> (<span class="id">row_mx</span><span class="id"> Aul</span><span class="id"> Aur</span>) (<span class="id">row_mx</span><span class="id"> Adl</span><span class="id"> Adr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> Bul</span><span class="id"> Bur</span><span class="id"> Bdl</span><span class="id"> Bdr</span><span class="id"> :</span><br/>
&nbsp;<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> =</span><span class="id"> block_mx</span><span class="id"> Bul</span><span class="id"> Bur</span><span class="id"> Bdl</span><span class="id"> Bdr</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">[/\</span><span class="id"> Aul</span><span class="id"> =</span><span class="id"> Bul,</span><span class="id"> Aur</span><span class="id"> =</span><span class="id"> Bur,</span><span class="id"> Adl</span><span class="id"> =</span><span class="id"> Bdl</span><span class="id"> &amp;</span><span class="id"> Adr</span><span class="id"> =</span><span class="id"> Bdr]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/eq_col_mx;</span><span class="id"> do</span><span class="id"> 2!case/eq_row_mx=&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mx_const</span><span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span> (<span class="id">const_mx</span><span class="id"> a</span>) (<span class="id">const_mx</span><span class="id"> a</span>) (<span class="id">const_mx</span><span class="id"> a</span>) (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> CutBlock</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> A</span><span class="id"> :</span><span class="id"> matrix</span><span class="id"> R</span> (<span class="id">m1</span><span class="id"> +</span><span class="id"> m2</span>) (<span class="id">n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ulsubmx</span><span class="id"> :=</span><span class="id"> lsubmx</span> (<span class="id">usubmx</span><span class="id"> A</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> ursubmx</span><span class="id"> :=</span><span class="id"> rsubmx</span> (<span class="id">usubmx</span><span class="id"> A</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> dlsubmx</span><span class="id"> :=</span><span class="id"> lsubmx</span> (<span class="id">dsubmx</span><span class="id"> A</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> drsubmx</span><span class="id"> :=</span><span class="id"> rsubmx</span> (<span class="id">dsubmx</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxK</span><span class="id"> :</span><span class="id"> block_mx</span><span class="id"> ulsubmx</span><span class="id"> ursubmx</span><span class="id"> dlsubmx</span><span class="id"> drsubmx</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /block_mx</span><span class="id"> !hsubmxK</span><span class="id"> vsubmxK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ulsubmxEsub</span><span class="id"> :</span><span class="id"> ulsubmx</span><span class="id"> =</span><span class="id"> mxsub</span> (<span class="id">lshift</span><span class="id"> _</span>) (<span class="id">lshift</span><span class="id"> _</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ulsubmx</span><span class="id"> lsubmxEsub</span><span class="id"> usubmxEsub</span><span class="id"> -mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dlsubmxEsub</span><span class="id"> :</span><span class="id"> dlsubmx</span><span class="id"> =</span><span class="id"> mxsub</span> (<span class="id">@rshift</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">lshift</span><span class="id"> _</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dlsubmx</span><span class="id"> lsubmxEsub</span><span class="id"> dsubmxEsub</span><span class="id"> -mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ursubmxEsub</span><span class="id"> :</span><span class="id"> ursubmx</span><span class="id"> =</span><span class="id"> mxsub</span> (<span class="id">lshift</span><span class="id"> _</span>) (<span class="id">@rshift</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ursubmx</span><span class="id"> rsubmxEsub</span><span class="id"> usubmxEsub</span><span class="id"> -mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> drsubmxEsub</span><span class="id"> :</span><span class="id"> drsubmx</span><span class="id"> =</span><span class="id"> mxsub</span> (<span class="id">@rshift</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">@rshift</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /drsubmx</span><span class="id"> rsubmxEsub</span><span class="id"> dsubmxEsub</span><span class="id"> -mxsub_comp</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CutBlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CatBlock</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m2,</span><span class="id"> n2</span>)).<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxEul</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> A</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i</span>) (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> Aul</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mxEu</span><span class="id"> row_mxEl</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> block_mxKul</span><span class="id"> :</span><span class="id"> ulsubmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> Aul</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ulsubmx</span><span class="id"> col_mxKu</span><span class="id"> row_mxKl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxEur</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> A</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i</span>) (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> Aur</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mxEu</span><span class="id"> row_mxEr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> block_mxKur</span><span class="id"> :</span><span class="id"> ursubmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> Aur</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ursubmx</span><span class="id"> col_mxKu</span><span class="id"> row_mxKr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxEdl</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> A</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i</span>) (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> Adl</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mxEd</span><span class="id"> row_mxEl</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> block_mxKdl</span><span class="id"> :</span><span class="id"> dlsubmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> Adl</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /dlsubmx</span><span class="id"> col_mxKd</span><span class="id"> row_mxKl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxEdr</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> A</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i</span>) (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> Adr</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mxEd</span><span class="id"> row_mxEr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> block_mxKdr</span><span class="id"> :</span><span class="id"> drsubmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> Adr</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /drsubmx</span><span class="id"> col_mxKd</span><span class="id"> row_mxKr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxEv</span><span class="id"> :</span><span class="id"> A</span><span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">row_mx</span><span class="id"> Aul</span><span class="id"> Aur</span>) (<span class="id">row_mx</span><span class="id"> Adl</span><span class="id"> Adr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CatBlock</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Block</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> TrCutBlock</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_ulsub</span><span class="id"> :</span> (<span class="id">ulsubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> ulsubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_ursub</span><span class="id"> :</span> (<span class="id">ursubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> dlsubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_dlsub</span><span class="id"> :</span> (<span class="id">dlsubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> ursubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_drsub</span><span class="id"> :</span> (<span class="id">drsubmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> drsubmx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> TrCutBlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> TrBlock</span>.<br/>
<span class="vernacular">Variables</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m2,</span><span class="id"> n2</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_block_mx</span><span class="id"> :</span><br/>
&nbsp;(<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> block_mx</span><span class="id"> Aul^T</span><span class="id"> Adl^T</span><span class="id"> Aur^T</span><span class="id"> Adr^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[_^T]submxK</span><span class="id"> -trmx_ulsub</span><span class="id"> -trmx_ursub</span><span class="id"> -trmx_dlsub</span><span class="id"> -trmx_drsub</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> block_mxKul</span><span class="id"> block_mxKur</span><span class="id"> block_mxKdl</span><span class="id"> block_mxKdr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxEh</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">col_mx</span><span class="id"> Aul</span><span class="id"> Adl</span>) (<span class="id">col_mx</span><span class="id"> Aur</span><span class="id"> Adr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> tr_block_mx</span><span class="id"> tr_row_mx</span><span class="id"> 2!tr_col_mx</span>. Qed.</div></details>
<span class="vernacular">End</span><span class="id"> TrBlock</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mxA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">A11</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">A12</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n2</span>)) (<span class="id">A13</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n3</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">A21</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">A22</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>)) (<span class="id">A23</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n3</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">A31</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n1</span>)) (<span class="id">A32</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n2</span>)) (<span class="id">A33</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n3</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> cast</span><span class="id"> :=</span> (<span class="id">esym</span> (<span class="id">addnA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span>)<span class="id">,</span><span class="id"> esym</span> (<span class="id">addnA</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span>))<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> row1</span><span class="id"> :=</span><span class="id"> row_mx</span><span class="id"> A12</span><span class="id"> A13</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> col1</span><span class="id"> :=</span><span class="id"> col_mx</span><span class="id"> A21</span><span class="id"> A31</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> row3</span><span class="id"> :=</span><span class="id"> row_mx</span><span class="id"> A31</span><span class="id"> A32</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> col3</span><span class="id"> :=</span><span class="id"> col_mx</span><span class="id"> A13</span><span class="id"> A23</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span><span class="id"> A11</span><span class="id"> row1</span><span class="id"> col1</span> (<span class="id">block_mx</span><span class="id"> A22</span><span class="id"> A23</span><span class="id"> A32</span><span class="id"> A33</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> castmx</span><span class="id"> cast</span> (<span class="id">block_mx</span> (<span class="id">block_mx</span><span class="id"> A11</span><span class="id"> A12</span><span class="id"> A21</span><span class="id"> A22</span>)<span class="id"> col3</span><span class="id"> row3</span><span class="id"> A33</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> block_mxEh</span><span class="id"> !col_mxA</span><span class="id"> -cast_row_mx</span><span class="id"> -block_mxEv</span><span class="id"> -block_mxEh</span>.<br/>
<span class="id">rewrite</span><span class="id"> block_mxEv</span><span class="id"> block_mxEh</span><span class="id"> !row_mxA</span><span class="id"> -cast_col_mx</span><span class="id"> -block_mxEh</span><span class="id"> -block_mxEv</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> castmx_comp</span><span class="id"> etrans_id</span>.<br/>
Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> block_mxAx</span><span class="id"> :=</span><span class="id"> block_mxA</span>. <br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Induction</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_ind</span><span class="id"> m</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> n,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> A</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">row_mx</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0</span><span class="id"> PS;</span><span class="id"> elim=&gt;</span><span class="id"> [//|n</span><span class="id"> IHn]</span><span class="id"> A</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[n</span>.<span class="id">+1]/</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[A]hsubmxK;</span><span class="id"> apply:</span><span class="id"> PS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_ind</span><span class="id"> n</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> A</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> r</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span> (<span class="id">col_mx</span><span class="id"> r</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0</span><span class="id"> PS;</span><span class="id"> elim=&gt;</span><span class="id"> [//|m</span><span class="id"> IHm]</span><span class="id"> A</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[m</span>.<span class="id">+1]/</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[A]vsubmxK;</span><span class="id"> apply:</span><span class="id"> PS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> 0</span><span class="id"> A</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> n</span><span class="id"> A</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0l</span><span class="id"> P0r</span><span class="id"> PS;</span><span class="id"> elim=&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> [|n]</span><span class="id"> A;</span><span class="id"> do</span><span class="id"> ?by</span><span class="id"> [apply:</span><span class="id"> P0l|apply:</span><span class="id"> P0r]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[A]</span>(<span class="id">@submxK</span><span class="id"> 1</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> PS</span>.<br/>
Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> matrix_rect</span><span class="id"> :=</span><span class="id"> mx_ind</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> matrix_rec</span><span class="id"> :=</span><span class="id"> mx_ind</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> matrix_ind</span><span class="id"> :=</span><span class="id"> mx_ind</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqmx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> n,</span><span class="id"> 'M[R]_n</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> A</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> P0</span><span class="id"> PS;</span><span class="id"> elim=&gt;</span><span class="id"> [//|n</span><span class="id"> IHn]</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> -[A]</span>(<span class="id">@submxK</span><span class="id"> 1</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> PS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ringmx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> n,</span><span class="id"> 'M[R]_n</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> x</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> 'rV_n</span>.<span class="id">+1</span>) (<span class="id">c</span><span class="id"> :</span><span class="id"> 'cV_n</span>.<span class="id">+1</span>)<span class="id"> A,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> P0</span><span class="id"> PS;</span><span class="id"> elim=&gt;</span><span class="id"> [//|n</span><span class="id"> IHn]</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> -[A]</span>(<span class="id">@submxK</span><span class="id"> 1</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> PS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_ind</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">weight</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="id"> nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sub</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n',</span> (<span class="id">'I_m'</span><span class="id"> -&gt;</span><span class="id"> 'I_m</span>)<span class="id"> -&gt;</span> (<span class="id">'I_n'</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g,</span><span class="id"> weight</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span>)<span class="id"> &lt;</span><span class="id"> weight</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span><span class="id"> A</span>))<span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Psub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A;</span><span class="id"> have</span><span class="id"> [k]</span><span class="id"> :=</span><span class="id"> ubnP</span> (<span class="id">weight</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>).<br/>
<span class="id">elim:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> [//|k</span><span class="id"> IHk]</span><span class="gallina-kwd"> in</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> *</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltnS</span><span class="id"> =&gt;</span><span class="id"> lt_A_k;</span><span class="id"> apply:</span><span class="id"> Psub</span><span class="id"> =&gt;</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> lt_A'_A</span><span class="id"> ?</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> IHk;</span><span class="id"> apply:</span><span class="id"> leq_trans</span><span class="id"> lt_A_k</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Induction</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> VecMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvec_cast</span><span class="id"> :</span><span class="id"> #|{:'I_m</span><span class="id"> *</span><span class="id"> 'I_n}|</span><span class="id"> =</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> card_prod</span><span class="id"> !card_ord</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxvec_index</span> (<span class="id">i</span><span class="id"> :</span><span class="id"> 'I_m</span>) (<span class="id">j</span><span class="id"> :</span><span class="id"> 'I_n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">cast_ord</span><span class="id"> mxvec_cast</span> (<span class="id">enum_rank</span> (<span class="id">i,</span><span class="id"> j</span>)).<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> is_mxvec_index</span><span class="id"> :</span><span class="id"> 'I_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isMxvecIndex</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> is_mxvec_index</span> (<span class="id">mxvec_index</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvec_indexP</span><span class="id"> k</span><span class="id"> :</span><span class="id"> is_mxvec_index</span><span class="id"> k</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[k]</span>(<span class="id">cast_ordK</span> (<span class="id">esym</span><span class="id"> mxvec_cast</span>))<span class="id"> esymK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> k]enum_valK;</span><span class="id"> case:</span> (<span class="id">enum_val</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Coercion</span><span class="id"> pair_of_mxvec_index</span><span class="id"> k</span> (<span class="id">i_k</span><span class="id"> :</span><span class="id"> is_mxvec_index</span><span class="id"> k</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span><span class="id"> isMxvecIndex</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> i_k</span><span class="gallina-kwd"> in</span> (<span class="id">i,</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxvec</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span> (<span class="id">erefl</span><span class="id"> _,</span><span class="id"> mxvec_cast</span>) (<span class="id">\row_k</span><span class="id"> A</span> (<span class="id">enum_val</span><span class="id"> k</span>).<span class="id">1</span> (<span class="id">enum_val</span><span class="id"> k</span>).<span class="id">2</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> vec_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> vec_mx</span> (<span class="id">u</span><span class="id"> :</span><span class="id"> 'rV[R]_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[vec_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> u</span><span class="id"> 0</span> (<span class="id">mxvec_index</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvecE</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> mxvec</span><span class="id"> A</span><span class="id"> 0</span> (<span class="id">mxvec_index</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> castmxE</span><span class="id"> mxE</span><span class="id"> cast_ordK</span><span class="id"> enum_rankK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvecK</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> mxvec</span><span class="id"> vec_mx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> mxvecE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> vec_mxK</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> vec_mx</span><span class="id"> mxvec</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> u;</span><span class="id"> apply/rowP=&gt;</span><span class="id"> k;</span><span class="id"> case/mxvec_indexP:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxvecE</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> curry_mxvec_bij</span><span class="id"> :</span><span class="id"> {on</span><span class="id"> 'I_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id">,</span><span class="id"> bijective</span> (<span class="id">uncurry</span><span class="id"> mxvec_index</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">exists</span> (<span class="id">enum_val</span><span class="id"> \o</span><span class="id"> cast_ord</span> (<span class="id">esym</span><span class="id"> mxvec_cast</span>))<span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]</span><span class="id"> _</span><span class="id"> |</span><span class="id"> k</span><span class="id"> _]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cast_ordK</span><span class="id"> enum_rankK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/mxvec_indexP:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> cast_ordK</span><span class="id"> enum_rankK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> VecMatrix</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixStructural</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> const_mx</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> row_mxA</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> A3}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> col_mxA</span><span class="id"> {R</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> A3}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> block_mxA</span><br/>
&nbsp;&nbsp;<span class="id">{R</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> n3</span><span class="id"> A11</span><span class="id"> A12</span><span class="id"> A13</span><span class="id"> A21</span><span class="id"> A22</span><span class="id"> A23</span><span class="id"> A31</span><span class="id"> A32</span><span class="id"> A33}</span>.<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> castmx</span><span class="id"> trmx</span><span class="id"> trmxK</span><span class="id"> lsubmx</span><span class="id"> rsubmx</span><span class="id"> usubmx</span><span class="id"> dsubmx</span><span class="id"> row_mx</span><span class="id"> col_mx</span>.<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> block_mx</span><span class="id"> ulsubmx</span><span class="id"> ursubmx</span><span class="id"> dlsubmx</span><span class="id"> drsubmx</span>.<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> mxvec</span><span class="id"> vec_mx</span><span class="id"> mxvec_indexP</span><span class="id"> mxvecK</span><span class="id"> vec_mxK</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> trmx_inj</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> [A1</span><span class="id"> A2]</span><span class="id"> eqA12t</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A ^T&quot;</span><span class="id"> :=</span> (<span class="id">trmx</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> colsub</span><span class="id"> g</span><span class="id"> :=</span> (<span class="id">mxsub</span><span class="id"> id</span><span class="id"> g</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">mxsub</span><span class="id"> f</span><span class="id"> id</span>).<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_mxsub</span><span class="id"> [R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f]</span><span class="id"> f'</span><span class="id"> [g]</span><span class="id"> g'</span><span class="id"> _</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_rowsub</span><span class="id"> [R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> f]</span><span class="id"> f'</span><span class="id"> _</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_colsub</span><span class="id"> [R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> n'</span><span class="id"> g]</span><span class="id"> g'</span><span class="id"> _</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MapMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aT</span><span class="id"> rT</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> rT</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> map_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> map_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><span class="id"> \matrix[map_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> f</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> OneMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_trmx</span><span class="id"> :</span><span class="id"> A^f^T</span><span class="id"> =</span><span class="id"> A^T^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_const_mx</span><span class="id"> a</span><span class="id"> :</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> const_mx</span> (<span class="id">f</span><span class="id"> a</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_row</span><span class="id"> i</span><span class="id"> :</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_col</span><span class="id"> j</span><span class="id"> :</span> (<span class="id">col</span><span class="id"> j</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> col</span><span class="id"> j</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_row'</span><span class="id"> i0</span><span class="id"> :</span> (<span class="id">row'</span><span class="id"> i0</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> row'</span><span class="id"> i0</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_col'</span><span class="id"> j0</span><span class="id"> :</span> (<span class="id">col'</span><span class="id"> j0</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> col'</span><span class="id"> j0</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> g</span><span class="id"> h</span><span class="id"> :</span> (<span class="id">@mxsub</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> <span class="id"> m'</span><span class="id"> n'</span><span class="id"> g</span><span class="id"> h</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> mxsub</span><span class="id"> g</span><span class="id"> h</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_row_perm</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">row_perm</span><span class="id"> s</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> row_perm</span><span class="id"> s</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_col_perm</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">col_perm</span><span class="id"> s</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> col_perm</span><span class="id"> s</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span> (<span class="id">xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> :</span> (<span class="id">xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_castmx</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> c</span><span class="id"> :</span> (<span class="id">castmx</span><span class="id"> c</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> castmx</span><span class="id"> c</span><span class="id"> A^f</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">castmxE,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_conform_mx</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">conform_mx</span><span class="id"> B</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> conform_mx</span><span class="id"> B^f</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> B;</span><span class="id"> have</span><span class="id"> [[&lt;-</span><span class="id"> &lt;-]</span><span class="id"> B|]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">m,</span><span class="id"> n</span>) (<span class="id">m',</span><span class="id"> n'</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !conform_mx_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> negb_and</span><span class="id"> =&gt;</span><span class="id"> neq_mn</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> !nonconform_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mxvec</span><span class="id"> :</span> (<span class="id">mxvec</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> mxvec</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">castmxE,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_vec_mx</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">vec_mx</span><span class="id"> v</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> vec_mx</span><span class="id"> v^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> OneMatrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Block</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m1,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m2,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">Bh</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m1,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>)) (<span class="id">Bv</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span>)).<br/>
<span class="vernacular">Variable</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[aT]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_row_mx</span><span class="id"> :</span> (<span class="id">row_mx</span><span class="id"> Aul</span><span class="id"> Aur</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> row_mx</span><span class="id"> Aul^f</span><span class="id"> Aur^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> 2![rewrite</span><span class="id"> !mxE</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_col_mx</span><span class="id"> :</span> (<span class="id">col_mx</span><span class="id"> Aul</span><span class="id"> Adl</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> col_mx</span><span class="id"> Aul^f</span><span class="id"> Adl^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> 2![rewrite</span><span class="id"> !mxE</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_block_mx</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> block_mx</span><span class="id"> Aul^f</span><span class="id"> Aur^f</span><span class="id"> Adl^f</span><span class="id"> Adr^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> 3![rewrite</span><span class="id"> !mxE</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_lsubmx</span><span class="id"> :</span> (<span class="id">lsubmx</span><span class="id"> Bh</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> lsubmx</span><span class="id"> Bh^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_rsubmx</span><span class="id"> :</span> (<span class="id">rsubmx</span><span class="id"> Bh</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> rsubmx</span><span class="id"> Bh^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_usubmx</span><span class="id"> :</span> (<span class="id">usubmx</span><span class="id"> Bv</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> usubmx</span><span class="id"> Bv^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_dsubmx</span><span class="id"> :</span> (<span class="id">dsubmx</span><span class="id"> Bv</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> dsubmx</span><span class="id"> Bv^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_ulsubmx</span><span class="id"> :</span> (<span class="id">ulsubmx</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> ulsubmx</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_ursubmx</span><span class="id"> :</span> (<span class="id">ursubmx</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> ursubmx</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_dlsubmx</span><span class="id"> :</span> (<span class="id">dlsubmx</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> dlsubmx</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_drsubmx</span><span class="id"> :</span> (<span class="id">drsubmx</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> drsubmx</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Block</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MapMatrix</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> map_mx</span><span class="id"> {aT</span><span class="id"> rT}</span><span class="id"> f</span><span class="id"> {m</span><span class="id"> n}</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MultipleMapMatrix</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> S</span><span class="id"> T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;M ^ phi&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> phi</span><span class="id"> M</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_comp</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;(<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> M</span><span class="id"> ^</span> (<span class="id">g</span><span class="id"> \o</span><span class="id"> f</span>)<span class="id"> =</span> (<span class="id">M</span><span class="id"> ^</span><span class="id"> f</span>)<span class="id"> ^</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_in_map_mx</span> (<span class="id">g</span><span class="id"> f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>) (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> f</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> g</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>))<span class="id"> -&gt;</span><span class="id"> M</span><span class="id"> ^</span><span class="id"> f</span><span class="id"> =</span><span class="id"> M</span><span class="id"> ^</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fg;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_map_mx</span> (<span class="id">g</span><span class="id"> f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>)<span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> g</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id">,</span><span class="id"> M</span><span class="id"> ^</span><span class="id"> f</span><span class="id"> =</span><span class="id"> M</span><span class="id"> ^</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eq_fg</span><span class="id"> M;</span><span class="id"> apply/eq_in_map_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_id_in</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> f</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> M</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><span class="id"> M</span><span class="id"> ^</span><span class="id"> f</span><span class="id"> =</span><span class="id"> M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fM;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_id</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> id</span><span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id">,</span><span class="id"> M</span><span class="id"> ^</span><span class="id"> f</span><span class="id"> =</span><span class="id"> M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fid</span><span class="id"> M;</span><span class="id"> rewrite</span><span class="id"> map_mx_id_in</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MultipleMapMatrix</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_map_mx</span><span class="id"> {R</span><span class="id"> S</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> g</span><span class="id"> [f]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_in_map_mx</span><span class="id"> {R</span><span class="id"> S</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> g</span><span class="id"> [f</span><span class="id"> M]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> map_mx_id_in</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> [f</span><span class="id"> M]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> map_mx_id</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> [f]</span>.<br/>
<br/>
<pre class="ssrdoc">
(********************* Matrix lifted laws ******************
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> Map2Matrix</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> S</span><span class="id"> T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> T</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> map2_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> map2_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[map2_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> f</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> j</span>) (<span class="id">B</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> OneMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_trmx</span><span class="id"> :</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> map2_mx</span><span class="id"> A^T</span><span class="id"> B^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_const_mx</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">const_mx</span><span class="id"> a</span>) (<span class="id">const_mx</span><span class="id"> b</span>)<span class="id"> =</span><span class="id"> const_mx</span> (<span class="id">f</span><span class="id"> a</span><span class="id"> b</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_row</span><span class="id"> i</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> A</span>) (<span class="id">row</span><span class="id"> i</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> row</span><span class="id"> i</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_col</span><span class="id"> j</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">col</span><span class="id"> j</span><span class="id"> A</span>) (<span class="id">col</span><span class="id"> j</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> col</span><span class="id"> j</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_row'</span><span class="id"> i0</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">row'</span><span class="id"> i0</span><span class="id"> A</span>) (<span class="id">row'</span><span class="id"> i0</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> row'</span><span class="id"> i0</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_col'</span><span class="id"> j0</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">col'</span><span class="id"> j0</span><span class="id"> A</span>) (<span class="id">col'</span><span class="id"> j0</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> col'</span><span class="id"> j0</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mxsub</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> g</span><span class="id"> h</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">@mxsub</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> <span class="id"> m'</span><span class="id"> n'</span><span class="id"> g</span><span class="id"> h</span><span class="id"> A</span>) (<span class="id">@mxsub</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> <span class="id"> m'</span><span class="id"> n'</span><span class="id"> g</span><span class="id"> h</span><span class="id"> B</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">mxsub</span><span class="id"> g</span><span class="id"> h</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_row_perm</span><span class="id"> s</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">row_perm</span><span class="id"> s</span><span class="id"> A</span>) (<span class="id">row_perm</span><span class="id"> s</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> row_perm</span><span class="id"> s</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_col_perm</span><span class="id"> s</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">col_perm</span><span class="id"> s</span><span class="id"> A</span>) (<span class="id">col_perm</span><span class="id"> s</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> col_perm</span><span class="id"> s</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> A</span>) (<span class="id">xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> xrow</span><span class="id"> i1</span><span class="id"> i2</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A</span>) (<span class="id">xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> xcol</span><span class="id"> j1</span><span class="id"> j2</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_castmx</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> c</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">castmx</span><span class="id"> c</span><span class="id"> A</span>) (<span class="id">castmx</span><span class="id"> c</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> castmx</span><span class="id"> c</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">castmxE,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_conform_mx</span><span class="id"> m'</span><span class="id"> n'</span> (<span class="id">A'</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>)) (<span class="id">B'</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">conform_mx</span><span class="id"> A'</span><span class="id"> A</span>) (<span class="id">conform_mx</span><span class="id"> B'</span><span class="id"> B</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">conform_mx</span> (<span class="id">map2_mx</span><span class="id"> A'</span><span class="id"> B'</span>) (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> A'</span><span class="id"> B';</span><span class="id"> have</span><span class="id"> [[&lt;-</span><span class="id"> &lt;-]</span><span class="id"> A'</span><span class="id"> B'|]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">m,</span><span class="id"> n</span>) (<span class="id">m',</span><span class="id"> n'</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !conform_mx_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> negb_and</span><span class="id"> =&gt;</span><span class="id"> neq_mn</span><span class="id"> A'</span><span class="id"> B';</span><span class="id"> rewrite</span><span class="id"> !nonconform_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mxvec</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">mxvec</span><span class="id"> A</span>) (<span class="id">mxvec</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> mxvec</span> (<span class="id">map2_mx</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">castmxE,</span><span class="id"> mxE</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_vec_mx</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)) (<span class="id">w</span><span class="id"> :</span><span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">vec_mx</span><span class="id"> v</span>) (<span class="id">vec_mx</span><span class="id"> w</span>)<span class="id"> =</span><span class="id"> vec_mx</span> (<span class="id">map2_mx</span><span class="id"> v</span><span class="id"> w</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> OneMatrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Block</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m2,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">Bh</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>)) (<span class="id">Bv</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span>)).<br/>
<span class="vernacular">Variable</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">A'ul</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">A'ur</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m1,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">A'dl</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">A'dr</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m2,</span><span class="id"> n2</span>)).<br/>
<span class="vernacular">Variables</span> (<span class="id">B'h</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m1,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>)) (<span class="id">B'v</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span>)).<br/>
<span class="vernacular">Variable</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_row_mx</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">row_mx</span><span class="id"> Aul</span><span class="id"> Aur</span>) (<span class="id">row_mx</span><span class="id"> A'ul</span><span class="id"> A'ur</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">row_mx</span> (<span class="id">map2_mx</span><span class="id"> Aul</span><span class="id"> A'ul</span>) (<span class="id">map2_mx</span><span class="id"> Aur</span><span class="id"> A'ur</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> 2![rewrite</span><span class="id"> !mxE</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_col_mx</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">col_mx</span><span class="id"> Aul</span><span class="id"> Adl</span>) (<span class="id">col_mx</span><span class="id"> A'ul</span><span class="id"> A'dl</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">col_mx</span> (<span class="id">map2_mx</span><span class="id"> Aul</span><span class="id"> A'ul</span>) (<span class="id">map2_mx</span><span class="id"> Adl</span><span class="id"> A'dl</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> 2![rewrite</span><span class="id"> !mxE</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_block_mx</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span> (<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span>) (<span class="id">block_mx</span><span class="id"> A'ul</span><span class="id"> A'ur</span><span class="id"> A'dl</span><span class="id"> A'dr</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">map2_mx</span><span class="id"> Aul</span><span class="id"> A'ul</span>) (<span class="id">map2_mx</span><span class="id"> Aur</span><span class="id"> A'ur</span>) (<span class="id">map2_mx</span><span class="id"> Adl</span><span class="id"> A'dl</span>) (<span class="id">map2_mx</span><span class="id"> Adr</span><span class="id"> A'dr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> 3![rewrite</span><span class="id"> !mxE</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_lsubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">lsubmx</span><span class="id"> Bh</span>) (<span class="id">lsubmx</span><span class="id"> B'h</span>)<span class="id"> =</span><span class="id"> lsubmx</span> (<span class="id">map2_mx</span><span class="id"> Bh</span><span class="id"> B'h</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_rsubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">rsubmx</span><span class="id"> Bh</span>) (<span class="id">rsubmx</span><span class="id"> B'h</span>)<span class="id"> =</span><span class="id"> rsubmx</span> (<span class="id">map2_mx</span><span class="id"> Bh</span><span class="id"> B'h</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_usubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">usubmx</span><span class="id"> Bv</span>) (<span class="id">usubmx</span><span class="id"> B'v</span>)<span class="id"> =</span><span class="id"> usubmx</span> (<span class="id">map2_mx</span><span class="id"> Bv</span><span class="id"> B'v</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_dsubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">dsubmx</span><span class="id"> Bv</span>) (<span class="id">dsubmx</span><span class="id"> B'v</span>)<span class="id"> =</span><span class="id"> dsubmx</span> (<span class="id">map2_mx</span><span class="id"> Bv</span><span class="id"> B'v</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_ulsubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">ulsubmx</span><span class="id"> B</span>) (<span class="id">ulsubmx</span><span class="id"> B'</span>)<span class="id"> =</span><span class="id"> ulsubmx</span> (<span class="id">map2_mx</span><span class="id"> B</span><span class="id"> B'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_ursubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">ursubmx</span><span class="id"> B</span>) (<span class="id">ursubmx</span><span class="id"> B'</span>)<span class="id"> =</span><span class="id"> ursubmx</span> (<span class="id">map2_mx</span><span class="id"> B</span><span class="id"> B'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_dlsubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">dlsubmx</span><span class="id"> B</span>) (<span class="id">dlsubmx</span><span class="id"> B'</span>)<span class="id"> =</span><span class="id"> dlsubmx</span> (<span class="id">map2_mx</span><span class="id"> B</span><span class="id"> B'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_drsubmx</span><span class="id"> :</span><span class="id"> map2_mx</span> (<span class="id">drsubmx</span><span class="id"> B</span>) (<span class="id">drsubmx</span><span class="id"> B'</span>)<span class="id"> =</span><span class="id"> drsubmx</span> (<span class="id">map2_mx</span><span class="id"> B</span><span class="id"> B'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Block</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Map2Matrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Map2Eq</span>.<br/>
<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> S</span><span class="id"> T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_in_map2_mx</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> T</span>) (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">M'</span><span class="id"> :</span><span class="id"> 'M[S]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> f</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>) (<span class="id">M'</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> g</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>) (<span class="id">M'</span><span class="id"> i</span><span class="id"> j</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">map2_mx</span><span class="id"> f</span><span class="id"> M</span><span class="id"> M'</span><span class="id"> =</span><span class="id"> map2_mx</span><span class="id"> g</span><span class="id"> M</span><span class="id"> M'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fg;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_map2_mx</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> f</span><span class="id"> =2</span><span class="id"> g</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> f</span><span class="id"> m</span><span class="id"> n</span><span class="id"> =2</span><span class="id"> @map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> g</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eq_fg</span><span class="id"> M</span><span class="id"> M';</span><span class="id"> apply/eq_in_map2_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mx_left_in</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">M'</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> f</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>) (<span class="id">M'</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> M</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><span class="id"> map2_mx</span><span class="id"> f</span><span class="id"> M</span><span class="id"> M'</span><span class="id"> =</span><span class="id"> M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fM;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mx_left</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> f</span><span class="id"> =2</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">M'</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id">,</span><span class="id"> map2_mx</span><span class="id"> f</span><span class="id"> M</span><span class="id"> M'</span><span class="id"> =</span><span class="id"> M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fl</span><span class="id"> M</span><span class="id"> M';</span><span class="id"> rewrite</span><span class="id"> map2_mx_left_in//</span><span class="id"> =&gt;i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> fl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mx_right_in</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">M'</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> f</span> (<span class="id">M</span><span class="id"> i</span><span class="id"> j</span>) (<span class="id">M'</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> M'</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><span class="id"> map2_mx</span><span class="id"> f</span><span class="id"> M</span><span class="id"> M'</span><span class="id"> =</span><span class="id"> M'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fM;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mx_right</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> f</span><span class="id"> =2</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">M'</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id">,</span><span class="id"> map2_mx</span><span class="id"> f</span><span class="id"> M</span><span class="id"> M'</span><span class="id"> =</span><span class="id"> M'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fr</span><span class="id"> M</span><span class="id"> M';</span><span class="id"> rewrite</span><span class="id"> map2_mx_right_in//</span><span class="id"> =&gt;i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> fr</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Map2Eq</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixLaws</span>.<br/>
<br/>
<span class="vernacular">Context</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {idm</span><span class="id"> :</span><span class="id"> T}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mxA</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">law</span><span class="id"> idm}</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> B</span><span class="id"> C;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mulmA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_1mx</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">law</span><span class="id"> idm}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">left_id</span> (<span class="id">const_mx</span><span class="id"> idm</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mul1m</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mx1</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">law</span><span class="id"> idm}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">right_id</span> (<span class="id">const_mx</span><span class="id"> idm</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mulm1</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">law</span><span class="id"> idm}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Monoid</span>.<span class="id">isLaw</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">const_mx</span><span class="id"> idm</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map2_mxA</span><span class="id"> map2_1mx</span><span class="id"> map2_mx1</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mxC</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">com_law</span><span class="id"> idm}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">commutative</span> (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> B;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mulmC</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">com_law</span><span class="id"> idm}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SemiGroup</span>.<span class="id">isCommutativeLaw</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> map2_mxC</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_0mx</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">mul_law</span><span class="id"> idm}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">left_zero</span> (<span class="id">const_mx</span><span class="id"> idm</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mul0m</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mx0</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">mul_law</span><span class="id"> idm}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">right_zero</span> (<span class="id">const_mx</span><span class="id"> idm</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mulm0</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> {opm</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">mul_law</span><span class="id"> idm}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Monoid</span>.<span class="id">isMulLaw</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">const_mx</span><span class="id"> idm</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> opm</span><span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map2_0mx</span><span class="id"> map2_mx0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mxDl</span><span class="id"> {mul</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T}</span><span class="id"> {add</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">add_law</span><span class="id"> idm</span><span class="id"> mul}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">left_distributive</span> (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> mul</span><span class="id"> m</span><span class="id"> n</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> add</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> B</span><span class="id"> C;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mulmDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map2_mxDr</span><span class="id"> {mul</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T}</span><span class="id"> {add</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">add_law</span><span class="id"> idm</span><span class="id"> mul}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">right_distributive</span> (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> mul</span><span class="id"> m</span><span class="id"> n</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> add</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> B</span><span class="id"> C;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Monoid</span>.<span class="id">mulmDr</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> {mul</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T}</span><span class="id"> {add</span><span class="id"> :</span><span class="id"> Monoid</span>.<span class="id">add_law</span><span class="id"> idm</span><span class="id"> mul}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Monoid</span>.<span class="id">isAddLaw</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> mul</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">@map2_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> add</span><span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map2_mxDl</span><span class="id"> map2_mxDr</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixLaws</span>.<br/>
<br/>
<pre class="ssrdoc">
(************* Matrix Nmodule (additive abelian monoid) structure ***********
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixNmodule</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> nmodType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> addmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> addmx</span><span class="id"> :=</span><span class="id"> @map2_mx</span><span class="id"> V</span><span class="id"> V</span><span class="id"> V</span><span class="id"> +%R</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> addmxA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> addmx</span><span class="id"> :=</span><span class="id"> map2_mxA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addmxC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> addmx</span><span class="id"> :=</span><span class="id"> map2_mxC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> add0mx</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">const_mx</span><span class="id"> 0</span>)<span class="id"> addmx</span><span class="id"> :=</span><span class="id"> map2_1mx</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isNmodule</span>.<span class="id">Build</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;<span class="id">addmxA</span><span class="id"> addmxC</span><span class="id"> add0mx</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxnE</span><span class="id"> A</span><span class="id"> d</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> *+</span><span class="id"> d</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *+</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> d</span><span class="id"> =&gt;</span><span class="id"> [|d</span><span class="id"> IHd];</span><span class="id"> rewrite</span><span class="id"> ?mulrS</span><span class="id"> mxE</span><span class="id"> ?IHd</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summxE</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">k</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> E</span><span class="id"> k</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">k</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> E</span><span class="id"> k</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">big_morph</span> (<span class="gallina-kwd">fun</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>))<span class="id"> =&gt;</span><span class="id"> [A</span><span class="id"> B|];</span><span class="id"> rewrite</span><span class="id"> mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> const_mx_is_semi_additive</span><span class="id"> :</span><span class="id"> semi_additive</span><span class="id"> const_mx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|a</span><span class="id"> b];</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> const_mx</span><br/>
&nbsp;&nbsp;<span class="id">const_mx_is_semi_additive</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiAdditive</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> 'I_m</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> swizzle_mx</span><span class="id"> k</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[k]_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A</span> (<span class="id">f</span><span class="id"> i</span><span class="id"> j</span>) (<span class="id">g</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> swizzle_mx_is_semi_additive</span><span class="id"> k</span><span class="id"> :</span><span class="id"> semi_additive</span> (<span class="id">swizzle_mx</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|A</span><span class="id"> B];</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> k</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> q</span>)<br/>
&nbsp;&nbsp;(<span class="id">swizzle_mx</span><span class="id"> k</span>) (<span class="id">swizzle_mx_is_semi_additive</span><span class="id"> k</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> SemiAdditive</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> SwizzleAdd</span><span class="id"> op</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">Additive</span>.<span class="id">copy</span><span class="id"> op</span> (<span class="id">swizzle_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@trmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@row</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@col</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@row'</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@col'</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@mxsub</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@row_perm</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@col_perm</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@xrow</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@xcol</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j1</span><span class="id"> j2</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@lsubmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@rsubmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@usubmx</span><span class="id"> V</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@dsubmx</span><span class="id"> V</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@vec_mx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;<span class="id">mxvec</span> (<span class="id">can2_semi_additive</span> (<span class="id">@vec_mxK</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> mxvecK</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> flatmx0</span><span class="id"> n</span><span class="id"> :</span><span class="id"> all_equal_to</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">0,</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> []</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> thinmx0</span><span class="id"> n</span><span class="id"> :</span><span class="id"> all_equal_to</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> 0</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id">^T</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> trmx_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i0</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i0</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j0</span><span class="id"> :</span><span class="id"> col</span><span class="id"> j0</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> col_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvec_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">mxvec</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">can2_eq</span><span class="id"> mxvecK</span><span class="id"> vec_mxK</span>)<span class="id"> raddf0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> vec_mx_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">vec_mx</span><span class="id"> v</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">v</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">can2_eq</span><span class="id"> vec_mxK</span><span class="id"> mxvecK</span>)<span class="id"> raddf0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mx0</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> row_mx</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_mx_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mx0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> col_mx</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> col_mx_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mx0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> block_mx</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> block_mx_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Ltac</span><span class="id"> split_mxE</span><span class="id"> :=</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> ![rewrite</span><span class="id"> mxE</span><span class="id"> |</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_row_mx</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> B1</span><span class="id"> B2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> +</span><span class="id"> row_mx</span><span class="id"> B1</span><span class="id"> B2</span><span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">A1</span><span class="id"> +</span><span class="id"> B1</span>) (<span class="id">A2</span><span class="id"> +</span><span class="id"> B2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> B1</span><span class="id"> B2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> +</span><span class="id"> col_mx</span><span class="id"> B1</span><span class="id"> B2</span><span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">A1</span><span class="id"> +</span><span class="id"> B1</span>) (<span class="id">A2</span><span class="id"> +</span><span class="id"> B2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_block_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> Aur</span><span class="id"> Adl</span> (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Bul</span><span class="id"> Bur</span><span class="id"> Bdl</span><span class="id"> Bdr</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> B</span><span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> Bul</span><span class="id"> Bur</span><span class="id"> Bdl</span><span class="id"> Bdr</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> =</span><span class="id"> block_mx</span> (<span class="id">Aul</span><span class="id"> +</span><span class="id"> Bul</span>) (<span class="id">Aur</span><span class="id"> +</span><span class="id"> Bur</span>) (<span class="id">Adl</span><span class="id"> +</span><span class="id"> Bdl</span>) (<span class="id">Adr</span><span class="id"> +</span><span class="id"> Bdr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> add_col_mx</span><span class="id"> !add_row_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mx_eq0</span> (<span class="id">m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A1</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">A2</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP/andP;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> /eqP-&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> row_mx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -row_mx0</span><span class="id"> =&gt;</span><span class="id"> /eq_row_mx</span><span class="id"> [-&gt;</span><span class="id"> -&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mx_eq0</span> (<span class="id">m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">col_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A1</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">A2</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -![_</span><span class="id"> ==</span><span class="id"> 0]</span>(<span class="id">inj_eq</span><span class="id"> trmx_inj</span>)<span class="id"> !trmx0</span><span class="id"> tr_col_mx</span><span class="id"> row_mx_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_mx_eq0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> Aur</span><span class="id"> Adl</span> (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">[&amp;&amp;</span><span class="id"> Aul</span><span class="id"> ==</span><span class="id"> 0,</span><span class="id"> Aur</span><span class="id"> ==</span><span class="id"> 0,</span><span class="id"> Adl</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> &amp;</span><span class="id"> Adr</span><span class="id"> ==</span><span class="id"> 0]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mx_eq0</span><span class="id"> !row_mx_eq0</span><span class="id"> !andbA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_eq0</span> <span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A^T</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -trmx0</span> (<span class="id">inj_eq</span><span class="id"> trmx_inj</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> matrix_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> [forall</span><span class="id"> i,</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> ==</span><span class="id"> 0]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP/'forall_'forall_eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> i</span><span class="id"> j|A_eq0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> A_eq0</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> matrix0Pn</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> !=</span><span class="id"> 0</span>) (<span class="id">A</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> matrix_eq0;</span><span class="id"> apply/</span>(<span class="id">iffP</span><span class="id"> forallPn</span>)<span class="id"> =&gt;</span><span class="id"> -[i</span><span class="id"> /forallPn];</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rV0Pn</span><span class="id"> n</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> 'rV_n</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> i,</span><span class="id"> v</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> 0</span>) (<span class="id">v</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">matrix0Pn</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> [j]]|[j]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> 0,</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ord1;</span><span class="gallina-kwd"> exists</span><span class="id"> j</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cV0Pn</span><span class="id"> n</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> 'cV_n</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> i,</span><span class="id"> v</span><span class="id"> i</span><span class="id"> 0</span><span class="id"> !=</span><span class="id"> 0</span>) (<span class="id">v</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">matrix0Pn</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> [[i]</span><span class="id"> [j]|[i]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> 0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ord1;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> nz_row</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">oapp</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span>)<span class="id"> 0</span><span class="id"> [pick</span><span class="id"> i</span><span class="id"> |</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> !=</span><span class="id"> 0]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nz_row_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">nz_row</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /nz_row;</span><span class="id"> symmetry;</span><span class="id"> case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> /=</span><span class="id"> nzAi</span><span class="id"> |</span><span class="id"> Ai0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">negPf</span><span class="id"> nzAi</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> contraTF</span><span class="id"> nzAi</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> row0</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eqxx;</span><span class="id"> apply/eqP/row_matrixP=&gt;</span><span class="id"> i;</span><span class="id"> move/eqP:</span> (<span class="id">Ai0</span><span class="id"> i</span>)<span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> row0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> is_diag_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'I__,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I__,</span> (<span class="id">i</span><span class="id"> !=</span><span class="id"> j</span><span class="id"> :&gt;</span><span class="id"> nat</span>)<span class="id"> ==&gt;</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_mxP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I__,</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> j</span><span class="id"> :&gt;</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">is_diag_mx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> 'forall_'forall_implyP</span>)<span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx0_is_diag</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> is_diag_mx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_diag_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx11_is_diag</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_1</span>)<span class="id"> :</span><span class="id"> is_diag_mx</span><span class="id"> M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_diag_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !ord1</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> is_trig_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'I__,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I__,</span> (<span class="id">i</span><span class="id"> &lt;</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> ==&gt;</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_trig_mxP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I__,</span> (<span class="id">i</span><span class="id"> &lt;</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">is_trig_mx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> 'forall_'forall_implyP</span>)<span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_mx_is_trig</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_trig_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /is_diag_mxP</span><span class="id"> A_eq0;</span><span class="id"> apply/is_trig_mxP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> lt_ij;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> A_eq0//</span><span class="id"> ltn_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx0_is_trig</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> is_trig_mx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx11_is_trig</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_1</span>)<span class="id"> :</span><span class="id"> is_trig_mx</span><span class="id"> M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !ord1</span><span class="id"> ltnn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_mxEtrig</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_diag_mx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> &amp;&amp;</span><span class="id"> is_trig_mx</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/is_diag_mxP/andP</span><span class="id"> =&gt;</span><span class="id"> [Adiag|[/is_trig_mxP</span><span class="id"> Atrig</span><span class="id"> /is_trig_mxP</span><span class="id"> ATtrig]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> lt_ij;</span><span class="id"> rewrite</span><span class="id"> ?mxE</span><span class="id"> ?Adiag//;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[rewrite</span><span class="id"> ltn_eqF|rewrite</span><span class="id"> gtn_eqF]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> case:</span><span class="id"> ltngtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [/Atrig|/ATtrig];</span><span class="id"> rewrite</span><span class="id"> ?mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_trmx</span> <span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> is_diag_mx</span><span class="id"> A^T</span><span class="id"> =</span><span class="id"> is_diag_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !is_diag_mxEtrig</span><span class="id"> trmxK</span><span class="id"> andbC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ursubmx_trig</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">m1</span><span class="id"> &lt;=</span><span class="id"> n1</span><span class="id"> -&gt;</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> ursubmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> leq_m1_n1</span><span class="id"> /is_trig_mxP</span><span class="id"> Atrig;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Atrig//=</span><span class="id"> ltn_addr//</span> (<span class="id">@leq_trans</span><span class="id"> m1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dlsubmx_diag</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">n1</span><span class="id"> &lt;=</span><span class="id"> m1</span><span class="id"> -&gt;</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> dlsubmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> leq_m2_n2</span><span class="id"> /is_diag_mxP</span><span class="id"> Adiag;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Adiag//</span><span class="id"> gtn_eqF//=</span><span class="id"> ltn_addr//</span> (<span class="id">@leq_trans</span><span class="id"> n1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ulsubmx_trig</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_trig_mx</span> (<span class="id">ulsubmx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /is_trig_mxP</span><span class="id"> Atrig;</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> lt_ij</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Atrig</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> drsubmx_trig</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">m1</span><span class="id"> &lt;=</span><span class="id"> n1</span><span class="id"> -&gt;</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_trig_mx</span> (<span class="id">drsubmx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> leq_m1_n1</span><span class="id"> /is_trig_mxP</span><span class="id"> Atrig;</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> lt_ij</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Atrig//=</span><span class="id"> -addnS</span><span class="id"> leq_add</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ulsubmx_diag</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_diag_mx</span> (<span class="id">ulsubmx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !is_diag_mxEtrig</span><span class="id"> trmx_ulsub</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /andP[/ulsubmx_trig-&gt;</span><span class="id"> /ulsubmx_trig-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> drsubmx_diag</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">m1</span><span class="id"> =</span><span class="id"> n1</span><span class="id"> -&gt;</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_diag_mx</span> (<span class="id">drsubmx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eq_m1_n1</span><span class="id"> /is_diag_mxP</span><span class="id"> Adiag;</span><span class="id"> apply/is_diag_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> neq_ij</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Adiag//=</span><span class="id"> eq_m1_n1</span><span class="id"> eqn_add2l</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_trig_block_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> ul</span><span class="id"> ur</span><span class="id"> dl</span><span class="id"> dr</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> n1</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">@is_trig_mx</span> (<span class="id">m1</span><span class="id"> +</span><span class="id"> m2</span>) (<span class="id">n1</span><span class="id"> +</span><span class="id"> n2</span>) (<span class="id">block_mx</span><span class="id"> ul</span><span class="id"> ur</span><span class="id"> dl</span><span class="id"> dr</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">[&amp;&amp;</span><span class="id"> ur</span><span class="id"> ==</span><span class="id"> 0,</span><span class="id"> is_trig_mx</span><span class="id"> ul</span><span class="id"> &amp;</span><span class="id"> is_trig_mx</span><span class="id"> dr]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eq_m1_n1;</span><span class="id"> rewrite</span><span class="id"> {}eq_m1_n1</span><span class="gallina-kwd"> in</span><span class="id"> ul</span><span class="id"> ur</span><span class="id"> dl</span><span class="id"> dr</span><span class="id"> *</span>.<br/>
<span class="id">apply/is_trig_mxP/and3P</span><span class="id"> =&gt;</span><span class="id"> [Atrig|];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [/eqP-&gt;</span><span class="id"> /is_trig_mxP</span><span class="id"> ul_trig</span><span class="id"> /is_trig_mxP</span><span class="id"> dr_trig]</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> 2![case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?mxE//=]</span><span class="id"> =&gt;</span><span class="id"> lt_ij;</span><span class="id"> rewrite</span><span class="id"> ?ul_trig//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span><span class="id"> lt_ij;</span><span class="id"> rewrite</span><span class="id"> ltnNge</span><span class="id"> -ltnS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">leq_trans</span> (<span class="id">ltn_ord</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> -addnS</span><span class="id"> leq_addr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dr_trig//;</span><span class="id"> move:</span><span class="id"> lt_ij;</span><span class="id"> rewrite</span><span class="id"> ltn_add2l</span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">-</span><span class="id"> apply/eqP/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Atrig</span> (<span class="id">lshift</span><span class="id"> _</span><span class="id"> i</span>) (<span class="id">rshift</span><span class="id"> _</span><span class="id"> j</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eq_shift//</span><span class="id"> ?mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eq_shift//</span><span class="id"> ?mxE</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;</span><span class="id"> /eqP&lt;-</span><span class="id"> &lt;-</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span> (<span class="id">leq_trans</span> (<span class="id">ltn_ord</span><span class="id"> _</span>))<span class="id"> ?leq_addr</span>.<br/>
<span class="id">-</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> lt_ij;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Atrig</span> (<span class="id">lshift</span><span class="id"> _</span><span class="id"> i</span>) (<span class="id">lshift</span><span class="id"> _</span><span class="id"> j</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eq_shift//</span><span class="id"> ?mxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eq_shift//</span><span class="id"> ?mxE</span><span class="id"> =&gt;</span><span class="id"> /eqP&lt;-</span><span class="id"> /eqP&lt;-</span><span class="id"> -&gt;</span>.<br/>
<span class="id">-</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> lt_ij;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Atrig</span> (<span class="id">rshift</span><span class="id"> _</span><span class="id"> i</span>) (<span class="id">rshift</span><span class="id"> _</span><span class="id"> j</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eq_shift//</span><span class="id"> ?mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eq_shift//</span><span class="id"> ?mxE</span><span class="id"> =&gt;</span><span class="id"> /eqP&lt;-</span><span class="id"> /eqP&lt;-</span><span class="id"> -&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ltn_add2l</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trigmx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n,</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> 0</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> n</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0l</span><span class="id"> P0r</span><span class="id"> PS</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A;</span><span class="id"> elim:</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> {m</span><span class="id"> n}</span><span class="id"> [m|n|m</span><span class="id"> n</span><span class="id"> xx</span><span class="id"> r</span><span class="id"> c]</span><span class="id"> A</span><span class="id"> PA;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?by</span><span class="id"> rewrite</span> (<span class="id">flatmx0,</span><span class="id"> thinmx0</span>)<span class="id">;</span><span class="gallina-kwd"> by</span><span class="id"> [apply:</span><span class="id"> P0l|apply:</span><span class="id"> P0r]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_trig_block_mx</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /and3P[/eqP-&gt;</span><span class="id"> _</span><span class="id"> Atrig];</span><span class="id"> apply:</span><span class="id"> PS</span> (<span class="id">PA</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trigsqmx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> n,</span><span class="id"> 'M[V]_n</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> 0</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> x</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0</span><span class="id"> PS</span><span class="id"> n</span><span class="id"> A;</span><span class="id"> elim/sqmx_ind:</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> {n}</span><span class="id"> [|n</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c]</span><span class="id"> A</span><span class="id"> PA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> thinmx0;</span><span class="id"> apply:</span><span class="id"> P0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_trig_block_mx</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /and3P[/eqP-&gt;</span><span class="id"> _</span><span class="id"> Atrig];</span><span class="id"> apply:</span><span class="id"> PS</span> (<span class="id">PA</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_block_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> ul</span><span class="id"> ur</span><span class="id"> dl</span><span class="id"> dr</span><span class="id"> :</span><span class="id"> m1</span><span class="id"> =</span><span class="id"> n1</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">@is_diag_mx</span> (<span class="id">m1</span><span class="id"> +</span><span class="id"> m2</span>) (<span class="id">n1</span><span class="id"> +</span><span class="id"> n2</span>) (<span class="id">block_mx</span><span class="id"> ul</span><span class="id"> ur</span><span class="id"> dl</span><span class="id"> dr</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">[&amp;&amp;</span><span class="id"> ur</span><span class="id"> ==</span><span class="id"> 0,</span><span class="id"> dl</span><span class="id"> ==</span><span class="id"> 0,</span><span class="id"> is_diag_mx</span><span class="id"> ul</span><span class="id"> &amp;</span><span class="id"> is_diag_mx</span><span class="id"> dr]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eq_m1_n1</span>.<br/>
<span class="id">rewrite</span><span class="id"> !is_diag_mxEtrig</span><span class="id"> tr_block_mx</span><span class="id"> !is_trig_block_mx//</span><span class="id"> trmx_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> andbACA</span><span class="id"> -!andbA;</span><span class="id"> congr</span><span class="id"> [&amp;&amp;</span><span class="id"> _,</span><span class="id"> _,</span><span class="id"> _</span><span class="id"> &amp;</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> andbCA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diagmx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> n,</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m,</span><span class="id"> P</span><span class="id"> m</span><span class="id"> 0</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> 0</span><span class="id"> n</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0l</span><span class="id"> P0r</span><span class="id"> PS</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> Adiag;</span><span class="id"> have</span><span class="id"> Atrig</span><span class="id"> :=</span><span class="id"> is_diag_mx_is_trig</span><span class="id"> Adiag</span>.<br/>
<span class="id">elim/trigmx_ind:</span><span class="id"> Atrig</span><span class="id"> Adiag</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> {}m</span><span class="id"> {}n</span><span class="id"> r</span><span class="id"> c</span><span class="id"> {}A</span><span class="id"> _</span><span class="id"> PA</span>.<br/>
<span class="id">rewrite</span><span class="id"> is_diag_block_mx</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /and4P[_</span><span class="id"> /eqP-&gt;</span><span class="id"> _</span><span class="id"> Adiag]</span>.<br/>
<span class="id">exact:</span><span class="id"> PS</span> (<span class="id">PA</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diagsqmx_ind</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> n,</span><span class="id"> 'M[V]_n</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> 0</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> x</span><span class="id"> c</span><span class="id"> A,</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span> (<span class="id">block_mx</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> c</span><span class="id"> A</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> A,</span><span class="id"> is_diag_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P0</span><span class="id"> PS</span><span class="id"> n</span><span class="id"> A;</span><span class="id"> elim/sqmx_ind:</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|{}n</span><span class="id"> x</span><span class="id"> r</span><span class="id"> c]</span><span class="id"> A</span><span class="id"> PA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> thinmx0;</span><span class="id"> apply:</span><span class="id"> P0</span>.<br/>
<span class="id">rewrite</span><span class="id"> is_diag_block_mx</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /and4P[/eqP-&gt;</span><span class="id"> /eqP-&gt;</span><span class="id"> _</span><span class="id"> Adiag]</span>.<br/>
<span class="id">exact:</span><span class="id"> PS</span> (<span class="id">PA</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> diag_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> diag_mx</span><span class="id"> n</span> (<span class="id">d</span><span class="id"> :</span><span class="id"> 'rV[V]_n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[diag_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">d</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> *+</span> (<span class="id">i</span><span class="id"> ==</span><span class="id"> j</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_diag_mx</span><span class="id"> n</span> (<span class="id">d</span><span class="id"> :</span><span class="id"> 'rV_n</span>)<span class="id"> :</span> (<span class="id">diag_mx</span><span class="id"> d</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> diag_mx</span><span class="id"> d</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!mxE];</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mx_is_semi_additive</span><span class="id"> n</span><span class="id"> :</span><span class="id"> semi_additive</span> (<span class="id">@diag_mx</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> [|A</span><span class="id"> B];</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> ?mul0rn//</span><span class="id"> mulrnDl</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> 'rV_n</span><span class="id"> 'M_n</span> (<span class="id">@diag_mx</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;(<span class="id">@diag_mx_is_semi_additive</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mx_row</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">l</span><span class="id"> :</span><span class="id"> 'rV_n</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> 'rV_m</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">diag_mx</span> (<span class="id">row_mx</span><span class="id"> l</span><span class="id"> r</span>)<span class="id"> =</span><span class="id"> block_mx</span> (<span class="id">diag_mx</span><span class="id"> l</span>)<span class="id"> 0</span><span class="id"> 0</span> (<span class="id">diag_mx</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> ?[rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> -&gt;];</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> eq_shift</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mxP</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> d</span><span class="id"> :</span><span class="id"> 'rV_n,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> diag_mx</span><span class="id"> d</span>) (<span class="id">is_diag_mx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">is_diag_mxP</span><span class="id"> A</span>))<span class="id"> =&gt;</span><span class="id"> [Adiag|[d</span><span class="id"> -&gt;]</span><span class="id"> i</span><span class="id"> j</span><span class="id"> neq_ij];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -val_eqE</span> (<span class="id">negPf</span><span class="id"> neq_ij</span>).<br/>
<span class="gallina-kwd">exists</span> (<span class="id">\row_i</span><span class="id"> A</span><span class="id"> i</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">altP</span> (<span class="id">i</span><span class="id"> =P</span><span class="id"> j</span>))<span class="id"> =&gt;</span><span class="id"> [-&gt;|/Adiag-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mx_is_diag</span><span class="id"> n</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> 'rV[V]_n</span>)<span class="id"> :</span><span class="id"> is_diag_mx</span> (<span class="id">diag_mx</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/diag_mxP;</span><span class="gallina-kwd"> exists</span><span class="id"> r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mx_is_trig</span><span class="id"> n</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> 'rV[V]_n</span>)<span class="id"> :</span><span class="id"> is_trig_mx</span> (<span class="id">diag_mx</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/is_diag_mx_is_trig/diag_mx_is_diag</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> ScalarMx</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> scalar_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> scalar_mx</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 'M[V]_n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[scalar_mx_key]_</span>(<span class="id">i</span><span class="id"> ,</span><span class="id"> j</span>) (<span class="id">x</span><span class="id"> *+</span> (<span class="id">i</span><span class="id"> ==</span><span class="id"> j</span>)).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:M&quot;</span><span class="id"> :=</span> (<span class="id">scalar_mx</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_const_mx</span><span class="id"> a</span><span class="id"> :</span><span class="id"> diag_mx</span> (<span class="id">const_mx</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> a%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_scalar_mx</span><span class="id"> a</span><span class="id"> :</span> (<span class="id">a%:M</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> a%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eq_sym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_is_semi_additive</span><span class="id"> :</span><span class="id"> semi_additive</span><span class="id"> scalar_mx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|a</span><span class="id"> b];</span><span class="id"> rewrite</span><span class="id"> -!diag_const_mx</span><span class="id"> ?raddf0//</span><span class="id"> !raddfD</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> 'M_n</span><span class="id"> scalar_mx</span><br/>
&nbsp;&nbsp;<span class="id">scalar_mx_is_semi_additive</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> is_scalar_mx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> insub</span><span class="id"> 0</span><span class="id"> is</span><span class="id"> Some</span><span class="id"> i</span><span class="gallina-kwd"> then</span><span class="id"> A</span><span class="id"> ==</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> i</span>)<span class="id">%:M</span><span class="gallina-kwd"> else</span><span class="id"> true</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_scalar_mxP</span><span class="id"> A</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> a,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> a%:M</span>) (<span class="id">is_scalar_mx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /is_scalar_mx;</span><span class="id"> case:</span><span class="id"> insubP</span><span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> _</span><span class="id"> _</span><span class="id"> |</span><span class="id"> ]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> eqP</span>)<span class="id"> =&gt;</span><span class="id"> [|[a</span><span class="id"> -&gt;]];</span><span class="id"> [exists</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> i</span>)<span class="id"> |</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> eqxx]</span>.<br/>
<span class="id">rewrite</span><span class="id"> -eqn0Ngt</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> n0;</span><span class="id"> left;</span><span class="gallina-kwd"> exists</span><span class="id"> 0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> raddf0;</span><span class="id"> rewrite</span><span class="id"> n0</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> [A]flatmx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_is_scalar</span><span class="id"> a</span><span class="id"> :</span><span class="id"> is_scalar_mx</span><span class="id"> a%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_scalar_mxP;</span><span class="gallina-kwd"> exists</span><span class="id"> a</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx0_is_scalar</span><span class="id"> :</span><span class="id"> is_scalar_mx</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_scalar_mxP;</span><span class="gallina-kwd"> exists</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> raddf0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_is_diag</span><span class="id"> a</span><span class="id"> :</span><span class="id"> is_diag_mx</span> (<span class="id">a%:M</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -diag_const_mx</span><span class="id"> diag_mx_is_diag</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_scalar_mx_is_diag</span><span class="id"> A</span><span class="id"> :</span><span class="id"> is_scalar_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_diag_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /is_scalar_mxP[a</span><span class="id"> -&gt;];</span><span class="id"> apply:</span><span class="id"> scalar_mx_is_diag</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_is_trig</span><span class="id"> a</span><span class="id"> :</span><span class="id"> is_trig_mx</span> (<span class="id">a%:M</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> is_diag_mx_is_trig//</span><span class="id"> scalar_mx_is_diag</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_scalar_mx_is_trig</span><span class="id"> A</span><span class="id"> :</span><span class="id"> is_scalar_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_trig_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /is_scalar_mx_is_diag</span><span class="id"> /is_diag_mx_is_trig</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ScalarMx</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:M&quot;</span><span class="id"> :=</span> (<span class="id">scalar_mx</span><span class="id"> _</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mx11_scalar</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_1</span>)<span class="id"> :</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> 0</span><span class="id"> 0</span>)<span class="id">%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> ord1</span><span class="id"> mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_block</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a%:M</span><span class="id"> =</span><span class="id"> block_mx</span><span class="id"> a%:M</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> a%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 2![case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> !mxE];</span><span class="id"> rewrite</span><span class="id"> ?eq_shift</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Trace</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mxtrace</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[V]_n</span>)<span class="id"> :=</span><span class="id"> \sum_i</span><span class="id"> A</span><span class="id"> i</span><span class="id"> i</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;'\tr' A&quot;</span><span class="id"> :=</span> (<span class="id">mxtrace</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_tr</span><span class="id"> A</span><span class="id"> :</span><span class="id"> \tr</span><span class="id"> A^T</span><span class="id"> =</span><span class="id"> \tr</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eq_bigr=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_is_semi_additive</span><span class="id"> :</span><span class="id"> semi_additive</span><span class="id"> mxtrace</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|A</span><span class="id"> B]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> /mxtrace;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_const_idem</span><span class="id"> //=</span><span class="id"> addr0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -big_split</span><span class="id"> /=;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> 'M_n</span><span class="id"> V</span><span class="id"> mxtrace</span><br/>
&nbsp;&nbsp;<span class="id">mxtrace_is_semi_additive</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace0</span><span class="id"> :</span><span class="id"> \tr</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddf0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mxtraceD</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> \tr</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> \tr</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \tr</span><span class="id"> B</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_diag</span><span class="id"> D</span><span class="id"> :</span><span class="id"> \tr</span> (<span class="id">diag_mx</span><span class="id"> D</span>)<span class="id"> =</span><span class="id"> \sum_j</span><span class="id"> D</span><span class="id"> 0</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_scalar</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \tr</span><span class="id"> a%:M</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -diag_const_mx</span><span class="id"> mxtrace_diag;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sumr_const</span><span class="id"> card_ord</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Trace</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;'\tr' A&quot;</span><span class="id"> :=</span> (<span class="id">mxtrace</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trace_mx11</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_1</span>)<span class="id"> :</span><span class="id"> \tr</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span><span class="id"> 0</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {1}[A]mx11_scalar</span><span class="id"> mxtrace_scalar</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_block</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M_n1</span>)<span class="id"> Aur</span><span class="id"> Adl</span> (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M_n2</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\tr</span> (<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span>)<span class="id"> =</span><span class="id"> \tr</span><span class="id"> Aul</span><span class="id"> +</span><span class="id"> \tr</span><span class="id"> Adr</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /</span>(<span class="id">\tr</span><span class="id"> _</span>)<span class="id"> big_split_ord</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span> (<span class="id">block_mxEul,</span><span class="id"> block_mxEdr</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixNmodule</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> is_diag_mx</span><span class="id"> {V</span><span class="id"> m</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> is_diag_mxP</span><span class="id"> {V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> is_trig_mx</span><span class="id"> {V</span><span class="id"> m</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> is_trig_mxP</span><span class="id"> {V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> scalar_mx</span><span class="id"> {V</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> is_scalar_mxP</span><span class="id"> {V</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MapNmodMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aR</span><span class="id"> rR</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> rR}</span>) (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[aR]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx0</span><span class="id"> :</span><span class="id"> 0^f</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_const_mx</span><span class="id"> raddf0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mxD</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> A^f</span><span class="id"> +</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> raddfD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> map_mx_sum</span><span class="id"> :=</span><span class="id"> big_morph</span><span class="id"> _</span><span class="id"> map_mxD</span><span class="id"> map_mx0</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> 'M[aR]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'M[rR]_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">map_mx</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map_mx0,</span><span class="id"> map_mxD</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MapNmodMatrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixZmodule</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> zmodType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> oppmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> oppmx</span><span class="id"> :=</span><span class="id"> @map_mx</span><span class="id"> V</span><span class="id"> V</span><span class="id"> -%R</span><span class="id"> m</span><span class="id"> n</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addNmx</span><span class="id"> :</span><span class="id"> left_inverse</span> (<span class="id">const_mx</span><span class="id"> 0</span>)<span class="id"> oppmx</span> (<span class="id">@addmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> addNr</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">Nmodule_isZmodule</span>.<span class="id">Build</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;<span class="id">addNmx</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> const_mx_is_additive</span><span class="id"> :</span><span class="id"> additive</span><span class="id"> const_mx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> const_mx</span><br/>
&nbsp;&nbsp;<span class="id">const_mx_is_additive</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Additive</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> 'I_m</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> 'I_n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> swizzle_mx_is_additive</span><span class="id"> k</span><span class="id"> :</span><span class="id"> additive</span> (<span class="id">swizzle_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> B;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> k</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> q</span>)<br/>
&nbsp;&nbsp;(<span class="id">swizzle_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> k</span>) (<span class="id">swizzle_mx_is_additive</span><span class="id"> k</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Additive</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> SwizzleAdd</span><span class="id"> op</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">Additive</span>.<span class="id">copy</span><span class="id"> op</span> (<span class="id">swizzle_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@trmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@row</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@col</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@row'</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@col'</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@mxsub</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> f</span><span class="id"> g</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@row_perm</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@col_perm</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@xrow</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@xcol</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j1</span><span class="id"> j2</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@lsubmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@rsubmx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@usubmx</span><span class="id"> V</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@dsubmx</span><span class="id"> V</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> SwizzleAdd</span> (<span class="id">@vec_mx</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;<span class="id">mxvec</span> (<span class="id">can2_additive</span> (<span class="id">@vec_mxK</span><span class="id"> V</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> mxvecK</span>).<br/>
<br/>
<span class="vernacular">Ltac</span><span class="id"> split_mxE</span><span class="id"> :=</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> ![rewrite</span><span class="id"> mxE</span><span class="id"> |</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> opp_row_mx</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> row_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">-</span><span class="id"> A1</span>) (<span class="id">-</span><span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> opp_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> col_mx</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">-</span><span class="id"> A1</span>) (<span class="id">-</span><span class="id"> A2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> opp_block_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>))<span class="id"> Aur</span><span class="id"> Adl</span> (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> =</span><span class="id"> block_mx</span> (<span class="id">-</span><span class="id"> Aul</span>) (<span class="id">-</span><span class="id"> Aur</span>) (<span class="id">-</span><span class="id"> Adl</span>) (<span class="id">-</span><span class="id"> Adr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> opp_col_mx</span><span class="id"> !opp_row_mx</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mx_is_additive</span><span class="id"> n</span><span class="id"> :</span><span class="id"> additive</span> (<span class="id">@diag_mx</span><span class="id"> V</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;A</span><span class="id"> B;</span><span class="id"> apply/matrixP=&gt;i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulrnBl</span>.<br/>
Qed.</div></details>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> 'rV_n</span><span class="id"> 'M_n</span> (<span class="id">@diag_mx</span><span class="id"> V</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;(<span class="id">@diag_mx_is_additive</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ScalarMx</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_is_additive</span><span class="id"> :</span><span class="id"> additive</span> (<span class="id">@scalar_mx</span><span class="id"> V</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> -!diag_const_mx</span><span class="id"> !raddfB</span>. Qed.</div></details>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> 'M_n</span><span class="id"> scalar_mx</span><br/>
&nbsp;&nbsp;<span class="id">scalar_mx_is_additive</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ScalarMx</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Trace</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_is_additive</span><span class="id"> :</span><span class="id"> additive</span> (<span class="id">@mxtrace</span><span class="id"> V</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;A</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> -sumrN</span><span class="id"> -big_split</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> 'M_n</span><span class="id"> V</span> (<span class="id">@mxtrace</span><span class="id"> V</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;<span class="id">mxtrace_is_additive</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Trace</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixZmodule</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MapZmodMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aR</span><span class="id"> rR</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> rR}</span>) (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[aR]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mxN</span><span class="id"> A</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> -</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> raddfN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mxB</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> -</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> A^f</span><span class="id"> -</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_mxD</span><span class="id"> map_mxN</span>. Qed.</div></details>
<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isAdditive</span>.<span class="id">Build</span><span class="id"> 'M[aR]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'M[rR]_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">map_mx</span><span class="id"> f</span>)<span class="id"> map_mxB</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MapZmodMatrix</span>.<br/>
<br/>
<pre class="ssrdoc">
(*********** Matrix ring module, graded ring, and ring structures ***********
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixAlgebra</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiRingModule</span>.<br/>
<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> scalemx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> scalemx</span><span class="id"> x</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> \matrix[scalemx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> delta_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> delta_mx</span><span class="id"> i0</span><span class="id"> j0</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[delta_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>) ((<span class="id">i</span><span class="id"> ==</span><span class="id"> i0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">j</span><span class="id"> ==</span><span class="id"> j0</span>))<span class="id">%:R</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x *m: A&quot;</span><span class="id"> :=</span> (<span class="id">scalemx</span><span class="id"> x</span><span class="id"> A</span>) (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 40</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scale1mx</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> *m:</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemxDl</span><span class="id"> A</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> *m:</span><span class="id"> A</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *m:</span><span class="id"> A</span><span class="id"> +</span><span class="id"> y</span><span class="id"> *m:</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulrDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemxDr</span><span class="id"> x</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *m:</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *m:</span><span class="id"> A</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *m:</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulrDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemxA</span><span class="id"> x</span><span class="id"> y</span><span class="id"> A</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *m:</span> (<span class="id">y</span><span class="id"> *m:</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> *m:</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SemiRingModule</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_delta</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> j</span><span class="id"> i</span><span class="id"> :&gt;</span><span class="id"> 'M[R]_</span>(<span class="id">n,</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> andbC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> delta_mx_lshift</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">delta_mx</span><span class="id"> i</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> splitK</span>) (<span class="id">unsplitK</span> (<span class="id">inl</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> ?andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> delta_mx_rshift</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">delta_mx</span><span class="id"> i</span> (<span class="id">rshift</span><span class="id"> n1</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> row_mx</span><span class="id"> 0</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span><span class="id"> +</span><span class="id"> n2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> splitK</span>) (<span class="id">unsplitK</span> (<span class="id">inr</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> ?andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> delta_mx_ushift</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">delta_mx</span> (<span class="id">lshift</span><span class="id"> m2</span><span class="id"> i</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> splitK</span>) (<span class="id">unsplitK</span> (<span class="id">inl</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span> <span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> delta_mx_dshift</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">delta_mx</span> (<span class="id">rshift</span><span class="id"> m1</span><span class="id"> i</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> col_mx</span><span class="id"> 0</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m1</span><span class="id"> +</span><span class="id"> m2,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> splitK</span>) (<span class="id">unsplitK</span> (<span class="id">inr</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> vec_mx_delta</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">vec_mx</span> (<span class="id">delta_mx</span><span class="id"> 0</span> (<span class="id">mxvec_index</span><span class="id"> i</span><span class="id"> j</span>))<span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> /=</span><span class="id"> [_</span><span class="id"> ==</span><span class="id"> _]</span>(<span class="id">inj_eq</span><span class="id"> enum_rank_inj</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvec_delta</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxvec</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> 0</span> (<span class="id">mxvec_index</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> :&gt;</span><span class="id"> 'rV_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -vec_mx_delta</span><span class="id"> vec_mxK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Ltac</span><span class="id"> split_mxE</span><span class="id"> :=</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> do</span><span class="id"> ![rewrite</span><span class="id"> mxE</span><span class="id"> |</span><span class="id"> case:</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> ?]</span>.<br/>
<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:M&quot;</span><span class="id"> :=</span> (<span class="id">scalar_mx</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx1</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">1%:M</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> :&gt;</span><span class="id"> 'M[R]_n</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> tr_scalar_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row1</span><span class="id"> n</span><span class="id"> i</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> 0</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eq_sym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col1</span><span class="id"> n</span><span class="id"> i</span><span class="id"> :</span><span class="id"> col</span><span class="id"> i</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> i</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eqxx</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> mulmx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> mulmx</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> p}</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> p</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[mulmx_key]_</span>(<span class="id">i,</span><span class="id"> k</span>)<span class="id"> \sum_j</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *</span><span class="id"> B</span><span class="id"> j</span><span class="id"> k</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A *m B&quot;</span><span class="id"> :=</span> (<span class="id">mulmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxA</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span> (<span class="id">B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> l</span><span class="id"> /[!mxE];</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> big_distrr/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> exchange_big;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> big_distrl</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul0mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><span class="id"> 0</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> big1</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> mul0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> big1</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> mulr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxDl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A1</span><span class="id"> +</span><span class="id"> A2</span>)<span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> A1</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> +</span><span class="id"> A2</span><span class="id"> *m</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -big_split</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -mulrDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxDr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B1</span><span class="id"> B2</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span> (<span class="id">B1</span><span class="id"> +</span><span class="id"> B2</span>)<span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B1</span><span class="id"> +</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -big_split</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> mulrDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_suml</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span>)<span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">big_morph</span> (<span class="id">mulmx^~</span><span class="id"> A</span>))<span class="id"> =&gt;</span><span class="id"> [B</span><span class="id"> C|];</span><span class="id"> rewrite</span><span class="id"> ?mul0mx</span><span class="id"> ?mulmxDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_sumr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> *m</span><span class="id"> B_</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">big_morph</span> (<span class="id">mulmx</span><span class="id"> A</span>))<span class="id"> =&gt;</span><span class="id"> [B</span><span class="id"> C|];</span><span class="id"> rewrite</span><span class="id"> ?mulmx0</span><span class="id"> ?mulmxDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowE</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/rowP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">bigD1_ord</span><span class="id"> i</span>)<span class="id"> //=</span><span class="id"> mxE</span><span class="id"> !eqxx</span><span class="id"> mul1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> /=</span><span class="id"> lift_eqF</span><span class="id"> mul0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> colE</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> col</span><span class="id"> i</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> delta_mx</span><span class="id"> i</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/colP=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">bigD1_ord</span><span class="id"> i</span>)<span class="id"> //=</span><span class="id"> mxE</span><span class="id"> !eqxx</span><span class="id"> mulr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> /=</span><span class="id"> lift_eqF</span><span class="id"> mulr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_rVP</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span>((<span class="id">@mulmx</span><span class="id"> 1</span><span class="id"> m</span><span class="id"> n</span>)<span class="id">^~</span><span class="id"> A</span><span class="id"> =1</span><span class="id"> mulmx^~</span><span class="id"> B</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">A</span><span class="id"> =</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [eqAB|-&gt;//];</span><span class="id"> apply/row_matrixP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !rowE</span><span class="id"> eqAB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mul</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">i</span><span class="id"> :</span><span class="id"> 'I_m</span>)<span class="id"> A</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !rowE</span><span class="id"> mulmxA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsub_mul</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> n'</span><span class="id"> p</span><span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsub</span><span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> colsub</span><span class="id"> g</span><span class="id"> B</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split_mxE;</span><span class="id"> under</span><span class="id"> [RHS]eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_rowsub_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> m'</span><span class="id"> p</span><span class="id"> f</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> rowsub</span><span class="id"> f</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxsub_mul</span><span class="id"> mxsub_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_colsub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> n'</span><span class="id"> p</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> colsub</span><span class="id"> g</span><span class="id"> B</span><span class="id"> =</span><span class="id"> colsub</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxsub_mul</span><span class="id"> mxsub_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_delta_mx_cond</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">j1</span><span class="id"> j2</span><span class="id"> :</span><span class="id"> 'I_n</span>) (<span class="id">i1</span><span class="id"> :</span><span class="id"> 'I_m</span>) (<span class="id">k2</span><span class="id"> :</span><span class="id"> 'I_p</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">delta_mx</span><span class="id"> i1</span><span class="id"> j1</span><span class="id"> *m</span><span class="id"> delta_mx</span><span class="id"> j2</span><span class="id"> k2</span><span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> i1</span><span class="id"> k2</span><span class="id"> *+</span> (<span class="id">j1</span><span class="id"> ==</span><span class="id"> j2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">bigD1_ord</span><span class="id"> j1</span>)<span class="id"> //=</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmxnE</span><span class="id"> !mxE</span><span class="id"> !eqxx</span><span class="id"> andbT</span><span class="id"> -natrM</span><span class="id"> -mulrnA</span><span class="id"> !mulnb</span><span class="id"> !andbA</span><span class="id"> andbAC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> andbC</span><span class="id"> -natrM</span><span class="id"> lift_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_delta_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">j</span><span class="id"> :</span><span class="id"> 'I_n</span>) (<span class="id">i</span><span class="id"> :</span><span class="id"> 'I_m</span>) (<span class="id">k</span><span class="id"> :</span><span class="id"> 'I_p</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> delta_mx</span><span class="id"> j</span><span class="id"> k</span><span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> i</span><span class="id"> k</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_delta_mx_cond</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_delta_mx_0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">j1</span><span class="id"> j2</span><span class="id"> :</span><span class="id"> 'I_n</span>) (<span class="id">i1</span><span class="id"> :</span><span class="id"> 'I_m</span>) (<span class="id">k2</span><span class="id"> :</span><span class="id"> 'I_p</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">j1</span><span class="id"> !=</span><span class="id"> j2</span><span class="id"> -&gt;</span><span class="id"> delta_mx</span><span class="id"> i1</span><span class="id"> j1</span><span class="id"> *m</span><span class="id"> delta_mx</span><span class="id"> j2</span><span class="id"> k2</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_delta_mx_cond</span><span class="id"> =&gt;</span><span class="id"> /negPf-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_diag_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> d</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">diag_mx</span><span class="id"> d</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \matrix_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">d</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> *</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //=</span><span class="id"> mxE</span><span class="id"> eqxx</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i'</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> eq_sym</span><span class="id"> mulrnAl</span><span class="id"> =&gt;</span><span class="id"> /negPf-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mx_diag</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> d</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> diag_mx</span><span class="id"> d</span><span class="id"> =</span><span class="id"> \matrix_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *</span><span class="id"> d</span><span class="id"> 0</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">bigD1</span><span class="id"> j</span>)<span class="id"> //=</span><span class="id"> mxE</span><span class="id"> eqxx</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i'</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> eq_sym</span><span class="id"> mulrnAr;</span><span class="id"> move/negPf-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_diag</span><span class="id"> n</span> (<span class="id">d</span><span class="id"> e</span><span class="id"> :</span><span class="id"> 'rV_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">diag_mx</span><span class="id"> d</span><span class="id"> *m</span><span class="id"> diag_mx</span><span class="id"> e</span><span class="id"> =</span><span class="id"> diag_mx</span> (<span class="id">\row_j</span> (<span class="id">d</span><span class="id"> 0</span><span class="id"> j</span><span class="id"> *</span><span class="id"> e</span><span class="id"> 0</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mul_diag_mx</span><span class="id"> !mxE</span><span class="id"> mulrnAr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mxM</span><span class="id"> n</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id">%:M</span><span class="id"> =</span><span class="id"> a%:M</span><span class="id"> *m</span><span class="id"> b%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[in</span><span class="id"> RHS]diag_const_mx</span><span class="id"> mul_diag_mx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulrnAr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul1mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 1%:M</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -diag_const_mx</span><span class="id"> mul_diag_mx;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx1</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> 1%:M</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -diag_const_mx</span><span class="id"> mul_mx_diag;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowsubE</span><span class="id"> m</span><span class="id"> m'</span><span class="id"> n</span><span class="id"> f</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> =</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> 1%:M</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m',</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_rowsub_mx</span><span class="id"> mul1mx</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_col_perm</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> s</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col_perm</span><span class="id"> s</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> row_perm</span><span class="id"> s^-1</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">reindex_perm</span><span class="id"> s^-1</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> permKV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_row_perm</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> s</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> row_perm</span><span class="id"> s</span><span class="id"> B</span><span class="id"> =</span><span class="id"> col_perm</span><span class="id"> s^-1</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_col_perm</span><span class="id"> invgK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_xcol</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> j1</span><span class="id"> j2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> xrow</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_col_perm</span><span class="id"> tpermV</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> perm_mx</span><span class="id"> n</span><span class="id"> s</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><span class="id"> row_perm</span><span class="id"> s</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> tperm_mx</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><span class="id"> perm_mx</span> (<span class="id">tperm</span><span class="id"> i1</span><span class="id"> i2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_permE</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> col_perm</span><span class="id"> s</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> perm_mx</span><span class="id"> s^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_row_perm</span><span class="id"> mulmx1</span><span class="id"> invgK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_permE</span><span class="id"> m</span><span class="id"> n</span><span class="id"> s</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_perm</span><span class="id"> s</span><span class="id"> A</span><span class="id"> =</span><span class="id"> perm_mx</span><span class="id"> s</span><span class="id"> *m</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[perm_mx</span><span class="id"> _]mul1mx</span><span class="id"> mul_row_perm</span><span class="id"> mulmx1</span><span class="id"> -mul_row_perm</span><span class="id"> mul1mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> xcolE</span><span class="id"> m</span><span class="id"> n</span><span class="id"> j1</span><span class="id"> j2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> xcol</span><span class="id"> j1</span><span class="id"> j2</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> tperm_mx</span><span class="id"> j1</span><span class="id"> j2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /xcol</span><span class="id"> col_permE</span><span class="id"> tpermV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> xrowE</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> xrow</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> A</span><span class="id"> =</span><span class="id"> tperm_mx</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> *m</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_permE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> perm_mxEsub</span><span class="id"> n</span><span class="id"> s</span><span class="id"> :</span><span class="id"> @perm_mx</span><span class="id"> n</span><span class="id"> s</span><span class="id"> =</span><span class="id"> rowsub</span><span class="id"> s</span><span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /perm_mx</span><span class="id"> row_permEsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tperm_mxEsub</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span><span class="id"> @tperm_mx</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">tperm</span><span class="id"> i1</span><span class="id"> i2</span>)<span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /tperm_mx</span><span class="id"> perm_mxEsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_perm_mx</span><span class="id"> n</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> :</span> (<span class="id">perm_mx</span><span class="id"> s</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> perm_mx</span><span class="id"> s^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[_^T]mulmx1</span><span class="id"> tr_row_perm</span><span class="id"> mul_col_perm</span><span class="id"> trmx1</span><span class="id"> mul1mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_tperm_mx</span><span class="id"> n</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span> (<span class="id">tperm_mx</span><span class="id"> i1</span><span class="id"> i2</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> tperm_mx</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> tr_perm_mx</span><span class="id"> tpermV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> perm_mx1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> perm_mx</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_perm1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> perm_mxM</span><span class="id"> n</span> (<span class="id">s</span><span class="id"> t</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> :</span><span class="id"> perm_mx</span> (<span class="id">s</span><span class="id"> *</span><span class="id"> t</span>)<span class="id"> =</span><span class="id"> perm_mx</span><span class="id"> s</span><span class="id"> *m</span><span class="id"> perm_mx</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -row_permE</span><span class="id"> -row_permM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> is_perm_mx</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :=</span><span class="id"> [exists</span><span class="id"> s,</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> perm_mx</span><span class="id"> s]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_perm_mxP</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> s,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> perm_mx</span><span class="id"> s</span>) (<span class="id">is_perm_mx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> existsP</span>)<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [s</span><span class="id"> /eqP];</span><span class="gallina-kwd"> exists</span><span class="id"> s</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> perm_mx_is_perm</span><span class="id"> n</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> :</span><span class="id"> is_perm_mx</span> (<span class="id">perm_mx</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/is_perm_mxP;</span><span class="gallina-kwd"> exists</span><span class="id"> s</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_perm_mx1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> is_perm_mx</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M_n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -perm_mx1</span><span class="id"> perm_mx_is_perm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_perm_mxMl</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_perm_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> is_perm_mx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> is_perm_mx</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/is_perm_mxP=&gt;</span><span class="id"> s</span><span class="id"> -&gt;</span>.<br/>
<span class="id">apply/is_perm_mxP/is_perm_mxP=&gt;</span><span class="id"> [[t</span><span class="id"> def_t]</span><span class="id"> |</span><span class="id"> [t</span><span class="id"> -&gt;]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">s</span><span class="id"> *</span><span class="id"> t</span>)<span class="id">%g;</span><span class="id"> rewrite</span><span class="id"> perm_mxM</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">s^-1</span><span class="id"> *</span><span class="id"> t</span>)<span class="id">%g</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> perm_mxM</span><span class="id"> -def_t</span><span class="id"> -!row_permE</span><span class="id"> -row_permM</span><span class="id"> mulVg</span><span class="id"> row_perm1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_perm_mx_tr</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> is_perm_mx</span><span class="id"> A^T</span><span class="id"> =</span><span class="id"> is_perm_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/is_perm_mxP/is_perm_mxP=&gt;</span><span class="id"> [[t</span><span class="id"> def_t]</span><span class="id"> |</span><span class="id"> [t</span><span class="id"> -&gt;]];</span><span class="gallina-kwd"> exists</span><span class="id"> t^-1%g</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -tr_perm_mx</span><span class="id"> -def_t</span><span class="id"> trmxK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> tr_perm_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_perm_mxMr</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_perm_mx</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> is_perm_mx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> is_perm_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/is_perm_mxP=&gt;</span><span class="id"> s</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[s]invgK</span><span class="id"> -col_permE</span><span class="id"> -is_perm_mx_tr</span><span class="id"> tr_col_perm</span><span class="id"> row_permE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_perm_mxMl</span> (<span class="id">perm_mx_is_perm,</span><span class="id"> is_perm_mx_tr</span>).<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pid_mx_key</span><span class="id"> :</span><span class="id"> unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> pid_mx</span><span class="id"> {m</span><span class="id"> n}</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix[pid_mx_key]_</span>(<span class="id">i,</span><span class="id"> j</span>) ((<span class="id">i</span><span class="id"> ==</span><span class="id"> j</span><span class="id"> :&gt;</span><span class="id"> nat</span>)<span class="id"> &amp;&amp;</span> (<span class="id">i</span><span class="id"> &lt;</span><span class="id"> r</span>))<span class="id">%:R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> pid_mx</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> andbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_1</span><span class="id"> r</span><span class="id"> :</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> ltn_ord</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_row</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> =</span><span class="id"> row_mx</span><span class="id"> 1%:M</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">r,</span><span class="id"> r</span><span class="id"> +</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> ltn_ord</span><span class="id"> andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> !mxE//</span> (<span class="id">val_eqE</span> (<span class="id">lshift</span><span class="id"> n</span><span class="id"> i</span>))<span class="id"> eq_shift</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_col</span><span class="id"> m</span><span class="id"> r</span><span class="id"> :</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> =</span><span class="id"> col_mx</span><span class="id"> 1%:M</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">r</span><span class="id"> +</span><span class="id"> m,</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> andbC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> !mxE//</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_block</span><span class="id"> m</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> =</span><span class="id"> block_mx</span><span class="id"> 1%:M</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">r</span><span class="id"> +</span><span class="id"> m,</span><span class="id"> r</span><span class="id"> +</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> row_mx0</span><span class="id"> andbC</span>.<br/>
<span class="id">do</span><span class="id"> ![case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> -&gt;</span><span class="id"> /[!mxE]//]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">val_eqE</span> (<span class="id">lshift</span><span class="id"> n</span><span class="id"> _</span>))<span class="id"> eq_shift</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_pid_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">pid_mx</span><span class="id"> r</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!mxE];</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_minv</span><span class="id"> m</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> pid_mx</span> (<span class="id">minn</span><span class="id"> m</span><span class="id"> r</span>)<span class="id"> =</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> leq_min</span><span class="id"> ltn_ord</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_minh</span><span class="id"> m</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> pid_mx</span> (<span class="id">minn</span><span class="id"> n</span><span class="id"> r</span>)<span class="id"> =</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> !tr_pid_mx</span><span class="id"> pid_mx_minv</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_pid_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">pid_mx</span><span class="id"> q</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> *m</span> (<span class="id">pid_mx</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> =</span><span class="id"> pid_mx</span> (<span class="id">minn</span><span class="id"> n</span> (<span class="id">minn</span><span class="id"> q</span><span class="id"> r</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !leq_min</span>.<br/>
<span class="id">have</span><span class="id"> [le_n_i</span><span class="id"> |</span><span class="id"> lt_i_n]</span><span class="id"> :=</span><span class="id"> leqP</span><span class="id"> n</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> andbF</span><span class="id"> big1</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -pid_mx_minh</span><span class="id"> !mxE</span><span class="id"> leq_min</span><span class="id"> ltnNge</span><span class="id"> le_n_i</span><span class="id"> andbF</span><span class="id"> mul0r</span>.<br/>
<span class="id">rewrite</span> (<span class="id">bigD1</span> (<span class="id">Ordinal</span><span class="id"> lt_i_n</span>))<span class="id"> //=</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> =&gt;</span><span class="id"> [|j]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eqxx</span><span class="id"> /=</span><span class="id"> -natrM</span><span class="id"> mulnb</span><span class="id"> andbCA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -val_eqE</span><span class="id"> /=</span><span class="id"> !mxE</span><span class="id"> eq_sym</span><span class="id"> -natrM</span><span class="id"> =&gt;</span><span class="id"> /negPf-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mx_id</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> r</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">r</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">pid_mx</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> *m</span> (<span class="id">pid_mx</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> =</span><span class="id"> pid_mx</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> le_r_n;</span><span class="id"> rewrite</span><span class="id"> mul_pid_mx</span><span class="id"> minnn</span> (<span class="id">minn_idPr</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mxErow</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">le_mn</span><span class="id"> :</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">pid_mx</span><span class="id"> m</span><span class="id"> =</span><span class="id"> rowsub</span> (<span class="id">widen_ord</span><span class="id"> le_mn</span>)<span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -!val_eqE/=</span><span class="id"> ltn_ord</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pid_mxEcol</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">le_mn</span><span class="id"> :</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">pid_mx</span><span class="id"> n</span><span class="id"> =</span><span class="id"> colsub</span> (<span class="id">widen_ord</span><span class="id"> le_mn</span>)<span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -!val_eqE/=</span><span class="id"> ltn_ord</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mx_row</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p1</span><span class="id"> p2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">Bl</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p1</span>)) (<span class="id">Br</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> row_mx</span><span class="id"> Bl</span><span class="id"> Br</span><span class="id"> =</span><span class="id"> row_mx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> Bl</span>) (<span class="id">A</span><span class="id"> *m</span><span class="id"> Br</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> defk:</span> (<span class="id">split</span><span class="id"> k</span>)<span class="id"> =&gt;</span><span class="id"> /[!mxE];</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> defk</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_col_mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">Au</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">Ad</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col_mx</span><span class="id"> Au</span><span class="id"> Ad</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> col_mx</span> (<span class="id">Au</span><span class="id"> *m</span><span class="id"> B</span>) (<span class="id">Ad</span><span class="id"> *m</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> defi:</span> (<span class="id">split</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> /[!mxE];</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> defi</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_row_col</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> p</span> (<span class="id">Al</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">Ar</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bu</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n1,</span><span class="id"> p</span>)) (<span class="id">Bd</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_mx</span><span class="id"> Al</span><span class="id"> Ar</span><span class="id"> *m</span><span class="id"> col_mx</span><span class="id"> Bu</span><span class="id"> Bd</span><span class="id"> =</span><span class="id"> Al</span><span class="id"> *m</span><span class="id"> Bu</span><span class="id"> +</span><span class="id"> Ar</span><span class="id"> *m</span><span class="id"> Bd</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> big_split_ord</span><span class="id"> /=</span>.<br/>
<span class="id">congr</span> (_<span class="id"> +</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> row_mxEl</span><span class="id"> col_mxEu</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> row_mxEr</span><span class="id"> col_mxEd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_col_row</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p1</span><span class="id"> p2</span> (<span class="id">Au</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">Ad</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bl</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p1</span>)) (<span class="id">Br</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col_mx</span><span class="id"> Au</span><span class="id"> Ad</span><span class="id"> *m</span><span class="id"> row_mx</span><span class="id"> Bl</span><span class="id"> Br</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> block_mx</span> (<span class="id">Au</span><span class="id"> *m</span><span class="id"> Bl</span>) (<span class="id">Au</span><span class="id"> *m</span><span class="id"> Br</span>) (<span class="id">Ad</span><span class="id"> *m</span><span class="id"> Bl</span>) (<span class="id">Ad</span><span class="id"> *m</span><span class="id"> Br</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_col_mx</span><span class="id"> !mul_mx_row</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_row_block</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> p1</span><span class="id"> p2</span> (<span class="id">Al</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>)) (<span class="id">Ar</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n1,</span><span class="id"> p1</span>)) (<span class="id">Bur</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n1,</span><span class="id"> p2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bdl</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p1</span>)) (<span class="id">Bdr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_mx</span><span class="id"> Al</span><span class="id"> Ar</span><span class="id"> *m</span><span class="id"> block_mx</span><span class="id"> Bul</span><span class="id"> Bur</span><span class="id"> Bdl</span><span class="id"> Bdr</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> row_mx</span> (<span class="id">Al</span><span class="id"> *m</span><span class="id"> Bul</span><span class="id"> +</span><span class="id"> Ar</span><span class="id"> *m</span><span class="id"> Bdl</span>) (<span class="id">Al</span><span class="id"> *m</span><span class="id"> Bur</span><span class="id"> +</span><span class="id"> Ar</span><span class="id"> *m</span><span class="id"> Bdr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> block_mxEh</span><span class="id"> mul_mx_row</span><span class="id"> !mul_row_col</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_block_col</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> p</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bu</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n1,</span><span class="id"> p</span>)) (<span class="id">Bd</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> *m</span><span class="id"> col_mx</span><span class="id"> Bu</span><span class="id"> Bd</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> col_mx</span> (<span class="id">Aul</span><span class="id"> *m</span><span class="id"> Bu</span><span class="id"> +</span><span class="id"> Aur</span><span class="id"> *m</span><span class="id"> Bd</span>) (<span class="id">Adl</span><span class="id"> *m</span><span class="id"> Bu</span><span class="id"> +</span><span class="id"> Adr</span><span class="id"> *m</span><span class="id"> Bd</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_col_mx</span><span class="id"> !mul_row_col</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_block</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> p1</span><span class="id"> p2</span> (<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n1</span>)) (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n1</span>)) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bul</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n1,</span><span class="id"> p1</span>)) (<span class="id">Bur</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n1,</span><span class="id"> p2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Bdl</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p1</span>)) (<span class="id">Bdr</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p2</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> Adl</span><span class="id"> Adr</span><span class="id"> *m</span><span class="id"> block_mx</span><span class="id"> Bul</span><span class="id"> Bur</span><span class="id"> Bdl</span><span class="id"> Bdr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> block_mx</span> (<span class="id">Aul</span><span class="id"> *m</span><span class="id"> Bul</span><span class="id"> +</span><span class="id"> Aur</span><span class="id"> *m</span><span class="id"> Bdl</span>) (<span class="id">Aul</span><span class="id"> *m</span><span class="id"> Bur</span><span class="id"> +</span><span class="id"> Aur</span><span class="id"> *m</span><span class="id"> Bdr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Adl</span><span class="id"> *m</span><span class="id"> Bul</span><span class="id"> +</span><span class="id"> Adr</span><span class="id"> *m</span><span class="id"> Bdl</span>) (<span class="id">Adl</span><span class="id"> *m</span><span class="id"> Bur</span><span class="id"> +</span><span class="id"> Adr</span><span class="id"> *m</span><span class="id"> Bdr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_col_mx</span><span class="id"> !mul_row_block</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_lsub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> k</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span><span class="id"> +</span><span class="id"> k</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> lsubmx</span><span class="id"> B</span><span class="id"> =</span><span class="id"> lsubmx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lsubmxEsub</span><span class="id"> mulmx_colsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_rsub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> k</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span><span class="id"> +</span><span class="id"> k</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> rsubmx</span><span class="id"> B</span><span class="id"> =</span><span class="id"> rsubmx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !rsubmxEsub</span><span class="id"> mulmx_colsub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_usub_mx</span><span class="id"> m</span><span class="id"> k</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m</span><span class="id"> +</span><span class="id"> k,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">usubmx</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> usubmx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !usubmxEsub</span><span class="id"> mul_rowsub_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_dsub_mx</span><span class="id"> m</span><span class="id"> k</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m</span><span class="id"> +</span><span class="id"> k,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">dsubmx</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> dsubmx</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !dsubmxEsub</span><span class="id"> mul_rowsub_mx</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Trace</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;'\tr' A&quot;</span><span class="id"> :=</span> (<span class="id">mxtrace</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace1</span><span class="id"> :</span><span class="id"> \tr</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> =</span><span class="id"> n%:R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxtrace_scalar</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Trace</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixSemiRing</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> 'M[R]_n</span><br/>
&nbsp;&nbsp;(<span class="id">@mulmxA</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@mul1mx</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@mulmx1</span><span class="id"> n</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;(<span class="id">@mulmxDl</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@mulmxDr</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@mul0mx</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@mulmx0</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxE</span><span class="id"> :</span><span class="id"> mulmx</span><span class="id"> =</span><span class="id"> *%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> idmxE</span><span class="id"> :</span><span class="id"> 1%:M</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_is_multiplicative</span><span class="id"> :</span><span class="id"> multiplicative</span> (<span class="id">@scalar_mx</span><span class="id"> R</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> scalar_mxM</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isMultiplicative</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> 'M_n</span> (<span class="id">@scalar_mx</span><span class="id"> _</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;<span class="id">scalar_mx_is_multiplicative</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixSemiRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LiftPerm</span>.<br/>
<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lift0_perm</span><span class="id"> s</span><span class="id"> :</span><span class="id"> 'S_n</span>.<span class="id">+1</span><span class="id"> :=</span><span class="id"> lift_perm</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> s</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lift0_perm0</span><span class="id"> s</span><span class="id"> :</span><span class="id"> lift0_perm</span><span class="id"> s</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> lift_perm_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lift0_perm_lift</span><span class="id"> s</span><span class="id"> k'</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">lift0_perm</span><span class="id"> s</span> (<span class="id">lift</span><span class="id"> 0</span><span class="id"> k'</span>)<span class="id"> =</span><span class="id"> lift</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'I_n</span>.<span class="id">+1</span>) (<span class="id">s</span><span class="id"> k'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> lift_perm_lift</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lift0_permK</span><span class="id"> s</span><span class="id"> :</span><span class="id"> cancel</span> (<span class="id">lift0_perm</span><span class="id"> s</span>) (<span class="id">lift0_perm</span><span class="id"> s^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /lift0_perm</span><span class="id"> -lift_permV</span><span class="id"> permK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lift0_perm_eq0</span><span class="id"> s</span><span class="id"> i</span><span class="id"> :</span> (<span class="id">lift0_perm</span><span class="id"> s</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">i</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">canF_eq</span> (<span class="id">lift0_permK</span><span class="id"> s</span>))<span class="id"> lift0_perm0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lift0_mx</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> 1</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lift0_mx_perm</span><span class="id"> s</span><span class="id"> :</span><span class="id"> lift0_mx</span> (<span class="id">perm_mx</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> perm_mx</span> (<span class="id">lift0_perm</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> /=</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> split1</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [i'|]</span><span class="id"> -&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> lift0_perm_lift</span><span class="id"> !mxE</span><span class="id"> split1</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [j'|]</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">inj_eq</span> (<span class="id">lift_inj</span><span class="id"> _</span>))<span class="id"> /=</span><span class="id"> !mxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> lift0_perm0</span><span class="id"> !mxE</span><span class="id"> split1</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [j'|]</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lift0_mx_is_perm</span><span class="id"> s</span><span class="id"> :</span><span class="id"> is_perm_mx</span> (<span class="id">lift0_mx</span> (<span class="id">perm_mx</span><span class="id"> s</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lift0_mx_perm</span><span class="id"> perm_mx_is_perm</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LiftPerm</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exp_block_diag_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A:</span><span class="id"> 'M_m</span>.<span class="id">+1</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_n</span>.<span class="id">+1</span>)<span class="id"> k</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">block_mx</span><span class="id"> A</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> B</span>)<span class="id"> ^+</span><span class="id"> k</span><span class="id"> =</span><span class="id"> block_mx</span> (<span class="id">A</span><span class="id"> ^+</span><span class="id"> k</span>)<span class="id"> 0</span><span class="id"> 0</span> (<span class="id">B</span><span class="id"> ^+</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> k=&gt;</span><span class="id"> [|k</span><span class="id"> IHk];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expr0</span><span class="id"> -scalar_mx_block</span>.<br/>
<span class="id">rewrite</span><span class="id"> !exprS</span><span class="id"> IHk</span><span class="id"> [LHS]</span>(<span class="id">mulmx_block</span><span class="id"> A</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">A</span><span class="id"> ^+</span><span class="id"> k</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulmx0</span><span class="id"> !mul0mx</span><span class="id"> !add0r</span><span class="id"> !addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixAlgebra</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> delta_mx</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> perm_mx</span><span class="id"> {R</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> tperm_mx</span><span class="id"> {R</span><span class="id"> n}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> pid_mx</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span>.<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> diag_mx</span><span class="id"> is_scalar_mx</span>.<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> mulmx</span><span class="id"> mxtrace</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> mul_delta_mx</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p}</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">is_diag_mx</span> (<span class="id">scalar_mx</span><span class="id"> _</span>)))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> scalar_mx_is_diag</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">is_trig_mx</span> (<span class="id">scalar_mx</span><span class="id"> _</span>)))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> scalar_mx_is_trig</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">is_diag_mx</span> (<span class="id">diag_mx</span><span class="id"> _</span>)))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> diag_mx_is_diag</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">is_trig_mx</span> (<span class="id">diag_mx</span><span class="id"> _</span>)))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> diag_mx_is_trig</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;a %:M&quot;</span><span class="id"> :=</span> (<span class="id">scalar_mx</span><span class="id"> a</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A *m B&quot;</span><span class="id"> :=</span> (<span class="id">mulmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\tr A&quot;</span><span class="id"> :=</span> (<span class="id">mxtrace</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_mul_rev</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id">^T</span><span class="id"> =</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[R^c]_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id">^T</span><span class="id"> *m</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R^c]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id">^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> k</span><span class="id"> i</span><span class="id"> /[!mxE];</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span><span class="id"> /[!mxE]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixNzSemiRing</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>) (<span class="id">n'</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> n'</span>.<span class="id">+1</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> matrix_nonzero1</span><span class="id"> :</span><span class="id"> 1%:M</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M[R]_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP=&gt;</span><span class="id"> /matrixP/</span>(_<span class="id"> 0</span><span class="id"> 0</span>)<span class="id">/eqP;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">PzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> 'M[R]_n</span><span class="id"> matrix_nonzero1</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixNzSemiRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> countNmodType</span>)<span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[Countable</span><span class="id"> of</span><span class="id"> 'M[M]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> countNzSemiRingType</span>)<span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[Countable</span><span class="id"> of</span><span class="id"> 'M[R]_n</span>.<span class="id">+1</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinNmodMatrix</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> finNmodType</span>) (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> MV</span><span class="id"> :=</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> [Finite</span><span class="id"> of</span><span class="id"> MV</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FinNmodMatrix</span>.<br/>
<br/>
<span class="id">#[compress_coercions,</span><span class="id"> warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> finNzSemiRingType</span>) (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">FinRing</span>.<span class="id">Nmodule</span>.<span class="id">on</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="id">#[compress_coercions]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> finNzSemiRingType</span>)<span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[Finite</span><span class="id"> of</span><span class="id"> 'M[R]_n</span>.<span class="id">+1</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MapNzSemiRingMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aR</span><span class="id"> rR</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> rR}</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FixedSize</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[aR]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mxM</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> A^f</span><span class="id"> *m</span><span class="id"> B^f</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorph_sum</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorphM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_delta_mx</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> delta_mx</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i'</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorph_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_diag_mx</span><span class="id"> d</span><span class="id"> :</span> (<span class="id">diag_mx</span><span class="id"> d</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> diag_mx</span><span class="id"> d^f</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorphMn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_scalar_mx</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a%:M^f</span><span class="id"> =</span> (<span class="id">f</span><span class="id"> a</span>)<span class="id">%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorphMn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx1</span><span class="id"> :</span><span class="id"> 1%:M^f</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_scalar_mx</span><span class="id"> rmorph1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_perm_mx</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> :</span> (<span class="id">perm_mx</span><span class="id"> s</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> perm_mx</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorph_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_tperm_mx</span> (<span class="id">i1</span><span class="id"> i2</span><span class="id"> :</span><span class="id"> 'I_n</span>)<span class="id"> :</span> (<span class="id">tperm_mx</span><span class="id"> i1</span><span class="id"> i2</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> tperm_mx</span><span class="id"> i1</span><span class="id"> i2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> map_perm_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_pid_mx</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">pid_mx</span><span class="id"> r</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> pid_mx</span><span class="id"> r</span><span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rmorph_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trace_map_mx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> \tr</span><span class="id"> A^f</span><span class="id"> =</span><span class="id"> f</span> (<span class="id">\tr</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph_sum;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FixedSize</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_is_multiplicative</span><span class="id"> n</span><span class="id"> :</span><span class="id"> multiplicative</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split;</span><span class="id"> [apply:</span><span class="id"> map_mxM</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> map_mx1]</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isMultiplicative</span>.<span class="id">Build</span><span class="id"> 'M[aR]_n</span><span class="id"> 'M[rR]_n</span> (<span class="id">map_mx</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">map_mx_is_multiplicative</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MapNzSemiRingMatrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CommMx</span>.<br/>
<pre class="ssrdoc">
(************* Commutation property specialized to 'M[R]_n ************
</pre>
<pre class="ssrdoc">
Context {R : pzSemiRingType} {n : nat}.
Implicit Types (f g p : 'M[R]_n) (fs : seq 'M[R]_n) (d : 'rV[R]_n) (I : Type).
Definition comm_mx  f g : Prop := f *m g =  g *m f.
Definition comm_mxb f g : bool := f *m g == g *m f.
Lemma comm_mx_sym f g : comm_mx f g -&gt; comm_mx g f.
Proof. by rewrite /comm_mx. Qed.
Lemma comm_mx_refl f : comm_mx f f. Proof. by []. Qed.
Lemma comm_mx0 f : comm_mx f 0. Proof. by rewrite /comm_mx mulmx0 mul0mx. Qed.
Lemma comm0mx f : comm_mx 0 f. Proof. by rewrite /comm_mx mulmx0 mul0mx. Qed.
Lemma comm_mx1 f : comm_mx f 1%:M.
Proof. by rewrite /comm_mx mulmx1 mul1mx. Qed.
Lemma comm1mx f : comm_mx 1%:M f.
Proof. by rewrite /comm_mx mulmx1 mul1mx. Qed.
Hint Resolve comm_mx0 comm0mx comm_mx1 comm1mx : core.
Lemma comm_mxD f g g' : comm_mx f g -&gt; comm_mx f g' -&gt; comm_mx f (g + g').
Proof. by rewrite /comm_mx mulmxDl mulmxDr =&gt; -&gt; -&gt;. Qed.
Lemma comm_mxM f g g' : comm_mx f g -&gt; comm_mx f g' -&gt; comm_mx f (g *m g').
Proof. by rewrite /comm_mx mulmxA =&gt; -&gt;; rewrite -!mulmxA =&gt; -&gt;. Qed.
Lemma comm_mx_sum I (s : seq I) (P : pred I) (F : I -&gt; 'M[R]_n) (f : 'M[R]_n) :
  (forall i : I, P i -&gt; comm_mx f (F i)) -&gt; comm_mx f (\sum_(i &lt;- s | P i) F i).
Proof. by move=&gt; comm_mxfF; elim/big_ind: _ =&gt; // g h; apply: comm_mxD. Qed.
Lemma comm_mxP f g : reflect (comm_mx f g) (comm_mxb f g).
Proof. exact: eqP. Qed.
Notation all_comm_mx fs := (all2rel comm_mxb fs).
Lemma all_comm_mxP fs :
  reflect {in fs &amp;, forall f g, f *m g = g *m f} (all_comm_mx fs).
Proof. by apply: (iffP allrelP) =&gt; fsP ? ? ? ?; apply/eqP/fsP. Qed.
Lemma all_comm_mx1 f : all_comm_mx [:: f].
Proof. by rewrite /comm_mxb all2rel1. Qed.
Lemma all_comm_mx2P f g : reflect (f *m g = g *m f) (all_comm_mx [:: f; g]).
Proof. by rewrite /comm_mxb /= all2rel2 ?eqxx //; exact: eqP. Qed.
Lemma all_comm_mx_cons f fs :
  all_comm_mx (f :: fs) = all (comm_mxb f) fs &amp;&amp; all_comm_mx fs.
Proof. by rewrite /comm_mxb /= all2rel_cons //= eqxx. Qed.
Lemma comm_mxE : comm_mx = @GRing.comm _. Proof. by []. Qed.
End CommMx.
Notation all_comm_mx := (allrel comm_mxb).
Section ComMatrix.
Lemmas for matrices with coefficients in a commutative ring
Variable R : comPzSemiRingType.
Section AssocLeft.
Variables m n p : nat.
Implicit Type A : 'M[R]_(m, n).
Implicit Type B : 'M[R]_(n, p).
Lemma trmx_mul A B : (A *m B)^T = B^T *m A^T.
Proof.
rewrite trmx_mul_rev; apply/matrixP=&gt; k i; rewrite !mxE.
by apply: eq_bigr =&gt; j _; rewrite mulrC.
Qed.
End AssocLeft.
Lemma diag_mxC n (d e : 'rV[R]_n) :
  diag_mx d *m diag_mx e = diag_mx e *m diag_mx d.
Proof.
by rewrite !mulmx_diag; congr (diag_mx _); apply/rowP=&gt; i; rewrite !mxE mulrC.
Qed.
Lemma diag_mx_comm n (d e : 'rV[R]_n) : comm_mx (diag_mx d) (diag_mx e).
Proof. exact: diag_mxC. Qed.
Lemma scalar_mxC m n a (A : 'M[R]_(m, n)) : A *m a%:M = a%:M *m A.
Proof.
rewrite -!diag_const_mx mul_mx_diag mul_diag_mx.
by apply/matrixP =&gt; i j; rewrite !mxE mulrC.
Qed.
Lemma comm_mx_scalar n a (A : 'M[R]_n) : comm_mx A a%:M.
Proof. exact: scalar_mxC. Qed.
Lemma comm_scalar_mx n a (A : 'M[R]_n) : comm_mx a%:M A.
Proof. exact/comm_mx_sym/comm_mx_scalar. Qed.
Lemma mxtrace_mulC m n (A : 'M[R]_(m, n)) B : \tr (A *m B) = \tr (B *m A).
Proof.
have expand_trM C D: \tr (C *m D) = \sum_i \sum_j C i j * D j i.
  by apply: eq_bigr =&gt; i _; rewrite mxE.
rewrite !{}expand_trM exchange_big /=.
by do 2!apply: eq_bigr =&gt; ? _; apply: mulrC.
Qed.
End ComMatrix.
Arguments comm_mx_scalar {R n}.
Arguments comm_scalar_mx {R n}.
Arguments diag_mx_comm {R n}.
#[warning="-HB.no-new-instance"]
HB.instance Definition _ (R : finComNzSemiRingType) (n' : nat) :=
  [Finite of 'M[R]_n'.+1 by &lt;:].
#[global] Hint Resolve comm_mx_scalar comm_scalar_mx : core.
Section MatrixAlgebra.
Variable R : pzRingType.
Section RingModule.
The ring module/vector space structure
Variables m n : nat.
Implicit Types A B : 'M[R]_(m, n).
HB.instance Definition _ := GRing.Zmodule_isLmodule.Build R 'M[R]_(m, n)
  (@scalemxA R m n) (@scale1mx R m n) (@scalemxDr R m n) (@scalemxDl R m n).
Lemma scalemx_const a b : a *: const_mx b = const_mx (a * b).
Proof. by apply/matrixP=&gt; i j; rewrite !mxE. Qed.
Lemma matrix_sum_delta A :
  A = \sum_(i &lt; m) \sum_(j &lt; n) A i j *: delta_mx i j.
Proof.
apply/matrixP=&gt; i j.
rewrite summxE (bigD1_ord i) // summxE (bigD1_ord j) //= !mxE !eqxx mulr1.
rewrite !big1 ?addr0 //= =&gt; [i' | j'] _.
  by rewrite summxE big1// =&gt; j' _; rewrite !mxE eq_liftF mulr0.
by rewrite !mxE eqxx eq_liftF mulr0.
Qed.
End RingModule.
Section StructuralLinear.
Lemma swizzle_mx_is_scalable m n p q f g k :
  scalable (@swizzle_mx R m n p q f g k).
Proof. by move=&gt; a A; apply/matrixP=&gt; i j; rewrite !mxE. Qed.
HB.instance Definition _ m n p q f g k :=
  GRing.isScalable.Build R 'M[R]_(m, n) 'M[R]_(p, q) *:%R (swizzle_mx f g k)
    (swizzle_mx_is_scalable f g k).
Local Notation SwizzleLin op := (GRing.Linear.copy op (swizzle_mx _ _ _)).
HB.instance Definition _ m n := SwizzleLin (@trmx R m n).
HB.instance Definition _ m n i := SwizzleLin (@row R m n i).
HB.instance Definition _ m n j := SwizzleLin (@col R m n j).
HB.instance Definition _ m n i := SwizzleLin (@row' R m n i).
HB.instance Definition _ m n j := SwizzleLin (@col' R m n j).
HB.instance Definition _ m n m' n' f g := SwizzleLin (@mxsub R m n m' n' f g).
HB.instance Definition _ m n s := SwizzleLin (@row_perm R m n s).
HB.instance Definition _ m n s := SwizzleLin (@col_perm R m n s).
HB.instance Definition _ m n i1 i2 := SwizzleLin (@xrow R m n i1 i2).
HB.instance Definition _ m n j1 j2 := SwizzleLin (@xcol R m n j1 j2).
HB.instance Definition _ m n1 n2 := SwizzleLin (@lsubmx R m n1 n2).
HB.instance Definition _ m n1 n2 := SwizzleLin (@rsubmx R m n1 n2).
HB.instance Definition _ m1 m2 n := SwizzleLin (@usubmx R m1 m2 n).
HB.instance Definition _ m1 m2 n := SwizzleLin (@dsubmx R m1 m2 n).
HB.instance Definition _ m n := SwizzleLin (@vec_mx R m n).
Definition mxvec_is_scalable m n := can2_scalable (@vec_mxK R m n) mxvecK.
HB.instance Definition _ m n :=
  GRing.isScalable.Build R 'M_(m, n) 'rV_(m * n) *:%R mxvec
    (@mxvec_is_scalable m n).
End StructuralLinear.
Lemma row_sum_delta n (u : 'rV_n) : u = \sum_(j &lt; n) u 0 j *: delta_mx 0 j.
Proof. by rewrite {1}[u]matrix_sum_delta big_ord1. Qed.
Ltac split_mxE := apply/matrixP=&gt; i j; do ![rewrite mxE | case: split =&gt; ?].
Lemma scale_row_mx m n1 n2 a (A1 : 'M_(m, n1)) (A2 : 'M_(m, n2)) :
  a *: row_mx A1 A2 = row_mx (a *: A1) (a *: A2).
Proof. by split_mxE. Qed.
Lemma scale_col_mx m1 m2 n a (A1 : 'M_(m1, n)) (A2 : 'M_(m2, n)) :
  a *: col_mx A1 A2 = col_mx (a *: A1) (a *: A2).
Proof. by split_mxE. Qed.
Lemma scale_block_mx m1 m2 n1 n2 a (Aul : 'M_(m1, n1)) (Aur : 'M_(m1, n2))
                                   (Adl : 'M_(m2, n1)) (Adr : 'M_(m2, n2)) :
  a *: block_mx Aul Aur Adl Adr
     = block_mx (a *: Aul) (a *: Aur) (a *: Adl) (a *: Adr).
Proof. by rewrite scale_col_mx !scale_row_mx. Qed.
Diagonal matrices
Lemma diag_mx_is_linear n : linear (@diag_mx R n).
Proof. by move=&gt; a A B; apply/matrixP=&gt; i j; rewrite !mxE mulrnAr mulrnDl. Qed.
HB.instance Definition _ n :=
  GRing.isSemilinear.Build R 'rV_n 'M_n _ (@diag_mx _ n)
    (GRing.semilinear_linear (@diag_mx_is_linear n)).
Lemma diag_mx_sum_delta n (d : 'rV_n) :
  diag_mx d = \sum_i d 0 i *: delta_mx i i.
Proof.
apply/matrixP=&gt; i j; rewrite summxE (bigD1_ord i) //= !mxE eqxx /=.
by rewrite eq_sym mulr_natr big1 ?addr0 // =&gt; i'; rewrite !mxE eq_liftF mulr0.
Qed.
Lemma row_diag_mx n (d : 'rV_n) i : row i (diag_mx d) = d 0 i *: delta_mx 0 i.
Proof. by apply/rowP =&gt; j; rewrite !mxE eqxx eq_sym mulr_natr. Qed.
Scalar matrix
Lemma scale_scalar_mx n a1 a2 : a1 *: a2%:M = (a1 * a2)%:M :&gt; 'M_n.
Proof. by apply/matrixP=&gt; i j; rewrite !mxE mulrnAr. Qed.
Lemma scalemx1 n a : a *: 1%:M = a%:M :&gt; 'M_n.
Proof. by rewrite scale_scalar_mx mulr1. Qed.
Lemma scalar_mx_sum_delta n a : a%:M = \sum_i a *: delta_mx i i :&gt; 'M_n.
Proof.
by rewrite -diag_const_mx diag_mx_sum_delta; under eq_bigr do rewrite mxE.
Qed.
Lemma mx1_sum_delta n : 1%:M = \sum_i delta_mx i i :&gt; 'M[R]_n.
Proof. by rewrite [1%:M]scalar_mx_sum_delta -scaler_sumr scale1r. Qed.
Lemma mulmxN m n p (A : 'M[R]_(m, n)) (B : 'M_(n, p)) : A *m (- B) = - (A *m B).
Proof.
by apply/matrixP=&gt; i k; rewrite !mxE -sumrN; under eq_bigr do rewrite mxE mulrN.
Qed.
Lemma mulNmx m n p (A : 'M[R]_(m, n)) (B : 'M_(n, p)) : - A *m B = - (A *m B).
Proof.
by apply/matrixP=&gt; i k; rewrite !mxE -sumrN; under eq_bigr do rewrite mxE mulNr.
Qed.
Lemma mulmxBl m n p (A1 A2 : 'M[R]_(m, n)) (B : 'M_(n, p)) :
  (A1 - A2) *m B = A1 *m B - A2 *m B.
Proof. by rewrite mulmxDl mulNmx. Qed.
Lemma mulmxBr m n p (A : 'M[R]_(m, n)) (B1 B2 : 'M_(n, p)) :
  A *m (B1 - B2) = A *m B1 - A *m B2.
Proof. by rewrite mulmxDr mulmxN. Qed.
Lemma scalemxAl m n p a (A : 'M_(m, n)) (B : 'M_(n, p)) :
  a *: (A *m B) = (a *: A) *m B.
Proof.
apply/matrixP=&gt; i k; rewrite !mxE big_distrr /=.
by apply: eq_bigr =&gt; j _; rewrite mulrA mxE.
Qed.
Right scaling associativity requires a commutative ring
Lemma mulmx_sum_row m n (u : 'rV_m) (A : 'M_(m, n)) :
  u *m A = \sum_i u 0 i *: row i A.
Proof. by apply/rowP =&gt; j /[!(mxE, summxE)]; apply: eq_bigr =&gt; i _ /[!mxE]. Qed.
Lemma mul_scalar_mx m n a (A : 'M_(m, n)) : a%:M *m A = a *: A.
Proof.
by rewrite -diag_const_mx mul_diag_mx; apply/matrixP=&gt; i j; rewrite !mxE.
Qed.
Partial identity matrix (used in rank decomposition).
Definition copid_mx {n} r : 'M[R]_n := 1%:M - pid_mx r.
Lemma mul_copid_mx_pid m n r :
  r &lt;= m -&gt; copid_mx r *m pid_mx r = 0 :&gt; 'M_(m, n).
Proof. by move=&gt; le_r_m; rewrite mulmxBl mul1mx pid_mx_id ?subrr. Qed.
Lemma mul_pid_mx_copid m n r :
  r &lt;= n -&gt; pid_mx r *m copid_mx r = 0 :&gt; 'M_(m, n).
Proof. by move=&gt; le_r_n; rewrite mulmxBr mulmx1 pid_mx_id ?subrr. Qed.
Lemma copid_mx_id n r : r &lt;= n -&gt; copid_mx r *m copid_mx r = copid_mx r :&gt; 'M_n.
Proof.
by move=&gt; le_r_n; rewrite mulmxBl mul1mx mul_pid_mx_copid // oppr0 addr0.
Qed.
Correspondence between matrices and linear function on row vectors.
Section LinRowVector.
Variables m n : nat.
Fact lin1_mx_key : unit. Proof. by []. Qed.
Definition lin1_mx (f : 'rV[R]_m -&gt; 'rV[R]_n) :=
  \matrix[lin1_mx_key]_(i, j) f (delta_mx 0 i) 0 j.
Variable f : {linear 'rV[R]_m -&gt; 'rV[R]_n}.
Lemma mul_rV_lin1 u : u *m lin1_mx f = f u.
Proof.
rewrite [u in RHS]matrix_sum_delta big_ord1 linear_sum; apply/rowP=&gt; i.
by rewrite mxE summxE; apply: eq_bigr =&gt; j _; rewrite linearZ !mxE.
Qed.
End LinRowVector.
Correspondence between matrices and linear function on matrices.
Section LinMatrix.
Variables m1 n1 m2 n2 : nat.
Definition lin_mx (f : 'M[R]_(m1, n1) -&gt; 'M[R]_(m2, n2)) :=
  lin1_mx (mxvec \o f \o vec_mx).
Variable f : {linear 'M[R]_(m1, n1) -&gt; 'M[R]_(m2, n2)}.
Lemma mul_rV_lin u : u *m lin_mx f = mxvec (f (vec_mx u)).
Proof. exact: mul_rV_lin1. Qed.
Lemma mul_vec_lin A : mxvec A *m lin_mx f = mxvec (f A).
Proof. by rewrite mul_rV_lin mxvecK. Qed.
Lemma mx_rV_lin u : vec_mx (u *m lin_mx f) = f (vec_mx u).
Proof. by rewrite mul_rV_lin mxvecK. Qed.
Lemma mx_vec_lin A : vec_mx (mxvec A *m lin_mx f) = f A.
Proof. by rewrite mul_rV_lin !mxvecK. Qed.
End LinMatrix.
HB.instance Definition _ m n p A :=
  GRing.isAdditive.Build 'M_(n, p) 'M_(m, p) (mulmx A) (mulmxBr A).
Section Mulmxr.
Variables m n p : nat.
Implicit Type A : 'M[R]_(m, n).
Implicit Type B : 'M[R]_(n, p).
Definition mulmxr B A := mulmx A B.
Arguments mulmxr B A /.
Definition lin_mulmxr B := lin_mx (mulmxr B).
Lemma mulmxr_is_linear B : linear (mulmxr B).
Proof. by move=&gt; a A1 A2; rewrite /= mulmxDl scalemxAl. Qed.
HB.instance Definition _ B :=
  GRing.isSemilinear.Build R 'M_(m, n) 'M_(m, p) _ (mulmxr B)
    (GRing.semilinear_linear (mulmxr_is_linear B)).
Lemma lin_mulmxr_is_linear : linear lin_mulmxr.
Proof.
move=&gt; a A B; apply/row_matrixP; case/mxvec_indexP=&gt; i j.
rewrite linearP /= !rowE !mul_rV_lin /= vec_mx_delta -linearP mulmxDr.
congr (mxvec (_ + _)); apply/row_matrixP=&gt; k.
rewrite linearZ /= !row_mul rowE mul_delta_mx_cond.
by case: (k == i); [rewrite -!rowE linearZ | rewrite !mul0mx raddf0].
Qed.
HB.instance Definition _ :=
  GRing.isSemilinear.Build R 'M_(n, p) 'M_(m * n, m * p) _ lin_mulmxr
    (GRing.semilinear_linear lin_mulmxr_is_linear).
End Mulmxr.
Arguments mulmxr {_ _ _} B A /.
The trace
Section Trace.
Variable n : nat.
Local Notation "'\tr' A" := (mxtrace A) : ring_scope.
Lemma mxtrace_is_scalar : scalar (@mxtrace R n).
Proof.
move=&gt; a A B; rewrite mulr_sumr -big_split /=.
by apply: eq_bigr=&gt; i _; rewrite !mxE.
Qed.
HB.instance Definition _ := GRing.isSemilinear.Build R 'M_n R _ (@mxtrace _ n)
  (GRing.semilinear_linear mxtrace_is_scalar).
Lemma mxtraceZ a (A : 'M_n) : \tr (a *: A) = a * \tr A.
Proof. exact: scalarZ. Qed.
End Trace.
Section MatrixRing.
Variable n : nat.
HB.instance Definition _ := GRing.PzSemiRing.on 'M[R]_n.
End MatrixRing.
Determinants and adjugates are defined here, but most of their properties
only hold for matrices over a commutative ring, so their theory is
deferred to that section.
The determinant, in one line with the Leibniz Formula
Definition determinant n (A : 'M_n) : R :=
  \sum_(s : 'S_n) (-1) ^+ s * \prod_i A i (s i).
The cofactor of a matrix on the indexes i and j
Definition cofactor n A (i j : 'I_n) : R :=
  (-1) ^+ (i + j) * determinant (row' i (col' j A)).
The adjugate matrix : defined as the transpose of the matrix of cofactors
Fact adjugate_key : unit. Proof. by []. Qed.
Definition adjugate n (A : 'M_n) := \matrix[adjugate_key]_(i, j) cofactor A j i.
End MatrixAlgebra.
Arguments copid_mx {R n}.
Arguments lin_mulmxr {R m n p}.
Prenex Implicits determinant cofactor adjugate.
Arguments mulmxr {_ _ _ _} B A /.
Notation "'\det' A" := (determinant A) : ring_scope.
Notation "'\adj' A" := (adjugate A) : ring_scope.
HB.instance Definition _ (R : nzRingType) n := GRing.NzSemiRing.on 'M[R]_n.+1.
HB.instance Definition _ (R : nzRingType) n :=
  GRing.Lmodule_isLalgebra.Build R 'M[R]_n.+1 (@scalemxAl R n.+1 n.+1 n.+1).
HB.instance Definition _ (M : countZmodType) m n :=
  [Countable of 'M[M]_(m, n) by &lt;:].
HB.instance Definition _ (R : countNzRingType) n :=
  [Countable of 'M[R]_n.+1 by &lt;:].
Section FinZmodMatrix.
Variables (V : finZmodType) (m n : nat).
Local Notation MV := 'M[V]_(m, n).
HB.instance Definition _ := [Finite of MV by &lt;:].
#[compress_coercions]
HB.instance Definition _ := [finGroupMixin of MV for +%R].
End FinZmodMatrix.
#[compress_coercions]
HB.instance Definition _ (R : finNzRingType) (m n : nat) :=
  FinRing.Zmodule.on 'M[R]_(m, n).
#[compress_coercions]
HB.instance Definition _ (R : finNzRingType) n :=
  [Finite of 'M[R]_n.+1 by &lt;:].
Parametricity over the algebra structure.
Section MapRingMatrix.
Variables (aR rR : pzRingType) (f : {rmorphism aR -&gt; rR}).
Local Notation "A ^f" := (map_mx f A) : ring_scope.
Section FixedSize.
Variables m n p : nat.
Implicit Type A : 'M[aR]_(m, n).
Lemma map_mxZ a A : (a *: A)^f = f a *: A^f.
Proof. by apply/matrixP=&gt; i j; rewrite !mxE rmorphM. Qed.
Lemma det_map_mx n' (A : 'M_n') : \det A^f = f (\det A).
Proof.
rewrite rmorph_sum //; apply: eq_bigr =&gt; s _.
rewrite rmorphM /= rmorph_sign rmorph_prod; congr (_ * _).
by apply: eq_bigr =&gt; i _; rewrite mxE.
Qed.
Lemma cofactor_map_mx (A : 'M_n) i j : cofactor A^f i j = f (cofactor A i j).
Proof. by rewrite rmorphM /= rmorph_sign -det_map_mx map_row' map_col'. Qed.
Lemma map_mx_adj (A : 'M_n) : (\adj A)^f = \adj A^f.
Proof. by apply/matrixP=&gt; i j; rewrite !mxE cofactor_map_mx. Qed.
End FixedSize.
Lemma map_copid_mx n r : (copid_mx r)^f = copid_mx r :&gt; 'M_n.
Proof. by rewrite map_mxB map_mx1 map_pid_mx. Qed.
Lemma map_lin1_mx m n (g : 'rV_m -&gt; 'rV_n) gf :
  (forall v, (g v)^f = gf v^f) -&gt; (lin1_mx g)^f = lin1_mx gf.
Proof.
move=&gt; def_gf; apply/matrixP =&gt; i j; rewrite !mxE.
by rewrite -(map_delta_mx f) -def_gf mxE.
Qed.
Lemma map_lin_mx m1 n1 m2 n2 (g : 'M_(m1, n1) -&gt; 'M_(m2, n2)) gf :
  (forall A, (g A)^f = gf A^f) -&gt; (lin_mx g)^f = lin_mx gf.
Proof.
move=&gt; def_gf; apply: map_lin1_mx =&gt; A /=.
by rewrite map_mxvec def_gf map_vec_mx.
Qed.
End MapRingMatrix.
Section CommMx.
</pre>
<pre class="ssrdoc">
See comment on top of NzSemiRing section CommMx above.
</pre>
<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> p</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>) (<span class="id">fs</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> 'M[R]_n</span>) (<span class="id">d</span><span class="id"> :</span><span class="id"> 'rV[R]_n</span>) (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_mxN</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> comm_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> comm_mx</span><span class="id"> f</span> (<span class="id">-</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /comm_mx</span><span class="id"> mulmxN</span><span class="id"> mulNmx</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_mxN1</span><span class="id"> f</span><span class="id"> :</span><span class="id"> comm_mx</span><span class="id"> f</span> (<span class="id">-</span><span class="id"> 1%:M</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/comm_mxN/comm_mx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_mxB</span><span class="id"> f</span><span class="id"> g</span><span class="id"> g'</span><span class="id"> :</span><span class="id"> comm_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> comm_mx</span><span class="id"> f</span><span class="id"> g'</span><span class="id"> -&gt;</span><span class="id"> comm_mx</span><span class="id"> f</span> (<span class="id">g</span><span class="id"> -</span><span class="id"> g'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fg</span><span class="id"> fg';</span><span class="id"> apply/comm_mxD</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply/comm_mxN</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CommMx</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComMatrix</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comPzRingType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> AssocLeft</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>).<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n,</span><span class="id"> p</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemxAr</span><span class="id"> a</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_mul</span><span class="id"> !linearZ</span><span class="id"> /=</span><span class="id"> trmx_mul</span><span class="id"> scalemxAl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_is_scalable</span><span class="id"> A</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">@mulmx</span><span class="id"> _</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> scalemxAr</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> A</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> 'M[R]_</span>(<span class="id">n,</span><span class="id"> p</span>)<span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> p</span>)<span class="id"> *:%R</span> (<span class="id">mulmx</span><span class="id"> A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mulmx_is_scalable</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lin_mulmx</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n</span><span class="id"> *</span><span class="id"> p,</span><span class="id"> m</span><span class="id"> *</span><span class="id"> p</span>)<span class="id"> :=</span><span class="id"> lin_mx</span> (<span class="id">mulmx</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lin_mulmx_is_linear</span><span class="id"> :</span><span class="id"> linear</span><span class="id"> lin_mulmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a</span><span class="id"> A</span><span class="id"> B;</span><span class="id"> apply/row_matrixP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> linearP</span><span class="id"> /=</span><span class="id"> !rowE</span><span class="id"> !mul_rV_lin</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -linearP</span><span class="id"> /=</span><span class="id"> scalemxAl</span><span class="id"> mulmxDl</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isSemilinear</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> 'M[R]_</span>(<span class="id">n</span><span class="id"> *</span><span class="id"> p,</span><span class="id"> m</span><span class="id"> *</span><span class="id"> p</span>)<span class="id"> _</span><span class="id"> lin_mulmx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">GRing</span>.<span class="id">semilinear_linear</span><span class="id"> lin_mulmx_is_linear</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> AssocLeft</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LinMulRow</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lin_mul_row</span><span class="id"> u</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m</span><span class="id"> *</span><span class="id"> n,</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> lin1_mx</span> (<span class="id">mulmx</span><span class="id"> u</span><span class="id"> \o</span><span class="id"> vec_mx</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lin_mul_row_is_linear</span><span class="id"> :</span><span class="id"> linear</span><span class="id"> lin_mul_row</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v;</span><span class="id"> apply/row_matrixP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> linearP</span><span class="id"> /=</span><span class="id"> !rowE</span><span class="id"> !mul_rV_lin1</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxDl</span><span class="id"> scalemxAl</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemilinear</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> lin_mul_row</span><br/>
&nbsp;&nbsp;(<span class="id">GRing</span>.<span class="id">semilinear_linear</span><span class="id"> lin_mul_row_is_linear</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_vec_lin_row</span><span class="id"> A</span><span class="id"> u</span><span class="id"> :</span><span class="id"> mxvec</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> lin_mul_row</span><span class="id"> u</span><span class="id"> =</span><span class="id"> u</span><span class="id"> *m</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_rV_lin1</span><span class="id"> /=</span><span class="id"> mxvecK</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LinMulRow</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxvec_dotmul</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> u</span><span class="id"> v</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxvec</span> (<span class="id">u^T</span><span class="id"> *m</span><span class="id"> v</span>)<span class="id"> *m</span> (<span class="id">mxvec</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> u</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> v^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">transitivity</span> (<span class="id">\sum_i</span><span class="id"> \sum_j</span> (<span class="id">u</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> *</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *:</span><span class="id"> row</span><span class="id"> j</span><span class="id"> v^T</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply/rowP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> {i}ord1</span><span class="id"> mxE</span> (<span class="id">reindex</span><span class="id"> _</span> (<span class="id">curry_mxvec_bij</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> pair_bigA</span><span class="id"> summxE;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]]</span><span class="id"> /=</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !mxvecE</span><span class="id"> mxE</span><span class="id"> big_ord1</span><span class="id"> mxE</span><span class="id"> mulrAC</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmx_sum_row</span><span class="id"> exchange_big;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> -scaler_suml</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mx_scalar</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> a%:M</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalar_mxC</span><span class="id"> mul_scalar_mx</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> determinant_multilinear</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> C</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> i0</span><span class="id"> b</span><span class="id"> c</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">row</span><span class="id"> i0</span><span class="id"> A</span><span class="id"> =</span><span class="id"> b</span><span class="id"> *:</span><span class="id"> row</span><span class="id"> i0</span><span class="id"> B</span><span class="id"> +</span><span class="id"> c</span><span class="id"> *:</span><span class="id"> row</span><span class="id"> i0</span><span class="id"> C</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">row'</span><span class="id"> i0</span><span class="id"> B</span><span class="id"> =</span><span class="id"> row'</span><span class="id"> i0</span><span class="id"> A</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">row'</span><span class="id"> i0</span><span class="id"> C</span><span class="id"> =</span><span class="id"> row'</span><span class="id"> i0</span><span class="id"> A</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\det</span><span class="id"> A</span><span class="id"> =</span><span class="id"> b</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> B</span><span class="id"> +</span><span class="id"> c</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> C</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[_</span><span class="id"> +</span><span class="id"> _]</span>(<span class="id">row_id</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> move/row_eq=&gt;</span><span class="id"> ABC</span>.<br/>
<span class="id">move/row'_eq=&gt;</span><span class="id"> BA;</span><span class="id"> move/row'_eq=&gt;</span><span class="id"> CA</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big_distrr</span><span class="id"> -big_split;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> _</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!</span>(<span class="id">mulrCA</span> (_<span class="id"> ^+s</span>))<span class="id"> -mulrDr;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">bigD1</span><span class="id"> i0</span> (_<span class="id"> :</span><span class="id"> predT</span><span class="id"> i0</span>))<span class="id"> //=</span><span class="id"> {}ABC</span><span class="id"> !mxE</span><span class="id"> mulrDl</span><span class="id"> !mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span><span class="id"> +</span><span class="id"> _</span><span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> i0i;</span><span class="id"> rewrite</span><span class="id"> ?BA</span><span class="id"> ?CA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> determinant_alternate</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> i1</span><span class="id"> i2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">i1</span><span class="id"> !=</span><span class="id"> i2</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> i1</span><span class="id"> =1</span><span class="id"> A</span><span class="id"> i2</span><span class="id"> -&gt;</span><span class="id"> \det</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> neq_i12</span><span class="id"> eqA12;</span><span class="id"> pose</span><span class="id"> t</span><span class="id"> :=</span><span class="id"> tperm</span><span class="id"> i1</span><span class="id"> i2</span>.<br/>
<span class="id">have</span><span class="id"> oddMt</span><span class="id"> s:</span> (<span class="id">t</span><span class="id"> *</span><span class="id"> s</span>)<span class="id">%g</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> s</span><span class="id"> :&gt;</span><span class="id"> bool</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> odd_permM</span><span class="id"> odd_tperm</span><span class="id"> neq_i12</span>.<br/>
<span class="id">rewrite</span><span class="id"> [\det</span><span class="id"> A]</span>(<span class="id">bigID</span> (<span class="id">@odd_perm</span><span class="id"> _</span>))<span class="id"> /=</span>.<br/>
<span class="id">apply:</span><span class="id"> canLR</span> (<span class="id">subrK</span><span class="id"> _</span>)<span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> add0r</span><span class="id"> -sumrN</span>.<br/>
<span class="id">rewrite</span> (<span class="id">reindex_inj</span> (<span class="id">mulgI</span><span class="id"> t</span>))<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_big</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> s</span>.<br/>
<span class="id">rewrite</span><span class="id"> oddMt</span><span class="id"> =&gt;</span><span class="id"> /negPf-&gt;;</span><span class="id"> rewrite</span><span class="id"> mulN1r</span><span class="id"> mul1r;</span><span class="id"> congr</span> (<span class="id">-</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span> (<span class="id">reindex_perm</span><span class="id"> t</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> permM</span><span class="id"> tpermK</span><span class="id"> /t;</span><span class="id"> case:</span><span class="id"> tpermP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> eqA12</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_tr</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> \det</span><span class="id"> A^T</span><span class="id"> =</span><span class="id"> \det</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [\det</span><span class="id"> A^T]</span>(<span class="id">reindex_inj</span><span class="id"> invg_inj</span>)<span class="id"> /=</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> _</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !odd_permV</span> (<span class="id">reindex_perm</span><span class="id"> s</span>)<span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> permK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_perm</span><span class="id"> n</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> :</span><span class="id"> \det</span> (<span class="id">perm_mx</span><span class="id"> s</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> s</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> [\det</span><span class="id"> _]</span>(<span class="id">bigD1</span><span class="id"> s</span>)<span class="id"> //=</span><span class="id"> big1</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> _];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> !mxE</span><span class="id"> eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulr1</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> t</span><span class="id"> Dst</span>.<br/>
<span class="id">case:</span> (<span class="id">pickP</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> t</span><span class="id"> i</span>))<span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> ist</span><span class="id"> |</span><span class="id"> Est]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //</span><span class="id"> mulrCA</span><span class="id"> /=</span><span class="id"> !mxE</span> (<span class="id">negPf</span><span class="id"> ist</span>)<span class="id"> mul0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/eqP:</span><span class="id"> Dst;</span><span class="id"> apply/permP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> move/eqP:</span> (<span class="id">Est</span><span class="id"> i</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> \det</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -perm_mx1</span><span class="id"> det_perm</span><span class="id"> odd_perm1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_mx00</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_0</span>)<span class="id"> :</span><span class="id"> \det</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> flatmx0</span><span class="id"> -</span>(<span class="id">flatmx0</span><span class="id"> 1%:M</span>)<span class="id"> det1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> detZ</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> \det</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> big_distrr</span><span class="id"> /=;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulrCA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> -[n</span><span class="gallina-kwd"> in</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> n]card_ord</span><span class="id"> -prodr_const</span><span class="id"> -big_split</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det0</span><span class="id"> n'</span><span class="id"> :</span><span class="id"> \det</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[R]_n'</span>.<span class="id">+1</span>)<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">scale0r</span><span class="id"> 0</span>)<span class="id"> detZ</span><span class="id"> exprS</span><span class="id"> !mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_scalar</span><span class="id"> n</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \det</span> (<span class="id">a%:M</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> =</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">mulr1</span><span class="id"> a</span>)<span class="id"> -scale_scalar_mx</span><span class="id"> detZ</span><span class="id"> det1</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_scalar1</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \det</span> (<span class="id">a%:M</span><span class="id"> :</span><span class="id"> 'M[R]_1</span>)<span class="id"> =</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> det_scalar</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_mx11</span>  (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M[R]_1</span>)<span class="id"> :</span><span class="id"> \det</span><span class="id"> M</span><span class="id"> =</span><span class="id"> M</span><span class="id"> 0</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {1}[M]mx11_scalar</span><span class="id"> det_scalar</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_mulmx</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> \det</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> \det</span><span class="id"> A</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> big_distrl</span><span class="id"> /=</span>.<br/>
<span class="id">pose</span><span class="id"> F</span><span class="id"> :=</span> (<span class="id">'I_n</span><span class="id"> ^</span><span class="id"> n</span>)<span class="id">%type;</span><span class="id"> pose</span><span class="id"> AB</span><span class="id"> s</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *</span><span class="id"> B</span><span class="id"> j</span> (<span class="id">s</span><span class="id"> i</span>).<br/>
<span class="id">transitivity</span> (<span class="id">\sum_</span>(<span class="id">f</span><span class="id"> :</span><span class="id"> F</span>)<span class="id"> \sum_</span>(<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>) (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> s</span><span class="id"> *</span><span class="id"> \prod_i</span><span class="id"> AB</span><span class="id"> s</span><span class="id"> i</span> (<span class="id">f</span><span class="id"> i</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> exchange_big;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> s</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -big_distrr</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">bigA_distr_bigA</span> (<span class="id">AB</span><span class="id"> s</span>))<span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
<span class="id">rewrite</span> (<span class="id">bigID</span> (<span class="gallina-kwd">fun</span><span class="id"> f</span><span class="id"> :</span><span class="id"> F</span><span class="id"> =&gt;</span><span class="id"> injectiveb</span><span class="id"> f</span>))<span class="id"> /=</span><span class="id"> addrC</span><span class="id"> big1</span><span class="id"> ?add0r</span><span class="id"> =&gt;</span><span class="id"> [|f</span><span class="id"> Uf]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">reindex</span> (<span class="id">@pval</span><span class="id"> _</span>))<span class="id"> /=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span><span class="id"> in_Sn</span><span class="id"> :=</span><span class="id"> insubd</span> (<span class="id">1%g</span><span class="id"> :</span><span class="id"> 'S_n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> in_Sn</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> f</span><span class="id"> Uf;</span><span class="id"> first</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> apply:</span><span class="id"> insubdK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> eq_big</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [s</span><span class="id"> |</span><span class="id"> s</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">valP</span><span class="id"> s</span>)<span class="id"> //</span><span class="id"> big_distrr</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">reindex_inj</span> (<span class="id">mulgI</span><span class="id"> s</span>))<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> _</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_split</span><span class="id"> /=</span><span class="id"> [in</span><span class="id"> LHS]mulrA</span><span class="id"> mulrCA</span><span class="id"> mulrA</span><span class="id"> mulrCA</span><span class="id"> mulrA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -signr_addb</span><span class="id"> odd_permM</span><span class="id"> !pvalE;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> symmetry</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">reindex_perm</span><span class="id"> s</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> permM</span>.<br/>
<span class="id">transitivity</span> (<span class="id">\det</span> (<span class="id">\matrix_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B</span> (<span class="id">f</span><span class="id"> i</span>)<span class="id"> j</span>)<span class="id"> *</span><span class="id"> \prod_i</span><span class="id"> A</span><span class="id"> i</span> (<span class="id">f</span><span class="id"> i</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrC</span><span class="id"> big_distrr</span><span class="id"> /=;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrCA</span><span class="id"> big_split</span><span class="id"> //=;</span><span class="id"> congr</span> (_<span class="id"> *</span> (_<span class="id"> *</span><span class="id"> _</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
<span class="id">case/injectivePn:</span><span class="id"> Uf</span><span class="id"> =&gt;</span><span class="id"> i1</span><span class="id"> [i2</span><span class="id"> Di12</span><span class="id"> Ef12]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">determinant_alternate</span><span class="id"> Di12</span>)<span class="id"> ?simp</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Ef12</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> detM</span><span class="id"> n'</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[R]_n'</span>.<span class="id">+1</span>)<span class="id"> :</span><span class="id"> \det</span> (<span class="id">A</span><span class="id"> *</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> \det</span><span class="id"> A</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> det_mulmx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand_cofactor</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cofactor</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span><span class="id"> |</span><span class="id"> s</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> j</span>) (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> s</span><span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> k</span>)<span class="id"> A</span><span class="id"> k</span> (<span class="id">s</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> [|n]</span><span class="id"> A</span><span class="id"> i0</span><span class="id"> j0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> i0</span>.<br/>
<span class="id">rewrite</span> (<span class="id">reindex</span> (<span class="id">lift_perm</span><span class="id"> i0</span><span class="id"> j0</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span><span class="id"> ulsf</span><span class="id"> i</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>.<span class="id">+1</span>)<span class="id"> k</span><span class="id"> :=</span><span class="id"> odflt</span><span class="id"> k</span> (<span class="id">unlift</span> (<span class="id">s</span><span class="id"> i</span>) (<span class="id">s</span> (<span class="id">lift</span><span class="id"> i</span><span class="id"> k</span>))).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> ulsfK</span><span class="id"> i</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>.<span class="id">+1</span>)<span class="id"> k:</span><span class="id"> lift</span> (<span class="id">s</span><span class="id"> i</span>) (<span class="id">ulsf</span><span class="id"> i</span><span class="id"> s</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> s</span> (<span class="id">lift</span><span class="id"> i</span><span class="id"> k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /ulsf;</span><span class="id"> have:=</span><span class="id"> neq_lift</span><span class="id"> i</span><span class="id"> k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">can_eq</span> (<span class="id">permK</span><span class="id"> s</span>))<span class="id"> =&gt;</span><span class="id"> /unlift_some[]</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> inj_ulsf:</span><span class="id"> injective</span> (<span class="id">ulsf</span><span class="id"> i0</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> s;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">ulsf</span> (<span class="id">s</span><span class="id"> i0</span>)<span class="id"> s^-1%g</span>)<span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> {1}/ulsf</span><span class="id"> ulsfK</span><span class="id"> !permK</span><span class="id"> liftK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">fun</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> perm</span> (<span class="id">inj_ulsf</span><span class="id"> s</span>))<span class="id"> =&gt;</span><span class="id"> [s</span><span class="id"> _</span><span class="id"> |</span><span class="id"> s]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/permP=&gt;</span><span class="id"> k';</span><span class="id"> rewrite</span><span class="id"> permE</span><span class="id"> /ulsf</span><span class="id"> lift_perm_lift</span><span class="id"> lift_perm_id</span><span class="id"> liftK</span>.<br/>
&nbsp;&nbsp;<span class="id">move/</span>(<span class="id">s</span><span class="id"> _</span><span class="id"> =P</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> si0;</span><span class="id"> apply/permP=&gt;</span><span class="id"> k</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">unliftP</span><span class="id"> i0</span><span class="id"> k</span>)<span class="id"> =&gt;</span><span class="id"> [k'|]</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?lift_perm_id</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lift_perm_lift</span><span class="id"> -si0</span><span class="id"> permE</span><span class="id"> ulsfK</span>.<br/>
<span class="id">rewrite</span><span class="id"> /cofactor</span><span class="id"> big_distrr</span><span class="id"> /=</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_big</span><span class="id"> =&gt;</span><span class="id"> [s</span><span class="id"> |</span><span class="id"> s</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lift_perm_id</span><span class="id"> eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> -signr_odd</span><span class="id"> mulrA</span><span class="id"> -signr_addb</span><span class="id"> oddD</span><span class="id"> -odd_lift_perm;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">case:</span> (<span class="id">pickP</span><span class="id"> 'I_n</span>)<span class="id"> =&gt;</span><span class="id"> [k0</span><span class="id"> _</span><span class="id"> |</span><span class="id"> n0];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !big1</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> [j</span><span class="id"> /unlift_some[i]</span><span class="id"> |</span><span class="id"> i</span><span class="id"> _];</span><span class="id"> have:=</span><span class="id"> n0</span><span class="id"> i</span>.<br/>
<span class="id">rewrite</span> (<span class="id">reindex</span> (<span class="id">lift</span><span class="id"> i0</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_big</span><span class="id"> =&gt;</span><span class="id"> [k</span><span class="id"> |</span><span class="id"> k</span><span class="id"> _]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ?neq_lift</span><span class="id"> //</span><span class="id"> !mxE</span><span class="id"> lift_perm_lift</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> odflt</span><span class="id"> k0</span> (<span class="id">unlift</span><span class="id"> i0</span><span class="id"> k</span>))<span class="id"> =&gt;</span><span class="id"> k;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> liftK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/unlift_some=&gt;</span><span class="id"> k'</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand_det_row</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> i0</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\det</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_j</span><span class="id"> A</span><span class="id"> i0</span><span class="id"> j</span><span class="id"> *</span><span class="id"> cofactor</span><span class="id"> A</span><span class="id"> i0</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /</span>(<span class="id">\det</span><span class="id"> A</span>) (<span class="id">partition_big</span> (<span class="gallina-kwd">fun</span><span class="id"> s</span><span class="id"> :</span><span class="id"> 'S_n</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> i0</span>)<span class="id"> predT</span>)<span class="id"> //=</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j0</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> expand_cofactor</span><span class="id"> big_distrr</span><span class="id"> /=</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> /eqP</span><span class="id"> Dsi0</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulrCA</span> (<span class="id">bigID</span> (<span class="id">pred1</span><span class="id"> i0</span>))<span class="id"> /=</span><span class="id"> big_pred1_eq</span><span class="id"> Dsi0;</span><span class="id"> congr</span> (_<span class="id"> *</span> (_<span class="id"> *</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigl</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cofactor_tr</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> cofactor</span><span class="id"> A^T</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> cofactor</span><span class="id"> A</span><span class="id"> j</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /cofactor</span><span class="id"> addnC;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> -tr_row'</span><span class="id"> -tr_col'</span><span class="id"> det_tr;</span><span class="id"> congr</span> (<span class="id">\det</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cofactorZ</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cofactor</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span><span class="id"> *</span><span class="id"> cofactor</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {1}/cofactor</span><span class="id"> !linearZ</span><span class="id"> detZ</span><span class="id"> mulrCA</span><span class="id"> mulrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand_det_col</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> j0</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\det</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_i</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> j0</span><span class="id"> *</span><span class="id"> cofactor</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -det_tr</span> (<span class="id">expand_det_row</span><span class="id"> _</span><span class="id"> j0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> cofactor_tr</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_adj</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span> (<span class="id">\adj</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> \adj</span><span class="id"> A^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> cofactor_tr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adjZ</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> \adj</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> a^+n</span>.<span class="id">-1</span><span class="id"> *:</span><span class="id"> \adj</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> cofactorZ</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mx_adj</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> \adj</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">\det</span><span class="id"> A</span>)<span class="id">%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP=&gt;</span><span class="id"> i1</span><span class="id"> i2</span><span class="id"> /[!mxE];</span><span class="id"> have</span><span class="id"> [-&gt;|Di]</span><span class="id"> :=</span><span class="id"> eqVneq</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">expand_det_row</span><span class="id"> _</span><span class="id"> i2</span>)<span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
<span class="id">pose</span><span class="id"> B</span><span class="id"> :=</span><span class="id"> \matrix_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="gallina-kwd">if</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> i2</span><span class="gallina-kwd"> then</span><span class="id"> A</span><span class="id"> i1</span><span class="id"> j</span><span class="gallina-kwd"> else</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<span class="id">have</span><span class="id"> EBi12:</span><span class="id"> B</span><span class="id"> i1</span><span class="id"> =1</span><span class="id"> B</span><span class="id"> i2</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> !mxE</span><span class="id"> eqxx</span> (<span class="id">negPf</span><span class="id"> Di</span>).<br/>
<span class="id">rewrite</span><span class="id"> -[_</span><span class="id"> *+</span><span class="id"> _]</span>(<span class="id">determinant_alternate</span><span class="id"> Di</span><span class="id"> EBi12</span>) (<span class="id">expand_det_row</span><span class="id"> _</span><span class="id"> i2</span>).<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eqxx;</span><span class="id"> congr</span> (_<span class="id"> *</span> (_<span class="id"> *</span><span class="id"> _</span>)).<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> _;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eq_sym</span><span class="id"> -if_neg</span><span class="id"> neq_lift</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_adj_mx</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> \adj</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">\det</span><span class="id"> A</span>)<span class="id">%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_mul</span><span class="id"> trmx_adj</span><span class="id"> mul_mx_adj</span><span class="id"> det_tr</span><span class="id"> tr_scalar_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adj1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> \adj</span> (<span class="id">1%:M</span>)<span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> :&gt;</span><span class="id"> 'M[R]_n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}</span>(<span class="id">det1</span><span class="id"> n</span>)<span class="id"> -mul_adj_mx</span><span class="id"> mulmx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx1C</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB1;</span><span class="id"> pose</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> \det</span><span class="id"> B</span><span class="id"> *:</span><span class="id"> \adj</span><span class="id"> A</span>.<br/>
<span class="id">suffices</span><span class="id"> kA:</span><span class="id"> A'</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[B]mul1mx</span><span class="id"> -kA</span><span class="id"> -</span>(<span class="id">mulmxA</span><span class="id"> A'</span>)<span class="id"> AB1</span><span class="id"> mulmx1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalemxAl</span><span class="id"> mul_adj_mx</span><span class="id"> scale_scalar_mx</span><span class="id"> mulrC</span><span class="id"> -det_mulmx</span><span class="id"> AB1</span><span class="id"> det1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_ublock</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> Aul</span> (<span class="id">Aur</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n1,</span><span class="id"> n2</span>))<span class="id"> Adr</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\det</span> (<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> 0</span><span class="id"> Adr</span>)<span class="id"> =</span><span class="id"> \det</span><span class="id"> Aul</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> Adr</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n1</span><span class="id"> =&gt;</span><span class="id"> [|n1</span><span class="id"> IHn1]</span><span class="gallina-kwd"> in</span><span class="id"> Aul</span><span class="id"> Aur</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;:</span><span class="id"> Aul</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> []</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> det1</span><span class="id"> mul1r;</span><span class="id"> congr</span> (<span class="id">\det</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 2![rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> [[]|k]</span><span class="id"> //=;</span><span class="id"> move/val_inj=&gt;</span><span class="id"> &lt;-</span><span class="id"> {k}]</span>.<br/>
<span class="id">rewrite</span> (<span class="id">expand_det_col</span><span class="id"> _</span> (<span class="id">lshift</span><span class="id"> n2</span><span class="id"> 0</span>))<span class="id"> big_split_ord</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> addrC</span><span class="id"> big1</span><span class="id"> 1?simp</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> _];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> block_mxEdl</span><span class="id"> mxE</span><span class="id"> simp</span>.<br/>
<span class="id">rewrite</span> (<span class="id">expand_det_col</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> big_distrl</span><span class="id"> /=;</span><span class="id"> apply:</span><span class="id"> eq_bigr=&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> block_mxEul</span><span class="id"> -!mulrA;</span><span class="id"> do</span><span class="id"> 2!congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> col'_col_mx</span><span class="id"> !col'Kl</span><span class="id"> raddf0</span><span class="id"> row'Ku</span><span class="id"> row'_row_mx</span><span class="id"> IHn1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_lblock</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> Aul</span> (<span class="id">Adl</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n2,</span><span class="id"> n1</span>))<span class="id"> Adr</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\det</span> (<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> 0</span><span class="id"> Adl</span><span class="id"> Adr</span>)<span class="id"> =</span><span class="id"> \det</span><span class="id"> Aul</span><span class="id"> *</span><span class="id"> \det</span><span class="id"> Adr</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -det_tr</span><span class="id"> tr_block_mx</span><span class="id"> trmx0</span><span class="id"> det_ublock</span><span class="id"> !det_tr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_trig</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><span class="id"> is_trig_mx</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> \det</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> A</span><span class="id"> i</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/trigsqmx_ind</span><span class="id"> =&gt;</span><span class="id"> [|k</span><span class="id"> x</span><span class="id"> c</span><span class="id"> B</span><span class="id"> Bt</span><span class="id"> IHB];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?big_ord0</span><span class="id"> ?det_mx00</span>.<br/>
<span class="id">rewrite</span><span class="id"> det_lblock</span><span class="id"> big_ord_recl</span><span class="id"> det_mx11</span><span class="id"> IHB//;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[ord0]</span>(<span class="id">lshift0</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> block_mxEul</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> -!rshift1</span><span class="id"> block_mxEdr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_diag</span><span class="id"> n</span> (<span class="id">d</span><span class="id"> :</span><span class="id"> 'rV[R]_n</span>)<span class="id"> :</span><span class="id"> \det</span> (<span class="id">diag_mx</span><span class="id"> d</span>)<span class="id"> =</span><span class="id"> \prod_i</span><span class="id"> d</span><span class="id"> 0</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> det_trig//;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ComMatrix</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> lin_mul_row</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> u</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lin_mulmx</span><span class="id"> {R</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p}</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComNzMatrix</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comNzRingType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx1_min</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> B</span><span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> -&gt;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB1;</span><span class="id"> rewrite</span><span class="id"> leqNgt;</span><span class="id"> apply/negP=&gt;</span><span class="id"> /subnKC;</span><span class="id"> rewrite</span><span class="id"> addSnnS</span>.<br/>
<span class="id">move:</span> (_<span class="id"> -</span><span class="id"> _</span>)<span class="id">%N</span><span class="id"> =&gt;</span><span class="id"> m'</span><span class="id"> def_m;</span><span class="id"> move:</span><span class="id"> AB1;</span><span class="id"> rewrite</span><span class="id"> -{m}def_m</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> B</span><span class="id"> *</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">vsubmxK</span><span class="id"> A</span>)<span class="id"> -</span>(<span class="id">hsubmxK</span><span class="id"> B</span>)<span class="id"> mul_col_row</span><span class="id"> scalar_mx_block</span>.<br/>
<span class="id">case/eq_block_mx=&gt;</span><span class="id"> /mulmx1C</span><span class="id"> BlAu1</span><span class="id"> AuBr0</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> /eqP/idPn[]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> B]mul1mx</span><span class="id"> -BlAu1</span><span class="id"> -mulmxA</span><span class="id"> AuBr0</span><span class="id"> !mulmx0</span><span class="id"> eq_sym</span><span class="id"> oner_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">Lalgebra_isAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> 'M[R]_n</span>.<span class="id">+1</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> scalemxAr</span><span class="id"> k</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ComNzMatrix</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> finComNzRingType</span>) (<span class="id">n'</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[Finite</span><span class="id"> of</span><span class="id"> 'M[R]_n'</span>.<span class="id">+1</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<br/>
<pre class="ssrdoc">
(********************** Matrix unit ring and inverse matrices ***************
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixInv</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Defs</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> unitmx</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> 'M[R]_n</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> \det</span><span class="id"> A</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invmx</span><span class="id"> A</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="gallina-kwd"> then</span> (<span class="id">\det</span><span class="id"> A</span>)<span class="id">^-1</span><span class="id"> *:</span><span class="id"> \adj</span><span class="id"> A</span><span class="gallina-kwd"> else</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmxE</span><span class="id"> A</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">\det</span><span class="id"> A</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmx1</span><span class="id"> :</span><span class="id"> 1%:M</span><span class="id"> \in</span><span class="id"> unitmx</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitmxE</span><span class="id"> det1</span><span class="id"> unitr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmx_perm</span><span class="id"> s</span><span class="id"> :</span><span class="id"> perm_mx</span><span class="id"> s</span><span class="id"> \in</span><span class="id"> unitmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitmxE</span><span class="id"> det_perm</span><span class="id"> unitrX</span><span class="id"> ?unitrN</span><span class="id"> ?unitr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmx_tr</span><span class="id"> A</span><span class="id"> :</span> (<span class="id">A^T</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitmxE</span><span class="id"> det_tr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmxZ</span><span class="id"> a</span><span class="id"> A</span><span class="id"> :</span><span class="id"> a</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Ua;</span><span class="id"> rewrite</span><span class="id"> !unitmxE</span><span class="id"> detZ</span><span class="id"> unitrM</span><span class="id"> unitrX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invmx1</span><span class="id"> :</span><span class="id"> invmx</span><span class="id"> 1%:M</span><span class="id"> =</span><span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /invmx</span><span class="id"> det1</span><span class="id"> invr1</span><span class="id"> scale1r</span><span class="id"> adj1</span><span class="id"> if_same</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invmxZ</span><span class="id"> a</span><span class="id"> A</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> -&gt;</span><span class="id"> invmx</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> a^-1</span><span class="id"> *:</span><span class="id"> invmx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /invmx</span><span class="id"> !unitmxE</span><span class="id"> detZ</span><span class="id"> unitrM</span><span class="id"> =&gt;</span><span class="id"> /andP[Ua</span><span class="id"> U_A]</span>.<br/>
<span class="id">rewrite</span><span class="id"> Ua</span><span class="id"> U_A</span><span class="id"> adjZ</span><span class="id"> !scalerA</span><span class="id"> invrM</span><span class="id"> {U_A}//=</span>.<br/>
<span class="id">case:</span> (<span class="id">posnP</span><span class="id"> n</span>)<span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> A;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> flatmx0</span><span class="id"> [_</span><span class="id"> *:</span><span class="id"> _]flatmx0</span>.<br/>
<span class="id">rewrite</span><span class="id"> unitrX_pos</span><span class="id"> //</span><span class="gallina-kwd"> in</span><span class="id"> Ua;</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> *</span><span class="id"> _]</span>(<span class="id">mulrK</span><span class="id"> Ua</span>)<span class="id"> mulrC</span><span class="id"> -!mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -exprSr</span><span class="id"> prednK</span><span class="id"> //</span><span class="id"> !mulrA</span><span class="id"> divrK</span><span class="id"> ?unitrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invmx_scalar</span><span class="id"> a</span><span class="id"> :</span><span class="id"> invmx</span> (<span class="id">a%:M</span>)<span class="id"> =</span><span class="id"> a^-1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> Ua:</span> (<span class="id">a%:M</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalemx1</span><span class="gallina-kwd"> in</span><span class="id"> Ua</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> invmxZ</span><span class="id"> //</span><span class="id"> invmx1</span><span class="id"> scalemx1</span>.<br/>
<span class="id">rewrite</span><span class="id"> /invmx</span><span class="id"> Ua;</span><span class="id"> have</span><span class="id"> [-&gt;|n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ![_%:M]flatmx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitmxE</span><span class="id"> det_scalar</span><span class="id"> unitrX_pos</span><span class="id"> //</span><span class="gallina-kwd"> in</span><span class="id"> Ua;</span><span class="id"> rewrite</span><span class="id"> invr_out</span><span class="id"> ?Ua</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulVmx</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unitmx,</span><span class="id"> left_inverse</span><span class="id"> 1%:M</span><span class="id"> invmx</span><span class="id"> mulmx}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> nsA;</span><span class="id"> rewrite</span><span class="id"> /invmx</span><span class="id"> nsA</span><span class="id"> -scalemxAl</span><span class="id"> mul_adj_mx</span><span class="id"> scale_scalar_mx</span><span class="id"> mulVr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxV</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unitmx,</span><span class="id"> right_inverse</span><span class="id"> 1%:M</span><span class="id"> invmx</span><span class="id"> mulmx}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> nsA;</span><span class="id"> rewrite</span><span class="id"> /invmx</span><span class="id"> nsA</span><span class="id"> -scalemxAr</span><span class="id"> mul_mx_adj</span><span class="id"> scale_scalar_mx</span><span class="id"> mulVr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKmx</span><span class="id"> m</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unitmx,</span><span class="id"> @left_loop</span><span class="id"> _</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> m</span>)<span class="id"> invmx</span><span class="id"> mulmx}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> uA</span><span class="id"> /=</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> mulVmx</span><span class="id"> ?mul1mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKVmx</span><span class="id"> m</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unitmx,</span><span class="id"> @rev_left_loop</span><span class="id"> _</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> m</span>)<span class="id"> invmx</span><span class="id"> mulmx}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> uA</span><span class="id"> /=</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> mulmxV</span><span class="id"> ?mul1mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxK</span><span class="id"> m</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unitmx,</span><span class="id"> @right_loop</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> _</span><span class="id"> invmx</span><span class="id"> mulmx}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> uA</span><span class="id"> /=</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> mulmxV</span><span class="id"> ?mulmx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxKV</span><span class="id"> m</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unitmx,</span><span class="id"> @rev_right_loop</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> _</span><span class="id"> invmx</span><span class="id"> mulmx}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> uA</span><span class="id"> /=</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> mulVmx</span><span class="id"> ?mulmx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_inv</span><span class="id"> A</span><span class="id"> :</span><span class="id"> \det</span> (<span class="id">invmx</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">\det</span><span class="id"> A</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> uA:</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /invmx</span><span class="id"> uA</span><span class="id"> invr_out</span><span class="id"> ?negbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">mulrI</span><span class="id"> uA</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -det_mulmx</span><span class="id"> mulmxV</span><span class="id"> ?divrr</span><span class="id"> ?det1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmx_inv</span><span class="id"> A</span><span class="id"> :</span> (<span class="id">invmx</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !unitmxE</span><span class="id"> det_inv</span><span class="id"> unitrV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitmx_mul</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> &amp;&amp;</span> (<span class="id">B</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitrM</span><span class="id"> -det_mulmx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmx_inv</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">invmx</span><span class="id"> A</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> invmx</span> (<span class="id">A^T</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">fun_if</span><span class="id"> trmx</span>)<span class="id"> linearZ</span><span class="id"> /=</span><span class="id"> trmx_adj</span><span class="id"> -unitmx_tr</span><span class="id"> -det_tr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invmxK</span><span class="id"> :</span><span class="id"> involutive</span><span class="id"> invmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> A;</span><span class="id"> case</span><span class="id"> uA</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /invmx</span><span class="id"> !uA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">can_inj</span> (<span class="id">mulKVmx</span><span class="id"> uA</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulVmx</span><span class="id"> //</span><span class="id"> mulmxV</span><span class="id"> ?unitmx_inv</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx1_unit</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> /\</span><span class="id"> B</span><span class="id"> \in</span><span class="id"> unitmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> AB1;</span><span class="id"> apply/andP;</span><span class="id"> rewrite</span><span class="id"> -unitmx_mul</span><span class="id"> AB1</span><span class="id"> unitmx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> intro_unitmx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> /\</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> -&gt;</span><span class="id"> unitmx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> _</span><span class="id"> /mulmx1_unit[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invmx_out</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [predC</span><span class="id"> unitmx],</span><span class="id"> invmx</span><span class="id"> =1</span><span class="id"> id}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> inE</span><span class="id"> /=</span><span class="id"> /invmx</span><span class="id"> -if_neg</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Defs</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n'</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> n'</span>.<span class="id">+1</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">NzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> 'M[R]_n</span><br/>
&nbsp;&nbsp;(<span class="id">@mulVmx</span><span class="id"> n</span>) (<span class="id">@mulmxV</span><span class="id"> n</span>) (<span class="id">@intro_unitmx</span><span class="id"> n</span>) (<span class="id">@invmx_out</span><span class="id"> n</span>).<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> detV</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> \det</span><span class="id"> A^-1</span><span class="id"> =</span> (<span class="id">\det</span><span class="id"> A</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> det_inv</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitr_trmx</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">A^T</span> <span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> unitmx_tr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trmxV</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> A^-1^T</span><span class="id"> =</span> (<span class="id">A^T</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> trmx_inv</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> perm_mxV</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_n</span>)<span class="id"> :</span><span class="id"> perm_mx</span><span class="id"> s^-1</span><span class="id"> =</span> (<span class="id">perm_mx</span><span class="id"> s</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[_^-1]mul1r;</span><span class="id"> apply:</span> (<span class="id">canRL</span> (<span class="id">mulmxK</span> (<span class="id">unitmx_perm</span><span class="id"> s</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -perm_mxM</span><span class="id"> mulVg</span><span class="id"> perm_mx1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_perm_mxV</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> is_perm_mx</span><span class="id"> A^-1</span><span class="id"> =</span><span class="id"> is_perm_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/is_perm_mxP/is_perm_mxP=&gt;</span><span class="id"> []</span><span class="id"> [s</span><span class="id"> defA];</span><span class="gallina-kwd"> exists</span><span class="id"> s^-1%g</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">invrK</span><span class="id"> A</span>)<span class="id"> defA</span><span class="id"> perm_mxV</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> defA</span><span class="id"> perm_mxV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixInv</span>.<br/>
<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> unitmx</span><span class="id"> invmx</span><span class="id"> invmxK</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> block_diag_mx_unit</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>)<span class="id"> n1</span><span class="id"> n2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M[R]_n1</span>) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M[R]_n2</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> Adr</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">Aul</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> &amp;&amp;</span> (<span class="id">Adr</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !unitmxE</span><span class="id"> det_ublock</span><span class="id"> unitrM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invmx_block_diag</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>)<span class="id"> n1</span><span class="id"> n2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Aul</span><span class="id"> :</span><span class="id"> 'M[R]_n1</span>) (<span class="id">Adr</span><span class="id"> :</span><span class="id"> 'M[R]_n2</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> Adr</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">invmx</span> (<span class="id">block_mx</span><span class="id"> Aul</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> Adr</span>)<span class="id"> =</span><span class="id"> block_mx</span> (<span class="id">invmx</span><span class="id"> Aul</span>)<span class="id"> 0</span><span class="id"> 0</span> (<span class="id">invmx</span><span class="id"> Adr</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /[dup]</span><span class="id"> Aunit;</span><span class="id"> rewrite</span><span class="id"> block_diag_mx_unit</span><span class="id"> =&gt;</span><span class="id"> /andP[Aul_unit</span><span class="id"> Adr_unit]</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[LHS]mul1mx;</span><span class="id"> apply:</span> (<span class="id">canLR</span> (<span class="id">mulmxK</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> [RHS]</span>(<span class="id">mulmx_block</span> (<span class="id">invmx</span><span class="id"> Aul</span>))<span class="id"> !</span>(<span class="id">mulmx0,</span><span class="id"> mul0mx,</span><span class="id"> add0r,</span><span class="id"> addr0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulVmx//</span><span class="id"> -?scalar_mx_block</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> countComUnitRingType</span>) (<span class="id">n'</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[Countable</span><span class="id"> of</span><span class="id"> 'M[R]_n'</span>.<span class="id">+1</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> finComUnitRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[Finite</span><span class="id"> of</span><span class="id"> 'M[R]_n</span>.<span class="id">+1</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<span class="vernacular">Section</span><span class="id"> FinUnitMatrix</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> GLtype</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> finComUnitRingType</span>)<span class="id"> :=</span><span class="id"> {unit</span><span class="id"> 'M[R]_n</span>.<span class="id">-1</span>.<span class="id">+1}</span>.<br/>
<br/>
<span class="vernacular">Coercion</span><span class="id"> GLval</span><span class="id"> R</span> (<span class="id">u</span><span class="id"> :</span><span class="id"> GLtype</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> 'M[R]_n</span>.<span class="id">-1</span>.<span class="id">+1</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span><span class="id"> FinRing</span>.<span class="id">Unit</span><span class="id"> A</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> u</span><span class="gallina-kwd"> in</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FinUnitMatrix</span>.<br/>
<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> group_scope</span><span class="gallina-kwd"> with</span><span class="id"> GLtype</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> GLtype</span><span class="id"> n%_N</span><span class="id"> R%_type</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> GLval</span><span class="id"> {n%_N</span><span class="id"> R}</span><span class="id"> u%_g</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ ''GL_' n [ R ] }&quot;</span><span class="id"> :=</span> (<span class="id">GLtype</span><span class="id"> n</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 0,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;{ ''GL_' n [ R ] }&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ ''GL_' n ( p ) }&quot;</span><span class="id"> :=</span><span class="id"> {'GL_n['F_p]}</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 0,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> p</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 10,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;{ ''GL_' n ( p ) }&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> finComUnitRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[isSub</span><span class="id"> of</span><span class="id"> {'GL_n[R]}</span><span class="gallina-kwd"> for</span><span class="id"> GLval]</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> GL_unit</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> finComUnitRingType</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> [Finite</span><span class="id"> of</span><span class="id"> {'GL_n[R]}</span><span class="gallina-kwd"> by</span><span class="id"> &lt;:]</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> FinGroup</span>.<span class="id">on</span><span class="id"> {'GL_n[R]}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> GLgroup</span><span class="id"> :=</span><span class="id"> [set:</span><span class="id"> {'GL_n[R]}]</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> GLgroup_group</span><span class="id"> :=</span><span class="vernacular"> Eval</span><span class="id"> hnf</span><span class="gallina-kwd"> in</span><span class="id"> [group</span><span class="id"> of</span><span class="id"> GLgroup]</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> {'GL_n[R]}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> GL_1E</span><span class="id"> :</span><span class="id"> GLval</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> GL_VE</span><span class="id"> u</span><span class="id"> :</span><span class="id"> GLval</span><span class="id"> u^-1</span><span class="id"> =</span> (<span class="id">GLval</span><span class="id"> u</span>)<span class="id">^-1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> GL_VxE</span><span class="id"> u</span><span class="id"> :</span><span class="id"> GLval</span><span class="id"> u^-1</span><span class="id"> =</span><span class="id"> invmx</span><span class="id"> u</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> GL_ME</span><span class="id"> u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> GLval</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> GLval</span><span class="id"> u</span><span class="id"> *</span><span class="id"> GLval</span><span class="id"> v</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> GL_MxE</span><span class="id"> u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> GLval</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> u</span><span class="id"> *m</span><span class="id"> v</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> GL_unit</span><span class="id"> u</span><span class="id"> :</span><span class="id"> GLval</span><span class="id"> u</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> valP</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> GL_unitmx</span><span class="id"> u</span><span class="id"> :</span><span class="id"> val</span><span class="id"> u</span><span class="id"> \in</span><span class="id"> unitmx</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> GL_unit</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> GL_det</span><span class="id"> u</span><span class="id"> :</span><span class="id"> \det</span><span class="id"> u</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraL</span> (<span class="id">GL_unitmx</span><span class="id"> u</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> unitmxE</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> GL_unit</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> GLgroup</span><span class="id"> n%_N</span><span class="id"> R%_type</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> GLgroup_group</span><span class="id"> n%_N</span><span class="id"> R%_type</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''GL_' n [ R ]&quot;</span><span class="id"> :=</span> (<span class="id">GLgroup</span><span class="id"> n</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;''GL_' n [ R ]&quot;</span>)<span class="id"> :</span><span class="id"> group_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''GL_' n ( p )&quot;</span><span class="id"> :=</span><span class="id"> 'GL_n['F_p]</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> p</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 10,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;''GL_' n ( p )&quot;</span>)<span class="id"> :</span><span class="id"> group_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''GL_' n [ R ]&quot;</span><span class="id"> :=</span> (<span class="id">GLgroup_group</span><span class="id"> n</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> Group_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''GL_' n ( p )&quot;</span><span class="id"> :=</span> (<span class="id">GLgroup_group</span><span class="id"> n</span><span class="id"> 'F_p</span>)<span class="id"> :</span><span class="id"> Group_scope</span>.<br/>
<br/>
<pre class="ssrdoc">
(********************** Matrices over a domain ******************************
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixDomain</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemx_eq0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> nz_a:</span> (<span class="id">a</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> /</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scale0r</span><span class="id"> eqxx</span>.<br/>
<span class="id">apply/eqP/eqP=&gt;</span><span class="id"> [aA0</span><span class="id"> |</span><span class="id"> -&gt;];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> scaler0</span>.<br/>
<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> apply/eqP;</span><span class="id"> move/matrixP/</span>(_<span class="id"> i</span><span class="id"> j</span>)<span class="id">/eqP:</span><span class="id"> aA0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulf_eq0</span><span class="id"> nz_a</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemx_inj</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id"> *:%R</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nz_a</span><span class="id"> A</span><span class="id"> B</span><span class="id"> eq_aAB;</span><span class="id"> apply:</span><span class="id"> contraNeq</span><span class="id"> nz_a</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[A</span><span class="id"> ==</span><span class="id"> B]subr_eq0</span><span class="id"> -[a</span><span class="id"> ==</span><span class="id"> 0]orbF</span><span class="id"> =&gt;</span><span class="id"> /negPf&lt;-</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalemx_eq0</span><span class="id"> linearB</span><span class="id"> subr_eq0</span><span class="id"> /=</span><span class="id"> eq_aAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det0P</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV[R]_n,</span><span class="id"> v</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> &amp;</span><span class="id"> v</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">\det</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> eqP</span>)<span class="id"> =&gt;</span><span class="id"> [detA0</span><span class="id"> |</span><span class="id"> [v</span><span class="id"> n0v</span><span class="id"> vA0]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contraNeq</span><span class="id"> n0v</span><span class="id"> =&gt;</span><span class="id"> nz_detA;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">inj_eq</span> (<span class="id">scalemx_inj</span><span class="id"> nz_detA</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scaler0</span><span class="id"> -mul_mx_scalar</span><span class="id"> -mul_mx_adj</span><span class="id"> mulmxA</span><span class="id"> vA0</span><span class="id"> mul0mx</span>.<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> detA0</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/idP:</span> (<span class="id">oner_eq0</span><span class="id"> R</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -detA0</span><span class="id"> [A]thinmx0</span><span class="id"> -</span>(<span class="id">thinmx0</span><span class="id"> 1%:M</span>)<span class="id"> det1</span>.<br/>
<span class="id">have</span><span class="id"> [{detA0}A'0</span><span class="id"> |</span><span class="id"> nzA']</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">row</span><span class="id"> 0</span> (<span class="id">\adj</span><span class="id"> A</span>))<span class="id"> 0;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">row</span><span class="id"> 0</span> (<span class="id">\adj</span><span class="id"> A</span>))<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> rowE</span><span class="id"> -mulmxA</span><span class="id"> mul_adj_mx</span><span class="id"> detA0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul_mx_scalar</span><span class="id"> scale0r</span>.<br/>
<span class="id">pose</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> col'</span><span class="id"> 0</span><span class="id"> A;</span><span class="id"> pose</span><span class="id"> vA</span><span class="id"> :=</span><span class="id"> col</span><span class="id"> 0</span><span class="id"> A</span>.<br/>
<span class="id">have</span><span class="id"> defA:</span><span class="id"> A</span><span class="id"> =</span><span class="id"> row_mx</span><span class="id"> vA</span><span class="id"> A'</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /[!mxE]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> -&gt;</span><span class="id"> /[!</span>(<span class="id">mxE,</span><span class="id"> ord1</span>)<span class="id">];</span><span class="id"> congr</span> (<span class="id">A</span><span class="id"> i</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> val_inj</span>.<br/>
<span class="id">have{IHn}</span><span class="id"> w_</span><span class="id"> j</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> w</span><span class="id"> :</span><span class="id"> 'rV_n</span>.<span class="id">+1,</span><span class="id"> [/\</span><span class="id"> w</span><span class="id"> !=</span><span class="id"> 0,</span><span class="id"> w</span><span class="id"> 0</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> &amp;</span><span class="id"> w</span><span class="id"> *m</span><span class="id"> A'</span><span class="id"> =</span><span class="id"> 0]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [|wj</span><span class="id"> nzwj</span><span class="id"> wjA'0]</span><span class="id"> :=</span><span class="id"> IHn</span> (<span class="id">row'</span><span class="id"> j</span><span class="id"> A'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> move/rowP/</span>(_<span class="id"> j</span>)<span class="id">/eqP:</span><span class="id"> A'0;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulf_eq0</span><span class="id"> signr_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">\row_k</span><span class="id"> oapp</span> (<span class="id">wj</span><span class="id"> 0</span>)<span class="id"> 0</span> (<span class="id">unlift</span><span class="id"> j</span><span class="id"> k</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> unlift_none</span><span class="id"> -wjA'0;</span><span class="id"> split=&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contraNneq</span><span class="id"> nzwj</span><span class="id"> =&gt;</span><span class="id"> w0;</span><span class="id"> apply/eqP/rowP=&gt;</span><span class="id"> k'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/rowP/</span>(_ (<span class="id">lift</span><span class="id"> j</span><span class="id"> k'</span>))<span class="id">:</span><span class="id"> w0;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> liftK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/rowP=&gt;</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !mxE</span> (<span class="id">bigD1_ord</span><span class="id"> j</span>)<span class="id"> //=</span><span class="id"> mxE</span><span class="id"> unlift_none</span><span class="id"> mul0r</span><span class="id"> add0r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_big</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> k';</span><span class="id"> rewrite</span><span class="id"> !mxE/=</span><span class="id"> liftK</span>.<br/>
<span class="id">have</span><span class="id"> [w0</span><span class="id"> [/rV0Pn[j</span><span class="id"> nz_w0j]</span><span class="id"> w00_0</span><span class="id"> w0A']]</span><span class="id"> :=</span><span class="id"> w_</span><span class="id"> 0;</span><span class="id"> pose</span><span class="id"> a0</span><span class="id"> :=</span> (<span class="id">w0</span><span class="id"> *m</span><span class="id"> vA</span>)<span class="id"> 0</span><span class="id"> 0</span>.<br/>
<span class="id">have{w_}</span><span class="id"> [wj</span><span class="id"> [nz_wj</span><span class="id"> wj0_0</span><span class="id"> wjA']]</span><span class="id"> :=</span><span class="id"> w_</span><span class="id"> j;</span><span class="id"> pose</span><span class="id"> aj</span><span class="id"> :=</span> (<span class="id">wj</span><span class="id"> *m</span><span class="id"> vA</span>)<span class="id"> 0</span><span class="id"> 0</span>.<br/>
<span class="id">have</span><span class="id"> [aj0</span><span class="id"> |</span><span class="id"> nz_aj]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> aj</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> wj</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> defA</span> (<span class="id">@mul_mx_row</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id"> [_</span><span class="id"> *m</span><span class="id"> _]mx11_scalar</span><span class="id"> -/aj</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> aj0</span><span class="id"> raddf0</span><span class="id"> wjA'</span><span class="id"> row_mx0</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">aj</span><span class="id"> *:</span><span class="id"> w0</span><span class="id"> -</span><span class="id"> a0</span><span class="id"> *:</span><span class="id"> wj</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contraNneq</span><span class="id"> nz_aj;</span><span class="id"> move/rowP/</span>(_<span class="id"> j</span>)<span class="id">/eqP;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> wj0_0</span><span class="id"> mulr0</span><span class="id"> subr0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_eq0</span> (<span class="id">negPf</span><span class="id"> nz_w0j</span>)<span class="id"> orbF</span>.<br/>
<span class="id">rewrite</span><span class="id"> defA</span> (<span class="id">@mul_mx_row</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id"> !mulmxBl</span><span class="id"> -!scalemxAl</span><span class="id"> w0A'</span><span class="id"> wjA'</span><span class="id"> !linear0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mul_mx_scalar</span><span class="id"> -mul_scalar_mx</span><span class="id"> -!mx11_scalar</span><span class="id"> subrr</span><span class="id"> addr0</span><span class="id"> row_mx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixDomain</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> det0P</span><span class="id"> {R</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MapFieldMatrix</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aF</span><span class="id"> :</span><span class="id"> fieldType</span>) (<span class="id">rF</span><span class="id"> :</span><span class="id"> comUnitRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aF</span><span class="id"> -&gt;</span><span class="id"> rF}</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_inj</span><span class="id"> {m</span><span class="id"> n}</span><span class="id"> :</span><span class="id"> injective</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> A</span><span class="id"> B</span><span class="id"> eq_AB;</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/matrixP/</span>(_<span class="id"> i</span><span class="id"> j</span>)<span class="id">:</span><span class="id"> eq_AB</span><span class="id"> =&gt;</span><span class="id"> /[!mxE];</span><span class="id"> apply:</span><span class="id"> fmorph_inj</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_is_scalar</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> is_scalar_mx</span><span class="id"> A^f</span><span class="id"> =</span><span class="id"> is_scalar_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /is_scalar_mx;</span><span class="id"> case:</span> (<span class="id">insub</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> -map_scalar_mx</span><span class="id"> inj_eq</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> map_mx_inj</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_unitmx</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">A^f</span><span class="id"> \in</span><span class="id"> unitmx</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitmxE</span><span class="id"> det_map_mx</span><span class="id"> //</span><span class="id"> fmorph_unit</span><span class="id"> //</span><span class="id"> -unitfE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_unit</span><span class="id"> n'</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n'</span>.<span class="id">+1</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A^f</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> map_unitmx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_invmx</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">invmx</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> invmx</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /invmx</span><span class="id"> map_unitmx</span> (<span class="id">fun_if</span> (<span class="id">map_mx</span><span class="id"> f</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> map_mxZ</span><span class="id"> map_mx_adj</span><span class="id"> det_map_mx</span><span class="id"> fmorphV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_inv</span><span class="id"> n'</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n'</span>.<span class="id">+1</span>)<span class="id"> :</span><span class="id"> A^-1^f</span><span class="id"> =</span><span class="id"> A^f^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> map_invmx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mx_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A^f</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">inj_eq</span><span class="id"> map_mx_inj</span>)<span class="id"> raddf0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MapFieldMatrix</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> map_mx_inj</span><span class="id"> {aF</span><span class="id"> rF</span><span class="id"> f</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> [A1</span><span class="id"> A2]</span><span class="id"> eqA12f</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<pre class="ssrdoc">
(***************************** LUP decomposition ****************************
</pre>
<br/>
<span class="vernacular">Section</span><span class="id"> CormenLUP</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> cormen_lup</span><span class="id"> {n}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> n</span><span class="gallina-kwd"> return</span><span class="gallina-kwd"> let</span><span class="id"> M</span><span class="id"> :=</span><span class="id"> 'M[F]_n</span>.<span class="id">+1</span><span class="gallina-kwd"> in</span><span class="id"> M</span><span class="id"> -&gt;</span><span class="id"> M</span><span class="id"> *</span><span class="id"> M</span><span class="id"> *</span><span class="id"> M</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> 0</span><span class="id"> =&gt;</span><span class="gallina-kwd"> fun</span><span class="id"> A</span><span class="id"> =&gt;</span> (<span class="id">1,</span><span class="id"> 1,</span><span class="id"> A</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span>.<span class="id">+1</span><span class="id"> =&gt;</span><span class="gallina-kwd"> fun</span><span class="id"> A</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> k</span><span class="id"> :=</span><span class="id"> odflt</span><span class="id"> 0</span><span class="id"> [pick</span><span class="id"> k</span><span class="id"> |</span><span class="id"> A</span><span class="id"> k</span><span class="id"> 0</span><span class="id"> !=</span><span class="id"> 0]</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> _</span>)<span class="id"> :=</span><span class="id"> xrow</span><span class="id"> 0</span><span class="id"> k</span><span class="id"> A</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> P1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> _</span>)<span class="id"> :=</span><span class="id"> tperm_mx</span><span class="id"> 0</span><span class="id"> k</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> Schur</span><span class="id"> :=</span> ((<span class="id">A</span><span class="id"> k</span><span class="id"> 0</span>)<span class="id">^-1</span><span class="id"> *:</span><span class="id"> dlsubmx</span><span class="id"> A1</span>)<span class="id"> *m</span><span class="id"> ursubmx</span><span class="id"> A1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">P2,</span><span class="id"> L2,</span><span class="id"> U2</span>)<span class="id"> :=</span><span class="id"> cormen_lup</span> (<span class="id">drsubmx</span><span class="id"> A1</span><span class="id"> -</span><span class="id"> Schur</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> P</span><span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> 1</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> P2</span><span class="id"> *m</span><span class="id"> P1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> L</span><span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> 1</span><span class="id"> 0</span> ((<span class="id">A</span><span class="id"> k</span><span class="id"> 0</span>)<span class="id">^-1</span><span class="id"> *:</span> (<span class="id">P2</span><span class="id"> *m</span><span class="id"> dlsubmx</span><span class="id"> A1</span>))<span class="id"> L2</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> block_mx</span> (<span class="id">ulsubmx</span><span class="id"> A1</span>) (<span class="id">ursubmx</span><span class="id"> A1</span>)<span class="id"> 0</span><span class="id"> U2</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P,</span><span class="id"> L,</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cormen_lup_perm</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>.<span class="id">+1</span>)<span class="id"> :</span><span class="id"> is_perm_mx</span> (<span class="id">cormen_lup</span><span class="id"> A</span>).<span class="id">1</span>.<span class="id">1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> is_perm_mx1</span>.<br/>
<span class="id">set</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _;</span><span class="id"> move/</span>(_<span class="id"> A'</span>)<span class="id">:</span><span class="id"> IHn;</span><span class="id"> case:</span><span class="id"> cormen_lup</span><span class="id"> =&gt;</span><span class="id"> [[P</span><span class="id"> L</span><span class="id"> U]]</span><span class="id"> {A'}/=</span>.<br/>
<span class="id">rewrite</span> (<span class="id">is_perm_mxMr</span><span class="id"> _</span> (<span class="id">perm_mx_is_perm</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> case/is_perm_mxP</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> -&gt;;</span><span class="id"> apply:</span><span class="id"> lift0_mx_is_perm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cormen_lup_correct</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>.<span class="id">+1</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">P,</span><span class="id"> L,</span><span class="id"> U</span>)<span class="id"> :=</span><span class="id"> cormen_lup</span><span class="id"> A</span><span class="gallina-kwd"> in</span><span class="id"> P</span><span class="id"> *</span><span class="id"> A</span><span class="id"> =</span><span class="id"> L</span><span class="id"> *</span><span class="id"> U</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mul1r</span>.<br/>
<span class="id">set</span><span class="id"> k</span><span class="id"> :=</span><span class="id"> odflt</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> A1</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> _</span>)<span class="id"> :=</span><span class="id"> xrow</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>.<br/>
<span class="id">set</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _;</span><span class="id"> move/</span>(_<span class="id"> A'</span>)<span class="id">:</span><span class="id"> IHn;</span><span class="id"> case:</span><span class="id"> cormen_lup</span><span class="id"> =&gt;</span><span class="id"> [[P'</span><span class="id"> L'</span><span class="id"> U']]</span><span class="id"> /=</span><span class="id"> IHn</span>.<br/>
<span class="id">rewrite</span><span class="id"> -mulrA</span><span class="id"> -!mulmxE</span><span class="id"> -xrowE</span><span class="id"> -/A1</span><span class="id"> /=</span><span class="id"> -[n</span>.<span class="id">+2]/</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>.<span class="id">+1</span>)<span class="id">%N</span><span class="id"> -{1}</span>(<span class="id">submxK</span><span class="id"> A1</span>).<br/>
<span class="id">rewrite</span><span class="id"> !mulmx_block</span><span class="id"> !mul0mx</span><span class="id"> !mulmx0</span><span class="id"> !add0r</span><span class="id"> !addr0</span><span class="id"> !mul1mx</span><span class="id"> -{L'</span><span class="id"> U'}[L'</span><span class="id"> *m</span><span class="id"> _]IHn</span>.<br/>
<span class="id">rewrite</span><span class="id"> -scalemxAl</span><span class="id"> !scalemxAr</span><span class="id"> -!mulmxA</span><span class="id"> addrC</span><span class="id"> -mulrDr</span><span class="id"> {A'}subrK</span>.<br/>
<span class="id">congr</span> (<span class="id">block_mx</span><span class="id"> _</span><span class="id"> _</span> (_<span class="id"> *m</span><span class="id"> _</span>)<span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> [_</span><span class="id"> *:</span><span class="id"> _]mx11_scalar</span><span class="id"> !mxE</span><span class="id"> lshift0</span><span class="id"> tpermL</span><span class="id"> {}/A1</span><span class="id"> {}/k</span>.<br/>
<span class="id">case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [k</span><span class="id"> nzAk0</span><span class="id"> |</span><span class="id"> no_k];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulVf</span><span class="id"> ?mulmx1</span>.<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> dlsubmx</span><span class="id"> _</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> ?mul0mx</span><span class="id"> //;</span><span class="id"> apply/colP=&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> lshift0</span> (<span class="id">elimNf</span><span class="id"> eqP</span> (<span class="id">no_k</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cormen_lup_detL</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>.<span class="id">+1</span>)<span class="id"> :</span><span class="id"> \det</span> (<span class="id">cormen_lup</span><span class="id"> A</span>).<span class="id">1</span>.<span class="id">2</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> det1</span>.<br/>
<span class="id">set</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _;</span><span class="id"> move/</span>(_<span class="id"> A'</span>)<span class="id">:</span><span class="id"> IHn;</span><span class="id"> case:</span><span class="id"> cormen_lup</span><span class="id"> =&gt;</span><span class="id"> [[P</span><span class="id"> L</span><span class="id"> U]]</span><span class="id"> {A'}/=</span><span class="id"> detL</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@det_lblock</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id"> det1</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cormen_lup_lower</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I_n</span>.<span class="id">+1</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span><span class="id"> -&gt;</span> (<span class="id">cormen_lup</span><span class="id"> A</span>).<span class="id">1</span>.<span class="id">2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span> (<span class="id">i</span><span class="id"> ==</span><span class="id"> j</span>)<span class="id">%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [i]ord1</span><span class="id"> [j]ord1</span><span class="id"> mxE</span>.<br/>
<span class="id">set</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _;</span><span class="id"> move/</span>(_<span class="id"> A'</span>)<span class="id">:</span><span class="id"> IHn;</span><span class="id"> case:</span><span class="id"> cormen_lup</span><span class="id"> =&gt;</span><span class="id"> [[P</span><span class="id"> L</span><span class="id"> U]]</span><span class="id"> {A'}/=</span><span class="id"> Ll</span>.<br/>
<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> split1;</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [i'|]</span><span class="id"> -&gt;</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> split1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [j'|]</span><span class="id"> -&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> Ll</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [j'|]</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cormen_lup_upper</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I_n</span>.<span class="id">+1</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">j</span><span class="id"> &lt;</span><span class="id"> i</span><span class="id"> -&gt;</span> (<span class="id">cormen_lup</span><span class="id"> A</span>).<span class="id">2</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [i]ord1</span>.<br/>
<span class="id">set</span><span class="id"> A'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _;</span><span class="id"> move/</span>(_<span class="id"> A'</span>)<span class="id">:</span><span class="id"> IHn;</span><span class="id"> case:</span><span class="id"> cormen_lup</span><span class="id"> =&gt;</span><span class="id"> [[P</span><span class="id"> L</span><span class="id"> U]]</span><span class="id"> {A'}/=</span><span class="id"> Uu</span>.<br/>
<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> split1;</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [i'|]</span><span class="id"> -&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> split1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> unliftP</span><span class="id"> =&gt;</span><span class="id"> [j'|]</span><span class="id"> -&gt;;</span><span class="id"> [apply:</span><span class="id"> Uu</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> mxE]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CormenLUP</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> mxOver</span>.<br/>
<span class="vernacular">Section</span><span class="id"> mxOverType</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> T}</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxOver_pred</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> T}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span><span class="id"> M</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> [forall</span><span class="id"> i,</span><span class="id"> [forall</span><span class="id"> j,</span><span class="id"> M</span><span class="id"> i</span><span class="id"> j</span><span class="id"> \in</span><span class="id"> S]]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxOver_pred</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mxOver</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> T}</span>)<span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> a</span><span class="id"> M</span><span class="id"> |</span><span class="id"> mxOver_pred</span><span class="id"> S</span><span class="id"> M]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOverP</span><span class="id"> {S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> T}}</span><span class="id"> {M</span><span class="id"> :</span><span class="id"> 'M[T]__}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> M</span><span class="id"> i</span><span class="id"> j</span><span class="id"> \in</span><span class="id"> S</span>) (<span class="id">M</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/'forall_forallP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOverS</span> (<span class="id">S1</span><span class="id"> S2</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> T}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{subset</span><span class="id"> S1</span><span class="id"> &lt;=</span><span class="id"> S2}</span><span class="id"> -&gt;</span><span class="id"> {subset</span><span class="id"> mxOver</span><span class="id"> S1</span><span class="id"> &lt;=</span><span class="id"> mxOver</span><span class="id"> S2}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> sS12</span><span class="id"> M</span><span class="id"> /mxOverP</span><span class="id"> S1M;</span><span class="id"> apply/mxOverP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> apply/sS12/S1M</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver_const</span><span class="id"> c</span><span class="id"> S</span><span class="id"> :</span><span class="id"> c</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> const_mx</span><span class="id"> c</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> cS;</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver_constE</span><span class="id"> c</span><span class="id"> S</span><span class="id"> :</span> (<span class="id">m</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">const_mx</span><span class="id"> c</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">c</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> m_gt0</span><span class="id"> n_gt0;</span><span class="id"> apply/idP/idP;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> mxOver_const</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /mxOverP</span><span class="id"> /</span>(_ (<span class="id">Ordinal</span><span class="id"> m_gt0</span>) (<span class="id">Ordinal</span><span class="id"> n_gt0</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> mxOverType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> thinmxOver</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">n,</span><span class="id"> 0</span>))<span class="id"> S</span><span class="id"> :</span><span class="id"> M</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> flatmxOver</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">0,</span><span class="id"> n</span>))<span class="id"> S</span><span class="id"> :</span><span class="id"> M</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> mxOverZmodule</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {M</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> M}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver0</span><span class="id"> S</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> @mxOver</span><span class="id"> m</span><span class="id"> n</span><span class="id"> _</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxOver_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> mxOverAdd</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> addS</span><span class="id"> :</span><span class="id"> addrClosed</span><span class="id"> M</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> mxOver_add_subproof</span><span class="id"> :</span><span class="id"> addr_closed</span> (<span class="id">@mxOver</span><span class="id"> m</span><span class="id"> n</span><span class="id"> _</span><span class="id"> addS</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|p</span><span class="id"> q</span><span class="id"> Sp</span><span class="id"> Sq];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxOver0</span><span class="id"> //</span><span class="id"> ?rpred0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/mxOverP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> rpredD</span><span class="id"> //</span><span class="id"> !</span>(<span class="id">mxOverP</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isAddClosed</span>.<span class="id">Build</span><span class="id"> 'M[M]_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">mxOver_pred</span><span class="id"> addS</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mxOver_add_subproof</span>.<br/>
<span class="vernacular">End</span><span class="id"> mxOverAdd</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> mxOverOpp</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> oppS</span><span class="id"> :</span><span class="id"> opprClosed</span><span class="id"> M</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> mxOver_opp_subproof</span><span class="id"> :</span><span class="id"> oppr_closed</span> (<span class="id">@mxOver</span><span class="id"> m</span><span class="id"> n</span><span class="id"> _</span><span class="id"> oppS</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> /mxOverP</span><span class="id"> SA;</span><span class="id"> apply/mxOverP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxE</span><span class="id"> rpredN</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isOppClosed</span>.<span class="id">Build</span><span class="id"> 'M[M]_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">mxOver_pred</span><span class="id"> oppS</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mxOver_opp_subproof</span>.<br/>
<span class="vernacular">End</span><span class="id"> mxOverOpp</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">zmodS</span><span class="id"> :</span><span class="id"> zmodClosed</span><span class="id"> M</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">OppClosed</span>.<span class="id">on</span> (<span class="id">mxOver_pred</span><span class="id"> zmodS</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> mxOverZmodule</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> mxOverRing</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver_scalar</span><span class="id"> S</span><span class="id"> c</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> c</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> c%:M</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> @mxOver</span><span class="id"> n</span><span class="id"> n</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> S0</span><span class="id"> cS;</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver_scalarE</span><span class="id"> S</span><span class="id"> c</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%N</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">c%:M</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> @mxOver</span><span class="id"> n</span><span class="id"> n</span><span class="id"> R</span><span class="id"> S</span>)<span class="id"> =</span> ((<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 1</span>)<span class="id"> ==&gt;</span> (<span class="id">0</span><span class="id"> \in</span><span class="id"> S</span>))<span class="id"> &amp;&amp;</span> (<span class="id">c</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|[|k]]//=</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/mxOverP/idP</span><span class="id"> =&gt;</span><span class="id"> [/</span>(_<span class="id"> ord0</span><span class="id"> ord0</span>)<span class="id">|cij</span><span class="id"> i</span><span class="id"> j];</span><span class="id"> rewrite</span><span class="id"> ?mxE</span><span class="id"> ?ord1</span>.<br/>
<span class="id">apply/mxOverP/andP</span><span class="id"> =&gt;</span><span class="id"> [cij|[S0</span><span class="id"> cij]</span><span class="id"> i</span><span class="id"> j];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> [have</span><span class="id"> :=</span><span class="id"> cij</span><span class="id"> 0</span><span class="id"> 1|have</span><span class="id"> :=</span><span class="id"> cij</span><span class="id"> 0</span><span class="id"> 0];</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOverZ</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> mulrClosed</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> mxOver</span><span class="id"> S,</span><span class="gallina-kwd"> forall</span><span class="id"> a</span><span class="id"> :</span><span class="id"> R,</span><span class="gallina-kwd"> forall</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> v</span><span class="id"> aS</span><span class="id"> /mxOverP</span><span class="id"> vS;</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rpredM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver_diag</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>)<span class="id"> k</span> (<span class="id">D</span><span class="id"> :</span><span class="id"> 'rV[R]_k</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">0</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> D</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> diag_mx</span><span class="id"> D</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> S0</span><span class="id"> DS;</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span> (<span class="id">mxOverP</span><span class="id"> DS</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOver_diagE</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>)<span class="id"> k</span> (<span class="id">D</span><span class="id"> :</span><span class="id"> 'rV[R]_k</span>)<span class="id"> :</span><span class="id"> k</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">diag_mx</span><span class="id"> D</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>)<span class="id"> =</span> ((<span class="id">k</span><span class="id"> &gt;</span><span class="id"> 1</span>)<span class="id"> ==&gt;</span> (<span class="id">0</span><span class="id"> \in</span><span class="id"> S</span>))<span class="id"> &amp;&amp;</span> (<span class="id">D</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> [|[|k]]//=</span><span class="gallina-kwd"> in</span><span class="id"> D</span><span class="id"> *</span><span class="id"> =&gt;</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [diag_mx</span><span class="id"> _]mx11_scalar</span><span class="id"> [D</span><span class="gallina-kwd"> in</span><span class="id"> RHS]mx11_scalar</span><span class="id"> !mxE</span>.<br/>
<span class="id">apply/idP/andP</span><span class="id"> =&gt;</span><span class="id"> [/mxOverP</span><span class="id"> DS|[S0</span><span class="id"> DS]];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> mxOver_diag</span>.<br/>
<span class="id">split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> /[!mxE]</span><span class="id"> :=</span><span class="id"> DS</span><span class="id"> 0</span><span class="id"> 1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> DS</span><span class="id"> j</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> ord1</span><span class="id"> !mxE</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxOverM</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> semiringClosed</span><span class="id"> R</span>)<span class="id"> p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> mxOver</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> mxOver</span><span class="id"> S,</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> u</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">p,</span><span class="id"> q</span>)<span class="id">,</span><span class="gallina-kwd"> forall</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">q,</span><span class="id"> r</span>)<span class="id">,</span><span class="id"> u</span><span class="id"> *m</span><span class="id"> v</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> mxOver</span><span class="id"> S}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> M</span><span class="id"> N</span><span class="id"> /mxOverP</span><span class="id"> MS</span><span class="id"> /mxOverP</span><span class="id"> NS;</span><span class="id"> apply/mxOverP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> rpred_sum</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> rpredM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> mxOverRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> mxRingOver</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> semiring</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> semiringClosed</span><span class="id"> R</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> mxOver_mul_subproof</span><span class="id"> :</span><span class="id"> mulr_closed</span> (<span class="id">@mxOver</span><span class="id"> n</span><span class="id"> n</span><span class="id"> _</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> ?mxOver_scalar</span><span class="id"> ?rpred0</span><span class="id"> ?rpred1//;</span><span class="id"> apply:</span><span class="id"> mxOverM</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isMulClosed</span>.<span class="id">Build</span><span class="id"> _</span> (<span class="id">mxOver_pred</span><span class="id"> S</span>)<br/>
&nbsp;&nbsp;<span class="id">mxOver_mul_subproof</span>.<br/>
<span class="vernacular">End</span><span class="id"> semiring</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> subringClosed</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">MulClosed</span>.<span class="id">on</span> (<span class="id">mxOver_pred</span><span class="id"> S</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> mxRingOver</span>.<br/>
<span class="vernacular">End</span><span class="id"> mxOver</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockMatrix</span>.<br/>
<span class="vernacular">Import</span><span class="id"> tagnat</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sq</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> q_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sp</span>) (<span class="id">t</span><span class="id"> :</span><span class="id"> 'I_sq</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxblock</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix_</span>(<span class="id">j,</span><span class="id"> k</span>)<span class="id"> B_</span> (<span class="id">sig1</span><span class="id"> j</span>) (<span class="id">sig1</span><span class="id"> k</span>) (<span class="id">sig2</span><span class="id"> j</span>) (<span class="id">sig2</span><span class="id"> k</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxblock_ ( i , j ) E&quot;</span><span class="id"> :=</span> (<span class="id">mxblock</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> E</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxrow</span><span class="id"> m</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix_</span>(<span class="id">j,</span><span class="id"> k</span>)<span class="id"> B_</span> (<span class="id">sig1</span><span class="id"> k</span>)<span class="id"> j</span> (<span class="id">sig2</span><span class="id"> k</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxrow_ i E&quot;</span><span class="id"> :=</span> (<span class="id">mxrow</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> E</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxcol</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix_</span>(<span class="id">j,</span><span class="id"> k</span>)<span class="id"> B_</span> (<span class="id">sig1</span><span class="id"> j</span>) (<span class="id">sig2</span><span class="id"> j</span>)<span class="id"> k</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxcol_ i E&quot;</span><span class="id"> :=</span> (<span class="id">mxcol</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> E</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> submxblock</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">sp,</span><span class="id"> sq</span>))<span class="id"> i</span><span class="id"> j</span><span class="id"> :=</span><span class="id"> mxsub</span>  (<span class="id">Rank</span><span class="id"> i</span>) (<span class="id">Rank</span><span class="id"> j</span>)<span class="id"> A</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> submxrow</span><span class="id"> m</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> sq</span>))   <span class="id"> j</span><span class="id"> :=</span><span class="id"> colsub</span>          (<span class="id">Rank</span><span class="id"> j</span>)<span class="id"> A</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> submxcol</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">sp,</span><span class="id"> n</span>)) <span class="id"> i</span>  <span class="id"> :=</span><span class="id"> rowsub</span> (<span class="id">Rank</span><span class="id"> i</span>)         <span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockEh</span><span class="id"> B_</span><span class="id"> :</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxrow_j</span><span class="id"> \mxcol_i</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockEv</span><span class="id"> B_</span><span class="id"> :</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxcol_i</span><span class="id"> \mxrow_j</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblockEh</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> submxblock</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> submxcol</span> (<span class="id">submxrow</span><span class="id"> A</span><span class="id"> j</span>)<span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblockEv</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> submxblock</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> submxrow</span> (<span class="id">submxcol</span><span class="id"> A</span><span class="id"> i</span>)<span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockK</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> submxblock</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrowK</span><span class="id"> m</span><span class="id"> B_</span><span class="id"> j</span><span class="id"> :</span><span class="id"> @submxrow</span><span class="id"> m</span> (<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcolK</span><span class="id"> n</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> :</span><span class="id"> @submxcol</span><span class="id"> n</span> (<span class="id">\mxcol_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> i</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrow_matrix</span><span class="id"> B_</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">submxrow</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> \mxcol_i</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxblockEh</span><span class="id"> mxrowK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcol_matrix</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">submxcol</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> i</span><span class="id"> =</span><span class="id"> \mxrow_j</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxblockEv</span><span class="id"> mxcolK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblockK</span><span class="id"> A</span><span class="id"> :</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">submxblock</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !sig2K</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrowK</span><span class="id"> m</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> sq</span>))<span class="id"> :</span><span class="id"> \mxrow_j</span> (<span class="id">submxrow</span><span class="id"> A</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !sig2K</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcolK</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">sp,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \mxcol_i</span> (<span class="id">submxcol</span><span class="id"> A</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !sig2K</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockP</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> submxblock</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> submxblock</span><span class="id"> B</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> &lt;-&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [eqAB|-&gt;//];</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> s</span><span class="id"> t;</span><br/>
<span class="id">have</span><span class="id"> /matrixP</span><span class="id"> :=</span><span class="id"> eqAB</span> (<span class="id">sig1</span><span class="id"> s</span>) (<span class="id">sig1</span><span class="id"> t</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(_ (<span class="id">sig2</span><span class="id"> s</span>) (<span class="id">sig2</span><span class="id"> t</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !sig2K</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrowP</span><span class="id"> m</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> sq</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> j,</span><span class="id"> submxrow</span><span class="id"> A</span><span class="id"> j</span><span class="id"> =</span><span class="id"> submxrow</span><span class="id"> B</span><span class="id"> j</span>)<span class="id"> &lt;-&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [eqAB|-&gt;//];</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> t;</span><span class="id"> have</span><span class="id"> /matrixP</span><span class="id"> :=</span><span class="id"> eqAB</span> (<span class="id">sig1</span><span class="id"> t</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(_<span class="id"> i</span> (<span class="id">sig2</span><span class="id"> t</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !sig2K</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcolP</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">sp,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> submxcol</span><span class="id"> A</span><span class="id"> i</span><span class="id"> =</span><span class="id"> submxcol</span><span class="id"> B</span><span class="id"> i</span>)<span class="id"> &lt;-&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [eqAB|-&gt;//];</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> s</span><span class="id"> j;</span><span class="id"> have</span><span class="id"> /matrixP</span><span class="id"> :=</span><span class="id"> eqAB</span> (<span class="id">sig1</span><span class="id"> s</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(_ (<span class="id">sig2</span><span class="id"> s</span>)<span class="id"> j</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !sig2K</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxblockP</span><span class="id"> A_</span><span class="id"> B_</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> &lt;-&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> apply/mxblockP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxblockK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> /mxblockP/</span>(_<span class="id"> i</span><span class="id"> j</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxblockK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxblock</span><span class="id"> A_</span><span class="id"> B_</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_mxblockP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxrowP</span><span class="id"> m</span> (<span class="id">A_</span><span class="id"> B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> j,</span><span class="id"> A_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">\mxrow_j</span><span class="id"> A_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> apply/mxrowP</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxrowK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> /mxrowP/</span>(_<span class="id"> j</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxrowK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxrow</span><span class="id"> m</span> (<span class="id">A_</span><span class="id"> B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> j,</span><span class="id"> A_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id"> -&gt;</span> (<span class="id">\mxrow_j</span><span class="id"> A_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_mxrowP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxcolP</span><span class="id"> n</span> (<span class="id">A_</span><span class="id"> B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">\mxcol_i</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \mxcol_i</span><span class="id"> B_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> apply/mxcolP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !mxcolK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> /mxcolP/</span>(_<span class="id"> i</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mxcolK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxcol</span><span class="id"> n</span> (<span class="id">A_</span><span class="id"> B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> -&gt;</span> (<span class="id">\mxcol_i</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \mxcol_i</span><span class="id"> B_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_mxcolP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxrow</span><span class="id"> m</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i</span> (<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \mxrow_j</span> (<span class="id">row</span><span class="id"> i</span> (<span class="id">B_</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxrow</span><span class="id"> m</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> j</span> (<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> col</span> (<span class="id">sig2</span><span class="id"> j</span>) (<span class="id">B_</span> (<span class="id">sig1</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxcol</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i</span> (<span class="id">\mxcol_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> row</span> (<span class="id">sig2</span><span class="id"> i</span>) (<span class="id">B_</span> (<span class="id">sig1</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxcol</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> j</span> (<span class="id">\mxcol_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">col</span><span class="id"> j</span> (<span class="id">B_</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxblock</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> i</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \mxrow_j</span><span class="id"> row</span> (<span class="id">sig2</span><span class="id"> i</span>) (<span class="id">B_</span> (<span class="id">sig1</span><span class="id"> i</span>)<span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/rowP</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxblock</span><span class="id"> B_</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> j</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \mxcol_i</span><span class="id"> col</span> (<span class="id">sig2</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span> (<span class="id">sig1</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/colP</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockMatrix</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxblock_ ( i &lt; m , j &lt; n ) E&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">mxblock</span> (<span class="gallina-kwd">fun</span> (<span class="id">i</span><span class="id"> :</span><span class="id"> 'I_m</span>) (<span class="id">j</span><span class="id"> :</span><span class="id"> 'I_</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> E</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxblock_ ( i , j &lt; n ) E&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\mxblock_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> E</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxblock_ ( i , j ) E&quot;</span><span class="id"> :=</span> (<span class="id">\mxblock_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> _,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxrow_ ( j &lt; m ) E&quot;</span><span class="id"> :=</span> (<span class="id">mxrow</span> (<span class="gallina-kwd">fun</span> (<span class="id">j</span><span class="id"> :</span><span class="id"> 'I_m</span>)<span class="id"> =&gt;</span><span class="id"> E</span>))<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxrow_ j E&quot;</span><span class="id"> :=</span> (<span class="id">\mxrow_</span>(<span class="id">j</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxcol_ ( i &lt; m ) E&quot;</span><span class="id"> :=</span> (<span class="id">mxcol</span> (<span class="gallina-kwd">fun</span> (<span class="id">i</span><span class="id"> :</span><span class="id"> 'I_m</span>)<span class="id"> =&gt;</span><span class="id"> E</span>))<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxcol_ i E&quot;</span><span class="id"> :=</span> (<span class="id">\mxcol_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_mxblock</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> j</span><span class="id"> i</span>)<span class="id">^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> SquareBlockMatrix</span>.<br/>
<br/>
<span class="vernacular">Context</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {p</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sp</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_mxrow</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">n,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="id">^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_mxcol</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxcol_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> \mxrow_i</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="id">^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_submxblock</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_sp</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">submxblock</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span>)<span class="id">^T</span><span class="id"> =</span> (<span class="id">submxblock</span><span class="id"> A^T</span><span class="id"> j</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_submxrow</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">n,</span><span class="id"> sp</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">submxrow</span><span class="id"> A</span><span class="id"> j</span>)<span class="id">^T</span><span class="id"> =</span> (<span class="id">submxcol</span><span class="id"> A^T</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_submxcol</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">sp,</span><span class="id"> n</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">submxcol</span><span class="id"> A</span><span class="id"> i</span>)<span class="id">^T</span><span class="id"> =</span> (<span class="id">submxrow</span><span class="id"> A^T</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SquareBlockMatrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockRowRecL</span>.<br/>
<span class="vernacular">Import</span><span class="id"> tagnat</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {m</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_m</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxsize_recl</span><span class="id"> :</span> (<span class="id">p_</span><span class="id"> ord0</span><span class="id"> +</span><span class="id"> \sum_i</span><span class="id"> p_</span> (<span class="id">lift</span><span class="id"> ord0</span><span class="id"> i</span>)<span class="id"> =</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>))<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_ord_recl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrow_recl</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">n,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">erefl,</span><span class="id"> mxsize_recl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">row_mx</span> (<span class="id">B_</span><span class="id"> 0</span>) (<span class="id">\mxrow_j</span><span class="id"> B_</span> (<span class="id">lift</span><span class="id"> ord0</span><span class="id"> j</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/mxrowP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> mxrowK</span>.<br/>
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">castmxE,</span><span class="id"> mxE</span>)<span class="id">/=</span>.<br/>
<span class="id">case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> /=;</span><span class="id"> do</span><span class="id"> [</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [LHS]RankEsum</span><span class="id"> big_mkcond</span><span class="id"> big_ord_recl</span><span class="id"> -big_mkcond/=;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /bump/=</span><span class="id"> -addnA</span><span class="id"> cast_ord_id;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">under</span><span class="id"> eq_bigl</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> add1n</span><span class="id"> -ltn_predRL/=]</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> posnP</span><span class="id"> =&gt;</span><span class="id"> i0;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> lE;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> ltn_ord</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> -lE</span><span class="id"> -ltn_subRL</span><span class="id"> subnn</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@val_inj</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> i</span><span class="id"> 0</span><span class="id"> i0</span>)<span class="id"> big_pred0_eq</span><span class="gallina-kwd"> in</span><span class="id"> k</span><span class="id"> *</span><span class="id"> =&gt;</span><span class="id"> /val_inj-&gt;</span>.<br/>
<span class="id">case:</span><span class="id"> posnP</span><span class="id"> =&gt;</span><span class="id"> i0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@val_inj</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> i</span><span class="id"> 0</span><span class="id"> i0</span>)<span class="id"> big_pred0_eq</span><span class="gallina-kwd"> in</span><span class="id"> k</span><span class="id"> l</span><span class="id"> *</span><span class="id"> =&gt;</span><span class="id"> kE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> ltn_ord</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> [val</span><span class="id"> k]kE</span><span class="id"> -ltn_subRL</span><span class="id"> subnn</span>.<br/>
<span class="id">have</span><span class="id"> i_lt</span><span class="id"> :</span><span class="id"> i</span>.<span class="id">-1</span><span class="id"> &lt;</span><span class="id"> m</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -subn1</span><span class="id"> ltn_subLR</span>.<br/>
<span class="id">set</span><span class="id"> i'</span><span class="id"> :=</span><span class="id"> lift</span><span class="id"> ord0</span> (<span class="id">Ordinal</span><span class="id"> i_lt</span>).<br/>
<span class="id">have</span><span class="id"> ii'</span><span class="id"> :</span><span class="id"> i</span><span class="id"> =</span><span class="id"> i'</span><span class="gallina-kwd"> by</span><span class="id"> apply/val_inj;</span><span class="id"> rewrite</span><span class="id"> /=/bump/=</span><span class="id"> add1n</span><span class="id"> prednK</span>.<br/>
<span class="id">have</span><span class="id"> k_lt</span><span class="id"> :</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> p_</span><span class="id"> i'</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ii'</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /addnI;</span><span class="id"> rewrite</span><span class="id"> eqRank</span><span class="id"> =&gt;</span><span class="id"> /val_inj/=</span><span class="id"> /[dup]</span><span class="id"> kl&lt;-;</span><span class="id"> rewrite</span><span class="id"> mxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> Rank2K//;</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> cast_ord_id/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -/i';</span><span class="id"> set</span><span class="id"> j'</span><span class="id"> :=</span><span class="id"> Ordinal</span><span class="id"> _;</span><span class="id"> have</span><span class="id"> :</span><span class="id"> k</span><span class="id"> =</span><span class="id"> j'</span><span class="id"> :&gt;</span><span class="id"> nat</span><span class="gallina-kwd"> by</span><span class="id"> []</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> -ii'</span><span class="id"> =&gt;</span><span class="id"> j'</span><span class="id"> /val_inj-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockRowRecL</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcol_recu</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> {p</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> j,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_j</span><span class="id"> B_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">mxsize_recl,</span><span class="id"> erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">col_mx</span> (<span class="id">B_</span><span class="id"> 0</span>) (<span class="id">\mxcol_j</span><span class="id"> B_</span> (<span class="id">lift</span><span class="id"> ord0</span><span class="id"> j</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_cast</span><span class="id"> tr_col_mx</span><span class="id"> !tr_mxcol</span><span class="id"> mxrow_recl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockMatrixRec</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> e</span><span class="id"> :=</span> (<span class="id">mxsize_recl,</span><span class="id"> mxsize_recl</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> l0</span><span class="id"> :=</span> (<span class="id">lift</span><span class="id"> ord0</span>).<br/>
<span class="vernacular">Context</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblock_recu</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">mxsize_recl,</span><span class="id"> erefl</span>) (<span class="id">col_mx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> ord0</span><span class="id"> j</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span> (<span class="id">l0</span><span class="id"> i</span>)<span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mxblockEv</span><span class="id"> mxcol_recu</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblock_recl</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">erefl,</span><span class="id"> mxsize_recl</span>)<br/>
&nbsp;&nbsp;(<span class="id">row_mx</span> (<span class="id">\mxcol_i</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> ord0</span>) (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span> (<span class="id">l0</span><span class="id"> j</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mxblockEh</span><span class="id"> mxrow_recl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblock_recul</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> castmx</span><span class="id"> e</span> (<span class="id">block_mx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> 0</span><span class="id"> 0</span>)                  (<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> ord0</span> (<span class="id">l0</span><span class="id"> j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\mxcol_i</span><span class="id"> B_</span> (<span class="id">l0</span><span class="id"> i</span>)<span class="id"> ord0</span>) (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span> (<span class="id">l0</span><span class="id"> i</span>) (<span class="id">l0</span><span class="id"> j</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxblock_recl</span><span class="id"> mxcol_recu</span><span class="id"> mxblock_recu</span><span class="id"> -cast_row_mx</span><span class="id"> -block_mxEh</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> castmx_comp;</span><span class="id"> apply:</span><span class="id"> eq_castmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrowEblock</span><span class="id"> {q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxrow_j</span><span class="id"> R_</span><span class="id"> j</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span> (<span class="id">big_ord1</span><span class="id"> _</span> (<span class="id">fun=&gt;</span><span class="id"> m</span>)<span class="id">,</span><span class="id"> erefl</span>) (<span class="id">\mxblock_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> 1,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> q</span>)<span class="id"> R_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxblock_recu</span><span class="id"> castmx_comp</span>.<br/>
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !castmxE</span><span class="id"> !mxE/=;</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> k</span><span class="id"> /val_inj-&gt;;</span><span class="id"> rewrite</span><span class="id"> ?cast_ord_id</span><span class="id"> ?mxE//=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [k</span><span class="id"> klt];</span><span class="id"> suff:</span><span class="id"> false</span><span class="gallina-kwd"> by</span><span class="id"> [];</span><span class="id"> rewrite</span><span class="id"> big_ord0</span><span class="gallina-kwd"> in</span><span class="id"> klt</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcolEblock</span><span class="id"> {p</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[T]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxcol_i</span><span class="id"> C_</span><span class="id"> i</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">castmx</span> (<span class="id">erefl,</span><span class="id"> big_ord1</span><span class="id"> _</span> (<span class="id">fun=&gt;</span><span class="id"> n</span>)) (<span class="id">\mxblock_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> p,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> C_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> tr_mxcol</span><span class="id"> mxrowEblock</span><span class="id"> trmx_cast</span><span class="id"> tr_mxblock</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxEmxrow</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">erefl,</span><span class="id"> big_ord1</span><span class="id"> _</span> (<span class="id">fun=&gt;</span><span class="id"> n</span>)) (<span class="id">\mxrow__</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> castmxE</span><span class="id"> !mxE/=</span><span class="id"> cast_ord_id</span>.<br/>
<span class="id">congr</span> (<span class="id">A</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> set</span><span class="id"> j'</span><span class="id"> :=</span><span class="id"> cast_ord</span><span class="id"> _</span><span class="id"> _</span>.<br/>
<span class="id">suff</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> j'</span><span class="id"> =</span> (<span class="id">tagnat</span>.<span class="id">Rank</span><span class="id"> 0</span><span class="id"> j</span>)<span class="gallina-kwd"> by</span><span class="id"> apply/val_inj;</span><span class="id"> rewrite</span><span class="id"> tagnat</span>.<span class="id">Rank2K</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/val_inj;</span><span class="id"> rewrite</span><span class="id"> [RHS]tagnat</span>.<span class="id">RankEsum/=</span><span class="id"> big_pred0_eq</span><span class="id"> add0n</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxEmxcol</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">big_ord1</span><span class="id"> _</span> (<span class="id">fun=&gt;</span><span class="id"> m</span>)<span class="id">,</span><span class="id"> erefl</span>) (<span class="id">\mxcol__</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_cast</span><span class="id"> tr_mxcol</span><span class="id"> [LHS]mxEmxrow</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxEmxblock</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[T]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">big_ord1</span><span class="id"> _</span> (<span class="id">fun=&gt;</span><span class="id"> m</span>)<span class="id">,</span><span class="id"> big_ord1</span><span class="id"> _</span> (<span class="id">fun=&gt;</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\mxblock_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> 1,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [LHS]mxEmxrow</span><span class="id"> mxrowEblock</span><span class="id"> castmx_comp;</span><span class="id"> apply:</span><span class="id"> eq_castmx</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockMatrixRec</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockRowZmod</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {V</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> {q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sq</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> q_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sq</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrowD</span><span class="id"> m</span> (<span class="id">R_</span><span class="id"> R'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_j</span> (<span class="id">R_</span><span class="id"> j</span><span class="id"> +</span><span class="id"> R'_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \mxrow_j</span> (<span class="id">R_</span><span class="id"> j</span>)<span class="id"> +</span><span class="id"> \mxrow_j</span> (<span class="id">R'_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrowN</span><span class="id"> m</span> (<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_j</span> (<span class="id">-</span><span class="id"> R_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> \mxrow_j</span> (<span class="id">R_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrowB</span><span class="id"> m</span> (<span class="id">R_</span><span class="id"> R'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_j</span> (<span class="id">R_</span><span class="id"> j</span><span class="id"> -</span><span class="id"> R'_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \mxrow_j</span> (<span class="id">R_</span><span class="id"> j</span>)<span class="id"> -</span><span class="id"> \mxrow_j</span> (<span class="id">R'_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrow0</span><span class="id"> m</span><span class="id"> :</span><span class="id"> \mxrow_j</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrow_const</span><span class="id"> m</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \mxrow_j</span> (<span class="id">const_mx</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrow_sum</span> (<span class="id">J</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> J}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_j</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> R_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> \mxrow_j</span> (<span class="id">R_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> summxE</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrowD</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> sq</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxrow</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> B'</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> submxrow</span><span class="id"> B</span><span class="id"> j</span><span class="id"> +</span><span class="id"> submxrow</span><span class="id"> B'</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrowN</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> sq</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxrow</span> (<span class="id">-</span><span class="id"> B</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> -</span><span class="id"> submxrow</span><span class="id"> B</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrowB</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> sq</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxrow</span> (<span class="id">B</span><span class="id"> -</span><span class="id"> B'</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> submxrow</span><span class="id"> B</span><span class="id"> j</span><span class="id"> -</span><span class="id"> submxrow</span><span class="id"> B'</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrow0</span><span class="id"> m</span><span class="id"> j</span><span class="id"> :</span><span class="id"> submxrow</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> sq</span>))<span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxrow_sum</span> (<span class="id">J</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">m,</span><span class="id"> sq</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> J}</span>)<span class="id"> j:</span><br/>
&nbsp;&nbsp;<span class="id">submxrow</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> R_</span><span class="id"> i</span>)<span class="id"> j</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> submxrow</span> (<span class="id">R_</span><span class="id"> i</span>)<span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> i';</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> summxE</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockRowZmod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockRowRing</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sq</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> q_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sq</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxrow</span><span class="id"> m</span><span class="id"> n'</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n'</span>)) (<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">n',</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> \mxrow_j</span><span class="id"> R_</span><span class="id"> j=</span><span class="id"> \mxrow_j</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> R_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_submxrow</span><span class="id"> m</span><span class="id"> n'</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> n'</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n',</span><span class="id"> sq</span>))<span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> submxrow</span><span class="id"> B</span><span class="id"> j=</span><span class="id"> submxrow</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockRowRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockColZmod</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {V</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sp</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcolD</span><span class="id"> m</span> (<span class="id">C_</span><span class="id"> C'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_i</span> (<span class="id">C_</span><span class="id"> i</span><span class="id"> +</span><span class="id"> C'_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">C_</span><span class="id"> i</span>)<span class="id"> +</span><span class="id"> \mxcol_i</span> (<span class="id">C'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcolN</span><span class="id"> m</span> (<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_i</span> (<span class="id">-</span><span class="id"> C_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> \mxcol_i</span> (<span class="id">C_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcolB</span><span class="id"> m</span> (<span class="id">C_</span><span class="id"> C'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_i</span> (<span class="id">C_</span><span class="id"> i</span><span class="id"> -</span><span class="id"> C'_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">C_</span><span class="id"> i</span>)<span class="id"> -</span><span class="id"> \mxcol_i</span> (<span class="id">C'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcol0</span><span class="id"> m</span><span class="id"> :</span><span class="id"> \mxcol_i</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcol_const</span><span class="id"> m</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \mxcol_j</span> (<span class="id">const_mx</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> j,</span><span class="id"> m</span>))<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcol_sum</span><br/>
&nbsp;&nbsp;(<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span> (<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_i</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> C_</span><span class="id"> j</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> \mxcol_i</span> (<span class="id">C_</span><span class="id"> j</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> summxE</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcolD</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> m</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxcol</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> B'</span>)<span class="id"> i</span><span class="id"> =</span><span class="id"> submxcol</span><span class="id"> B</span><span class="id"> i</span><span class="id"> +</span><span class="id"> submxcol</span><span class="id"> B'</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcolN</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> m</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxcol</span> (<span class="id">-</span><span class="id"> B</span>)<span class="id"> i</span><span class="id"> =</span><span class="id"> -</span><span class="id"> submxcol</span><span class="id"> B</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcolB</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> m</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxcol</span> (<span class="id">B</span><span class="id"> -</span><span class="id"> B'</span>)<span class="id"> i</span><span class="id"> =</span><span class="id"> submxcol</span><span class="id"> B</span><span class="id"> i</span><span class="id"> -</span><span class="id"> submxcol</span><span class="id"> B'</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcol0</span><span class="id"> m</span><span class="id"> i</span><span class="id"> :</span><span class="id"> submxcol</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> m</span>))<span class="id"> i</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcol_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> m</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">submxcol</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> C_</span><span class="id"> j</span>)<span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> submxcol</span> (<span class="id">C_</span><span class="id"> j</span>)<span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> summxE</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockColZmod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockColRing</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sp</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxcol_mul</span><span class="id"> n'</span><span class="id"> m</span> (<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n'</span>)) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n',</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_i</span><span class="id"> C_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">C_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxcol_mul</span><span class="id"> n'</span><span class="id"> m</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">sp,</span><span class="id"> n'</span>)) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">n',</span><span class="id"> m</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">submxcol</span><span class="id"> B</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> submxcol</span> (<span class="id">B</span><span class="id"> *m</span><span class="id"> A</span>)<span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> j</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockColRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockMatrixZmod</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {V</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_m</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sq</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> q_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockD</span> (<span class="id">B_</span><span class="id"> B'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> +</span><span class="id"> B'_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> +</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B'_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockN</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">-</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblockB</span> (<span class="id">B_</span><span class="id"> B'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> -</span><span class="id"> B'_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B'_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblock0</span><span class="id"> :</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblock_const</span><span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">const_mx</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> =</span><span class="id"> const_mx</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxblock_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> k</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">\sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> B_</span><span class="id"> k</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> k</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> summxE</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblockD</span> (<span class="id">B</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> sq</span>))<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxblock</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> B'</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> submxblock</span><span class="id"> B</span><span class="id"> i</span><span class="id"> j</span><span class="id"> +</span><span class="id"> submxblock</span><span class="id"> B'</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblockN</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> sq</span>))<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxblock</span> (<span class="id">-</span><span class="id"> B</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> -</span><span class="id"> submxblock</span><span class="id"> B</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblockB</span> (<span class="id">B</span><span class="id"> B'</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> sq</span>))<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;<span class="id">submxblock</span> (<span class="id">B</span><span class="id"> -</span><span class="id"> B'</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> submxblock</span><span class="id"> B</span><span class="id"> i</span><span class="id"> j</span><span class="id"> -</span><span class="id"> submxblock</span><span class="id"> B'</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblock0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> submxblock</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> sq</span>))<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/matrixP=&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblock_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> k,</span><span class="id"> 'M[V]_</span>(<span class="id">sp,</span><span class="id"> sq</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">submxblock</span> (<span class="id">\sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> B_</span><span class="id"> k</span>)<span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> submxblock</span> (<span class="id">B_</span><span class="id"> k</span>)<span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mxE,</span><span class="id"> summxE</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockMatrixZmod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BlockMatrixRing</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sq</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> q_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxrow_mxcol</span><span class="id"> m</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> p_</span><span class="id"> j</span>)) (<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_j</span><span class="id"> R_</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> \mxcol_i</span><span class="id"> C_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_i</span> (<span class="id">R_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> C_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> summxE;</span><span class="id"> under</span><span class="id"> [RHS]eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> sig_big_dep/=</span> (<span class="id">reindex</span><span class="id"> _</span><span class="id"> tagnat</span>.<span class="id">sig_bij_on</span>)<span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr=&gt;</span><span class="id"> l</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxcol_mxrow</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>)) (<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxcol_i</span><span class="id"> C_</span><span class="id"> i*m</span><span class="id"> \mxrow_j</span><span class="id"> R_</span><span class="id"> j</span> <span class="id"> =</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">C_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> R_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/mxblockP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> mxblockK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> submxblockEh</span><span class="id"> -mul_submxrow</span><span class="id"> -submxcol_mul</span><span class="id"> mxcolK</span><span class="id"> mxrowK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxrow_mxblock</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> p_</span><span class="id"> i</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_i</span><span class="id"> R_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxrow_j</span> (<span class="id">\sum_i</span> (<span class="id">R_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxblockEv</span><span class="id"> mul_mxrow_mxcol</span><span class="id"> mxrow_sum</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mul_mxrow</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxblock_mxrow</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">q_</span><span class="id"> i,</span><span class="id"> p_</span><span class="id"> j</span>)) (<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> \mxcol_j</span><span class="id"> C_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">\sum_j</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> C_</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxblockEh</span><span class="id"> mul_mxrow_mxcol</span><span class="id"> mxcol_sum</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxcol_mul</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BlockMatrixRing</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxblock</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> r</span><span class="id"> :</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {r_</span><span class="id"> :</span><span class="id"> 'I_r</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="id"> k,</span><span class="id"> 'M_</span>(<span class="id">q_</span><span class="id"> j,</span><span class="id"> r_</span><span class="id"> k</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> A_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> \mxblock_</span>(<span class="id">j,</span><span class="id"> k</span>)<span class="id"> B_</span><span class="id"> j</span><span class="id"> k</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> k</span>)<span class="id"> \sum_j</span> (<span class="id">A_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> B_</span><span class="id"> j</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxblockEh</span><span class="id"> mul_mxrow_mxblock</span><span class="id"> mxblockEh;</span><span class="id"> apply:</span><span class="id"> eq_mxrow</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> under</span><span class="id"> [LHS]eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxcol_mul;</span><span class="id"> rewrite</span><span class="id"> -mxcol_sum</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> SquareBlockMatrixZmod</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span><span class="id"> tagnat</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {V</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> {p</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sp</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_trig_mxblockP</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span><span class="id"> [/\</span><span class="gallina-kwd"> forall</span> (<span class="id">i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I_p</span>)<span class="id">,</span> (<span class="id">i</span><span class="id"> &lt;</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> is_trig_mx</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> i</span>)<span class="id">]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_trig_mx</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> is_trig_mxP</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [Blt1</span><span class="id"> /</span>(_<span class="id"> _</span>)<span class="id">/is_trig_mxP</span><span class="id"> Blt2]/=</span><span class="id"> s</span><span class="id"> s';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[_</span><span class="id"> &lt;</span><span class="id"> _]lt_sig</span><span class="id"> ltEsig/=</span><span class="id"> /sig1</span><span class="id"> /sig2</span><span class="id"> leEord</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> ltngtP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> ii';</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">Blt1</span><span class="id"> _</span><span class="id"> _</span><span class="id"> ii'</span>)<span class="id"> mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">sig</span><span class="id"> s</span>) (<span class="id">sig</span><span class="id"> s'</span>)<span class="id"> ii'</span><span class="id"> =&gt;</span><span class="id"> -[/=</span><span class="id"> i</span><span class="id"> j]</span><span class="id"> [/=</span><span class="id"> i'</span><span class="id"> +]</span><span class="id"> /val_inj</span><span class="id"> ii'</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> ii'</span><span class="id"> =&gt;</span><span class="id"> j';</span><span class="id"> rewrite</span><span class="id"> tagged_asE</span><span class="id"> =&gt;</span><span class="id"> /Blt2-&gt;</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> Btrig;</span><span class="id"> split=&gt;</span><span class="id"> [i</span><span class="id"> i'</span><span class="id"> lti|i]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Btrig</span> (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j</span>) (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j'</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K;</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /Rank</span><span class="id"> [_</span><span class="id"> &lt;=</span><span class="id"> _]lt_rank</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltEsig/=</span><span class="id"> leEord</span><span class="id"> ltnW//=</span> (<span class="id">ltn_geF</span><span class="id"> lti</span>)<span class="id">//=</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> isT</span>).<br/>
<span class="id">apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j'</span><span class="id"> ltj;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Btrig</span> (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j</span>) (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j'</span>).<br/>
<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K;</span><span class="id"> do!</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> &lt;=</span><span class="id"> _]lt_rank</span><span class="id"> ltEsig/=</span><span class="id"> !leEord</span><span class="id"> leqnn/=</span><span class="id"> tagged_asE;</span><span class="id"> apply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_trig_mxblock</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_trig_mx</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="id">[forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'I_p,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I_p,</span> (<span class="id">i</span><span class="id"> &lt;</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> ==&gt;</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">]</span><span class="id"> &amp;&amp;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">[forall</span><span class="id"> i,</span><span class="id"> is_trig_mx</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> i</span>)<span class="id">]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/is_trig_mxblockP/andP</span><span class="id"> =&gt;</span><span class="id"> -[]</span><span class="id"> =&gt;</span><span class="id"> [/</span>(_<span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">/eqP|]</span><br/>
&nbsp;&nbsp;<span class="id">=&gt;</span><span class="id"> /'forall_'forall_implyP</span><span class="id"> =&gt;</span><span class="id"> [|/</span>(_<span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">/eqP]</span><span class="id"> Blt</span><span class="id"> /forallP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_mxblockP</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span><span class="id"> [/\</span><span class="gallina-kwd"> forall</span> (<span class="id">i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I_p</span>)<span class="id">,</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> j</span><span class="id"> -&gt;</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> is_diag_mx</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> i</span>)<span class="id">]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is_diag_mx</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> is_diag_mxP</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [Bneq1</span><span class="id"> /</span>(_<span class="id"> _</span>)<span class="id">/is_diag_mxP</span><span class="id"> Bneq2]/=</span><span class="id"> s</span><span class="id"> s';</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> val_eqE</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> sigK</span>)<span class="id"> /sig1</span><span class="id"> /sig2</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">sig</span><span class="id"> s</span>) (<span class="id">sig</span><span class="id"> s'</span>)<span class="id"> =&gt;</span><span class="id"> -[/=</span><span class="id"> i</span><span class="id"> j]</span><span class="id"> [/=</span><span class="id"> i'</span><span class="id"> j']</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -tag_eqE/=</span><span class="id"> /tag_eq/=</span><span class="id"> negb_and</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [ii'|/Bneq1-&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ii'</span><span class="gallina-kwd"> in</span><span class="id"> j'</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> tagged_asE</span><span class="id"> =&gt;</span><span class="id"> /Bneq2</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> Bdiag;</span><span class="id"> split=&gt;</span><span class="id"> [i</span><span class="id"> i'</span><span class="id"> Ni|i]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j';</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Bdiag</span> (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j</span>) (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j'</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K;</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_Rank</span><span class="id"> negb_and</span><span class="id"> Ni;</span><span class="id"> apply</span>.<br/>
<span class="id">apply/is_diag_mxP</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> j'</span><span class="id"> Nj;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Bdiag</span> (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j</span>) (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j'</span>).<br/>
<span class="id">rewrite</span><span class="id"> !mxE</span><span class="id"> !Rank2K;</span><span class="id"> do!</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> !cast_ord_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_Rank</span><span class="id"> negb_and</span><span class="id"> val_eqE</span><span class="id"> Nj</span><span class="id"> orbT;</span><span class="id"> apply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_diag_mxblock</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">is_diag_mx</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="id">[forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'I_p,</span><span class="gallina-kwd"> forall</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'I_p,</span> (<span class="id">i</span><span class="id"> !=</span><span class="id"> j</span>)<span class="id"> ==&gt;</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">]</span><span class="id"> &amp;&amp;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">[forall</span><span class="id"> i,</span><span class="id"> is_diag_mx</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> i</span>)<span class="id">]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/is_diag_mxblockP/andP</span><span class="id"> =&gt;</span><span class="id"> -[]</span><span class="id"> =&gt;</span><span class="id"> [/</span>(_<span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">/eqP|]</span><br/>
&nbsp;&nbsp;<span class="id">=&gt;</span><span class="id"> /'forall_'forall_implyP</span><span class="id"> =&gt;</span><span class="id"> [|/</span>(_<span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">/eqP]</span><span class="id"> Blt</span><span class="id"> /forallP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxdiag</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">j,</span><span class="id"> k</span>)<span class="gallina-kwd"> if</span><span class="id"> j</span><span class="id"> ==</span><span class="id"> k</span><span class="gallina-kwd"> then</span><span class="id"> conform_mx</span><span class="id"> 0</span> (<span class="id">B_</span><span class="id"> j</span>)<span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\mxdiag_ i E&quot;</span><span class="id"> :=</span> (<span class="id">mxdiag</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> E</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxblock_diag</span> (<span class="id">B_</span> <span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> i</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">submxblock</span> (<span class="id">\mxdiag_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> i</span><span class="id"> i</span><span class="id"> =</span><span class="id"> B_</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxblockK</span><span class="id"> conform_mx_id</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxdiagP</span> (<span class="id">B_</span><span class="id"> B'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> B'_</span><span class="id"> i</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">\mxdiag_i</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \mxdiag_i</span><span class="id"> B'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdiag;</span><span class="id"> split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> apply/eq_mxblockP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> e</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> /eq_mxblockP/</span>(_<span class="id"> i</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> eqxx</span><span class="id"> !conform_mx_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_mxdiag</span> (<span class="id">B_</span><span class="id"> B'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> B'_</span><span class="id"> i</span>)<span class="id"> -&gt;</span> (<span class="id">\mxdiag_i</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \mxdiag_i</span><span class="id"> B'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_mxdiagP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiagD</span> (<span class="id">B_</span><span class="id"> B'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_i</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> +</span><span class="id"> B'_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \mxdiag_i</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="id"> +</span><span class="id"> \mxdiag_i</span> (<span class="id">B'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdiag</span><span class="id"> -mxblockD;</span><span class="id"> apply/eq_mxblock</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?conform_mx_id</span><span class="id"> ?addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiagN</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_i</span> (<span class="id">-</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> \mxdiag_i</span> (<span class="id">B_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdiag</span><span class="id"> -mxblockN;</span><span class="id"> apply/eq_mxblock</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?conform_mx_id</span><span class="id"> ?oppr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiagB</span> (<span class="id">B_</span><span class="id"> B'_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_i</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> -</span><span class="id"> B'_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \mxdiag_i</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="id"> -</span><span class="id"> \mxdiag_i</span> (<span class="id">B'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxdiagD</span><span class="id"> mxdiagN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiag0</span><span class="id"> :</span><span class="id"> \mxdiag_i</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> under</span><span class="id"> [LHS]eq_mxdiag</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> -[0]subr0;</span><span class="id"> rewrite</span><span class="id"> mxdiagB</span><span class="id"> subrr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiag_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> k</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>)) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_i</span> (<span class="id">\sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> B_</span><span class="id"> k</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">k</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> \mxdiag_i</span> (<span class="id">B_</span><span class="id"> k</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdiag</span><span class="id"> -mxblock_sum;</span><span class="id"> apply/eq_mxblock</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="id">case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?conform_mx_id//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> conform_mx_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tr_mxdiag</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxdiag_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id">^T</span><span class="id"> =</span><span class="id"> \mxdiag_i</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="id">^T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> tr_mxblock;</span><span class="id"> apply/eq_mxblock</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?trmx_conform</span><span class="id"> ?trmx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_mxdiag</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> k</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> B'_</span><span class="id"> i</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> sig1</span><span class="id"> k</span><span class="id"> ==</span><span class="id"> i</span><span class="gallina-kwd"> then</span><span class="id"> conform_mx</span><span class="id"> 0</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="gallina-kwd"> else</span><span class="id"> 0</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">row</span><span class="id"> k</span> (<span class="id">\mxdiag_</span><span class="id"> i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> row</span> (<span class="id">sig2</span><span class="id"> k</span>) (<span class="id">\mxrow_i</span><span class="id"> B'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> row_mxblock</span><span class="id"> row_mxrow;</span><span class="id"> apply/eq_mxrow</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> e;</span><span class="id"> congr</span><span class="id"> row;</span><span class="id"> rewrite</span><span class="id"> e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mxdiag</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> k</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> B'_</span><span class="id"> i</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> sig1</span><span class="id"> k</span><span class="id"> ==</span><span class="id"> i</span><span class="gallina-kwd"> then</span><span class="id"> conform_mx</span><span class="id"> 0</span> (<span class="id">B_</span><span class="id"> i</span>)<span class="gallina-kwd"> else</span><span class="id"> 0</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">col</span><span class="id"> k</span> (<span class="id">\mxdiag_</span><span class="id"> i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> col</span> (<span class="id">sig2</span><span class="id"> k</span>) (<span class="id">\mxcol_i</span><span class="id"> B'_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> col_mxblock</span><span class="id"> col_mxcol;</span><span class="id"> apply/eq_mxcol</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SquareBlockMatrixZmod</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxdiag_ ( i &lt; n ) E&quot;</span><span class="id"> :=</span> (<span class="id">mxdiag</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> =&gt;</span><span class="id"> E</span>))<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\mxdiag_ i E&quot;</span><span class="id"> :=</span> (<span class="id">\mxdiag_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id"> E</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiag_recl</span><span class="id"> {V</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> {m</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_m</span>.<span class="id">+1</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[V]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_i</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">mxsize_recl,</span><span class="id"> mxsize_recl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">block_mx</span> (<span class="id">B_</span><span class="id"> 0</span>)<span class="id"> 0</span><span class="id"> 0</span> (<span class="id">\mxdiag_i</span><span class="id"> B_</span> (<span class="id">lift</span><span class="id"> ord0</span><span class="id"> i</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdiag</span><span class="id"> mxblock_recul/=</span><span class="id"> !conform_mx_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (<span class="id">castmx</span><span class="id"> _</span> (<span class="id">block_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?mxrow0</span><span class="id"> ?mxcol0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> SquareBlockMatrixRing</span>.<br/>
<span class="vernacular">Import</span><span class="id"> tagnat</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {p</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sp</span><span class="id"> :=</span> (<span class="id">\sum_i</span><span class="id"> p_</span><span class="id"> i</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> 'I_sp</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_mxblock</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\tr</span> (<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \sum_i</span><span class="id"> \tr</span> (<span class="id">B_</span><span class="id"> i</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxtrace</span><span class="id"> sig_big_dep</span> (<span class="id">reindex</span><span class="id"> _</span><span class="id"> sig_bij_on</span>)<span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdiagZ</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \mxdiag_i</span> (<span class="id">a%:M</span><span class="id"> :</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> =</span><span class="id"> a%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> sigK</span>)<span class="id"> /sig1</span><span class="id"> /sig2</span>.<br/>
<span class="id">case:</span> (<span class="id">sig</span><span class="id"> s</span>) (<span class="id">sig</span><span class="id"> t</span>)<span class="id"> =&gt;</span><span class="id"> [/=</span><span class="id"> i</span><span class="id"> j]</span><span class="id"> [/=</span><span class="id"> i'</span><span class="id"> j']</span>.<br/>
<span class="id">case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [&lt;-|ni]</span><span class="gallina-kwd"> in</span><span class="id"> j'</span><span class="id"> *;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> conform_mx_id</span><span class="id"> eq_Tagged/=</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diag_mxrow</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'rV[R]_</span>(<span class="id">p_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">diag_mx</span> (<span class="id">\mxrow_j</span><span class="id"> B_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> \mxdiag_j</span> (<span class="id">diag_mx</span> (<span class="id">B_</span><span class="id"> j</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> s</span><span class="id"> s';</span><span class="id"> rewrite</span><span class="id"> !mxE/=</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> sigK</span>)<span class="id"> /sig1</span><span class="id"> /sig2</span>.<br/>
<span class="id">case:</span> (<span class="id">sig</span><span class="id"> s</span>) (<span class="id">sig</span><span class="id"> s'</span>)<span class="id"> =&gt;</span><span class="id"> [/=</span><span class="id"> i</span><span class="id"> j]</span><span class="id"> [/=</span><span class="id"> i'</span><span class="id"> j']</span>.<br/>
<span class="id">rewrite</span><span class="id"> -tag_eqE</span><span class="id"> /tag_eq/=;</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> i</span><span class="id"> i'</span>)<span class="id"> =&gt;</span><span class="id"> ii';</span><span class="id"> rewrite</span><span class="id"> ?mxE//=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> ii'</span><span class="gallina-kwd"> in</span><span class="id"> j'</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> tagged_asE/=</span><span class="id"> conform_mx_id</span><span class="id"> mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxtrace_mxdiag</span> (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\tr</span> (<span class="id">\mxdiag_i</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_i</span><span class="id"> \tr</span> (<span class="id">B_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxtrace_mxblock;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> eqxx/=</span><span class="id"> conform_mx_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxdiag_mxcol</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">D_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i</span>)) (<span class="id">C_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_i</span><span class="id"> D_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> \mxcol_i</span><span class="id"> C_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \mxcol_i</span> (<span class="id">D_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> C_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdiag</span><span class="id"> mxblockEh</span><span class="id"> mul_mxrow_mxcol</span>.<br/>
<span class="id">under</span><span class="id"> [LHS]eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxcol_mul;</span><span class="id"> rewrite</span><span class="id"> -mxcol_sum</span>.<br/>
<span class="id">apply/eq_mxcol</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id">//=</span><span class="id"> eqxx</span><span class="id"> conform_mx_id</span><span class="id"> big1</span><span class="id"> ?addr0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> j;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> mul0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SquareBlockMatrixRing</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxrow_mxdiag</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {p</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">m,</span><span class="id"> p_</span><span class="id"> i</span>)) (<span class="id">D_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxrow_i</span><span class="id"> R_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> \mxdiag_i</span><span class="id"> D_</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \mxrow_i</span> (<span class="id">R_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> D_</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> trmx_mul_rev</span><span class="id"> !tr_mxrow</span><span class="id"> tr_mxdiag</span><span class="id"> mul_mxdiag_mxcol</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/</span><span class="id"> eq_mxcol</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> trmx_mul_rev</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxblock_mxdiag</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;<span class="id">{p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>)) (<span class="id">D_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">q_</span><span class="id"> j</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> \mxdiag_j</span><span class="id"> D_</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> D_</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxblockEh</span><span class="id"> mul_mxrow_mxdiag;</span><span class="id"> under</span><span class="id"> eq_mxrow</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mxcol_mul</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul_mxdiag_mxblock</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> pzRingType}</span><span class="id"> {p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;<span class="id">{p_</span><span class="id"> :</span><span class="id"> 'I_p</span><span class="id"> -&gt;</span><span class="id"> nat}</span><span class="id"> {q_</span><span class="id"> :</span><span class="id"> 'I_q</span><span class="id"> -&gt;</span><span class="id"> nat}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">D_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> j</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 'M[R]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> q_</span><span class="id"> j</span>))<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">\mxdiag_j</span><span class="id"> D_</span><span class="id"> j</span><span class="id"> *m</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>)<span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \mxblock_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">D_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B_</span><span class="id"> i</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxblockEv</span><span class="id"> mul_mxdiag_mxcol;</span><span class="id"> under</span><span class="id"> eq_mxcol</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mul_mxrow</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> Vandermonde</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> 'rV[R]_n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\matrix_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> m,</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> a</span><span class="id"> 0</span><span class="id"> j</span><span class="id"> ^+</span><span class="id"> i</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> det_Vandermonde</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> 'rV[R]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\det</span> (<span class="id">Vandermonde</span><span class="id"> n</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> \prod_</span>(<span class="id">j</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> j</span>) (<span class="id">a</span><span class="id"> 0</span><span class="id"> j</span><span class="id"> -</span><span class="id"> a</span><span class="id"> 0</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> @Vandermonde</span><span class="id"> R</span>.<br/>
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="gallina-kwd"> in</span><span class="id"> a</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> det_mx00</span><span class="id"> big1//</span><span class="id"> =&gt;</span><span class="id"> -[]</span><span class="id"> []</span>.<br/>
<span class="id">pose</span><span class="id"> b</span><span class="id"> :</span><span class="id"> 'rV_n</span><span class="id"> :=</span><span class="id"> \row_i</span><span class="id"> a</span><span class="id"> 0</span> (<span class="id">lift</span><span class="id"> 0</span><span class="id"> i</span>).<br/>
<span class="id">pose</span><span class="id"> C</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><span class="id"> diag_mx</span> (<span class="id">\row_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>) (<span class="id">b</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> -</span><span class="id"> a</span><span class="id"> 0</span><span class="id"> 0</span>)).<br/>
<span class="id">pose</span><span class="id"> D</span><span class="id"> :</span><span class="id"> 'M_n</span>.<span class="id">+1</span><span class="id"> :=</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> a</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> *:</span><span class="id"> \matrix_</span>(<span class="id">i,</span><span class="id"> j</span>) (<span class="id">i</span><span class="id"> ==</span><span class="id"> j</span>.<span class="id">+1</span><span class="id"> :&gt;</span><span class="id"> nat</span>)<span class="id">%:R</span>. <br/>
<span class="id">have</span><span class="id"> detD</span><span class="id"> :</span><span class="id"> \det</span><span class="id"> D</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> det_trig</span><span class="id"> ?big_ord_recl</span><span class="id"> ?mxE</span><span class="id"> ?mulr0</span><span class="id"> ?subr0</span><span class="id"> ?eqxx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?big1</span><span class="id"> ?mulr1//</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> eqxx</span><span class="id"> ltn_eqF//</span><span class="id"> mulr0</span><span class="id"> subr0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/is_trig_mxP</span><span class="id"> =&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> ![_</span><span class="id"> ==</span><span class="id"> _]ltn_eqF</span><span class="id"> ?mulr0</span><span class="id"> ?subr0</span><span class="id"> ?leqW</span>.<br/>
<span class="id">suff:</span><span class="id"> D</span><span class="id"> *</span><span class="id"> V</span><span class="id"> _</span><span class="id"> _</span><span class="id"> a</span><span class="id"> =</span><span class="id"> block_mx</span><span class="id"> 1</span> (<span class="id">const_mx</span><span class="id"> 1</span>)<span class="id"> 0</span> (<span class="id">V</span><span class="id"> _</span><span class="id"> _</span><span class="id"> b</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id"> :&gt;</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /</span>(<span class="id">congr1</span><span class="id"> determinant</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> detM</span><span class="id"> detD</span><span class="id"> mul1r</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> det_ublock</span><span class="id"> det1</span><span class="id"> mul1r</span><span class="id"> det_mulmx</span><span class="id"> IHn</span><span class="id"> big_ord_recl</span><span class="id"> mulrC;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_mkcond</span><span class="id"> big_ord_recl/=</span><span class="id"> mul1r</span><span class="id"> det_diag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_mkcond</span><span class="id"> [RHS]big_mkcond</span><span class="id"> big_ord_recl/=</span><span class="id"> mul1r</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulrBl</span><span class="id"> mul1r</span><span class="id"> -[_</span><span class="id"> *</span><span class="id"> _]scalemxAl;</span><span class="id"> apply/matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
<span class="id">under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE;</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> [{i}_</span><span class="id"> -&gt;</span><span class="id"> /[!ord1]|{}i</span><span class="id"> -&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !expr0</span><span class="id"> big1;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> mul0r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?mulr0</span><span class="id"> ?subr0</span><span class="id"> ?mxE;</span><span class="id"> case:</span><span class="id"> splitP</span><span class="id"> =&gt;</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> ?ord1</span><span class="id"> mxE//</span>.<br/>
<span class="id">under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> eqSS</span><span class="id"> mulr_natl</span><span class="id"> mulrb</span><span class="id"> eq_sym</span>.<br/>
<span class="id">rewrite</span><span class="id"> -big_mkcond/=</span><span class="id"> big_ord1_eq</span><span class="id"> exprS</span><span class="id"> ifT//</span><span class="id"> ?leqW//</span><span class="id"> -mulrBl</span><span class="id"> !mxE/=</span>.<br/>
<span class="id">case:</span><span class="id"> split_ordP</span><span class="id"> =&gt;</span><span class="id"> [{j}_</span><span class="id"> -&gt;</span><span class="id"> /[!ord1]|{}j</span><span class="id"> -&gt;];</span><span class="id"> rewrite</span><span class="id"> ?lshift0</span><span class="id"> ?rshift1</span><span class="id"> ?mxE</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?subrr</span><span class="id"> ?mul0r//</span>.<br/>
<span class="id">under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> mulrnAr</span><span class="id"> mulrb</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -big_mkcond</span><span class="id"> big_pred1_eq</span><span class="id"> /=</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>

      <div class="footer"><hr/>Generated by <a href="https://github.com/affeldt-aist/rocqnavi/">rocqnavi</a></div>
    </div>
  </div>
    </main>
</body>
</html>
