
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.ssralg</title>
<meta name="description" content="Documentation of Coq module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.ssralg" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="rocqnavi.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="rocqnavi.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="Corelib"><summary>Corelib</summary>
          <ul>
          <li><details id="Corelib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Corelib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Corelib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Corelib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Corelib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Corelib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Corelib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Corelib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Corelib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Corelib.Classes.Init.html">Init</a></li>
<li><a href="Corelib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Corelib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Corelib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Corelib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Corelib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Corelib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Corelib.Compat.Coq820.html">Coq820</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Corelib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Corelib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Corelib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Corelib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Corelib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Corelib.Init.Byte.html">Byte</a></li>
<li><a href="Corelib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Corelib.Init.Decimal.html">Decimal</a></li>
<li><a href="Corelib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Corelib.Init.Logic.html">Logic</a></li>
<li><a href="Corelib.Init.Ltac.html">Ltac</a></li>
<li><a href="Corelib.Init.Nat.html">Nat</a></li>
<li><a href="Corelib.Init.Notations.html">Notations</a></li>
<li><a href="Corelib.Init.Number.html">Number</a></li>
<li><a href="Corelib.Init.Peano.html">Peano</a></li>
<li><a href="Corelib.Init.Prelude.html">Prelude</a></li>
<li><a href="Corelib.Init.Specif.html">Specif</a></li>
<li><a href="Corelib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Corelib.Init.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Init.Tauto.html">Tauto</a></li>
<li><a href="Corelib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Corelib.Lists.ListDef.html">ListDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Corelib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Corelib.Numbers.BinNums.html">BinNums</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Corelib.Program.Basics.html">Basics</a></li>
<li><a href="Corelib.Program.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Program.Utils.html">Utils</a></li>
<li><a href="Corelib.Program.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Corelib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Corelib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Corelib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Corelib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Corelib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Corelib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Corelib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Corelib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Corelib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Corelib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Corelib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Corelib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Corelib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Corelib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Corelib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="HB"><summary>HB</summary>
          <ul>
          <li><a href="HB.structures.html">structures</a></li>
          </ul>
          </details>
          </li>
<li><details id="Ltac2"><summary>Ltac2</summary>
          <ul>
          <li><details id="Ltac2.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Ltac2.Compat.Coq818.html">Coq818</a></li>
<li><a href="Ltac2.Compat.Coq819.html">Coq819</a></li>
          </ul>
          </details>
          </li>
<li><a href="Ltac2.Array.html">Array</a></li>
<li><a href="Ltac2.Bool.html">Bool</a></li>
<li><a href="Ltac2.Char.html">Char</a></li>
<li><a href="Ltac2.Constant.html">Constant</a></li>
<li><a href="Ltac2.Constr.html">Constr</a></li>
<li><a href="Ltac2.Constructor.html">Constructor</a></li>
<li><a href="Ltac2.Control.html">Control</a></li>
<li><a href="Ltac2.Env.html">Env</a></li>
<li><a href="Ltac2.Evar.html">Evar</a></li>
<li><a href="Ltac2.FMap.html">FMap</a></li>
<li><a href="Ltac2.FSet.html">FSet</a></li>
<li><a href="Ltac2.Float.html">Float</a></li>
<li><a href="Ltac2.Fresh.html">Fresh</a></li>
<li><a href="Ltac2.Ident.html">Ident</a></li>
<li><a href="Ltac2.Ind.html">Ind</a></li>
<li><a href="Ltac2.Init.html">Init</a></li>
<li><a href="Ltac2.Int.html">Int</a></li>
<li><a href="Ltac2.Lazy.html">Lazy</a></li>
<li><a href="Ltac2.List.html">List</a></li>
<li><a href="Ltac2.Ltac1.html">Ltac1</a></li>
<li><a href="Ltac2.Ltac2.html">Ltac2</a></li>
<li><a href="Ltac2.Message.html">Message</a></li>
<li><a href="Ltac2.Meta.html">Meta</a></li>
<li><a href="Ltac2.Notations.html">Notations</a></li>
<li><a href="Ltac2.Option.html">Option</a></li>
<li><a href="Ltac2.Pattern.html">Pattern</a></li>
<li><a href="Ltac2.Printf.html">Printf</a></li>
<li><a href="Ltac2.Proj.html">Proj</a></li>
<li><a href="Ltac2.Pstring.html">Pstring</a></li>
<li><a href="Ltac2.RedFlags.html">RedFlags</a></li>
<li><a href="Ltac2.Ref.html">Ref</a></li>
<li><a href="Ltac2.Std.html">Std</a></li>
<li><a href="Ltac2.String.html">String</a></li>
<li><a href="Ltac2.TransparentState.html">TransparentState</a></li>
<li><a href="Ltac2.Uint63.html">Uint63</a></li>
<li><a href="Ltac2.Unification.html">Unification</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib"><summary>Stdlib</summary>
          <ul>
          <li><details id="Stdlib.All"><summary>All</summary>
          <ul>
          <li><a href="Stdlib.All.All.html">All</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Arith"><summary>Arith</summary>
          <ul>
          <li><a href="Stdlib.Arith.Arith.html">Arith</a></li>
<li><a href="Stdlib.Arith.Arith_base.html">Arith_base</a></li>
<li><a href="Stdlib.Arith.Between.html">Between</a></li>
<li><a href="Stdlib.Arith.Bool_nat.html">Bool_nat</a></li>
<li><a href="Stdlib.Arith.Cantor.html">Cantor</a></li>
<li><a href="Stdlib.Arith.Compare.html">Compare</a></li>
<li><a href="Stdlib.Arith.Compare_dec.html">Compare_dec</a></li>
<li><a href="Stdlib.Arith.EqNat.html">EqNat</a></li>
<li><a href="Stdlib.Arith.Euclid.html">Euclid</a></li>
<li><a href="Stdlib.Arith.Factorial.html">Factorial</a></li>
<li><a href="Stdlib.Arith.PeanoNat.html">PeanoNat</a></li>
<li><a href="Stdlib.Arith.Peano_dec.html">Peano_dec</a></li>
<li><a href="Stdlib.Arith.Wf_nat.html">Wf_nat</a></li>
<li><a href="Stdlib.Arith.Zerob.html">Zerob</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Stdlib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Stdlib.Array.PArray.html">PArray</a></li>
<li><a href="Stdlib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Stdlib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Stdlib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Stdlib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Bool"><summary>Bool</summary>
          <ul>
          <li><a href="Stdlib.Bool.Bool.html">Bool</a></li>
<li><a href="Stdlib.Bool.BoolEq.html">BoolEq</a></li>
<li><a href="Stdlib.Bool.DecBool.html">DecBool</a></li>
<li><a href="Stdlib.Bool.IfProp.html">IfProp</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Stdlib.Classes.CEquivalence.html">CEquivalence</a></li>
<li><a href="Stdlib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Stdlib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Stdlib.Classes.DecidableClass.html">DecidableClass</a></li>
<li><a href="Stdlib.Classes.EquivDec.html">EquivDec</a></li>
<li><a href="Stdlib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Stdlib.Classes.Init.html">Init</a></li>
<li><a href="Stdlib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Stdlib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Stdlib.Classes.Morphisms_Relations.html">Morphisms_Relations</a></li>
<li><a href="Stdlib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Stdlib.Classes.RelationPairs.html">RelationPairs</a></li>
<li><a href="Stdlib.Classes.SetoidClass.html">SetoidClass</a></li>
<li><a href="Stdlib.Classes.SetoidDec.html">SetoidDec</a></li>
<li><a href="Stdlib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Stdlib.Compat.AdmitAxiom.html">AdmitAxiom</a></li>
<li><a href="Stdlib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Stdlib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Stdlib.Compat.Coq820.html">Coq820</a></li>
<li><a href="Stdlib.Compat.Stdlib818.html">Stdlib818</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.FSets"><summary>FSets</summary>
          <ul>
          <li><a href="Stdlib.FSets.FMapAVL.html">FMapAVL</a></li>
<li><a href="Stdlib.FSets.FMapFacts.html">FMapFacts</a></li>
<li><a href="Stdlib.FSets.FMapFullAVL.html">FMapFullAVL</a></li>
<li><a href="Stdlib.FSets.FMapInterface.html">FMapInterface</a></li>
<li><a href="Stdlib.FSets.FMapList.html">FMapList</a></li>
<li><a href="Stdlib.FSets.FMapPositive.html">FMapPositive</a></li>
<li><a href="Stdlib.FSets.FMapWeakList.html">FMapWeakList</a></li>
<li><a href="Stdlib.FSets.FMaps.html">FMaps</a></li>
<li><a href="Stdlib.FSets.FSetAVL.html">FSetAVL</a></li>
<li><a href="Stdlib.FSets.FSetBridge.html">FSetBridge</a></li>
<li><a href="Stdlib.FSets.FSetCompat.html">FSetCompat</a></li>
<li><a href="Stdlib.FSets.FSetDecide.html">FSetDecide</a></li>
<li><a href="Stdlib.FSets.FSetEqProperties.html">FSetEqProperties</a></li>
<li><a href="Stdlib.FSets.FSetFacts.html">FSetFacts</a></li>
<li><a href="Stdlib.FSets.FSetInterface.html">FSetInterface</a></li>
<li><a href="Stdlib.FSets.FSetList.html">FSetList</a></li>
<li><a href="Stdlib.FSets.FSetPositive.html">FSetPositive</a></li>
<li><a href="Stdlib.FSets.FSetProperties.html">FSetProperties</a></li>
<li><a href="Stdlib.FSets.FSetToFiniteSet.html">FSetToFiniteSet</a></li>
<li><a href="Stdlib.FSets.FSetWeakList.html">FSetWeakList</a></li>
<li><a href="Stdlib.FSets.FSets.html">FSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Stdlib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Stdlib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Stdlib.Floats.FloatLemmas.html">FloatLemmas</a></li>
<li><a href="Stdlib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Stdlib.Floats.Floats.html">Floats</a></li>
<li><a href="Stdlib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Stdlib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Stdlib.Init.Byte.html">Byte</a></li>
<li><a href="Stdlib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Stdlib.Init.Decimal.html">Decimal</a></li>
<li><a href="Stdlib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Stdlib.Init.Logic.html">Logic</a></li>
<li><a href="Stdlib.Init.Ltac.html">Ltac</a></li>
<li><a href="Stdlib.Init.Nat.html">Nat</a></li>
<li><a href="Stdlib.Init.Notations.html">Notations</a></li>
<li><a href="Stdlib.Init.Number.html">Number</a></li>
<li><a href="Stdlib.Init.Peano.html">Peano</a></li>
<li><a href="Stdlib.Init.Prelude.html">Prelude</a></li>
<li><a href="Stdlib.Init.Specif.html">Specif</a></li>
<li><a href="Stdlib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Stdlib.Init.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Init.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Stdlib.Lists.List.html">List</a></li>
<li><a href="Stdlib.Lists.ListDec.html">ListDec</a></li>
<li><a href="Stdlib.Lists.ListDef.html">ListDef</a></li>
<li><a href="Stdlib.Lists.ListSet.html">ListSet</a></li>
<li><a href="Stdlib.Lists.ListTactics.html">ListTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Logic"><summary>Logic</summary>
          <ul>
          <li><a href="Stdlib.Logic.Adjointification.html">Adjointification</a></li>
<li><a href="Stdlib.Logic.Berardi.html">Berardi</a></li>
<li><a href="Stdlib.Logic.ChoiceFacts.html">ChoiceFacts</a></li>
<li><a href="Stdlib.Logic.Classical.html">Classical</a></li>
<li><a href="Stdlib.Logic.ClassicalChoice.html">ClassicalChoice</a></li>
<li><a href="Stdlib.Logic.ClassicalDescription.html">ClassicalDescription</a></li>
<li><a href="Stdlib.Logic.ClassicalEpsilon.html">ClassicalEpsilon</a></li>
<li><a href="Stdlib.Logic.ClassicalFacts.html">ClassicalFacts</a></li>
<li><a href="Stdlib.Logic.ClassicalUniqueChoice.html">ClassicalUniqueChoice</a></li>
<li><a href="Stdlib.Logic.Classical_Pred_Type.html">Classical_Pred_Type</a></li>
<li><a href="Stdlib.Logic.Classical_Prop.html">Classical_Prop</a></li>
<li><a href="Stdlib.Logic.ConstructiveEpsilon.html">ConstructiveEpsilon</a></li>
<li><a href="Stdlib.Logic.Decidable.html">Decidable</a></li>
<li><a href="Stdlib.Logic.Description.html">Description</a></li>
<li><a href="Stdlib.Logic.Diaconescu.html">Diaconescu</a></li>
<li><a href="Stdlib.Logic.Epsilon.html">Epsilon</a></li>
<li><a href="Stdlib.Logic.Eqdep.html">Eqdep</a></li>
<li><a href="Stdlib.Logic.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="Stdlib.Logic.Eqdep_dec.html">Eqdep_dec</a></li>
<li><a href="Stdlib.Logic.ExtensionalFunctionRepresentative.html">ExtensionalFunctionRepresentative</a></li>
<li><a href="Stdlib.Logic.ExtensionalityFacts.html">ExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></li>
<li><a href="Stdlib.Logic.HLevels.html">HLevels</a></li>
<li><a href="Stdlib.Logic.Hurkens.html">Hurkens</a></li>
<li><a href="Stdlib.Logic.IndefiniteDescription.html">IndefiniteDescription</a></li>
<li><a href="Stdlib.Logic.JMeq.html">JMeq</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevance.html">ProofIrrelevance</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevanceFacts.html">ProofIrrelevanceFacts</a></li>
<li><a href="Stdlib.Logic.PropExtensionality.html">PropExtensionality</a></li>
<li><a href="Stdlib.Logic.PropExtensionalityFacts.html">PropExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.PropFacts.html">PropFacts</a></li>
<li><a href="Stdlib.Logic.RelationalChoice.html">RelationalChoice</a></li>
<li><a href="Stdlib.Logic.SetIsType.html">SetIsType</a></li>
<li><a href="Stdlib.Logic.SetoidChoice.html">SetoidChoice</a></li>
<li><a href="Stdlib.Logic.StrictProp.html">StrictProp</a></li>
<li><a href="Stdlib.Logic.WKL.html">WKL</a></li>
<li><a href="Stdlib.Logic.WeakFan.html">WeakFan</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.MSets"><summary>MSets</summary>
          <ul>
          <li><a href="Stdlib.MSets.MSetAVL.html">MSetAVL</a></li>
<li><a href="Stdlib.MSets.MSetDecide.html">MSetDecide</a></li>
<li><a href="Stdlib.MSets.MSetEqProperties.html">MSetEqProperties</a></li>
<li><a href="Stdlib.MSets.MSetFacts.html">MSetFacts</a></li>
<li><a href="Stdlib.MSets.MSetGenTree.html">MSetGenTree</a></li>
<li><a href="Stdlib.MSets.MSetInterface.html">MSetInterface</a></li>
<li><a href="Stdlib.MSets.MSetList.html">MSetList</a></li>
<li><a href="Stdlib.MSets.MSetPositive.html">MSetPositive</a></li>
<li><a href="Stdlib.MSets.MSetProperties.html">MSetProperties</a></li>
<li><a href="Stdlib.MSets.MSetRBT.html">MSetRBT</a></li>
<li><a href="Stdlib.MSets.MSetToFiniteSet.html">MSetToFiniteSet</a></li>
<li><a href="Stdlib.MSets.MSetWeakList.html">MSetWeakList</a></li>
<li><a href="Stdlib.MSets.MSets.html">MSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.NArith"><summary>NArith</summary>
          <ul>
          <li><a href="Stdlib.NArith.BinNat.html">BinNat</a></li>
<li><a href="Stdlib.NArith.BinNatDef.html">BinNatDef</a></li>
<li><a href="Stdlib.NArith.NArith.html">NArith</a></li>
<li><a href="Stdlib.NArith.NArith_base.html">NArith_base</a></li>
<li><a href="Stdlib.NArith.Ndec.html">Ndec</a></li>
<li><a href="Stdlib.NArith.Ndiv_def.html">Ndiv_def</a></li>
<li><a href="Stdlib.NArith.Ngcd_def.html">Ngcd_def</a></li>
<li><a href="Stdlib.NArith.Nnat.html">Nnat</a></li>
<li><a href="Stdlib.NArith.Nsqrt_def.html">Nsqrt_def</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Abstract.CyclicAxioms.html">CyclicAxioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.DoubleType.html">DoubleType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.NZCyclic.html">NZCyclic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Cyclic63.html">Cyclic63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Ring63.html">Ring63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63.html">Sint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63.html">Uint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer"><summary>Integer</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Integer.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Abstract.ZAdd.html">ZAdd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAddOrder.html">ZAddOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAxioms.html">ZAxioms</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBase.html">ZBase</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBits.html">ZBits</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivEucl.html">ZDivEucl</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivFloor.html">ZDivFloor</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivTrunc.html">ZDivTrunc</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZGcd.html">ZGcd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLcm.html">ZLcm</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLt.html">ZLt</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMaxMin.html">ZMaxMin</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMul.html">ZMul</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMulOrder.html">ZMulOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZParity.html">ZParity</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZPow.html">ZPow</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZProperties.html">ZProperties</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZSgnAbs.html">ZSgnAbs</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Binary.ZBinary.html">ZBinary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.NatPairs"><summary>NatPairs</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.NatPairs.ZNatPairs.html">ZNatPairs</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.NatInt"><summary>NatInt</summary>
          <ul>
          <li><a href="Stdlib.Numbers.NatInt.NZAdd.html">NZAdd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAddOrder.html">NZAddOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAxioms.html">NZAxioms</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBase.html">NZBase</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBits.html">NZBits</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDiv.html">NZDiv</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDomain.html">NZDomain</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZGcd.html">NZGcd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZLog.html">NZLog</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMul.html">NZMul</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMulOrder.html">NZMulOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZOrder.html">NZOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZParity.html">NZParity</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZPow.html">NZPow</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZProperties.html">NZProperties</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZSqrt.html">NZSqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural"><summary>Natural</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Natural.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Abstract.NAdd.html">NAdd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAddOrder.html">NAddOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAxioms.html">NAxioms</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBase.html">NBase</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBits.html">NBits</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDefOps.html">NDefOps</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv.html">NDiv</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv0.html">NDiv0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NGcd.html">NGcd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NIso.html">NIso</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm.html">NLcm</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm0.html">NLcm0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLog.html">NLog</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMaxMin.html">NMaxMin</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMulOrder.html">NMulOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NOrder.html">NOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NParity.html">NParity</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NPow.html">NPow</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NProperties.html">NProperties</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSqrt.html">NSqrt</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NStrongRec.html">NStrongRec</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSub.html">NSub</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Binary.NBinary.html">NBinary</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Numbers.AltBinNotations.html">AltBinNotations</a></li>
<li><a href="Stdlib.Numbers.BinNums.html">BinNums</a></li>
<li><a href="Stdlib.Numbers.DecimalFacts.html">DecimalFacts</a></li>
<li><a href="Stdlib.Numbers.DecimalN.html">DecimalN</a></li>
<li><a href="Stdlib.Numbers.DecimalNat.html">DecimalNat</a></li>
<li><a href="Stdlib.Numbers.DecimalPos.html">DecimalPos</a></li>
<li><a href="Stdlib.Numbers.DecimalQ.html">DecimalQ</a></li>
<li><a href="Stdlib.Numbers.DecimalR.html">DecimalR</a></li>
<li><a href="Stdlib.Numbers.DecimalString.html">DecimalString</a></li>
<li><a href="Stdlib.Numbers.DecimalZ.html">DecimalZ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalFacts.html">HexadecimalFacts</a></li>
<li><a href="Stdlib.Numbers.HexadecimalN.html">HexadecimalN</a></li>
<li><a href="Stdlib.Numbers.HexadecimalNat.html">HexadecimalNat</a></li>
<li><a href="Stdlib.Numbers.HexadecimalPos.html">HexadecimalPos</a></li>
<li><a href="Stdlib.Numbers.HexadecimalQ.html">HexadecimalQ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalR.html">HexadecimalR</a></li>
<li><a href="Stdlib.Numbers.HexadecimalString.html">HexadecimalString</a></li>
<li><a href="Stdlib.Numbers.HexadecimalZ.html">HexadecimalZ</a></li>
<li><a href="Stdlib.Numbers.NaryFunctions.html">NaryFunctions</a></li>
<li><a href="Stdlib.Numbers.NumPrelude.html">NumPrelude</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.PArith"><summary>PArith</summary>
          <ul>
          <li><a href="Stdlib.PArith.BinPos.html">BinPos</a></li>
<li><a href="Stdlib.PArith.BinPosDef.html">BinPosDef</a></li>
<li><a href="Stdlib.PArith.PArith.html">PArith</a></li>
<li><a href="Stdlib.PArith.POrderedType.html">POrderedType</a></li>
<li><a href="Stdlib.PArith.Pnat.html">Pnat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Stdlib.Program.Basics.html">Basics</a></li>
<li><a href="Stdlib.Program.Combinators.html">Combinators</a></li>
<li><a href="Stdlib.Program.Equality.html">Equality</a></li>
<li><a href="Stdlib.Program.Program.html">Program</a></li>
<li><a href="Stdlib.Program.Subset.html">Subset</a></li>
<li><a href="Stdlib.Program.Syntax.html">Syntax</a></li>
<li><a href="Stdlib.Program.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Program.Utils.html">Utils</a></li>
<li><a href="Stdlib.Program.Wf.html">Wf</a></li>
<li><a href="Stdlib.Program.WfExtensionality.html">WfExtensionality</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.QArith"><summary>QArith</summary>
          <ul>
          <li><a href="Stdlib.QArith.QArith.html">QArith</a></li>
<li><a href="Stdlib.QArith.QArith_base.html">QArith_base</a></li>
<li><a href="Stdlib.QArith.QOrderedType.html">QOrderedType</a></li>
<li><a href="Stdlib.QArith.Qabs.html">Qabs</a></li>
<li><a href="Stdlib.QArith.Qcabs.html">Qcabs</a></li>
<li><a href="Stdlib.QArith.Qcanon.html">Qcanon</a></li>
<li><a href="Stdlib.QArith.Qfield.html">Qfield</a></li>
<li><a href="Stdlib.QArith.Qminmax.html">Qminmax</a></li>
<li><a href="Stdlib.QArith.Qpower.html">Qpower</a></li>
<li><a href="Stdlib.QArith.Qreduction.html">Qreduction</a></li>
<li><a href="Stdlib.QArith.Qring.html">Qring</a></li>
<li><a href="Stdlib.QArith.Qround.html">Qround</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals"><summary>Reals</summary>
          <ul>
          <li><details id="Stdlib.Reals.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Reals.Abstract.ConstructiveAbs.html">ConstructiveAbs</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLUB.html">ConstructiveLUB</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLimits.html">ConstructiveLimits</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveMinMax.html">ConstructiveMinMax</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructivePower.html">ConstructivePower</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveReals.html">ConstructiveReals</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveRealsMorphisms.html">ConstructiveRealsMorphisms</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveSum.html">ConstructiveSum</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals.Cauchy"><summary>Cauchy</summary>
          <ul>
          <li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyAbs.html">ConstructiveCauchyAbs</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyReals.html">ConstructiveCauchyReals</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyRealsMult.html">ConstructiveCauchyRealsMult</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveExtra.html">ConstructiveExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveRcomplete.html">ConstructiveRcomplete</a></li>
<li><a href="Stdlib.Reals.Cauchy.PosExtra.html">PosExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.QExtra.html">QExtra</a></li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Reals.Alembert.html">Alembert</a></li>
<li><a href="Stdlib.Reals.AltSeries.html">AltSeries</a></li>
<li><a href="Stdlib.Reals.ArithProp.html">ArithProp</a></li>
<li><a href="Stdlib.Reals.Binomial.html">Binomial</a></li>
<li><a href="Stdlib.Reals.Cauchy_prod.html">Cauchy_prod</a></li>
<li><a href="Stdlib.Reals.ClassicalConstructiveReals.html">ClassicalConstructiveReals</a></li>
<li><a href="Stdlib.Reals.ClassicalDedekindReals.html">ClassicalDedekindReals</a></li>
<li><a href="Stdlib.Reals.Cos_plus.html">Cos_plus</a></li>
<li><a href="Stdlib.Reals.Cos_rel.html">Cos_rel</a></li>
<li><a href="Stdlib.Reals.DiscrR.html">DiscrR</a></li>
<li><a href="Stdlib.Reals.Exp_prop.html">Exp_prop</a></li>
<li><a href="Stdlib.Reals.Integration.html">Integration</a></li>
<li><a href="Stdlib.Reals.MVT.html">MVT</a></li>
<li><a href="Stdlib.Reals.Machin.html">Machin</a></li>
<li><a href="Stdlib.Reals.NewtonInt.html">NewtonInt</a></li>
<li><a href="Stdlib.Reals.Nsatz.html">Nsatz</a></li>
<li><a href="Stdlib.Reals.PSeries_reg.html">PSeries_reg</a></li>
<li><a href="Stdlib.Reals.PartSum.html">PartSum</a></li>
<li><a href="Stdlib.Reals.Qreals.html">Qreals</a></li>
<li><a href="Stdlib.Reals.RIneq.html">RIneq</a></li>
<li><a href="Stdlib.Reals.RList.html">RList</a></li>
<li><a href="Stdlib.Reals.ROrderedType.html">ROrderedType</a></li>
<li><a href="Stdlib.Reals.R_Ifp.html">R_Ifp</a></li>
<li><a href="Stdlib.Reals.R_sqr.html">R_sqr</a></li>
<li><a href="Stdlib.Reals.R_sqrt.html">R_sqrt</a></li>
<li><a href="Stdlib.Reals.Ranalysis.html">Ranalysis</a></li>
<li><a href="Stdlib.Reals.Ranalysis1.html">Ranalysis1</a></li>
<li><a href="Stdlib.Reals.Ranalysis2.html">Ranalysis2</a></li>
<li><a href="Stdlib.Reals.Ranalysis3.html">Ranalysis3</a></li>
<li><a href="Stdlib.Reals.Ranalysis4.html">Ranalysis4</a></li>
<li><a href="Stdlib.Reals.Ranalysis5.html">Ranalysis5</a></li>
<li><a href="Stdlib.Reals.Ranalysis_reg.html">Ranalysis_reg</a></li>
<li><a href="Stdlib.Reals.Ratan.html">Ratan</a></li>
<li><a href="Stdlib.Reals.Raxioms.html">Raxioms</a></li>
<li><a href="Stdlib.Reals.Rbase.html">Rbase</a></li>
<li><a href="Stdlib.Reals.Rbasic_fun.html">Rbasic_fun</a></li>
<li><a href="Stdlib.Reals.Rcomplete.html">Rcomplete</a></li>
<li><a href="Stdlib.Reals.Rdefinitions.html">Rdefinitions</a></li>
<li><a href="Stdlib.Reals.Rderiv.html">Rderiv</a></li>
<li><a href="Stdlib.Reals.Reals.html">Reals</a></li>
<li><a href="Stdlib.Reals.Rfunctions.html">Rfunctions</a></li>
<li><a href="Stdlib.Reals.Rgeom.html">Rgeom</a></li>
<li><a href="Stdlib.Reals.RiemannInt.html">RiemannInt</a></li>
<li><a href="Stdlib.Reals.RiemannInt_SF.html">RiemannInt_SF</a></li>
<li><a href="Stdlib.Reals.Rlimit.html">Rlimit</a></li>
<li><a href="Stdlib.Reals.Rlogic.html">Rlogic</a></li>
<li><a href="Stdlib.Reals.Rminmax.html">Rminmax</a></li>
<li><a href="Stdlib.Reals.Rpow_def.html">Rpow_def</a></li>
<li><a href="Stdlib.Reals.Rpower.html">Rpower</a></li>
<li><a href="Stdlib.Reals.Rprod.html">Rprod</a></li>
<li><a href="Stdlib.Reals.Rregisternames.html">Rregisternames</a></li>
<li><a href="Stdlib.Reals.Rseries.html">Rseries</a></li>
<li><a href="Stdlib.Reals.Rsigma.html">Rsigma</a></li>
<li><a href="Stdlib.Reals.Rsqrt_def.html">Rsqrt_def</a></li>
<li><a href="Stdlib.Reals.Rtopology.html">Rtopology</a></li>
<li><a href="Stdlib.Reals.Rtrigo.html">Rtrigo</a></li>
<li><a href="Stdlib.Reals.Rtrigo1.html">Rtrigo1</a></li>
<li><a href="Stdlib.Reals.Rtrigo_alt.html">Rtrigo_alt</a></li>
<li><a href="Stdlib.Reals.Rtrigo_calc.html">Rtrigo_calc</a></li>
<li><a href="Stdlib.Reals.Rtrigo_def.html">Rtrigo_def</a></li>
<li><a href="Stdlib.Reals.Rtrigo_facts.html">Rtrigo_facts</a></li>
<li><a href="Stdlib.Reals.Rtrigo_fun.html">Rtrigo_fun</a></li>
<li><a href="Stdlib.Reals.Rtrigo_reg.html">Rtrigo_reg</a></li>
<li><a href="Stdlib.Reals.Runcountable.html">Runcountable</a></li>
<li><a href="Stdlib.Reals.SeqProp.html">SeqProp</a></li>
<li><a href="Stdlib.Reals.SeqSeries.html">SeqSeries</a></li>
<li><a href="Stdlib.Reals.SplitAbsolu.html">SplitAbsolu</a></li>
<li><a href="Stdlib.Reals.SplitRmult.html">SplitRmult</a></li>
<li><a href="Stdlib.Reals.Sqrt_reg.html">Sqrt_reg</a></li>
<li><a href="Stdlib.Reals.Zfloor.html">Zfloor</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Stdlib.Relations.Operators_Properties.html">Operators_Properties</a></li>
<li><a href="Stdlib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
<li><a href="Stdlib.Relations.Relation_Operators.html">Relation_Operators</a></li>
<li><a href="Stdlib.Relations.Relations.html">Relations</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Stdlib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sets"><summary>Sets</summary>
          <ul>
          <li><a href="Stdlib.Sets.Classical_sets.html">Classical_sets</a></li>
<li><a href="Stdlib.Sets.Constructive_sets.html">Constructive_sets</a></li>
<li><a href="Stdlib.Sets.Cpo.html">Cpo</a></li>
<li><a href="Stdlib.Sets.Ensembles.html">Ensembles</a></li>
<li><a href="Stdlib.Sets.Finite_sets.html">Finite_sets</a></li>
<li><a href="Stdlib.Sets.Finite_sets_facts.html">Finite_sets_facts</a></li>
<li><a href="Stdlib.Sets.Image.html">Image</a></li>
<li><a href="Stdlib.Sets.Infinite_sets.html">Infinite_sets</a></li>
<li><a href="Stdlib.Sets.Integers.html">Integers</a></li>
<li><a href="Stdlib.Sets.Multiset.html">Multiset</a></li>
<li><a href="Stdlib.Sets.Partial_Order.html">Partial_Order</a></li>
<li><a href="Stdlib.Sets.Permut.html">Permut</a></li>
<li><a href="Stdlib.Sets.Powerset.html">Powerset</a></li>
<li><a href="Stdlib.Sets.Powerset_Classical_facts.html">Powerset_Classical_facts</a></li>
<li><a href="Stdlib.Sets.Powerset_facts.html">Powerset_facts</a></li>
<li><a href="Stdlib.Sets.Relations_1.html">Relations_1</a></li>
<li><a href="Stdlib.Sets.Relations_1_facts.html">Relations_1_facts</a></li>
<li><a href="Stdlib.Sets.Relations_2.html">Relations_2</a></li>
<li><a href="Stdlib.Sets.Relations_2_facts.html">Relations_2_facts</a></li>
<li><a href="Stdlib.Sets.Relations_3.html">Relations_3</a></li>
<li><a href="Stdlib.Sets.Relations_3_facts.html">Relations_3_facts</a></li>
<li><a href="Stdlib.Sets.Uniset.html">Uniset</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sorting"><summary>Sorting</summary>
          <ul>
          <li><a href="Stdlib.Sorting.CPermutation.html">CPermutation</a></li>
<li><a href="Stdlib.Sorting.Heap.html">Heap</a></li>
<li><a href="Stdlib.Sorting.Mergesort.html">Mergesort</a></li>
<li><a href="Stdlib.Sorting.PermutEq.html">PermutEq</a></li>
<li><a href="Stdlib.Sorting.PermutSetoid.html">PermutSetoid</a></li>
<li><a href="Stdlib.Sorting.Permutation.html">Permutation</a></li>
<li><a href="Stdlib.Sorting.SetoidList.html">SetoidList</a></li>
<li><a href="Stdlib.Sorting.SetoidPermutation.html">SetoidPermutation</a></li>
<li><a href="Stdlib.Sorting.Sorted.html">Sorted</a></li>
<li><a href="Stdlib.Sorting.Sorting.html">Sorting</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Streams"><summary>Streams</summary>
          <ul>
          <li><a href="Stdlib.Streams.StreamMemo.html">StreamMemo</a></li>
<li><a href="Stdlib.Streams.Streams.html">Streams</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Stdlib.Strings.Ascii.html">Ascii</a></li>
<li><a href="Stdlib.Strings.BinaryString.html">BinaryString</a></li>
<li><a href="Stdlib.Strings.Byte.html">Byte</a></li>
<li><a href="Stdlib.Strings.HexString.html">HexString</a></li>
<li><a href="Stdlib.Strings.OctalString.html">OctalString</a></li>
<li><a href="Stdlib.Strings.PString.html">PString</a></li>
<li><a href="Stdlib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Stdlib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="Stdlib.Strings.String.html">String</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Structures"><summary>Structures</summary>
          <ul>
          <li><a href="Stdlib.Structures.BoolOrder.html">BoolOrder</a></li>
<li><a href="Stdlib.Structures.DecidableType.html">DecidableType</a></li>
<li><a href="Stdlib.Structures.DecidableTypeEx.html">DecidableTypeEx</a></li>
<li><a href="Stdlib.Structures.Equalities.html">Equalities</a></li>
<li><a href="Stdlib.Structures.EqualitiesFacts.html">EqualitiesFacts</a></li>
<li><a href="Stdlib.Structures.GenericMinMax.html">GenericMinMax</a></li>
<li><a href="Stdlib.Structures.OrderedType.html">OrderedType</a></li>
<li><a href="Stdlib.Structures.OrderedTypeAlt.html">OrderedTypeAlt</a></li>
<li><a href="Stdlib.Structures.OrderedTypeEx.html">OrderedTypeEx</a></li>
<li><a href="Stdlib.Structures.Orders.html">Orders</a></li>
<li><a href="Stdlib.Structures.OrdersAlt.html">OrdersAlt</a></li>
<li><a href="Stdlib.Structures.OrdersEx.html">OrdersEx</a></li>
<li><a href="Stdlib.Structures.OrdersFacts.html">OrdersFacts</a></li>
<li><a href="Stdlib.Structures.OrdersLists.html">OrdersLists</a></li>
<li><a href="Stdlib.Structures.OrdersTac.html">OrdersTac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Unicode"><summary>Unicode</summary>
          <ul>
          <li><a href="Stdlib.Unicode.Utf8.html">Utf8</a></li>
<li><a href="Stdlib.Unicode.Utf8_core.html">Utf8_core</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Vectors"><summary>Vectors</summary>
          <ul>
          <li><a href="Stdlib.Vectors.Bvector.html">Bvector</a></li>
<li><a href="Stdlib.Vectors.Fin.html">Fin</a></li>
<li><a href="Stdlib.Vectors.FinFun.html">FinFun</a></li>
<li><a href="Stdlib.Vectors.Vector.html">Vector</a></li>
<li><a href="Stdlib.Vectors.VectorDef.html">VectorDef</a></li>
<li><a href="Stdlib.Vectors.VectorEq.html">VectorEq</a></li>
<li><a href="Stdlib.Vectors.VectorSpec.html">VectorSpec</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Wellfounded"><summary>Wellfounded</summary>
          <ul>
          <li><a href="Stdlib.Wellfounded.Disjoint_Union.html">Disjoint_Union</a></li>
<li><a href="Stdlib.Wellfounded.Inclusion.html">Inclusion</a></li>
<li><a href="Stdlib.Wellfounded.Inverse_Image.html">Inverse_Image</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Exponentiation.html">Lexicographic_Exponentiation</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Product.html">Lexicographic_Product</a></li>
<li><a href="Stdlib.Wellfounded.List_Extension.html">List_Extension</a></li>
<li><a href="Stdlib.Wellfounded.Transitive_Closure.html">Transitive_Closure</a></li>
<li><a href="Stdlib.Wellfounded.Union.html">Union</a></li>
<li><a href="Stdlib.Wellfounded.Well_Ordering.html">Well_Ordering</a></li>
<li><a href="Stdlib.Wellfounded.Wellfounded.html">Wellfounded</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ZArith"><summary>ZArith</summary>
          <ul>
          <li><a href="Stdlib.ZArith.BinInt.html">BinInt</a></li>
<li><a href="Stdlib.ZArith.BinIntDef.html">BinIntDef</a></li>
<li><a href="Stdlib.ZArith.Int.html">Int</a></li>
<li><a href="Stdlib.ZArith.Wf_Z.html">Wf_Z</a></li>
<li><a href="Stdlib.ZArith.ZArith.html">ZArith</a></li>
<li><a href="Stdlib.ZArith.ZArith_base.html">ZArith_base</a></li>
<li><a href="Stdlib.ZArith.ZArith_dec.html">ZArith_dec</a></li>
<li><a href="Stdlib.ZArith.Zabs.html">Zabs</a></li>
<li><a href="Stdlib.ZArith.Zbitwise.html">Zbitwise</a></li>
<li><a href="Stdlib.ZArith.Zbool.html">Zbool</a></li>
<li><a href="Stdlib.ZArith.Zcompare.html">Zcompare</a></li>
<li><a href="Stdlib.ZArith.Zcomplements.html">Zcomplements</a></li>
<li><a href="Stdlib.ZArith.Zdiv.html">Zdiv</a></li>
<li><a href="Stdlib.ZArith.Zdiv_facts.html">Zdiv_facts</a></li>
<li><a href="Stdlib.ZArith.Zeuclid.html">Zeuclid</a></li>
<li><a href="Stdlib.ZArith.Zeven.html">Zeven</a></li>
<li><a href="Stdlib.ZArith.Zgcd_alt.html">Zgcd_alt</a></li>
<li><a href="Stdlib.ZArith.Zhints.html">Zhints</a></li>
<li><a href="Stdlib.ZArith.Zmax.html">Zmax</a></li>
<li><a href="Stdlib.ZArith.Zmin.html">Zmin</a></li>
<li><a href="Stdlib.ZArith.Zminmax.html">Zminmax</a></li>
<li><a href="Stdlib.ZArith.Zmisc.html">Zmisc</a></li>
<li><a href="Stdlib.ZArith.Znat.html">Znat</a></li>
<li><a href="Stdlib.ZArith.Znumtheory.html">Znumtheory</a></li>
<li><a href="Stdlib.ZArith.Zorder.html">Zorder</a></li>
<li><a href="Stdlib.ZArith.Zpow_alt.html">Zpow_alt</a></li>
<li><a href="Stdlib.ZArith.Zpow_def.html">Zpow_def</a></li>
<li><a href="Stdlib.ZArith.Zpow_facts.html">Zpow_facts</a></li>
<li><a href="Stdlib.ZArith.Zpower.html">Zpower</a></li>
<li><a href="Stdlib.ZArith.Zquot.html">Zquot</a></li>
<li><a href="Stdlib.ZArith.Zwf.html">Zwf</a></li>
<li><a href="Stdlib.ZArith.auxiliary.html">auxiliary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.btauto"><summary>btauto</summary>
          <ul>
          <li><a href="Stdlib.btauto.Algebra.html">Algebra</a></li>
<li><a href="Stdlib.btauto.Btauto.html">Btauto</a></li>
<li><a href="Stdlib.btauto.Reflect.html">Reflect</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Stdlib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Stdlib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInt.html">ExtrHaskellNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInteger.html">ExtrHaskellNatInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatNum.html">ExtrHaskellNatNum</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellString.html">ExtrHaskellString</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInt.html">ExtrHaskellZInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInteger.html">ExtrHaskellZInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZNum.html">ExtrHaskellZNum</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlFloats.html">ExtrOCamlFloats</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlInt63.html">ExtrOCamlInt63</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPArray.html">ExtrOCamlPArray</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPString.html">ExtrOCamlPString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlChar.html">ExtrOcamlChar</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlIntConv.html">ExtrOcamlIntConv</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatBigInt.html">ExtrOcamlNatBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatInt.html">ExtrOcamlNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNativeString.html">ExtrOcamlNativeString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlString.html">ExtrOcamlString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZBigInt.html">ExtrOcamlZBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZInt.html">ExtrOcamlZInt</a></li>
<li><a href="Stdlib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.funind"><summary>funind</summary>
          <ul>
          <li><a href="Stdlib.funind.FunInd.html">FunInd</a></li>
<li><a href="Stdlib.funind.Recdef.html">Recdef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.micromega"><summary>micromega</summary>
          <ul>
          <li><a href="Stdlib.micromega.DeclConstant.html">DeclConstant</a></li>
<li><a href="Stdlib.micromega.DeclConstantZ.html">DeclConstantZ</a></li>
<li><a href="Stdlib.micromega.Env.html">Env</a></li>
<li><a href="Stdlib.micromega.EnvRing.html">EnvRing</a></li>
<li><a href="Stdlib.micromega.Fourier.html">Fourier</a></li>
<li><a href="Stdlib.micromega.Fourier_util.html">Fourier_util</a></li>
<li><a href="Stdlib.micromega.Lia.html">Lia</a></li>
<li><a href="Stdlib.micromega.Lqa.html">Lqa</a></li>
<li><a href="Stdlib.micromega.Lra.html">Lra</a></li>
<li><a href="Stdlib.micromega.OrderedRing.html">OrderedRing</a></li>
<li><a href="Stdlib.micromega.Psatz.html">Psatz</a></li>
<li><a href="Stdlib.micromega.QMicromega.html">QMicromega</a></li>
<li><a href="Stdlib.micromega.RMicromega.html">RMicromega</a></li>
<li><a href="Stdlib.micromega.Refl.html">Refl</a></li>
<li><a href="Stdlib.micromega.RingMicromega.html">RingMicromega</a></li>
<li><a href="Stdlib.micromega.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.micromega.VarMap.html">VarMap</a></li>
<li><a href="Stdlib.micromega.ZArith_hints.html">ZArith_hints</a></li>
<li><a href="Stdlib.micromega.ZCoeff.html">ZCoeff</a></li>
<li><a href="Stdlib.micromega.ZMicromega.html">ZMicromega</a></li>
<li><a href="Stdlib.micromega.Zify.html">Zify</a></li>
<li><a href="Stdlib.micromega.ZifyBool.html">ZifyBool</a></li>
<li><a href="Stdlib.micromega.ZifyClasses.html">ZifyClasses</a></li>
<li><a href="Stdlib.micromega.ZifyComparison.html">ZifyComparison</a></li>
<li><a href="Stdlib.micromega.ZifyInst.html">ZifyInst</a></li>
<li><a href="Stdlib.micromega.ZifyN.html">ZifyN</a></li>
<li><a href="Stdlib.micromega.ZifyNat.html">ZifyNat</a></li>
<li><a href="Stdlib.micromega.ZifyPow.html">ZifyPow</a></li>
<li><a href="Stdlib.micromega.ZifySint63.html">ZifySint63</a></li>
<li><a href="Stdlib.micromega.ZifyUint63.html">ZifyUint63</a></li>
<li><a href="Stdlib.micromega.Ztac.html">Ztac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.nsatz"><summary>nsatz</summary>
          <ul>
          <li><a href="Stdlib.nsatz.NsatzTactic.html">NsatzTactic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.omega"><summary>omega</summary>
          <ul>
          <li><a href="Stdlib.omega.OmegaLemmas.html">OmegaLemmas</a></li>
<li><a href="Stdlib.omega.PreOmega.html">PreOmega</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.rtauto"><summary>rtauto</summary>
          <ul>
          <li><a href="Stdlib.rtauto.Bintree.html">Bintree</a></li>
<li><a href="Stdlib.rtauto.Rtauto.html">Rtauto</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.setoid_ring"><summary>setoid_ring</summary>
          <ul>
          <li><a href="Stdlib.setoid_ring.Algebra_syntax.html">Algebra_syntax</a></li>
<li><a href="Stdlib.setoid_ring.ArithRing.html">ArithRing</a></li>
<li><a href="Stdlib.setoid_ring.BinList.html">BinList</a></li>
<li><a href="Stdlib.setoid_ring.Cring.html">Cring</a></li>
<li><a href="Stdlib.setoid_ring.Field.html">Field</a></li>
<li><a href="Stdlib.setoid_ring.Field_tac.html">Field_tac</a></li>
<li><a href="Stdlib.setoid_ring.Field_theory.html">Field_theory</a></li>
<li><a href="Stdlib.setoid_ring.InitialRing.html">InitialRing</a></li>
<li><a href="Stdlib.setoid_ring.Integral_domain.html">Integral_domain</a></li>
<li><a href="Stdlib.setoid_ring.NArithRing.html">NArithRing</a></li>
<li><a href="Stdlib.setoid_ring.Ncring.html">Ncring</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_initial.html">Ncring_initial</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_polynom.html">Ncring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_tac.html">Ncring_tac</a></li>
<li><a href="Stdlib.setoid_ring.RealField.html">RealField</a></li>
<li><a href="Stdlib.setoid_ring.Ring.html">Ring</a></li>
<li><a href="Stdlib.setoid_ring.Ring_base.html">Ring_base</a></li>
<li><a href="Stdlib.setoid_ring.Ring_polynom.html">Ring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ring_tac.html">Ring_tac</a></li>
<li><a href="Stdlib.setoid_ring.Ring_theory.html">Ring_theory</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Q.html">Rings_Q</a></li>
<li><a href="Stdlib.setoid_ring.Rings_R.html">Rings_R</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Z.html">Rings_Z</a></li>
<li><a href="Stdlib.setoid_ring.ZArithRing.html">ZArithRing</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Stdlib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Stdlib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Stdlib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Stdlib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Stdlib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Stdlib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Stdlib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi"><summary>elpi</summary>
          <ul>
          <li><details id="elpi.apps"><summary>apps</summary>
          <ul>
          <li><details id="elpi.apps.NES"><summary>NES</summary>
          <ul>
          <li><details id="elpi.apps.NES.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.NES.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.NES.NES.html">NES</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.coercion"><summary>coercion</summary>
          <ul>
          <li><a href="elpi.apps.coercion.coercion.html">coercion</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.cs"><summary>cs</summary>
          <ul>
          <li><a href="elpi.apps.cs.cs.html">cs</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive"><summary>derive</summary>
          <ul>
          <li><details id="elpi.apps.derive.derive"><summary>derive</summary>
          <ul>
          <li><a href="elpi.apps.derive.derive.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="elpi.apps.derive.derive.bcongr.html">bcongr</a></li>
<li><a href="elpi.apps.derive.derive.cast.html">cast</a></li>
<li><a href="elpi.apps.derive.derive.eq.html">eq</a></li>
<li><a href="elpi.apps.derive.derive.eqK.html">eqK</a></li>
<li><a href="elpi.apps.derive.derive.eqOK.html">eqOK</a></li>
<li><a href="elpi.apps.derive.derive.eqType_ast.html">eqType_ast</a></li>
<li><a href="elpi.apps.derive.derive.eqb.html">eqb</a></li>
<li><a href="elpi.apps.derive.derive.eqbOK.html">eqbOK</a></li>
<li><a href="elpi.apps.derive.derive.eqb_core_defs.html">eqb_core_defs</a></li>
<li><a href="elpi.apps.derive.derive.eqbcorrect.html">eqbcorrect</a></li>
<li><a href="elpi.apps.derive.derive.eqcorrect.html">eqcorrect</a></li>
<li><a href="elpi.apps.derive.derive.experimental.html">experimental</a></li>
<li><a href="elpi.apps.derive.derive.fields.html">fields</a></li>
<li><a href="elpi.apps.derive.derive.idx2inv.html">idx2inv</a></li>
<li><a href="elpi.apps.derive.derive.induction.html">induction</a></li>
<li><a href="elpi.apps.derive.derive.invert.html">invert</a></li>
<li><a href="elpi.apps.derive.derive.isK.html">isK</a></li>
<li><a href="elpi.apps.derive.derive.legacy.html">legacy</a></li>
<li><a href="elpi.apps.derive.derive.lens.html">lens</a></li>
<li><a href="elpi.apps.derive.derive.lens_laws.html">lens_laws</a></li>
<li><a href="elpi.apps.derive.derive.map.html">map</a></li>
<li><a href="elpi.apps.derive.derive.param1.html">param1</a></li>
<li><a href="elpi.apps.derive.derive.param1_congr.html">param1_congr</a></li>
<li><a href="elpi.apps.derive.derive.param1_functor.html">param1_functor</a></li>
<li><a href="elpi.apps.derive.derive.param1_trivial.html">param1_trivial</a></li>
<li><a href="elpi.apps.derive.derive.param2.html">param2</a></li>
<li><a href="elpi.apps.derive.derive.projK.html">projK</a></li>
<li><a href="elpi.apps.derive.derive.std.html">std</a></li>
<li><a href="elpi.apps.derive.derive.tag.html">tag</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.derive.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.derive.derive.html">derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.eltac"><summary>eltac</summary>
          <ul>
          <li><a href="elpi.apps.eltac.apply.html">apply</a></li>
<li><a href="elpi.apps.eltac.assumption.html">assumption</a></li>
<li><a href="elpi.apps.eltac.case.html">case</a></li>
<li><a href="elpi.apps.eltac.clear.html">clear</a></li>
<li><a href="elpi.apps.eltac.constructor.html">constructor</a></li>
<li><a href="elpi.apps.eltac.cycle.html">cycle</a></li>
<li><a href="elpi.apps.eltac.discriminate.html">discriminate</a></li>
<li><a href="elpi.apps.eltac.fail.html">fail</a></li>
<li><a href="elpi.apps.eltac.generalize.html">generalize</a></li>
<li><a href="elpi.apps.eltac.injection.html">injection</a></li>
<li><a href="elpi.apps.eltac.intro.html">intro</a></li>
<li><a href="elpi.apps.eltac.rewrite.html">rewrite</a></li>
<li><a href="elpi.apps.eltac.tactics.html">tactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.locker"><summary>locker</summary>
          <ul>
          <li><details id="elpi.apps.locker.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.locker.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.locker.locker.html">locker</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.rbuild"><summary>rbuild</summary>
          <ul>
          <li><details id="elpi.apps.rbuild.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.rbuild.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.rbuild.rbuild.html">rbuild</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.tc"><summary>tc</summary>
          <ul>
          <li><details id="elpi.apps.tc.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.tc.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.tc.add_commands.html">add_commands</a></li>
<li><a href="elpi.apps.tc.db.html">db</a></li>
<li><a href="elpi.apps.tc.tc.html">tc</a></li>
<li><a href="elpi.apps.tc.wip.html">wip</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi.core"><summary>core</summary>
          <ul>
          <li><a href="elpi.core.Bool.html">Bool</a></li>
<li><a href="elpi.core.ListDef.html">ListDef</a></li>
<li><a href="elpi.core.Morphisms.html">Morphisms</a></li>
<li><a href="elpi.core.PosDef.html">PosDef</a></li>
<li><a href="elpi.core.PrimFloat.html">PrimFloat</a></li>
<li><a href="elpi.core.PrimInt63.html">PrimInt63</a></li>
<li><a href="elpi.core.PrimString.html">PrimString</a></li>
<li><a href="elpi.core.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="elpi.core.RelationClasses.html">RelationClasses</a></li>
<li><a href="elpi.core.Setoid.html">Setoid</a></li>
<li><a href="elpi.core.Uint63Axioms.html">Uint63Axioms</a></li>
<li><a href="elpi.core.ssrbool.html">ssrbool</a></li>
<li><a href="elpi.core.ssreflect.html">ssreflect</a></li>
<li><a href="elpi.core.ssrfun.html">ssrfun</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.elpi.html">elpi</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_elpi"><summary>elpi_elpi</summary>
          <ul>
          <li><a href="elpi_elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_examples"><summary>elpi_examples</summary>
          <ul>
          <li><a href="elpi_examples.example_abs_evars.html">example_abs_evars</a></li>
<li><a href="elpi_examples.example_curry_howard_tactics.html">example_curry_howard_tactics</a></li>
<li><a href="elpi_examples.example_data_base.html">example_data_base</a></li>
<li><a href="elpi_examples.example_fuzzer.html">example_fuzzer</a></li>
<li><a href="elpi_examples.example_generalize.html">example_generalize</a></li>
<li><a href="elpi_examples.example_import_projections.html">example_import_projections</a></li>
<li><a href="elpi_examples.example_record_expansion.html">example_record_expansion</a></li>
<li><a href="elpi_examples.example_record_to_sigma.html">example_record_to_sigma</a></li>
<li><a href="elpi_examples.example_reduction_surgery.html">example_reduction_surgery</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_HOAS.html">tutorial_coq_elpi_HOAS</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_command.html">tutorial_coq_elpi_command</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_tactic.html">tutorial_coq_elpi_tactic</a></li>
<li><a href="elpi_examples.tutorial_elpi_lang.html">tutorial_elpi_lang</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp"><summary>mathcomp</summary>
          <ul>
          <li><details id="mathcomp.algebra"><summary>algebra</summary>
          <ul>
          <li><details id="mathcomp.algebra.num_theory"><summary>num_theory</summary>
          <ul>
          <li><a href="mathcomp.algebra.num_theory.numdomain.html">numdomain</a></li>
<li><a href="mathcomp.algebra.num_theory.numfield.html">numfield</a></li>
<li><a href="mathcomp.algebra.num_theory.orderedzmod.html">orderedzmod</a></li>
<li><a href="mathcomp.algebra.num_theory.ssrnum.html">ssrnum</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.algebra.all_algebra.html">all_algebra</a></li>
<li><a href="mathcomp.algebra.archimedean.html">archimedean</a></li>
<li><a href="mathcomp.algebra.countalg.html">countalg</a></li>
<li><a href="mathcomp.algebra.finalg.html">finalg</a></li>
<li><a href="mathcomp.algebra.fraction.html">fraction</a></li>
<li><a href="mathcomp.algebra.intdiv.html">intdiv</a></li>
<li><a href="mathcomp.algebra.interval.html">interval</a></li>
<li><a href="mathcomp.algebra.interval_inference.html">interval_inference</a></li>
<li><a href="mathcomp.algebra.matrix.html">matrix</a></li>
<li><a href="mathcomp.algebra.mxalgebra.html">mxalgebra</a></li>
<li><a href="mathcomp.algebra.mxpoly.html">mxpoly</a></li>
<li><a href="mathcomp.algebra.mxred.html">mxred</a></li>
<li><a href="mathcomp.algebra.poly.html">poly</a></li>
<li><a href="mathcomp.algebra.polyXY.html">polyXY</a></li>
<li><a href="mathcomp.algebra.polydiv.html">polydiv</a></li>
<li><a href="mathcomp.algebra.qpoly.html">qpoly</a></li>
<li><a href="mathcomp.algebra.rat.html">rat</a></li>
<li><a href="mathcomp.algebra.ring_quotient.html">ring_quotient</a></li>
<li><a href="mathcomp.algebra.sesquilinear.html">sesquilinear</a></li>
<li><a href="mathcomp.algebra.spectral.html">spectral</a></li>
<li><a href="mathcomp.algebra.ssralg.html">ssralg</a></li>
<li><a href="mathcomp.algebra.ssrint.html">ssrint</a></li>
<li><a href="mathcomp.algebra.vector.html">vector</a></li>
<li><a href="mathcomp.algebra.zmodp.html">zmodp</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis"><summary>analysis</summary>
          <ul>
          <li><details id="mathcomp.analysis.homotopy_theory"><summary>homotopy_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.homotopy_theory.continuous_path.html">continuous_path</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.homotopy.html">homotopy</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.wedge_sigT.html">wedge_sigT</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.lebesgue_integral_theory"><summary>lebesgue_integral_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_Rintegral.html">lebesgue_Rintegral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integrable.html">lebesgue_integrable</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral.html">lebesgue_integral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_definition.html">lebesgue_integral_definition</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_differentiation.html">lebesgue_integral_differentiation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_dominated_convergence.html">lebesgue_integral_dominated_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_fubini.html">lebesgue_integral_fubini</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_monotone_convergence.html">lebesgue_integral_monotone_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_nonneg.html">lebesgue_integral_nonneg</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_under.html">lebesgue_integral_under</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.measurable_fun_approximation.html">measurable_fun_approximation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.simple_functions.html">simple_functions</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.measure_theory"><summary>measure_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.measure_theory.counting_measure.html">counting_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.dirac_measure.html">dirac_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_function.html">measurable_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_structure.html">measurable_structure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure.html">measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_extension.html">measure_extension</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_function.html">measure_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_negligible.html">measure_negligible</a></li>
<li><a href="mathcomp.analysis.measure_theory.probability_measure.html">probability_measure</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.normedtype_theory"><summary>normedtype_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.normedtype_theory.complete_normed_module.html">complete_normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.ereal_normedtype.html">ereal_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.matrix_normedtype.html">matrix_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normed_module.html">normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normedtype.html">normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.num_normedtype.html">num_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.pseudometric_normed_Zmodule.html">pseudometric_normed_Zmodule</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.urysohn.html">urysohn</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.vitali_lemma.html">vitali_lemma</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis.showcase.pnt.html">pnt</a></li>
<li><a href="mathcomp.analysis.showcase.summability.html">summability</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.topology_theory"><summary>topology_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.topology_theory.bool_topology.html">bool_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.compact.html">compact</a></li>
<li><a href="mathcomp.analysis.topology_theory.connected.html">connected</a></li>
<li><a href="mathcomp.analysis.topology_theory.discrete_topology.html">discrete_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.matrix_topology.html">matrix_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.nat_topology.html">nat_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.num_topology.html">num_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.one_point_compactification.html">one_point_compactification</a></li>
<li><a href="mathcomp.analysis.topology_theory.order_topology.html">order_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.product_topology.html">product_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.pseudometric_structure.html">pseudometric_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.quotient_topology.html">quotient_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.separation_axioms.html">separation_axioms</a></li>
<li><a href="mathcomp.analysis.topology_theory.sigT_topology.html">sigT_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subspace_topology.html">subspace_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subtype_topology.html">subtype_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.supremum_topology.html">supremum_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology.html">topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology_structure.html">topology_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.uniform_structure.html">uniform_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.weak_topology.html">weak_topology</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis.all_analysis.html">all_analysis</a></li>
<li><a href="mathcomp.analysis.borel_hierarchy.html">borel_hierarchy</a></li>
<li><a href="mathcomp.analysis.cantor.html">cantor</a></li>
<li><a href="mathcomp.analysis.charge.html">charge</a></li>
<li><a href="mathcomp.analysis.convex.html">convex</a></li>
<li><a href="mathcomp.analysis.derive.html">derive</a></li>
<li><a href="mathcomp.analysis.ereal.html">ereal</a></li>
<li><a href="mathcomp.analysis.ess_sup_inf.html">ess_sup_inf</a></li>
<li><a href="mathcomp.analysis.esum.html">esum</a></li>
<li><a href="mathcomp.analysis.exp.html">exp</a></li>
<li><a href="mathcomp.analysis.ftc.html">ftc</a></li>
<li><a href="mathcomp.analysis.function_spaces.html">function_spaces</a></li>
<li><a href="mathcomp.analysis.gauss_integral.html">gauss_integral</a></li>
<li><a href="mathcomp.analysis.hoelder.html">hoelder</a></li>
<li><a href="mathcomp.analysis.kernel.html">kernel</a></li>
<li><a href="mathcomp.analysis.landau.html">landau</a></li>
<li><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></li>
<li><a href="mathcomp.analysis.lebesgue_stieltjes_measure.html">lebesgue_stieltjes_measure</a></li>
<li><a href="mathcomp.analysis.measurable_realfun.html">measurable_realfun</a></li>
<li><a href="mathcomp.analysis.numfun.html">numfun</a></li>
<li><a href="mathcomp.analysis.pi_irrational.html">pi_irrational</a></li>
<li><a href="mathcomp.analysis.probability.html">probability</a></li>
<li><a href="mathcomp.analysis.realfun.html">realfun</a></li>
<li><a href="mathcomp.analysis.sequences.html">sequences</a></li>
<li><a href="mathcomp.analysis.trigo.html">trigo</a></li>
<li><a href="mathcomp.analysis.tvs.html">tvs</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis_stdlib"><summary>analysis_stdlib</summary>
          <ul>
          <li><details id="mathcomp.analysis_stdlib.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis_stdlib.showcase.uniform_bigO.html">uniform_bigO</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis_stdlib.Rstruct_topology.html">Rstruct_topology</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.bigenough"><summary>bigenough</summary>
          <ul>
          <li><a href="mathcomp.bigenough.bigenough.html">bigenough</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.boot"><summary>boot</summary>
          <ul>
          <li><a href="mathcomp.boot.all_boot.html">all_boot</a></li>
<li><a href="mathcomp.boot.bigop.html">bigop</a></li>
<li><a href="mathcomp.boot.binomial.html">binomial</a></li>
<li><a href="mathcomp.boot.choice.html">choice</a></li>
<li><a href="mathcomp.boot.div.html">div</a></li>
<li><a href="mathcomp.boot.eqtype.html">eqtype</a></li>
<li><a href="mathcomp.boot.finfun.html">finfun</a></li>
<li><a href="mathcomp.boot.fingraph.html">fingraph</a></li>
<li><a href="mathcomp.boot.finset.html">finset</a></li>
<li><a href="mathcomp.boot.fintype.html">fintype</a></li>
<li><a href="mathcomp.boot.generic_quotient.html">generic_quotient</a></li>
<li><a href="mathcomp.boot.monoid.html">monoid</a></li>
<li><a href="mathcomp.boot.nmodule.html">nmodule</a></li>
<li><a href="mathcomp.boot.path.html">path</a></li>
<li><a href="mathcomp.boot.prime.html">prime</a></li>
<li><a href="mathcomp.boot.seq.html">seq</a></li>
<li><a href="mathcomp.boot.ssrAC.html">ssrAC</a></li>
<li><a href="mathcomp.boot.ssrbool.html">ssrbool</a></li>
<li><a href="mathcomp.boot.ssreflect.html">ssreflect</a></li>
<li><a href="mathcomp.boot.ssrfun.html">ssrfun</a></li>
<li><a href="mathcomp.boot.ssrmatching.html">ssrmatching</a></li>
<li><a href="mathcomp.boot.ssrnat.html">ssrnat</a></li>
<li><a href="mathcomp.boot.ssrnotations.html">ssrnotations</a></li>
<li><a href="mathcomp.boot.tuple.html">tuple</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.classical"><summary>classical</summary>
          <ul>
          <li><a href="mathcomp.classical.all_classical.html">all_classical</a></li>
<li><a href="mathcomp.classical.boolp.html">boolp</a></li>
<li><a href="mathcomp.classical.cardinality.html">cardinality</a></li>
<li><a href="mathcomp.classical.classical_orders.html">classical_orders</a></li>
<li><a href="mathcomp.classical.classical_sets.html">classical_sets</a></li>
<li><a href="mathcomp.classical.contra.html">contra</a></li>
<li><a href="mathcomp.classical.filter.html">filter</a></li>
<li><a href="mathcomp.classical.fsbigop.html">fsbigop</a></li>
<li><a href="mathcomp.classical.functions.html">functions</a></li>
<li><a href="mathcomp.classical.internal_Eqdep_dec.html">internal_Eqdep_dec</a></li>
<li><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></li>
<li><a href="mathcomp.classical.set_interval.html">set_interval</a></li>
<li><a href="mathcomp.classical.unstable.html">unstable</a></li>
<li><a href="mathcomp.classical.wochoice.html">wochoice</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.experimental_reals"><summary>experimental_reals</summary>
          <ul>
          <li><a href="mathcomp.experimental_reals.discrete.html">discrete</a></li>
<li><a href="mathcomp.experimental_reals.distr.html">distr</a></li>
<li><a href="mathcomp.experimental_reals.realseq.html">realseq</a></li>
<li><a href="mathcomp.experimental_reals.realsum.html">realsum</a></li>
<li><a href="mathcomp.experimental_reals.xfinmap.html">xfinmap</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.field"><summary>field</summary>
          <ul>
          <li><a href="mathcomp.field.algC.html">algC</a></li>
<li><a href="mathcomp.field.algebraics_fundamentals.html">algebraics_fundamentals</a></li>
<li><a href="mathcomp.field.algnum.html">algnum</a></li>
<li><a href="mathcomp.field.all_field.html">all_field</a></li>
<li><a href="mathcomp.field.closed_field.html">closed_field</a></li>
<li><a href="mathcomp.field.cyclotomic.html">cyclotomic</a></li>
<li><a href="mathcomp.field.falgebra.html">falgebra</a></li>
<li><a href="mathcomp.field.fieldext.html">fieldext</a></li>
<li><a href="mathcomp.field.finfield.html">finfield</a></li>
<li><a href="mathcomp.field.galois.html">galois</a></li>
<li><a href="mathcomp.field.qfpoly.html">qfpoly</a></li>
<li><a href="mathcomp.field.separable.html">separable</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.fingroup"><summary>fingroup</summary>
          <ul>
          <li><a href="mathcomp.fingroup.action.html">action</a></li>
<li><a href="mathcomp.fingroup.all_fingroup.html">all_fingroup</a></li>
<li><a href="mathcomp.fingroup.automorphism.html">automorphism</a></li>
<li><a href="mathcomp.fingroup.fingroup.html">fingroup</a></li>
<li><a href="mathcomp.fingroup.gproduct.html">gproduct</a></li>
<li><a href="mathcomp.fingroup.morphism.html">morphism</a></li>
<li><a href="mathcomp.fingroup.perm.html">perm</a></li>
<li><a href="mathcomp.fingroup.presentation.html">presentation</a></li>
<li><a href="mathcomp.fingroup.quotient.html">quotient</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.finmap"><summary>finmap</summary>
          <ul>
          <li><a href="mathcomp.finmap.finmap.html">finmap</a></li>
<li><a href="mathcomp.finmap.multiset.html">multiset</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.order"><summary>order</summary>
          <ul>
          <li><a href="mathcomp.order.all_order.html">all_order</a></li>
<li><a href="mathcomp.order.order.html">order</a></li>
<li><a href="mathcomp.order.preorder.html">preorder</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals"><summary>reals</summary>
          <ul>
          <li><a href="mathcomp.reals.all_reals.html">all_reals</a></li>
<li><a href="mathcomp.reals.constructive_ereal.html">constructive_ereal</a></li>
<li><a href="mathcomp.reals.prodnormedzmodule.html">prodnormedzmodule</a></li>
<li><a href="mathcomp.reals.real_interval.html">real_interval</a></li>
<li><a href="mathcomp.reals.reals.html">reals</a></li>
<li><a href="mathcomp.reals.signed.html">signed</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals_stdlib"><summary>reals_stdlib</summary>
          <ul>
          <li><a href="mathcomp.reals_stdlib.Rstruct.html">Rstruct</a></li>
<li><a href="mathcomp.reals_stdlib.nsatz_realtype.html">nsatz_realtype</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.solvable"><summary>solvable</summary>
          <ul>
          <li><a href="mathcomp.solvable.abelian.html">abelian</a></li>
<li><a href="mathcomp.solvable.all_solvable.html">all_solvable</a></li>
<li><a href="mathcomp.solvable.alt.html">alt</a></li>
<li><a href="mathcomp.solvable.burnside_app.html">burnside_app</a></li>
<li><a href="mathcomp.solvable.center.html">center</a></li>
<li><a href="mathcomp.solvable.commutator.html">commutator</a></li>
<li><a href="mathcomp.solvable.cyclic.html">cyclic</a></li>
<li><a href="mathcomp.solvable.extraspecial.html">extraspecial</a></li>
<li><a href="mathcomp.solvable.extremal.html">extremal</a></li>
<li><a href="mathcomp.solvable.finmodule.html">finmodule</a></li>
<li><a href="mathcomp.solvable.frobenius.html">frobenius</a></li>
<li><a href="mathcomp.solvable.gfunctor.html">gfunctor</a></li>
<li><a href="mathcomp.solvable.gseries.html">gseries</a></li>
<li><a href="mathcomp.solvable.hall.html">hall</a></li>
<li><a href="mathcomp.solvable.jordanholder.html">jordanholder</a></li>
<li><a href="mathcomp.solvable.maximal.html">maximal</a></li>
<li><a href="mathcomp.solvable.nilpotent.html">nilpotent</a></li>
<li><a href="mathcomp.solvable.pgroup.html">pgroup</a></li>
<li><a href="mathcomp.solvable.primitive_action.html">primitive_action</a></li>
<li><a href="mathcomp.solvable.sylow.html">sylow</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.ssreflect"><summary>ssreflect</summary>
          <ul>
          <li><a href="mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.ssralg</h1>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> ssreflect</span><span class="id"> ssrfun</span><span class="id"> ssrbool</span><span class="id"> eqtype</span><span class="id"> ssrnat</span><span class="id"> div</span><span class="id"> seq</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> choice</span><span class="id"> fintype</span><span class="id"> finfun</span><span class="id"> bigop</span><span class="id"> prime</span><span class="id"> binomial</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Export</span><span class="id"> nmodule</span>.<br/>
<br/>
<pre class="ssrdoc">
                           Ring-like structures

NB: See CONTRIBUTING.md for an introduction to HB concepts and commands.

Reference: Francois Garillot, Georges Gonthier, Assia Mahboubi, Laurence
Rideau, Packaging mathematical structures, TPHOLs 2009

This file defines the following algebraic structures:

 semiPzRingType == non-commutative semi rings
                   (NModule with a multiplication)
                   The HB class is called PzSemiRing.
 nzSemiRingType == non-commutative non-trivial semi rings
                   (NModule with a multiplication)
                   The HB class is called NzSemiRing.
comPzSemiRingType == commutative semi rings
                   The HB class is called ComPzSemiRing.
comNzSemiRingType == commutative non-trivial semi rings
                   The HB class is called ComNzSemiRing.
     pzRingType == non-commutative rings
                   (semi rings with an opposite)
                   The HB class is called PzRing.
     nzRingType == non-commutative non-trivial rings
                   (semi rings with an opposite)
                   The HB class is called NzRing.
  comPzRingType == commutative rings
                   The HB class is called ComPzRing.
  comNzRingType == commutative non-trivial rings
                   The HB class is called ComNzRing.
 lSemiModType R == semimodule with left multiplication by external scalars
                   in the semiring R
                   The HB class is called LSemiModule.
     lmodType R == module with left multiplication by external scalars
                   in the pzRing R
                   The HB class is called Lmodule.
 lSemiAlgType R == left semialgebra, semiring with scaling that associates
                   on the left
                   The HB class is called LSemiAlgebra.
     lalgType R == left algebra, ring with scaling that associates on the
                   left
                   The HB class is called Lalgebra.
  semiAlgType R == semialgebra, semiring with scaling that associates both
                   left and right
                   The HB class is called SemiAlgebra.
      algType R == algebra, ring with scaling that associates both left
                   and right
                   The HB class is called Algebra.
(*comSemiAlgType R == commutative semiAlgType
                   The HB class is called ComSemiAlgebra.
   comAlgType R == commutative algType
                   The HB class is called ComAlgebra.
   unitRingType == Rings whose units have computable inverses
                   The HB class is called UnitRing.
comUnitRingType == commutative UnitRing
                   The HB class is called ComUnitRing.
  unitAlgType R == algebra with computable inverses
                   The HB class is called UnitAlgebra.
(*comUnitAlgType R == commutative UnitAlgebra
                   The HB class is called ComUnitAlgebra.
    idomainType == integral, commutative, ring with partial inverses
                   The HB class is called IntegralDomain.
      fieldType == commutative fields
                   The HB class is called Field.
   decFieldType == fields with a decidable first order theory
                   The HB class is called DecidableField.
closedFieldType == algebraically closed fields
                   The HB class is called ClosedField.

and their joins with subType:

  subPzSemiRingType R P == join of pzSemiRingType and
                           subType (P : pred R) such that val is a
                           semiring morphism
                           The HB class is called SubPzSemiRing.
  subNzSemiRingType R P == join of nzSemiRingType and
                           subType (P : pred R) such that val is a
                           semiring morphism
                           The HB class is called SubNzSemiRing.
(*subComPzSemiRingType R P == join of comPzSemiRingType and
                           subType (P : pred R) such that val is a morphism
                           The HB class is called SubComPzSemiRing.
(*subComNzSemiRingType R P == join of comNzSemiRingType and
                           subType (P : pred R) such that val is a morphism
                           The HB class is called SubComNzSemiRing.
      subPzRingType R P == join of pzRingType and subType (P : pred R)
                           such that val is a morphism
                           The HB class is called SubPzRing.
   subComPzRingType R P == join of comPzRingType and subType (P : pred R)
                           such that val is a morphism
                           The HB class is called SubComPzRing.
      subNzRingType R P == join of nzRingType and subType (P : pred R)
                           such that val is a morphism
                           The HB class is called SubNzRing.
   subComNzRingType R P == join of comNzRingType and subType (P : pred R)
                           such that val is a morphism
                           The HB class is called SubComNzRing.
  subLSemiModType R V P == join of lSemiModType and subType (P : pred V)
                           such that val is scalable
                           The HB class is called SubLSemiModule.
      subLmodType R V P == join of lmodType and subType (P : pred V)
                           such that val is scalable
                           The HB class is called SubLmodule.
  subLSemiAlgType R V P == join of lSemiAlgType and subType (P : pred V)
                           such that val is linear
                           The HB class is called SubLSemiAlgebra.
      subLalgType R V P == join of lalgType and subType (P : pred V)
                           such that val is linear
                           The HB class is called SubLalgebra.
   subSemiAlgType R V P == join of semiAlgType and subType (P : pred V)
                           such that val is linear
                           The HB class is called SubSemiAlgebra.
       subAlgType R V P == join of algType and subType (P : pred V)
                           such that val is linear
                           The HB class is called SubAlgebra.
    subUnitRingType R P == join of unitRingType and subType (P : pred R)
                           such that val is a ring morphism
                           The HB class is called SubUnitRing.
 subComUnitRingType R P == join of comUnitRingType and subType (P : pred R)
                           such that val is a ring morphism
                           The HB class is called SubComUnitRing.
     subIdomainType R P == join of idomainType and subType (P : pred R)
                           such that val is a ring morphism
                           The HB class is called SubIntegralDomain.
           subField R P == join of fieldType and subType (P : pred R)
                           such that val is a ring morphism
                           The HB class is called SubField.

Morphisms between the above structures (see below for details):

     {rmorphism R -&gt; S} == semi ring (resp. ring) morphism between
                           semiPzRingType (resp. pzRingType) instances
                           R and S.
                           The HB class is called RMorphism.
    {linear U -&gt; V | s} == semilinear (resp. linear) functions of type
                           U -&gt; V, where U is a left semimodule (resp.
                           left module) over semiring (resp. ring) R, V is
                           an N-module (resp. Z-module), and s is a scaling
                           operator (detailed below) of type R -&gt; V -&gt; V.
                           The HB class is called Linear.
{lrmorphism A -&gt; B | s} == semialgebra (resp. algebra) morphisms of type
                           A -&gt; B, where A is a left semialgebra
                           (resp. left algebra) over semiring (resp. ring)
                           R, B is an semiring (resp. ring), and s is a
                           scaling operator (detailed below) of type
                           R -&gt; B -&gt; B.
                           The HB class is called LRMorphism.

-&gt; The scaling operator s above should be one of *:%R, *%R, or a
   combination nu \; *:%R or nu \; *%R with a semiring morphism nu;
   otherwise some of the theory (e.g., the linearZ rule) will not apply.
   To enable the overloading of the scaling operator, we use the following
   structures:

 GRing.Scale.preLaw R V == scaling morphisms of type R -&gt; V -&gt; V
                           The HB class is called Scale.PreLaw.
GRing.Scale.semiLaw R V == scaling morphisms of type R -&gt; V -&gt; V
                           The HB class is called Scale.SemiLaw.
    GRing.Scale.law R V == scaling morphisms of type R -&gt; V -&gt; V
                           The HB class is called Scale.Law.

Closedness predicates for the algebraic structures:

 addrClosed V == predicate closed under addition on V : nmodType
                 The HB class is called AddClosed.
 opprClosed V == predicate closed under opposite on V : zmodType
                 The HB class is called OppClosed.
 zmodClosed V == predicate closed under opposite and addition on V
                 The HB class is called ZmodClosed.
mulr2Closed R == predicate closed under multiplication on
                 R : semiPzRingType
                 The HB class is called Mul2Closed.
 mulrClosed R == predicate closed under multiplication and for 1
                 The HB class is called MulClosed.
semiring2Closed R == predicate closed under addition and multiplication
                 The HB class is called Semiring2Closed.
semiringClosed R == predicate closed under semiring operations
                 The HB class is called SemiringClosed.
 smulClosed R == predicate closed under multiplication and for -1
                 The HB class is called SmulClosed.
subringClosed R == predicate closed under ring operations
                 The HB class is called SubringClosed.
  divClosed R == predicate closed under division
                 The HB class is called DivClosed.
 sdivClosed R == predicate closed under division and opposite
                 The HB class is called SdivClosed.
submodClosed R == predicate closed under lSemiModType operations
                 The HB class is called SubmodClosed.
subalgClosed R == predicate closed under lSemiAlgType operations
                 The HB class is called SubalgClosed.
divringClosed R == predicate closed under unitRing operations
                 The HB class is called DivringClosed.
divalgClosed R S == predicate closed under (S : unitAlg R) operations
                 The HB class is called DivalgClosed.

The rpred* lemmas ensure that the set S remains stable under the specified
operations, provided the corresponding closedness predicate is satisfied.
This stability is crucial for constructing and reasoning about
substructures within algebraic hierarchies. For example:

- rpred0: Concludes 0 \in S if S is addrClosed.
- rpredD: Concludes x + y \in S if x \in S and y \in S and S is addrClosed.
- rpredN: Concludes -x \in S if x \in S and S is opprClosed.
- rpredZ: Concludes a *: v \in S if v \in S and S is scalerClosed.

Canonical properties of the algebraic structures:
 * Nmodule (additive abelian monoids):
                    0 == the zero (additive identity) of a Nmodule
                x + y == the sum of x and y (in a Nmodule)
               x *+ n == n times x, with n in nat (non-negative), i.e.,
                         x + (x + .. (x + x)..) (n terms); x *+ 1 is thus
                         convertible to x, and x *+ 2 to x + x
       \sum_&lt;range&gt; e == iterated sum for a Nmodule (cf bigop.v)
                 e`_i == nth 0 e i, when e : seq M and M has a nmodType
                         structure
            support f == 0.-support f, i.e., [pred x | f x != 0]
        addr_closed S &lt;-&gt; collective predicate S is closed under finite
                          sums (0 and x + y in S, for x, y in S)
[SubChoice_isSubNmodule of U by &lt;:] == nmodType mixin for a subType whose
                         base type is a nmodType and whose predicate's is
                         an addrClosed

 * Zmodule (additive abelian groups):
                  - x == the opposite (additive inverse) of x
                x - y == the difference of x and y; this is only notation
                         for x + (- y)
               x *- n == notation for - (x *+ n), the opposite of x *+ n
        oppr_closed S &lt;-&gt; collective predicate S is closed under opposite
        zmod_closed S &lt;-&gt; collective predicate S is closed under zmodType
                         operations (0 and x - y in S, for x, y in S)
                         This property coerces to oppr_pred and addr_pred.
[SubChoice_isSubZmodule of U by &lt;:] == zmodType mixin for a subType whose
                         base type is a zmodType and whose predicate's
                         is a zmodClosed
[SubNmodule_isSubZmodule of U by &lt;:] == zmodType mixin for a subNmodType
                         base type is a zmodType and whose predicate's
                         is an opprClosed

 * PzSemiRing (non-commutative semirings):
                   R^c == the converse (semi)ring for R: R^c is convertible
                          to R but when R has a canonical (semi)ring
                          structure R^c has the converse one:
                          if x y : R^c, then x * y = (y : R) * (x : R)
                     1 == the multiplicative identity element of a semiring
                  n%:R == the semiring image of an n in nat; this is just
                          notation for 1 *+ n, so 1%:R is convertible to 1
                          and 2%:R to 1 + 1
              &lt;number&gt; == &lt;number&gt;%:R with &lt;number&gt; a sequence of digits
                 x * y == the semiring product of x and y
       \prod_&lt;range&gt; e == iterated product for a semiring (cf bigop.v)
                x ^+ n == x to the nth power with n in nat (non-negative),
                          i.e., x * (x * .. (x * x)..) (n factors); x ^+ 1
                          is thus convertible to x, and x ^+ 2 to x * x
        GRing.comm x y &lt;-&gt; x and y commute, i.e., x * y = y * x
          GRing.lreg x &lt;-&gt; x if left-regular, i.e., *%R x is injective
          GRing.rreg x &lt;-&gt; x if right-regular, i.e., *%R^~ x is injective
              [pchar R] == the characteristic of R, defined as the set of
                          prime numbers p such that p%:R = 0 in R
                          The set [pchar R] has at most one element, and is
                          implemented as a pred_nat collective predicate
                          (see prime.v); thus the statement p \in [pchar R]
                          can be read as `R has characteristic p', while
                          [pchar R] =i pred0 means `R has characteristic 0'
                          when R is a field.
    pFrobenius_aut chRp == the Frobenius automorphism mapping x in R to
                          x ^+ p, where chRp : p \in [pchar R] is a proof
                          that R has (non-zero) characteristic p
         mulr_closed S &lt;-&gt; collective predicate S is closed under finite
                          products (1 and x * y in S for x, y in S)
     semiring_closed S &lt;-&gt; collective predicate S is closed under semiring
                          operations (0, 1, x + y and x * y in S)
[SubNmodule_isSubPzSemiRing of R by &lt;:] ==
[SubChoice_isSubPzSemiRing of R by &lt;:] == semiPzRingType mixin for a
                          subType whose base type is a pzSemiRingType and
                          whose predicate's is a semiringClosed

 * NzSemiRing (non-commutative non-trivial semirings):
[SubNmodule_isSubNzSemiRing of R by &lt;:] ==
[SubChoice_isSubNzSemiRing of R by &lt;:] == semiNzRingType mixin for a
                          subType whose base type is a nzSemiRingType and
                          whose predicate's is a semiringClosed

 * PzRing (non-commutative rings):
        GRing.sign R b := (-1) ^+ b in R : pzRingType, with b : bool
                          This is a parsing-only helper notation, to be
                          used for defining more specific instances.
        smulr_closed S &lt;-&gt; collective predicate S is closed under products
                          and opposite (-1 and x * y in S for x, y in S)
      subring_closed S &lt;-&gt; collective predicate S is closed under ring
                          operations (1, x - y and x * y in S)
[SubZmodule_isSubPzRing of R by &lt;:] ==
[SubChoice_isSubPzRing of R by &lt;:] == pzRingType mixin for a subType whose
                          base
                          type is a pzRingType and whose predicate's is a
                          subringClosed

 * NzRing (non-commutative non-trivial rings):
[SubZmodule_isSubNzRing of R by &lt;:] ==
[SubChoice_isSubNzRing of R by &lt;:] == nzRingType mixin for a subType whose
                          base
                          type is a nzRingType and whose predicate's is a
                          subringClosed

 * ComPzSemiRing (commutative PzSemiRings):
[SubNmodule_isSubComPzSemiRing of R by &lt;:] ==
[SubChoice_isSubComPzSemiRing of R by &lt;:] == comPzSemiRingType mixin for a
                          subType whose base type is a comPzSemiRingType
                         and whose predicate's is a semiringClosed

 * ComNzSemiRing (commutative NzSemiRings):
[SubNmodule_isSubComNzSemiRing of R by &lt;:] ==
[SubChoice_isSubComNzSemiRing of R by &lt;:] == comNzSemiRingType mixin for a
                          subType whose base type is a comNzSemiRingType
                         and whose predicate's is a semiringClosed

 * ComPzRing (commutative PzRings):
[SubZmodule_isSubComPzRing of R by &lt;:] ==
[SubChoice_isSubComPzRing of R by &lt;:] == comPzRingType mixin for a
                          subType whose base type is a comPzRingType and
                          whose predicate's is a subringClosed

 * ComNzRing (commutative NzRings):
[SubZmodule_isSubComNzRing of R by &lt;:] ==
[SubChoice_isSubComNzRing of R by &lt;:] == comNzRingType mixin for a
                          subType whose base type is a comNzRingType and
                          whose predicate's is a subringClosed

 * UnitRing (NzRings whose units have computable inverses):
    x \is a GRing.unit &lt;=&gt; x is a unit (i.e., has an inverse)
                  x^-1 == the ring inverse of x, if x is a unit, else x
                 x / y == x divided by y (notation for x * y^-1)
                x ^- n := notation for (x ^+ n)^-1, the inverse of x ^+ n
        invr_closed S &lt;-&gt; collective predicate S is closed under inverse
        divr_closed S &lt;-&gt; collective predicate S is closed under division
                          (1 and x / y in S)
       sdivr_closed S &lt;-&gt; collective predicate S is closed under division
                          and opposite (-1 and x / y in S, for x, y in S)
     divring_closed S &lt;-&gt; collective predicate S is closed under unitRing
                          operations (1, x - y and x / y in S)
[SubNzRing_isSubUnitRing of R by &lt;:] ==
[SubChoice_isSubUnitRing of R by &lt;:] == unitRingType mixin for a subType
                          whose base type is a unitRingType and whose
                          predicate's is a divringClosed and whose ring
                          structure is compatible with the base type's

 * ComUnitRing (commutative rings with computable inverses):
[SubChoice_isSubComUnitRing of R by &lt;:] == comUnitRingType mixin for a
                          subType whose base type is a comUnitRingType and
                          whose predicate's is a divringClosed and whose
                          ring structure is compatible with the base
                          type's

 * IntegralDomain (integral, commutative, ring with partial inverses):
[SubComUnitRing_isSubIntegralDomain R by &lt;:] ==
[SubChoice_isSubIntegralDomain R by &lt;:] == mixin axiom for a idomain
                          subType

 * Field (commutative fields):
 GRing.Field.axiom inv == field axiom: x != 0 -&gt; inv x * x = 1 for all x
                          This is equivalent to the property above, but
                          does not require a unitRingType as inv is an
                          explicit argument.
[SubIntegralDomain_isSubField of R by &lt;:] == mixin axiom for a field
                          subType

 * DecidableField (fields with a decidable first order theory):
          GRing.term R == the type of formal expressions in a unit ring R
                          with formal variables 'X_k, k : nat, and
                          manifest constants x%:T, x : R
                          The notation of all the ring operations is
                          redefined for terms, in scope %T.
       GRing.formula R == the type of first order formulas over R; the %T
                          scope binds the logical connectives /\, \/, ~,
                          ==&gt;, ==, and != to formulae; GRing.True/False
                          and GRing.Bool b denote constant formulae, and
                          quantifiers are written 'forall/'exists 'X_k, f
                            GRing.Unit x tests for ring units
                            GRing.If p_f t_f e_f emulates if-then-else
                            GRing.Pick p_f t_f e_f emulates fintype.pick
                            foldr GRing.Exists/Forall q_f xs can be used
                              to write iterated quantifiers
        GRing.eval e t == the value of term t with valuation e : seq R
                          (e maps 'X_i to e`_i)
 GRing.same_env e1 e2 &lt;-&gt; environments e1 and e2 are extensionally equal
       GRing.qf_form f == f is quantifier-free
       GRing.holds e f == the intuitionistic CiC interpretation of the
                          formula f holds with valuation e
     GRing.qf_eval e f == the value (in bool) of a quantifier-free f
         GRing.sat e f == valuation e satisfies f (only in a decField)
         GRing.sol n f == a sequence e of size n such that e satisfies f,
                          if one exists, or [::] if there is no such e
       'exists 'X_i, u1 == 0 /\ ... /\ u_m == 0 /\ v1 != 0 ... /\ v_n != 0

 * LSemiModule (semimodule with left multiplication by external scalars).
                a *: v == v scaled by a, when v is in an LSemiModule V and
                          a is in the scalar semiring of V
       scaler_closed S &lt;-&gt; collective predicate S is closed under scaling
   subsemimod_closed S &lt;-&gt; collective predicate S is closed under
                          lSemiModType operations (0, +%R, and *:%R)
[SubNmodule_isSubLSemiModule of V by &lt;:] ==
[SubChoice_isSubLSemiModule of V by &lt;:] == mixin axiom for a subType of an
                          lSemiModType

 * Lmodule (module with left multiplication by external scalars).
       linear_closed S &lt;-&gt; collective predicate S is closed under linear
                          combinations (a *: u + v in S when u, v in S)
       submod_closed S &lt;-&gt; collective predicate S is closed under lmodType
                          operations (0 and a *: u + v in S)
[SubZmodule_isSubLmodule of V by &lt;:] ==
[SubChoice_isSubLmodule of V by &lt;:] == mixin axiom for a subType of an
                          lmodType

 * LSemiAlgebra
   (left semialgebra, semiring with scaling that associates on the left):
                   R^o == the regular (semi)algebra of R: R^o is
                          convertible to R, but when R has a
                          nz(Semi)RingType structure then R^o extends it
                          to an l(Semi)AlgType structure by letting R act
                          on itself: if x : R and y : R^o then
                          x *: y = x * (y : R)
                  k%:A == the image of the scalar k in a left semialgebra;
                          this is simply notation for k *: 1
   subsemialg_closed S &lt;-&gt; collective predicate S is closed under
                          lSemiAlgType operations
                          (0, 1, +%R, *%R, and *:%R)
[SubSemiRing_SubLSemiModule_isSubLSemiAlgebra of V by &lt;:]
[SubChoice_isSubLSemiAlgebra of V by &lt;:] == mixin axiom for a subType of
                          an lSemiAlgType

 * Lalgebra (left algebra, ring with scaling that associates on the left):
       subalg_closed S &lt;-&gt; collective predicate S is closed under lalgType
                          operations (1, a *: u + v and u * v in S)
[SubNzRing_SubLmodule_isSubLalgebra of V by &lt;:] ==
[SubChoice_isSubLalgebra of V by &lt;:] == mixin axiom for a subType of an
                          lalgType

 * SemiAlgebra (semiring with scaling that associates both left and right):
[SubLSemiAlgebra_isSubSemiAlgebra of V by &lt;:] ==
[SubChoice_isSubSemiAlgebra of V by &lt;:] == mixin axiom for a subType of an
                          semiAlgType

 * Algebra (ring with scaling that associates both left and right):
[SubLalgebra_isSubAlgebra of V by &lt;:] ==
[SubChoice_isSubAlgebra of V by &lt;:] == mixin axiom for a subType of an
                          algType

 * UnitAlgebra (algebra with computable inverses):
       divalg_closed S &lt;-&gt; collective predicate S is closed under all
                          unitAlgType operations (1, a *: u + v and u / v
                          are in S fo u, v in S)

  In addition to this structure hierarchy, we also develop a separate,
parallel hierarchy for morphisms linking these structures:

* RMorphism (semiring or ring morphisms):
     monoid_morphism f &lt;-&gt; f of type R -&gt; S is a multiplicative monoid
                          morphism, i.e., f maps 1 and * in R to 1 and *
                          in S, respectively. R and S must have canonical
                          pzSemiRingType instances.
    {rmorphism R -&gt; S} == the interface type for semiring morphisms; both
                          R and S must have pzSemiRingType instances
                          When both R and S have pzRingType instances, it
                          is a ring morphism.
                       := GRing.RMorphism.type R S

 -&gt; If R and S are UnitRings the f also maps units to units and inverses
    of units to inverses; if R is a field then f is a field isomorphism
    between R and its image.
 -&gt; Additive properties (raddf_suffix, see below) are duplicated and
    specialised for RMorphism (as rmorph_suffix). This allows more
    precise rewriting and cleaner chaining: although raddf lemmas will
    recognize RMorphism functions, the converse will not hold (we cannot
    add reverse inheritance rules because of incomplete backtracking in
    the Canonical Projection unification), so one would have to insert a
    /= every time one switched from additive to multiplicative rules.

* Linear (semilinear or linear functions):
      scalable_for s f &lt;-&gt; f of type U -&gt; V is scalable for the scaling
                          operator s of type R -&gt; V -&gt; V, i.e.,
                          f morphs a *: _ to s a _; R, U, and V must be a
                          pzSemiRingType, an lSemiModType R, and an
                          nmodType, respectively.
                       := forall a, {morph f : u / a *: u &gt;-&gt; s a u}
            scalable f &lt;-&gt; f of type U -&gt; V is scalable, i.e., f morphs
                          scaling on U to scaling on V, a *: _ to a *: _;
                          U and V must be lSemiModType R for the same
                          pzSemiRingType R.
                       := scalable_for *:%R f
    semilinear_for s f &lt;-&gt; f of type U -&gt; V is semilinear for s of type
                          R -&gt; V -&gt; V , i.e., f morphs a *: _ and addition
                          on U to s a _ and addition on V, respectively;
                          R, U, and V must be a pzSemiRingType, an
                          lSemiModType R and an nmodType, respectively.
                       := scalable_for s f * {morph f : x y / x + y}
          semilinear f &lt;-&gt; f of type U -&gt; V is semilinear, i.e., f morphs
                          scaling and addition on U to scaling and
                          addition on V, respectively; U and V must be
                          lSemiModType R for the same pzSemiRingType R.
                       := semilinear_for *:% f
          semiscalar f &lt;-&gt; f of type U -&gt; R is a semiscalar function,
                          i.e., f morphs scaling and addition on U to
                          multiplication and addition on R; R and U must
                          be a pzSemiRingType and an lSemiModType R,
                          respectively.
                       := semilinear_for *%R f
        linear_for s f &lt;-&gt; f of type U -&gt; V is linear for s of type
                          R -&gt; V -&gt; V, i.e.,
                          f (a *: u + v) = s a (f u) + f v;
                          R, U, and V must be a pzRingType, an lmodType R,
                          and a zmodType, respectively.
              linear f &lt;-&gt; f of type U -&gt; V is linear, i.e.,
                          f (f *: u + v) = a *: f u + f v;
                          U and V must be lmodType R for the same
                          pzRingType R.
                       := linear_for *:%R f
              scalar f &lt;-&gt; f of type U -&gt; R is a scalar function, i.e.,
                          f (a *: u + v) = a * f u + f v;
                          R and U must be a pzRingType and an lmodType R,
                          respectively.
                       := linear_for *%R f
   {linear U -&gt; V | s} == the interface type for functions (semi)linear
                          for the scaling operator s of type R -&gt; V -&gt; V,
                          i.e., a structure that encapsulates two
                          properties semi_additive f and scalable_for s f
                          for functions f : U -&gt; V; R, U, and V must be a
                          pzSemiRingType, an lSemiModType R, and an
                          nmodType, respectively.
       {linear U -&gt; V} == the interface type for (semi)linear functions,
                          of type U -&gt; V where both U and V must be
                          lSemiModType R for the same pzSemiRingType R
                       := {linear U -&gt; V | *:%R}
            {scalar U} == the interface type for (semi)scalar functions,
                          of type U -&gt; R where U must be an lSemiModType R
                       := {linear U -&gt; R | *%R}
         (a *: u)%Rlin == transient forms that simplify to a *: u, a * u,
          (a * u)%Rlin    nu a *: u, and nu a * u, respectively, and are
      (a *:^nu u)%Rlin    created by rewriting with the linearZ lemma
       (a *^nu u)%Rlin    The forms allows the RHS of linearZ to be matched
                          reliably, using the GRing.Scale.law structure.
-&gt; Similarly to semiring morphisms, semiadditive properties are
   specialized for semilinear functions.
-&gt; Although {scalar U} is convertible to {linear U -&gt; R^o}, it does not
   actually use R^o, so that rewriting preserves the canonical structure
   of the range of scalar functions.
-&gt; The generic linearZ lemma uses a set of bespoke interface structures to
   ensure that both left-to-right and right-to-left rewriting work even in
   the presence of scaling functions that simplify non-trivially (e.g.,
   idfun \; *%R). Because most of the canonical instances and projections
   are coercions the machinery will be mostly invisible (with only the
   {linear ...} structure and %Rlin notations showing), but users should
   beware that in (a *: f u)%Rlin, a actually occurs in the f u subterm.
-&gt; The simpler linearZ_LR, or more specialized linearZZ and scalarZ rules
   should be used instead of linearZ if there are complexity issues, as
   well as for explicit forward and backward application, as the main
   parameter of linearZ is a proper sub-interface of {linear U -&gt; V | s}.

* LRMorphism (semialgebra or algebra morphisms):
{lrmorphism A -&gt; B | s} == the interface type for semiring (resp. ring)
                          morphisms semilinear (resp. linear) for the
                          scaling operator s of type R -&gt; B -&gt; B, i.e.,
                          the join of semiring (resp. ring) morphisms
                          {rmorphism A -&gt; B} and semilinear (resp. linear)
                          functions {linear A -&gt; B | s}; R, A, and B must
                          be a pzSemiRingType (resp. pzRingType), an
                          lSemiAlgType R (resp. lalgType R), and a
                          pzSemiRingType (resp. pzRingType), respectively
   {lrmorphism A -&gt; B} == the interface type for semialgebra (resp.
                          algebra) morphisms, where A and B must be
                          lSemiAlgType R (resp. lalgType R) for the same
                          pzSemiRingType (resp. pzRingType) R
                       := {lrmorphism A -&gt; B | *:%R}
 -&gt; Linear and rmorphism properties do not need to be specialized for
    as we supply inheritance join instances in both directions.
Finally we supply some helper notation for morphisms:
                   x^f == the image of x under some morphism
                          This notation is only reserved (not defined)
                          here; it is bound locally in sections where some
                          morphism is used heavily (e.g., the container
                          morphism in the parametricity sections of poly
                          and matrix, or the Frobenius section here)
                    \0 == the constant null function, which has a
                          canonical linear structure, and simplifies on
                          application (see ssrfun.v)
                f \+ g == the additive composition of f and g, i.e., the
                          function x |-&gt; f x + g x; f \+ g is canonically
                          linear when f and g are, and simplifies on
                          application (see ssrfun.v)
                f \- g == the function x |-&gt; f x - g x, canonically
                          linear when f and g are, and simplifies on
                          application
                  \- g == the function x |-&gt; - f x, canonically linear
                          when f is, and simplifies on application
               k \*: f == the function x |-&gt; k *: f x, which is
                          canonically linear when f is and simplifies on
                          application (this is a shorter alternative to
                          *:%R k \o f)
        GRing.in_alg A == the ring morphism that injects R into A, where A
                          has an lalgType R structure; GRing.in_alg A k
                          simplifies to k%:A
               a \*o f == the function x |-&gt; a * f x, canonically linear
                          when f is and its codomain is an algType
                          and which simplifies on application
               a \o* f == the function x |-&gt; f x * a, canonically linear
                          when f is and its codomain is an lalgType
                          and which simplifies on application
                f \* g == the function x |-&gt; f x * g x; f \* g
                          simplifies on application
The Lemmas about these structures are contained in both the GRing module
and in the submodule GRing.Theory, which can be imported when unqualified
access to the theory is needed (GRing.Theory also allows the unqualified
use of additive, linear, Linear, etc). The main GRing module should NOT be
imported.
  Notations are defined in scope ring_scope (delimiter %R), except term
and formula notations, which are in term_scope (delimiter %T).
  This library also extends the conventional suffixes described in library
ssrbool.v with the following:
  0 -- ring 0, as in addr0 : x + 0 = x
  1 -- ring 1, as in mulr1 : x * 1 = x
  D -- ring addition, as in linearD : f (u + v) = f u + f v
  B -- ring subtraction, as in opprB : - (x - y) = y - x
  M -- ring multiplication, as in invfM : (x * y)^-1 = x^-1 * y^-1
 Mn -- ring by nat multiplication, as in raddfMn : f (x *+ n) = f x *+ n
  N -- ring opposite, as in mulNr : (- x) * y = - (x * y)
  V -- ring inverse, as in mulVr : x^-1 * x = 1
  X -- ring exponentiation, as in rmorphXn : f (x ^+ n) = f x ^+ n
  Z -- (left) module scaling, as in linearZ : f (a *: v)  = s *: f v
The operator suffixes D, B, M and X are also used for the corresponding
operations on nat, as in natrX : (m ^ n)%:R = m%:R ^+ n. For the binary
power operator, a trailing "n" suffix is used to indicate the operator
suffix applies to the left-hand ring argument, as in
  expr1n : 1 ^+ n = 1 vs. expr1 : x ^+ 1 = x.
</pre>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> linear_ring_scope</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;+%R&quot;</span>.<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;-%R&quot;</span>.<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;*%R&quot;</span> (<span class="id">format</span> <span class="id">&quot; *%R&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;*:%R&quot;</span> (<span class="id">format</span> <span class="id">&quot; *:%R&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;n %:R&quot;</span> (<span class="id">left</span><span class="id"> associativity,</span><span class="id"> format</span> <span class="id">&quot;n %:R&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;k %:A&quot;</span> (<span class="id">left</span><span class="id"> associativity,</span><span class="id"> format</span> <span class="id">&quot;k %:A&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;[ 'pchar' F ]&quot;</span> (<span class="id">format</span> <span class="id">&quot;[ 'pchar'  F ]&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;[ 'char' F ]&quot;</span> (<span class="id">format</span> <span class="id">&quot;[ 'char'  F ]&quot;</span>).<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x %:T&quot;</span> (<span class="id">left</span><span class="id"> associativity,</span><span class="id"> format</span> <span class="id">&quot;x %:T&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''X_' i&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> i</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;''X_' i&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''exists' ''X_' i , f&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 199,</span><span class="id"> i</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> right</span><span class="id"> associativity,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;'[hv' ''exists'  ''X_' i , '/ '  f ']'&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;''forall' ''X_' i , f&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 199,</span><span class="id"> i</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> right</span><span class="id"> associativity,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;'[hv' ''forall'  ''X_' i , '/ '  f ']'&quot;</span>).<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x ^f&quot;</span> (<span class="id">left</span><span class="id"> associativity,</span><span class="id"> format</span> <span class="id">&quot;x ^f&quot;</span>).<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\0&quot;</span>.<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;f \+ g&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 50,</span><span class="id"> left</span><span class="id"> associativity</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;f \- g&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 50,</span><span class="id"> left</span><span class="id"> associativity</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\- f&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 35,</span><span class="id"> f</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 35</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;a \*o f&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 40</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;a \o* f&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 40</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;a \*: f&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 40</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;f \* g&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 40,</span><span class="id"> left</span><span class="id"> associativity</span>).<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'additive' U '-&gt;' V '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 98,</span><span class="id"> V</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 99,</span><span class="id"> format</span> <span class="id">&quot;{ 'additive'  U  -&gt;  V }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'rmorphism' U '-&gt;' V '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 98,</span><span class="id"> V</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 99,</span><span class="id"> format</span> <span class="id">&quot;{ 'rmorphism'  U  -&gt;  V }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'lrmorphism' U '-&gt;' V '|' s '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 98,</span><span class="id"> V</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 99,</span><span class="id"> format</span> <span class="id">&quot;{ 'lrmorphism'  U  -&gt;  V  |  s }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'lrmorphism' U '-&gt;' V '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 98,</span><span class="id"> V</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 99,</span><span class="id"> format</span> <span class="id">&quot;{ 'lrmorphism'  U  -&gt;  V }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'linear' U '-&gt;' V '|' s '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 98,</span><span class="id"> V</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 99,</span><span class="id"> format</span> <span class="id">&quot;{ 'linear'  U  -&gt;  V  |  s }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'linear' U '-&gt;' V '}'&quot;</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 98,</span><span class="id"> V</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 99,</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;{ 'linear'  U  -&gt;  V }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'{' 'scalar' U '}'&quot;</span> (<span class="id">format</span> <span class="id">&quot;{ 'scalar'  U }&quot;</span>).<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;R ^c&quot;</span> (<span class="id">format</span> <span class="id">&quot;R ^c&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;R ^o&quot;</span> (<span class="id">format</span> <span class="id">&quot;R ^o&quot;</span>).<br/>
<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Delimit</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> R</span>.<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Delimit</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span><span class="gallina-kwd"> with</span><span class="id"> T</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Export</span><span class="id"> Dummy</span>.<br/>
<span class="vernacular">Module</span><span class="id"> GRing</span><span class="id"> :=</span><span class="id"> Algebra</span>.<br/>
<span class="vernacular">End</span><span class="id"> Dummy</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Import</span><span class="id"> GRing</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> Algebra</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Monoid</span>.<span class="id">Theory</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;0&quot;</span><span class="id"> :=</span> (<span class="id">@zero</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;+%R&quot;</span><span class="id"> :=</span> (<span class="id">@add</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x + y&quot;</span><span class="id"> :=</span> (<span class="id">add</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x *+ n&quot;</span><span class="id"> :=</span> (<span class="id">natmul</span><span class="id"> x</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r | P ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[+%R/0]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span>)<span class="id"> F</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[+%R/0]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\sum_ ( i &lt; n ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[+%R/0]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\sum_ ( i 'in' A ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[+%R/0]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;s `_ i&quot;</span><span class="id"> :=</span> (<span class="id">nth</span><span class="id"> 0</span><span class="id"> s</span><span class="id"> i</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> nmodType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addrA</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id">@add</span><span class="id"> V</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addrC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">@add</span><span class="id"> V</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add0r</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">@zero</span><span class="id"> V</span>)<span class="id"> add</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addr0</span><span class="id"> :</span><span class="id"> right_id</span> (<span class="id">@zero</span><span class="id"> V</span>)<span class="id"> add</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addrCA</span><span class="id"> :</span><span class="id"> @left_commutative</span><span class="id"> V</span><span class="id"> V</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrCA</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrAC</span><span class="id"> :</span><span class="id"> @right_commutative</span><span class="id"> V</span><span class="id"> V</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrAC</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrACA</span><span class="id"> :</span><span class="id"> @interchange</span><span class="id"> V</span><span class="id"> +%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrACA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr0n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulr0n</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulr1n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulr1n</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulr2n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulr2n</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrS</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrS</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrSr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> +</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrSr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrb</span><span class="id"> x</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> b</span><span class="id"> =</span> (<span class="gallina-kwd">if</span><span class="id"> b</span><span class="gallina-kwd"> then</span><span class="id"> x</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrb</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul0rn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> V</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mul0rn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnDl</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnDr</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span> (<span class="id">m</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> m</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnA</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> m</span><span class="id"> *+</span><span class="id"> n</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnAC</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> m</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> *+</span><span class="id"> m</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnAC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iter_addr</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> iter</span><span class="id"> n</span> (<span class="id">+%R</span><span class="id"> x</span>)<span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> iter_addr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iter_addr_0</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> iter</span><span class="id"> n</span> (<span class="id">+%R</span><span class="id"> x</span>)<span class="id"> 0</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> iter_addr_0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumrMnl</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sumrMnl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumrMnr</span><span class="id"> x</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> x</span><span class="id"> *+</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sumrMnr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumr_const</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> x</span><span class="id"> :</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> #|A|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sumr_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumr_const_nat</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> \sum_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sumr_const_nat</span>. Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Algebra.nmod_closed instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> addr_closed</span><span class="id"> :=</span><span class="id"> nmod_closed</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;-%R&quot;</span><span class="id"> :=</span> (<span class="id">@opp</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;- x&quot;</span><span class="id"> :=</span> (<span class="id">opp</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x - y&quot;</span><span class="id"> :=</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x *- n&quot;</span><span class="id"> :=</span> (<span class="id">-</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> zmodType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addNr</span><span class="id"> :</span><span class="id"> @left_inverse</span><span class="id"> V</span><span class="id"> V</span><span class="id"> V</span><span class="id"> 0</span><span class="id"> -%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addNr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrN</span><span class="id"> :</span><span class="id"> @right_inverse</span><span class="id"> V</span><span class="id"> V</span><span class="id"> V</span><span class="id"> 0</span><span class="id"> -%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrN</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> subrr</span><span class="id"> :=</span><span class="id"> addrN</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addKr</span><span class="id"> :</span><span class="id"> @left_loop</span><span class="id"> V</span><span class="id"> V</span><span class="id"> -%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addKr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addNKr</span><span class="id"> :</span><span class="id"> @rev_left_loop</span><span class="id"> V</span><span class="id"> V</span><span class="id"> -%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addNKr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrK</span><span class="id"> :</span><span class="id"> @right_loop</span><span class="id"> V</span><span class="id"> V</span><span class="id"> -%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrNK</span><span class="id"> :</span><span class="id"> @rev_right_loop</span><span class="id"> V</span><span class="id"> V</span><span class="id"> -%R</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrNK</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> subrK</span><span class="id"> :=</span><span class="id"> addrNK</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> subrKC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> subrK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subKr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> involutive</span> (<span class="gallina-kwd">fun</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subKr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrI</span><span class="id"> :</span><span class="id"> @right_injective</span><span class="id"> V</span><span class="id"> V</span><span class="id"> V</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrI</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addIr</span><span class="id"> :</span><span class="id"> @left_injective</span><span class="id"> V</span><span class="id"> V</span><span class="id"> V</span><span class="id"> +%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addIr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subrI</span><span class="id"> :</span><span class="id"> right_injective</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subrI</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subIr</span><span class="id"> :</span><span class="id"> left_injective</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subIr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> opprK</span><span class="id"> :</span><span class="id"> @involutive</span><span class="id"> V</span><span class="id"> -%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> opprK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> oppr_inj</span><span class="id"> :</span><span class="id"> @injective</span><span class="id"> V</span><span class="id"> V</span><span class="id"> -%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> oppr_inj</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> oppr0</span><span class="id"> :</span><span class="id"> -0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> V</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> oppr0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> oppr_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> oppr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subr0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> sub0r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sub0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> opprB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> opprB</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> opprD</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> -%R:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> opprD</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addrKA</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> -</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrKA</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subrKA</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> +</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subrKA</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addr0_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addr0_eq</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subr0_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subr0_eq</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subr_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subr_eq</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> subr_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> subr_eq0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> addr_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addr_eq0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> eqr_opp</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eqr_opp</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> eqr_oppLR</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eqr_oppLR</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulNrn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *-</span><span class="id"> n</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulNrn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnBl</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnBl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnBr</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> m</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnBr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumrN</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> -</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sumrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumrB</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F1</span><span class="id"> F2</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F1</span><span class="id"> i</span><span class="id"> -</span><span class="id"> F2</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F1</span><span class="id"> i</span><span class="id"> -</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F2</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> sumrB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_sumr</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>) (<span class="id">f</span><span class="id"> k</span>.<span class="id">+1</span><span class="id"> -</span><span class="id"> f</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> m</span><span class="id"> -</span><span class="id"> f</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> telescope_sumr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_sumr_eq</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> u</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> u</span><span class="id"> k</span><span class="id"> =</span><span class="id"> f</span><span class="id"> k</span>.<span class="id">+1</span><span class="id"> -</span><span class="id"> f</span><span class="id"> k</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id"> u</span><span class="id"> k</span><span class="id"> =</span><span class="id"> f</span><span class="id"> m</span><span class="id"> -</span><span class="id"> f</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> telescope_sumr_eq</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_closed</span><span class="id"> :=</span><span class="id"> oppr_closed</span><span class="id"> S</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr_2closed</span><span class="id"> :=</span><span class="id"> subr_closed</span><span class="id"> S</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> zmod_closed</span><span class="id"> :=</span><span class="id"> zmod_closed</span><span class="id"> S</span>.<br/>
&nbsp;<br/>
<span class="vernacular">Lemma</span><span class="id"> zmod_closedN</span><span class="id"> :</span><span class="id"> zmod_closed</span><span class="id"> -&gt;</span><span class="id"> oppr_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> zmod_closedN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> zmod_closedD</span><span class="id"> :</span><span class="id"> zmod_closed</span><span class="id"> -&gt;</span><span class="id"> nmod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z;</span><span class="id"> split;</span><span class="id"> [case:</span><span class="id"> z|apply/zmod_closedD]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ZmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> addrI</span><span class="id"> {V}</span><span class="id"> y</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addIr</span><span class="id"> {V}</span><span class="id"> x</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> opprK</span><span class="id"> {V}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> oppr_inj</span><span class="id"> {V}</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> telescope_sumr_eq</span><span class="id"> {V</span><span class="id"> n</span><span class="id"> m}</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> Nmodule_isPzSemiRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;pzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> PzSemiRing</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule_isPzSemiRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> Nmodule</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isPzSemiRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Choice</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">zero</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">add</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">addrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">addrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">add0r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> zero</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> isPzSemiRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @isNmodule</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">zero</span><span class="id"> add</span><span class="id"> addrA</span><span class="id"> addrC</span><span class="id"> add0r</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">one</span><span class="id"> mul</span><span class="id"> mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> PzSemiRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> PzSemiRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> PzSemiRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> PzSemiRingExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> PzSemiRing_isNonZero</span><span class="id"> R</span><span class="id"> of</span><span class="id"> PzSemiRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> @one</span><span class="id"> R</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;nzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> NzSemiRing</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> R</span><span class="id"> of</span><span class="id"> PzSemiRing_isNonZero</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> PzSemiRing</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">NzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzSemiRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">NzSemiRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzSemiRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">NzSemiRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzSemiRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">NzSemiRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SemiRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Nmodule_isNzSemiRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> one</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule_isNzSemiRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> oner_neq0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Nmodule_isSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Nmodule_isNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Nmodule_isNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Nmodule_isSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Nmodule_isNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Nmodule_isSemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Nmodule_isNzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isNzSemiRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Choice</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">zero</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">add</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">addrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">addrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">add0r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> zero</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> one</span><span class="id"> !=</span><span class="id"> zero</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> isSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use isNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">isNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> isSemiRing</span>.<br/>
<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use isNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> isSemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">isNzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> isNzSemiRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @isNmodule</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">zero</span><span class="id"> add</span><span class="id"> addrA</span><span class="id"> addrC</span><span class="id"> add0r</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @Nmodule_isNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">one</span><span class="id"> mul</span><span class="id"> mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span><span class="id"> oner_neq0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NzSemiRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> NzSemiRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> NzSemiRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> NzSemiRingExports</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> exp</span><span class="id"> R</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> iterop</span><span class="id"> n</span> (<span class="id">@mul</span><span class="id"> R</span>)<span class="id"> x</span> (<span class="id">@one</span><span class="id"> R</span>).<br/>
<span class="vernacular">Arguments</span><span class="id"> exp</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> comm</span><span class="id"> R</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> @mul</span><span class="id"> R</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> mul</span><span class="id"> y</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lreg</span><span class="id"> R</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> injective</span> (<span class="id">@mul</span><span class="id"> R</span><span class="id"> x</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> rreg</span><span class="id"> R</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> injective</span> ((<span class="id">@mul</span><span class="id"> R</span>)<span class="id">^~</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span> (<span class="id">@one</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;n %:R&quot;</span><span class="id"> :=</span> (<span class="id">1</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;*%R&quot;</span><span class="id"> :=</span> (<span class="id">@mul</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x * y&quot;</span><span class="id"> :=</span> (<span class="id">mul</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x ^+ n&quot;</span><span class="id"> :=</span> (<span class="id">exp</span><span class="id"> x</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\prod_ ( i &lt;- r | P ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[*%R/1]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span>)<span class="id"> F</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\prod_ ( i | P ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[*%R/1]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span>)<span class="id"> F</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\prod_ ( i 'in' A ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[*%R/1]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\prod_ ( m &lt;= i &lt; n ) F&quot;</span><span class="id"> :=</span> (<span class="id">\big[*%R/1%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> pchar</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> :</span><span class="id"> nat_pred</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[pred</span><span class="id"> p</span><span class="id"> |</span><span class="id"> prime</span><span class="id"> p</span><span class="id"> &amp;</span><span class="id"> p%:R</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R]</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> char</span><span class="id"> :=</span><span class="id"> pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> has_pchar0</span><span class="id"> L</span><span class="id"> :=</span> (<span class="id">pchar</span><span class="id"> L</span><span class="id"> =i</span><span class="id"> pred0</span>).<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use has_pchar0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> has_char0</span><span class="id"> L</span><span class="id"> :=</span> (<span class="id">has_pchar0</span><span class="id"> L</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> converse</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><span class="id"> R</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;R ^c&quot;</span><span class="id"> :=</span> (<span class="id">converse</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PzSemiRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">isLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> 1</span><span class="id"> *%R</span><span class="id"> mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">isMulLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> 0</span><span class="id"> *%R</span><span class="id"> mul0r</span><span class="id"> mulr0</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">isAddLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> *%R</span><span class="id"> +%R</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_suml</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> big_distrl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sumr</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> big_distrr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnAl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?mul0r</span><span class="id"> //</span><span class="id"> !mulrS</span><span class="id"> mulrDl</span><span class="id"> IHn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrnAr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?mulr0</span><span class="id"> //</span><span class="id"> !mulrS</span><span class="id"> mulrDr</span><span class="id"> IHn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_natl</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrnAl</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_natr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> n%:R</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrnAr</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natrD</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">m</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> m%:R</span><span class="id"> +</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnDr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> natr1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> +</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> n</span>.<span class="id">+1%:R</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrSr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> nat1r</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> n%:R</span><span class="id"> =</span><span class="id"> n</span>.<span class="id">+1%:R</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrS</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> natr_sum</span><span class="id"> :=</span><span class="id"> big_morph</span> (<span class="id">natmul</span><span class="id"> 1</span>)<span class="id"> natrD</span> (<span class="id">mulr0n</span><span class="id"> 1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natrM</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> m%:R</span><span class="id"> *</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrnA</span><span class="id"> mulr_natr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> expr1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> expr2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprS</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr0n</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0%N</span>)<span class="id">%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr1n</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> IHn;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprD</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm];</span><span class="id"> rewrite</span><span class="id"> ?mul1r</span><span class="id"> //</span><span class="id"> !exprS</span><span class="id"> -mulrA</span><span class="id"> -IHm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprSr</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -addn1</span><span class="id"> exprD</span><span class="id"> expr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_sum</span><span class="id"> x</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> ^+</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> x</span><span class="id"> ^+</span><span class="id"> F</span><span class="id"> i</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> _</span> (<span class="id">exprD</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr_sym</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> y</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> commr_refl</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulr0</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulr1</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">F</span><span class="id"> i</span>))<span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> comm_x_F;</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulr_suml</span><span class="id"> mulr_sumr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /comm_x_F</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrMn</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">y</span><span class="id"> *+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /comm</span><span class="id"> =&gt;</span><span class="id"> com_xy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?commr0</span><span class="id"> //</span><span class="id"> mulrS</span><span class="id"> commrD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> com_xy;</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulrA</span><span class="id"> com_xy</span><span class="id"> -!mulrA</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr_prod</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">F</span><span class="id"> i</span>))<span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_ind</span><span class="id"> _</span> (<span class="id">commr1</span><span class="id"> x</span>) (<span class="id">@commrM</span><span class="id"> x</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr_nat</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> n%:R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/commrMn/commr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrX</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">y</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /comm</span><span class="id"> =&gt;</span><span class="id"> com_xy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?commr1</span><span class="id"> //</span><span class="id"> exprS</span><span class="id"> commrM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprMn_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> com_xy;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !exprS</span><span class="id"> IHn</span><span class="id"> !mulrA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -!mulrA</span><span class="id"> -commrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprMn_n</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> m</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> *+</span> (<span class="id">m</span><span class="id"> ^</span><span class="id"> n</span>)<span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr1n</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> IHn</span><span class="id"> mulrnAl</span><span class="id"> mulrnAr</span><span class="id"> -mulrnA</span><span class="id"> exprS</span><span class="id"> -expnSr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprM</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr1n</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulSn</span><span class="id"> exprD</span><span class="id"> IHm</span><span class="id"> exprS</span><span class="id"> exprMn_comm</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> commrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprAC</span><span class="id"> x</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> m</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> ^+</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!exprM</span><span class="id"> mulnC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_mod</span><span class="id"> n</span><span class="id"> x</span><span class="id"> i</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">i</span><span class="id"> %%</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xn1;</span><span class="id"> rewrite</span><span class="id"> {2}</span>(<span class="id">divn_eq</span><span class="id"> i</span><span class="id"> n</span>)<span class="id"> exprD</span><span class="id"> mulnC</span><span class="id"> exprM</span><span class="id"> xn1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_dvd</span><span class="id"> n</span><span class="id"> x</span><span class="id"> i</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> n</span><span class="id"> %|</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xn1</span><span class="id"> dvd_n_i;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">expr_mod</span><span class="id"> i</span><span class="id"> xn1</span>) (<span class="id">eqnP</span><span class="id"> dvd_n_i</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natrX</span><span class="id"> n</span><span class="id"> k</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> ^</span><span class="id"> k</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> n%:R</span><span class="id"> ^+</span><span class="id"> k</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprMn_n</span><span class="id"> expr1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrI_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> lreg</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> reg_x;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">mulr0</span><span class="id"> x</span>) (<span class="id">inj_eq</span><span class="id"> reg_x</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lreg1</span><span class="id"> :</span><span class="id"> lreg</span> (<span class="id">1</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lregM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> lreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> lreg</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> lreg</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> reg_x</span><span class="id"> reg_y</span><span class="id"> z</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> -!mulrA</span><span class="id"> =&gt;</span><span class="id"> /reg_x/reg_y</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lregMl</span> (<span class="id">a</span><span class="id"> b:</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> lreg</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> -&gt;</span><span class="id"> lreg</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> rab</span><span class="id"> c</span><span class="id"> c'</span><span class="id"> eq_bc;</span><span class="id"> apply/rab;</span><span class="id"> rewrite</span><span class="id"> -!mulrA</span><span class="id"> eq_bc</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rregMr</span> (<span class="id">a</span><span class="id"> b:</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> rreg</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> -&gt;</span><span class="id"> rreg</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> rab</span><span class="id"> c</span><span class="id"> c'</span><span class="id"> eq_ca;</span><span class="id"> apply/rab;</span><span class="id"> rewrite</span><span class="id"> !mulrA</span><span class="id"> eq_ca</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lregX</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> lreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> lreg</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> reg_x;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> [apply:</span><span class="id"> lreg1</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> exprS;</span><span class="id"> apply:</span><span class="id"> lregM]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iter_mulr</span><span class="id"> n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> iter</span><span class="id"> n</span> (<span class="id"> *%R</span><span class="id"> x</span>)<span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ih];</span><span class="id"> rewrite</span><span class="id"> ?expr0</span><span class="id"> ?mul1r</span><span class="id"> //=</span><span class="id"> ih</span><span class="id"> exprS</span><span class="id"> -mulrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iter_mulr_1</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> iter</span><span class="id"> n</span> (<span class="id"> *%R</span><span class="id"> x</span>)<span class="id"> 1</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> iter_mulr</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodr_const</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> x</span><span class="id"> :</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> #|A|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_const</span><span class="id"> -iteropE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodr_const_nat</span><span class="id"> n</span><span class="id"> m</span><span class="id"> x</span><span class="id"> :</span><span class="id"> \prod_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_const_nat</span><span class="id"> -iteropE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrXr</span><span class="id"> x</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> x</span><span class="id"> ^+</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">big_morph</span><span class="id"> _</span> (<span class="id">exprD</span><span class="id"> _</span>) (<span class="id">erefl</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrM_comm</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> eqType}</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> G</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> j</span><span class="id"> -&gt;</span><span class="id"> comm</span> (<span class="id">F</span><span class="id"> i</span>) (<span class="id">G</span><span class="id"> j</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> G</span><span class="id"> i</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> G</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> FG;</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> r</span><span class="id"> IHr];</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">big_nil,</span><span class="id"> big_cons</span>)<span class="id"> ?mulr1//</span>.<br/>
<span class="id">case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> IHr</span><span class="id"> !mulrA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -!mulrA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> commr_prod</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> Pj;</span><span class="id"> apply/commr_sym/FG</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrMl_comm</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> finType}</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> A</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">F</span><span class="id"> i</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> #|A|</span><span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xF;</span><span class="id"> rewrite</span><span class="id"> prodrM_comm</span><span class="id"> ?prodr_const//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> _</span><span class="id"> /xF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrMr_comm</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> finType}</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> A</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">F</span><span class="id"> i</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> #|A|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xF;</span><span class="id"> rewrite</span><span class="id"> prodrM_comm</span><span class="id"> ?prodr_const//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /xF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrMn</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> g</span><span class="id"> i</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>)<span class="id"> *+</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> g</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> elim/big_rec3:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span><span class="id"> y1</span><span class="id"> y2</span><span class="id"> y3</span><span class="id"> _</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> mulrnAr</span><span class="id"> mulrnAl</span><span class="id"> -mulrnA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrMn_const</span><span class="id"> n</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> ^</span><span class="id"> #|A|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> prodrMn</span><span class="id"> prod_nat_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_prod</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>)<span class="id">%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> _</span><span class="id"> natrM</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprDn_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span> (<span class="id">cxy</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>) (<span class="id">x</span><span class="id"> ^+</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> i</span>)<span class="id"> *+</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> big_ord_recl</span><span class="id"> mulr1</span><span class="id"> ?big_ord0</span><span class="id"> ?addr0</span><span class="id"> //=</span>.<br/>
<span class="id">rewrite</span><span class="id"> exprS</span><span class="id"> {}IHn</span><span class="id"> /=</span><span class="id"> mulrDl</span><span class="id"> !big_distrr</span><span class="id"> /=</span><span class="id"> big_ord_recl</span><span class="id"> mulr1</span><span class="id"> subn0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big_ord_recr</span><span class="id"> /=</span><span class="id"> !binn</span><span class="id"> !subnn</span><span class="id"> !mul1r</span><span class="id"> !subn0</span><span class="id"> bin0</span><span class="id"> !exprS</span><span class="id"> -addrA</span>.<br/>
<span class="id">congr</span> (_<span class="id"> +</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> addrA</span><span class="id"> -big_split</span><span class="id"> /=;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>).<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mulrnAr</span><span class="id"> !mulrA</span><span class="id"> -exprS</span><span class="id"> -subSn</span><span class="id"> ?</span>(<span class="id">valP</span><span class="id"> i</span>)<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subSS</span> (<span class="id">commrX</span><span class="id"> _</span> (<span class="id">commr_sym</span><span class="id"> cxy</span>))<span class="id"> -mulrA</span><span class="id"> -exprS</span><span class="id"> -mulrnDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprD1n</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>)<span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> *+</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> addrC</span> (<span class="id">exprDn_comm</span><span class="id"> n</span> (<span class="id">commr_sym</span> (<span class="id">commr1</span><span class="id"> x</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrrD1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> exprD1n</span><span class="id"> !big_ord_recr</span><span class="id"> big_ord0</span><span class="id"> /=</span><span class="id"> add0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> addrA</span><span class="id"> addrAC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_2closed</span><span class="id"> :=</span><span class="id"> {in</span><span class="id"> S</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> u</span><span class="id"> v,</span><span class="id"> u</span><span class="id"> *</span><span class="id"> v</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_closed</span><span class="id"> :=</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> mulr_2closed</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semiring_closed</span><span class="id"> :=</span><span class="id"> nmod_closed</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> mulr_closed</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> semiring_closedD</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> -&gt;</span><span class="id"> nmod_closed</span><span class="id"> S</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> semiring_closedM</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> -&gt;</span><span class="id"> mulr_closed</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PzSemiRingTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NzSemiRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oner_eq0</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> negbTE</span><span class="id"> oner_neq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lastr_eq0</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">last</span><span class="id"> x</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">last</span><span class="id"> 1</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> [|y</span><span class="id"> s]</span><span class="id"> /negPf</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lreg_neq0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> lreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> reg_x;</span><span class="id"> rewrite</span><span class="id"> -[x]mulr1</span><span class="id"> mulrI_eq0</span><span class="id"> ?oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_aut</span><span class="id"> p</span><span class="id"> of</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> p</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FrobeniusAutomorphism</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> pcharFp</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pcharf0</span><span class="id"> :</span><span class="id"> p%:R</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> case/andP:</span><span class="id"> pcharFp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pcharf_prime</span><span class="id"> :</span><span class="id"> prime</span><span class="id"> p</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/andP:</span><span class="id"> pcharFp</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> pcharf_prime</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrn_pchar</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulr_natl</span><span class="id"> pcharf0</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_mod_pchar</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> %%</span><span class="id"> p</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {2}</span>(<span class="id">divn_eq</span><span class="id"> n</span><span class="id"> p</span>)<span class="id"> natrD</span><span class="id"> mulrnA</span><span class="id"> mulrn_pchar</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvdn_pcharf</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">p</span><span class="id"> %|</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> =</span> (<span class="id">n%:R</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/eqP=&gt;</span><span class="id"> [/dvdnP[n'</span><span class="id"> -&gt;]|n0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> natrM</span><span class="id"> pcharf0</span><span class="id"> mulr0</span>.<br/>
<span class="id">apply/idPn;</span><span class="id"> rewrite</span><span class="id"> -prime_coprime</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /eqnP</span><span class="id"> pn1</span>.<br/>
<span class="id">have</span><span class="id"> [a</span><span class="id"> _</span><span class="id"> /dvdnP[b]]</span><span class="id"> :=</span><span class="id"> Bezoutl</span><span class="id"> n</span> (<span class="id">prime_gt0</span><span class="id"> pcharf_prime</span>).<br/>
<span class="id">move/</span>(<span class="id">congr1</span> (<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> m%:R</span><span class="id"> :</span><span class="id"> R</span>))<span class="id">/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> natrD</span><span class="id"> !natrM</span><span class="id"> pcharf0</span><span class="id"> n0</span><span class="id"> !mulr0</span><span class="id"> pn1</span><span class="id"> addr0</span><span class="id"> oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pcharf_eq</span><span class="id"> :</span><span class="id"> pchar</span><span class="id"> R</span><span class="id"> =i</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> nat_pred</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> q;</span><span class="id"> apply/andP/eqP=&gt;</span><span class="id"> [[q_pr</span><span class="id"> q0]</span><span class="id"> |</span><span class="id"> -&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pcharf0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> -dvdn_prime2</span><span class="id"> //</span><span class="id"> dvdn_pcharf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bin_lt_pcharf_0</span><span class="id"> k</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> 'C</span>(<span class="id">p,</span><span class="id"> k</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lt0kp;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -dvdn_pcharf</span><span class="id"> prime_dvd_bin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x ^f&quot;</span><span class="id"> :=</span> (<span class="id">pFrobenius_aut</span><span class="id"> pcharFp</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x^f</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> p</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> f'E</span><span class="id"> :=</span><span class="id"> pFrobenius_autE</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_aut0</span><span class="id"> :</span><span class="id"> 0^f</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> f'E</span><span class="id"> -</span>(<span class="id">prednK</span> (<span class="id">prime_gt0</span><span class="id"> pcharf_prime</span>))<span class="id"> exprS</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_aut1</span><span class="id"> :</span><span class="id"> 1^f</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> f'E</span><span class="id"> expr1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autD_comm</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">cxy</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> x^f</span><span class="id"> +</span><span class="id"> y^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> defp</span><span class="id"> :=</span><span class="id"> prednK</span> (<span class="id">prime_gt0</span><span class="id"> pcharf_prime</span>).<br/>
<span class="id">rewrite</span><span class="id"> !f'E</span><span class="id"> exprDn_comm</span><span class="id"> //</span><span class="id"> big_ord_recr</span><span class="id"> subnn</span><span class="id"> -defp</span><span class="id"> big_ord_recl</span><span class="id"> /=</span><span class="id"> defp</span>.<br/>
<span class="id">rewrite</span><span class="id"> subn0</span><span class="id"> mulr1</span><span class="id"> mul1r</span><span class="id"> bin0</span><span class="id"> binn</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulr_natl</span><span class="id"> bin_lt_pcharf_0</span><span class="id"> ?mul0r</span><span class="id"> //=</span><span class="id"> -{2}defp</span><span class="id"> ltnS</span> (<span class="id">valP</span><span class="id"> i</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autMn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> x^f</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> pFrobenius_aut0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulrS</span><span class="id"> pFrobenius_autD_comm</span><span class="id"> ?IHn</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> commrMn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_aut_nat</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> n%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> pFrobenius_autMn</span><span class="id"> pFrobenius_aut1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autM_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> x^f</span><span class="id"> *</span><span class="id"> y^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> exprMn_comm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autX</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> x^f</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !f'E</span><span class="id"> -!exprM</span><span class="id"> mulnC</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FrobeniusAutomorphism</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Char2</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> pcharR2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addrr_pchar2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulr2n</span><span class="id"> mulrn_pchar</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Char2</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NzSemiRingTheory</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;pzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> PzRing</span><span class="id"> :=</span><span class="id"> {</span><span class="id"> R</span><span class="id"> of</span><span class="id"> PzSemiRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> Zmodule</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isPzRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule_isPzRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span><span class="id"> one</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x * y&quot;</span><span class="id"> :=</span> (<span class="id">mul</span><span class="id"> x</span><span class="id"> y</span>).<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> mul0r</span><span class="id"> :</span><span class="id"> @left_zero</span><span class="id"> R</span><span class="id"> R</span><span class="id"> 0</span><span class="id"> mul</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span> (<span class="id">addIr</span> (<span class="id">1</span><span class="id"> *</span><span class="id"> x</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrDl</span><span class="id"> !add0r</span><span class="id"> mul1r</span>. Qed.</div></details>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> mulr0</span><span class="id"> :</span><span class="id"> @right_zero</span><span class="id"> R</span><span class="id"> R</span><span class="id"> 0</span><span class="id"> mul</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span> (<span class="id">addIr</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> 1</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrDr</span><span class="id"> !add0r</span><span class="id"> mulr1</span>. Qed.</div></details>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isPzRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Choice</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">zero</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">opp</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">add</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">addrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">addrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">add0r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> zero</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">addNr</span><span class="id"> :</span><span class="id"> left_inverse</span><span class="id"> zero</span><span class="id"> opp</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> isPzRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @isZmodule</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">zero</span><span class="id"> opp</span><span class="id"> add</span><span class="id"> addrA</span><span class="id"> addrC</span><span class="id"> add0r</span><span class="id"> addNr</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @Zmodule_isPzRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">one</span><span class="id"> mul</span><span class="id"> mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> PzRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> PzRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> PzRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> PzRingExports</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_aut</span><span class="id"> :=</span><span class="id"> pFrobenius_aut</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> charf0</span><span class="id"> :=</span><span class="id"> pcharf0</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf_prime instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> charf_prime</span><span class="id"> :=</span><span class="id"> pcharf_prime</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use mulrn_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> mulrn_char</span><span class="id"> :=</span><span class="id"> mulrn_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use natr_mod_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> natr_mod_char</span><span class="id"> :=</span><span class="id"> natr_mod_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use dvdn_pcharf instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> dvdn_charf</span><span class="id"> :=</span><span class="id"> dvdn_pcharf</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf_eq instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> charf_eq</span><span class="id"> :=</span><span class="id"> pcharf_eq</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use bin_lt_pcharf_0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> bin_lt_charf_0</span><span class="id"> :=</span><span class="id"> bin_lt_pcharf_0</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autE instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autE</span><span class="id"> :=</span><span class="id"> pFrobenius_autE</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_aut0</span><span class="id"> :=</span><span class="id"> pFrobenius_aut0</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut1 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_aut1</span><span class="id"> :=</span><span class="id"> pFrobenius_aut1</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autD_comm instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autD_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autD_comm</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autMn instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autMn</span><span class="id"> :=</span><span class="id"> pFrobenius_autMn</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut_nat instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_aut_nat</span><span class="id"> :=</span><span class="id"> pFrobenius_aut_nat</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autM_comm instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autM_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autM_comm</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autX instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autX</span><span class="id"> :=</span><span class="id"> pFrobenius_autX</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use addrr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> addrr_char2</span><span class="id"> :=</span><span class="id"> addrr_pchar2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;nzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> NzRing</span><span class="id"> :=</span><span class="id"> {</span><span class="id"> R</span><span class="id"> of</span><span class="id"> NzSemiRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> Zmodule</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Ring</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">NzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Ring</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">NzRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">NzRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">NzRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Ring</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isNzRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> one</span><span class="id"> !=</span><span class="id"> 0</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Zmodule_isRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Zmodule_isNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Zmodule_isNzRing</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Zmodule_isRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Zmodule_isNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Zmodule_isRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Zmodule_isNzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule_isNzRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Zmodule_isPzRing</span>.<span class="id">Build</span><span class="id"> R</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> oner_neq0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isNzRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Choice</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">zero</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">opp</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">add</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">addrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">addrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">add0r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> zero</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">addNr</span><span class="id"> :</span><span class="id"> left_inverse</span><span class="id"> zero</span><span class="id"> opp</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> one</span><span class="id"> !=</span><span class="id"> zero</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> isRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use isNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">isNzRing</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> isRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use isNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> isRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">isNzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> isNzRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @isZmodule</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">zero</span><span class="id"> opp</span><span class="id"> add</span><span class="id"> addrA</span><span class="id"> addrC</span><span class="id"> add0r</span><span class="id"> addNr</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @Zmodule_isNzRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">one</span><span class="id"> mul</span><span class="id"> mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> oner_neq0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> NzRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> NzRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> NzRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> NzRingExports</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> sign</span><span class="id"> R</span><span class="id"> b</span><span class="id"> :=</span> (<span class="id">exp</span> (<span class="id">-</span><span class="id"> @one</span><span class="id"> R</span>) (<span class="id">nat_of_bool</span><span class="id"> b</span>)) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;- 1&quot;</span><span class="id"> :=</span> (<span class="id">-</span> (<span class="id">1</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PzRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> pzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">-</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">addrI</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrDr</span><span class="id"> !subrr</span><span class="id"> mulr0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulNr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">addrI</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrDl</span><span class="id"> !subrr</span><span class="id"> mul0r</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrNN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> *</span> (<span class="id">-</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> mulNr</span><span class="id"> opprK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulN1r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulNr</span><span class="id"> mul1r</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrN1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> -1</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> mulNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrBr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDr</span><span class="id"> mulrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natrB</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> m%:R</span><span class="id"> -</span><span class="id"> n%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrnBr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> com_xy;</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulrN</span><span class="id"> com_xy</span><span class="id"> mulNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrN1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">-1</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/commrN/commr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> com_xy</span><span class="id"> com_xz;</span><span class="id"> apply:</span><span class="id"> commrD</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> commrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commr_sign</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">commrX</span><span class="id"> n</span> (<span class="id">commrN1</span><span class="id"> x</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_odd</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> IHn;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> -{}IHn</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/odd:</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> !mulN1r</span><span class="id"> ?opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_sign</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> x</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span> (<span class="gallina-kwd">if</span><span class="id"> b</span><span class="gallina-kwd"> then</span><span class="id"> -</span><span class="id"> x</span><span class="gallina-kwd"> else</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> ?mulNr</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_addb</span><span class="id"> b1</span><span class="id"> b2</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">b1</span> (<span class="id">+</span>)<span class="id"> b2</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b1</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b2</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_sign;</span><span class="id"> case:</span><span class="id"> b1</span><span class="id"> b2</span><span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [];</span><span class="id"> rewrite</span><span class="id"> ?opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signrE</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> b</span>.<span class="id">*2%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> ?subr0</span><span class="id"> //</span><span class="id"> opprD</span><span class="id"> addNKr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signrN</span><span class="id"> b</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">~~</span><span class="id"> b</span>)<span class="id"> =</span><span class="id"> -</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> ?opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_signM</span> (<span class="id">b1</span><span class="id"> b2</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> x1</span><span class="id"> x2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b1</span><span class="id"> *</span><span class="id"> x1</span>)<span class="id"> *</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b2</span><span class="id"> *</span><span class="id"> x2</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">b1</span> (<span class="id">+</span>)<span class="id"> b2</span>)<span class="id"> *</span> (<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> signr_addb</span><span class="id"> -!mulrA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mulrA</span><span class="id"> commr_sign</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprNn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulN1r</span><span class="id"> exprMn_comm</span><span class="id"> //</span><span class="id"> /comm</span><span class="id"> mulN1r</span><span class="id"> mulrN</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrrN</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulrNN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrr_sign</span><span class="id"> n</span><span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprAC</span><span class="id"> sqrrN</span><span class="id"> !expr1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signrMK</span><span class="id"> n</span><span class="id"> :</span><span class="id"> @involutive</span><span class="id"> R</span> (<span class="id"> *%R</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> -expr2</span><span class="id"> sqrr_sign</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrI0_lreg</span><span class="id"> x</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> lreg</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> reg_x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> eq_xy_xz;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> [y</span><span class="id"> -</span><span class="id"> z]reg_x</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrBr</span><span class="id"> eq_xy_xz</span><span class="id"> subrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lregN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> lreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> lreg</span> (<span class="id">-</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> reg_x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !mulNr</span><span class="id"> =&gt;</span><span class="id"> /oppr_inj/reg_x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lreg_sign</span><span class="id"> n</span><span class="id"> :</span><span class="id"> lreg</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> :</span><span class="id"> R</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/lregX/lregN/lreg1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrN</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> -</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> #|A|</span><span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -sum1_card;</span><span class="id"> elim/big_rec3:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> x</span><span class="id"> n</span><span class="id"> _</span><span class="id"> _</span><span class="id"> -&gt;];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> !mulrA</span><span class="id"> mulN1r</span><span class="id"> !mulNr</span><span class="id"> commrX</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> commrN1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprBn_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span> (<span class="id">cxy</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>) ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> i</span>)<span class="id"> *+</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> exprDn_comm;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> commrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> congr</span> (_<span class="id"> *+</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -commr_sign</span><span class="id"> -mulrA</span><span class="id"> -exprNn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subrXX_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span> (<span class="id">cxy</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> x</span><span class="id"> ^+</span> (<span class="id">n</span>.<span class="id">-1</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_ord0</span><span class="id"> mulr0</span><span class="id"> subrr</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulrBl</span><span class="id"> !big_distrr</span><span class="id"> big_ord_recl</span><span class="id"> big_ord_recr</span><span class="id"> /=</span><span class="id"> subnn</span><span class="id"> mulr1</span><span class="id"> mul1r</span>.<br/>
<span class="id">rewrite</span><span class="id"> subn0</span><span class="id"> -!exprS</span><span class="id"> opprD</span><span class="id"> -!addrA;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> addrA</span><span class="id"> -sumrB</span>.<br/>
<span class="id">rewrite</span><span class="id"> big1</span><span class="id"> ?add0r</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !mulrA</span><span class="id"> -exprS</span><span class="id"> -subSn</span><span class="id"> ?</span>(<span class="id">valP</span><span class="id"> i</span>)<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subSS</span> (<span class="id">commrX</span><span class="id"> _</span> (<span class="id">commr_sym</span><span class="id"> cxy</span>))<span class="id"> -mulrA</span><span class="id"> -exprS</span><span class="id"> subrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subrX1</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span><span class="id"> 1</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> 1</span>)<span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -!</span>(<span class="id">opprB</span><span class="id"> 1</span>)<span class="id"> mulNr</span><span class="id"> -{1}</span>(<span class="id">expr1n</span><span class="id"> _</span><span class="id"> n</span>).<br/>
<span class="id">rewrite</span> (<span class="id">subrXX_comm</span><span class="id"> _</span> (<span class="id">commr_sym</span> (<span class="id">commr1</span><span class="id"> x</span>)))<span class="id">;</span><span class="id"> congr</span> (<span class="id">-</span> (_<span class="id"> *</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> expr1n</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrrB1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sqrrN</span><span class="id"> opprB</span><span class="id"> addrC</span><span class="id"> sqrrD1</span><span class="id"> sqrrN</span><span class="id"> mulNrn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_sqr_1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 1</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> 1</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> subrX1</span><span class="id"> !big_ord_recr</span><span class="id"> big_ord0</span><span class="id"> /=</span><span class="id"> addrAC</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> smulr_closed</span><span class="id"> :=</span><span class="id"> -1</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> mulr_2closed</span><span class="id"> S</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subring_closed</span><span class="id"> :=</span><span class="id"> [/\</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S,</span><span class="id"> subr_2closed</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> mulr_2closed</span><span class="id"> S]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> smulr_closedM</span><span class="id"> :</span><span class="id"> smulr_closed</span><span class="id"> -&gt;</span><span class="id"> mulr_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> SN1</span><span class="id"> SM;</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -[1]mulr1</span><span class="id"> -mulrNN</span><span class="id"> SM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> smulr_closedN</span><span class="id"> :</span><span class="id"> smulr_closed</span><span class="id"> -&gt;</span><span class="id"> oppr_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> SN1</span><span class="id"> SM</span><span class="id"> x</span><span class="id"> Sx;</span><span class="id"> rewrite</span><span class="id"> -mulN1r</span><span class="id"> SM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subring_closedB</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> -&gt;</span><span class="id"> zmod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> SB</span><span class="id"> _;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">subrr</span><span class="id"> 1</span>)<span class="id"> SB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subring_closedM</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> -&gt;</span><span class="id"> smulr_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> SB</span><span class="id"> SM;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">zmod_closedN</span> (<span class="id">subring_closedB</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subring_closed_semi</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> -&gt;</span><span class="id"> semiring_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ringS;</span><span class="id"> split;</span><span class="id"> [apply/zmod_closedD/subring_closedB</span><span class="id"> |</span><span class="id"> case:</span><span class="id"> ringS]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PzRingTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NzRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> nzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signr_eq0</span><span class="id"> n</span><span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -signr_odd;</span><span class="id"> case:</span><span class="id"> odd;</span><span class="id"> rewrite</span><span class="id"> ?oppr_eq0</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> FrobeniusAutomorphism</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> p</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Hypothesis</span><span class="id"> pcharFp</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> pcharf_prime</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x ^f&quot;</span><span class="id"> :=</span> (<span class="id">pFrobenius_aut</span><span class="id"> pcharFp</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autN</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> opprK</span><span class="id"> addrC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">pFrobenius_autD_comm</span><span class="id"> _</span> (<span class="id">commrN</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> subrr</span><span class="id"> pFrobenius_aut0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_autB_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> x^f</span><span class="id"> -</span><span class="id"> y^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move/commrN/pFrobenius_autD_comm-&gt;;</span><span class="id"> rewrite</span><span class="id"> pFrobenius_autN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FrobeniusAutomorphism</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprNn_pchar</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">pchar</span><span class="id"> R</span>).<span class="id">-nat</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> pdiv</span><span class="id"> n;</span><span class="id"> have</span><span class="id"> [|n_gt1</span><span class="id"> pcharRn]</span><span class="id"> :=</span><span class="id"> leqP</span><span class="id"> n</span><span class="id"> 1;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">n</span>)<span class="id"> =&gt;</span><span class="id"> [|[]]</span>.<br/>
<span class="id">have</span><span class="id"> pcharRp:</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">pnatPpi</span><span class="id"> pcharRn</span>)<span class="id"> //</span><span class="id"> pi_pdiv</span>.<br/>
<span class="id">have</span><span class="id"> /p_natP[e</span><span class="id"> -&gt;]:</span><span class="id"> p</span>.<span class="id">-nat</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eq_pnat</span><span class="id"> _</span> (<span class="id">pcharf_eq</span><span class="id"> pcharRp</span>)).<br/>
<span class="id">elim:</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> e</span><span class="id"> IHe;</span><span class="id"> rewrite</span><span class="id"> expnSr</span><span class="id"> !exprM</span><span class="id"> {}IHe</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -pFrobenius_autE</span><span class="id"> pFrobenius_autN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Char2</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span><span class="id"> pcharR2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppr_pchar2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/esym/eqP;</span><span class="id"> rewrite</span><span class="id"> -addr_eq0</span><span class="id"> addrr_pchar2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_pchar2</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppr_pchar2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addrK_pchar2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> involutive</span> (<span class="id">+%R^~</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> -subr_pchar2</span><span class="id"> addrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addKr_pchar2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> involutive</span> (<span class="id">+%R</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -{1}[x]oppr_pchar2</span><span class="id"> addKr</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Char2</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NzRingTheory</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autN instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autN</span><span class="id"> :=</span><span class="id"> pFrobenius_autN</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autB_comm instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_autB_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autB_comm</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use exprNn_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> exprNn_char</span><span class="id"> :=</span><span class="id"> exprNn_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use oppr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> oppr_char2</span><span class="id"> :=</span><span class="id"> oppr_pchar2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use subr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> subr_char2</span><span class="id"> :=</span><span class="id"> subr_pchar2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use addrK_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> addrK_char2</span><span class="id"> :=</span><span class="id"> addrK_pchar2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use addKr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> addKr_char2</span><span class="id"> :=</span><span class="id"> addKr_pchar2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ConverseRing</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>)<span class="id"> :=</span><span class="id"> Equality</span>.<span class="id">on</span><span class="id"> T^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>)<span class="id"> :=</span><span class="id"> Choice</span>.<span class="id">on</span><span class="id"> T^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> nmodType</span>)<span class="id"> :=</span><span class="id"> Nmodule</span>.<span class="id">on</span><span class="id"> U^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> zmodType</span>)<span class="id"> :=</span><span class="id"> Zmodule</span>.<span class="id">on</span><span class="id"> U^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> mul'</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> mulrA'</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> esym</span> (<span class="id">mulrA</span><span class="id"> z</span><span class="id"> y</span><span class="id"> x</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> mulrDl'</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> mulrDr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> mulrDr'</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :=</span><span class="id"> mulrDl</span><span class="id"> y</span><span class="id"> z</span><span class="id"> x</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> R^c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA'</span><span class="id"> mulr1</span><span class="id"> mul1r</span><span class="id"> mulrDl'</span><span class="id"> mulrDr'</span><span class="id"> mulr0</span><span class="id"> mul0r</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><span class="id"> PzSemiRing</span>.<span class="id">on</span><span class="id"> R^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">PzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R^c</span><span class="id"> oner_neq0</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>)<span class="id"> :=</span><span class="id"> NzSemiRing</span>.<span class="id">on</span><span class="id"> R^c</span>.<br/>
<span class="vernacular">End</span><span class="id"> ConverseRing</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rev_prodr</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<br/>
&nbsp;&nbsp;(<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">E</span><span class="id"> i</span><span class="id"> :</span><span class="id"> R^c</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> rev</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rev_big_rev</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiRightRegular</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulIr_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> rreg</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">@mulrI_eq0</span><span class="id"> R^c</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rreg1</span><span class="id"> :</span><span class="id"> rreg</span> (<span class="id">1</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">@lreg1</span><span class="id"> R^c</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rregM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> rreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> rreg</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> rreg</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> reg_x</span><span class="id"> reg_y;</span><span class="id"> apply:</span> (<span class="id">@lregM</span><span class="id"> R^c</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> revrX</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R^c</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> IHn;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> exprSr</span><span class="id"> IHn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rregX</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> rreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> rreg</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/</span>(<span class="id">@lregX</span><span class="id"> R^c</span><span class="id"> x</span><span class="id"> n</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> revrX</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SemiRightRegular</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rreg_neq0</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> rreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">@lreg_neq0</span><span class="id"> R^c</span>). Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> RightRegular</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> pzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulIr0_rreg</span><span class="id"> x</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> y,</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> rreg</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">@mulrI0_lreg</span><span class="id"> R^c</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rregN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> rreg</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> rreg</span> (<span class="id">-</span><span class="id"> x</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">@lregN</span><span class="id"> R^c</span>). Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RightRegular</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> Nmodule_isLSemiModule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> V</span><span class="id"> of</span><span class="id"> Nmodule</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">scale</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V;</span><br/>
&nbsp;&nbsp;<span class="id">scalerA</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v,</span><span class="id"> scale</span><span class="id"> a</span> (<span class="id">scale</span><span class="id"> b</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> scale</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> v;</span><br/>
&nbsp;&nbsp;<span class="id">scale0r</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> v,</span><span class="id"> scale</span><span class="id"> 0</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">scale1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> 1</span><span class="id"> scale;</span><br/>
&nbsp;&nbsp;<span class="id">scalerDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> scale</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">scalerDl</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> v,</span><span class="id"> {morph</span><span class="id"> scale^~</span><span class="id"> v:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b}</span><br/>
<span class="id">}</span>.<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;lSemiModType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> LSemiModule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{M</span><span class="id"> of</span><span class="id"> Nmodule</span><span class="id"> M</span><span class="id"> &amp;</span><span class="id"> Nmodule_isLSemiModule</span><span class="id"> R</span><span class="id"> M}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> LSemiModExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> LSemiModule</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> LSemiModExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> LSemiModExports</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;*:%R&quot;</span><span class="id"> :=</span> (<span class="id">@scale</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;a *: v&quot;</span><span class="id"> :=</span> (<span class="id">scale</span><span class="id"> a</span><span class="id"> v</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;lmodType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Lmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{M</span><span class="id"> of</span><span class="id"> Zmodule</span><span class="id"> M</span><span class="id"> &amp;</span><span class="id"> Nmodule_isLSemiModule</span><span class="id"> R</span><span class="id"> M}</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> scalerA</span><span class="id"> [R</span><span class="id"> s]</span> (<span class="id">a</span><span class="id"> b</span>)<span class="id">%_ring_scope</span><span class="id"> v</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> LmodExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> Lmodule</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> LmodExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> LmodExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isLmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> V</span><span class="id"> of</span><span class="id"> Zmodule</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">scale</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V;</span><br/>
&nbsp;&nbsp;<span class="id">scalerA</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v,</span><span class="id"> scale</span><span class="id"> a</span> (<span class="id">scale</span><span class="id"> b</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> scale</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> v;</span><br/>
&nbsp;&nbsp;<span class="id">scale1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> 1</span><span class="id"> scale;</span><br/>
&nbsp;&nbsp;<span class="id">scalerDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> scale</span><span class="id"> +%R;</span><br/>
&nbsp;&nbsp;<span class="id">scalerDl</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> v,</span><span class="id"> {morph</span><span class="id"> scale^~</span><span class="id"> v:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b}</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> Zmodule_isLmodule</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scale0r</span><span class="id"> v</span><span class="id"> :</span><span class="id"> scale</span><span class="id"> 0</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">addIr</span> (<span class="id">scale</span><span class="id"> 1</span><span class="id"> v</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -scalerDl</span><span class="id"> !add0r</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Nmodule_isLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> scalerA</span><span class="id"> scale0r</span><span class="id"> scale1r</span><span class="id"> scalerDr</span><span class="id"> scalerDl</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> LSemiModule_isLmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> V</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> LSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> LSemiModule_isLmodule</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> opp</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> scale</span> (<span class="id">-</span><span class="id"> 1</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addNr</span><span class="id"> :</span><span class="id"> left_inverse</span><span class="id"> 0</span><span class="id"> opp</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> v;</span><span class="id"> suff</span><span class="id"> :</span><span class="id"> scale</span> (<span class="id">-1</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id"> v</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalerDl</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addNr</span><span class="id"> scale0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isZmodule</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> addNr</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LSemiModuleTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">a</span><span class="id"> b</span><span class="id"> c</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> V</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[0</span><span class="gallina-kwd"> in</span><span class="id"> LHS]</span>(<span class="id">scale0r</span><span class="id"> 0</span>)<span class="id"> scalerA</span><span class="id"> mulr0</span><span class="id"> scale0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_nat</span><span class="id"> n</span><span class="id"> v</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> =</span><span class="id"> v</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scale0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulrS</span><span class="id"> scalerDl</span><span class="id"> ?scale1r</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerMnl</span><span class="id"> a</span><span class="id"> v</span><span class="id"> n</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> *:</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr0n</span><span class="id"> scale0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulrSr</span><span class="id"> IHn</span><span class="id"> scalerDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerMnr</span><span class="id"> a</span><span class="id"> v</span><span class="id"> n</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">v</span><span class="id"> *+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr0n</span><span class="id"> scaler0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulrSr</span><span class="id"> IHn</span><span class="id"> scalerDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_suml</span><span class="id"> v</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *:</span><span class="id"> v</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *:</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> _</span> (<span class="id">scalerDl</span><span class="id"> v</span>) (<span class="id">scale0r</span><span class="id"> v</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_sumr</span><span class="id"> a</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> *:</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> a</span><span class="id"> *:</span><span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> big_endo</span> (<span class="id">scalerDr</span><span class="id"> a</span>) (<span class="id">scaler0</span><span class="id"> a</span>)<span class="id"> I</span><span class="id"> r</span><span class="id"> P</span><span class="id"> F</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_closed</span><span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> a,</span><span class="id"> {in</span><span class="id"> S,</span><span class="gallina-kwd"> forall</span><span class="id"> v,</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subsemimod_closed</span><span class="id"> :=</span><span class="id"> nmod_closed</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> scaler_closed</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemimod_closedD</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> -&gt;</span><span class="id"> nmod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemimod_closedZ</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> -&gt;</span><span class="id"> scaler_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LSemiModuleTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LmoduleTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">a</span><span class="id"> b</span><span class="id"> c</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaleNr</span><span class="id"> a</span><span class="id"> v</span><span class="id"> :</span><span class="id"> -</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">addIr</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -scalerDl</span><span class="id"> !addNr</span><span class="id"> scale0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaleN1r</span><span class="id"> v</span><span class="id"> :</span><span class="id"> -</span><span class="id"> 1</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> =</span><span class="id"> -</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaleNr</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerN</span><span class="id"> a</span><span class="id"> v</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> -</span><span class="id"> v</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">addIr</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -scalerDr</span><span class="id"> !addNr</span><span class="id"> scaler0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerBl</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v</span><span class="id"> :</span> (<span class="id">a</span><span class="id"> -</span><span class="id"> b</span>)<span class="id"> *:</span><span class="id"> v</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> -</span><span class="id"> b</span><span class="id"> *:</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalerDl</span><span class="id"> scaleNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerBr</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">u</span><span class="id"> -</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> -</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalerDr</span><span class="id"> scalerN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_sign</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> v</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> =</span> (<span class="gallina-kwd">if</span><span class="id"> b</span><span class="gallina-kwd"> then</span><span class="id"> -</span><span class="id"> v</span><span class="gallina-kwd"> else</span><span class="id"> v</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> ?scaleNr</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> signrZK</span><span class="id"> n</span><span class="id"> :</span><span class="id"> @involutive</span><span class="id"> V</span> (<span class="id"> *:%R</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> u;</span><span class="id"> rewrite</span><span class="id"> scalerA</span><span class="id"> -expr2</span><span class="id"> sqrr_sign</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> linear_closed</span><span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> a,</span><span class="id"> {in</span><span class="id"> S</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> u</span><span class="id"> v,</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> +</span><span class="id"> v</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> submod_closed</span><span class="id"> :=</span><span class="id"> 0</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> linear_closed</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> linear_closedB</span><span class="id"> :</span><span class="id"> linear_closed</span><span class="id"> -&gt;</span><span class="id"> subr_2closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Slin</span><span class="id"> u</span><span class="id"> v</span><span class="id"> Su</span><span class="id"> Sv;</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> -scaleN1r</span><span class="id"> Slin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submod_closedB</span><span class="id"> :</span><span class="id"> submod_closed</span><span class="id"> -&gt;</span><span class="id"> zmod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S0</span><span class="id"> /linear_closedB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submod_closed_semi</span><span class="id"> :</span><span class="id"> submod_closed</span><span class="id"> -&gt;</span><span class="id"> subsemimod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /[dup]</span><span class="id"> /submod_closedB</span><span class="id"> /zmod_closedD</span><span class="id"> SD</span><span class="id"> [S0</span><span class="id"> Slin];</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> a</span><span class="id"> v</span><span class="id"> Sv</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[a</span><span class="id"> *:</span><span class="id"> v]addr0</span><span class="id"> Slin</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemimod_closed_submod</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> submod_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [[S0</span><span class="id"> SD]</span><span class="id"> SZ];</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v</span><span class="id"> Su</span><span class="id"> Sv;</span><span class="id"> apply/SD/Sv/SZ</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemimod_closedB</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> zmod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/subsemimod_closed_submod/submod_closedB</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LmoduleTheory</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> LSemiModule_isLSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> NzSemiRing</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> LSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">scalerAl</span><span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> V</span>)<span class="id">,</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> *</span><span class="id"> v</span><br/>
<span class="id">}</span>.<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;lSemiAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> LSemiAlgebra</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{A</span><span class="id"> of</span><span class="id"> LSemiModule</span><span class="id"> R</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> NzSemiRing</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> LSemiModule_isLSemiAlgebra</span><span class="id"> R</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> LSemiAlgExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> LSemiAlgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> LSemiAlgExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> LSemiAlgExports</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;k %:A&quot;</span><span class="id"> :=</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> 1</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;lalgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Lalgebra</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{A</span><span class="id"> of</span><span class="id"> Lmodule</span><span class="id"> R</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> NzRing</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> LSemiModule_isLSemiAlgebra</span><span class="id"> R</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> LalgExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> Lalgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> LalgExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> LalgExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Lmodule_isLalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> NzRing</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> Lmodule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">scalerAl</span><span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> V</span>)<span class="id">,</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> *</span><span class="id"> v</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> Lmodule_isLalgebra</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiModule_isLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> scalerAl</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> regular</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><span class="id"> R</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;R ^o&quot;</span><span class="id"> :=</span> (<span class="id">regular</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RegularAlgebra</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>)<span class="id"> :=</span><span class="id"> Nmodule</span>.<span class="id">on</span><span class="id"> V^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>)<span class="id"> :=</span><span class="id"> Zmodule</span>.<span class="id">on</span><span class="id"> V^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><span class="id"> PzSemiRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> :=</span><span class="id"> NzSemiRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">@Nmodule_isLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R^o</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mul</span><span class="id"> mulrA</span><span class="id"> mul0r</span><span class="id"> mul1r</span><span class="id"> mulrDr</span> (<span class="gallina-kwd">fun</span><span class="id"> v</span><span class="id"> a</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> mulrDl</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v</span>).<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">LSemiModule_isLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R^o</span><span class="id"> mulrA</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><span class="id"> PzRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>)<span class="id"> :=</span><span class="id"> NzRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="vernacular">End</span><span class="id"> RegularAlgebra</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LSemiAlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_algl</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> A</span>)<span class="id"> :</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> 1</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> subsemialg_closed</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[/\</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S,</span><span class="id"> nmod_closed</span><span class="id"> S,</span><span class="id"> scaler_closed</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> mulr_2closed</span><span class="id"> S]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemialg_closedZ</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> -&gt;</span><span class="id"> subsemimod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemialg_closedM</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> -&gt;</span><span class="id"> semiring_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LSemiAlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LalgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> subalg_closed</span><span class="id"> :=</span><span class="id"> [/\</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S,</span><span class="id"> linear_closed</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> mulr_2closed</span><span class="id"> S]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subalg_closedZ</span><span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> -&gt;</span><span class="id"> submod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> Slin</span><span class="id"> _;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">subrr</span><span class="id"> 1</span>)<span class="id"> linear_closedB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subalg_closedBM</span><span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> -&gt;</span><span class="id"> subring_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> Slin</span><span class="id"> SM;</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> linear_closedB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subalg_closed_semi</span><span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> -&gt;</span><span class="id"> subsemialg_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /[dup]</span><span class="id"> /subalg_closedZ</span><span class="id"> /submod_closedB</span><span class="id"> /zmod_closedD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [S0</span><span class="id"> SD]</span><span class="id"> [S1</span><span class="id"> Slin</span><span class="id"> SM];</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> a</span><span class="id"> u</span><span class="id"> Su;</span><span class="id"> rewrite</span><span class="id"> -[a</span><span class="id"> *:</span><span class="id"> u]addr0</span><span class="id"> Slin</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemialg_closed_subalg</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> subalg_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> [S0</span><span class="id"> SD]</span><span class="id"> SZ</span><span class="id"> SM;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v</span><span class="id"> Su</span><span class="id"> Sv;</span><span class="id"> apply/SD/Sv/SZ</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemialg_closedBM</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> subring_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/subsemialg_closed_subalg/subalg_closedBM</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LalgebraTheory</span>.<br/>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LiftedSemiRing</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>).<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> R</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mull_fun</span><span class="id"> a</span><span class="id"> f</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> a</span><span class="id"> *</span><span class="id"> f</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_fun</span><span class="id"> a</span><span class="id"> f</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> f</span><span class="id"> x</span><span class="id"> *</span><span class="id"> a</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mul_fun</span><span class="id"> f</span><span class="id"> g</span><span class="id"> x</span><span class="id"> :=</span><span class="id"> f</span><span class="id"> x</span><span class="id"> *</span><span class="id"> g</span><span class="id"> x</span>.<br/>
<span class="vernacular">End</span><span class="id"> LiftedSemiRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LiftedScale</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> scale_fun</span><span class="id"> a</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> x</span><span class="id"> :=</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> f</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> in_alg</span><span class="id"> k</span><span class="id"> :</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> k%:A</span>.<br/>
<span class="vernacular">End</span><span class="id"> LiftedScale</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\0&quot;</span><span class="id"> :=</span> (<span class="id">null_fun</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;f \+ g&quot;</span><span class="id"> :=</span> (<span class="id">add_fun</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;f \- g&quot;</span><span class="id"> :=</span> (<span class="id">sub_fun</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\- f&quot;</span><span class="id"> :=</span> (<span class="id">opp_fun</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;a \*: f&quot;</span><span class="id"> :=</span> (<span class="id">scale_fun</span><span class="id"> a</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x \*o f&quot;</span><span class="id"> :=</span> (<span class="id">mull_fun</span><span class="id"> x</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x \o* f&quot;</span><span class="id"> :=</span> (<span class="id">mulr_fun</span><span class="id"> x</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;f \* g&quot;</span><span class="id"> :=</span> (<span class="id">mul_fun</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> in_alg</span> <span class="id"> {_}</span><span class="id"> A</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mull_fun</span><span class="id"> {_</span><span class="id"> _}</span> <span class="id"> a</span><span class="id"> f</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mulr_fun</span><span class="id"> {_</span><span class="id"> _}</span><span class="id"> a</span><span class="id"> f</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> scale_fun</span><span class="id"> {_</span><span class="id"> _</span><span class="id"> _}</span><span class="id"> a</span><span class="id"> f</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mul_fun</span><span class="id"> {_</span><span class="id"> _}</span><span class="id"> f</span><span class="id"> g</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> AdditiveTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiRingProperties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddfMnat</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> f</span> (<span class="id">n%:R</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr_natl</span><span class="id"> raddfMn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> S</span>) (<span class="id">h</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddfZnat</span><span class="id"> n</span><span class="id"> u</span><span class="id"> :</span><span class="id"> h</span> (<span class="id">n%:R</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> =</span><span class="id"> n%:R</span><span class="id"> *:</span><span class="id"> h</span><span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !scaler_nat</span><span class="id"> raddfMn</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SemiRingProperties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MulFun</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> R}</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> mull_fun_is_nmod_morphism</span><span class="id"> :</span><span class="id"> nmod_morphism</span> (<span class="id">a</span><span class="id"> \*o</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ?raddf0</span><span class="id"> ?mulr0//</span><span class="id"> raddfD</span><span class="id"> mulrDr</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isNmodMorphism</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> R</span> (<span class="id">a</span><span class="id"> \*o</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;<span class="id">mull_fun_is_nmod_morphism</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> mulr_fun_is_nmod_morphism</span><span class="id"> :</span><span class="id"> nmod_morphism</span> (<span class="id">a</span><span class="id"> \o*</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ?raddf0</span><span class="id"> ?mul0r//</span><span class="id"> raddfD</span><span class="id"> mulrDl</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isNmodMorphism</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> R</span> (<span class="id">a</span><span class="id"> \o*</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;<span class="id">mulr_fun_is_nmod_morphism</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> MulFun</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Properties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddfN</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> -</span><span class="id"> x}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfN</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> raddfB</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddf_inj</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> f</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> injective</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddf_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddfMNn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *-</span><span class="id"> n}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfMNn</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Properties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RingProperties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddfMsign</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> f</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> f</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mulr_sign,</span><span class="id"> =^~</span><span class="id"> signr_odd</span>) (<span class="id">fun_if</span><span class="id"> f</span>)<span class="id"> raddfN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> S</span>) (<span class="id">h</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> raddfZsign</span><span class="id"> n</span><span class="id"> u</span><span class="id"> :</span><span class="id"> h</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *:</span><span class="id"> h</span><span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">scaler_sign,</span><span class="id"> =^~</span><span class="id"> signr_odd</span>) (<span class="id">fun_if</span><span class="id"> h</span>)<span class="id"> raddfN</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RingProperties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ScaleFun</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {additive</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V}</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isNmodMorphism</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> V</span> (<span class="id"> *:%R</span><span class="id"> a</span>) (<span class="id">conj</span> (<span class="id">scaler0</span><span class="id"> _</span><span class="id"> a</span>) (<span class="id">scalerDr</span><span class="id"> a</span>)).<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Additive</span>.<span class="id">copy</span> (<span class="id">a</span><span class="id"> \*:</span><span class="id"> f</span>) (<span class="id">f</span><span class="id"> \;</span><span class="id"> *:%R</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ScaleFun</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> AdditiveTheory</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `monoid_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> multiplicative</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>)<span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}%R</span><span class="id"> *</span> (<span class="id">f</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> monoid_morphism</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>)<span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">f</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span>)<span class="id"> *</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}%R</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isMonoidMorphism</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">monoid_morphism_subproof</span><span class="id"> :</span><span class="id"> monoid_morphism</span><span class="id"> f</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> RMorphism</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{f</span><span class="id"> of</span><span class="id"> @isNmodMorphism</span><span class="id"> R</span><span class="id"> S</span><span class="id"> f</span><span class="id"> &amp;</span><span class="id"> isMonoidMorphism</span><span class="id"> R</span><span class="id"> S</span><span class="id"> f}</span>.<br/>
<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isMultiplicative</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rmorphism_subproof</span><span class="id"> :</span><span class="id"> multiplicative</span><span class="id"> f</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> f</span><span class="id"> of</span><span class="id"> isMultiplicative</span><span class="id"> R</span><span class="id"> S</span><span class="id"> f</span>.<br/>
<br/>
<span class="id">#[warning=</span><span class="id">&quot;-HB.no-new-instance&quot;</span><span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rmorphism_subproof</span>.<span class="id">2,</span><span class="id"> rmorphism_subproof</span>.<span class="id">1</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> RMorphismExports</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'rmorphism' U -&gt; V }&quot;</span><span class="id"> :=</span> (<span class="id">RMorphism</span>.<span class="id">type</span><span class="id"> U%type</span><span class="id"> V%type</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">End</span><span class="id"> RMorphismExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> RMorphismExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RmorphismTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Properties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph0</span><span class="id"> :</span><span class="id"> f</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddf0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorphD</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfD</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorphMn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfMn</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorph_sum</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> E</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">f</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span> (<span class="id">E</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddf_sum</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorphism_monoidP</span><span class="id"> :</span><span class="id"> monoid_morphism</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> monoid_morphism_subproof</span>. Qed.</div></details>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><span class="id"> deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;use `rmorphism_monoidP` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> rmorphismMP</span><span class="id"> :</span><span class="id"> multiplicative</span><span class="id"> f</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> p</span><span class="id"> =&gt;</span> (<span class="id">p</span>.<span class="id">2,</span><span class="id"> p</span>.<span class="id">1</span>))<span class="id"> rmorphism_monoidP</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph1</span><span class="id"> :</span><span class="id"> f</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> rmorphism_monoidP</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorphM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f:</span><span class="id"> x</span><span class="id"> y</span> <span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> rmorphism_monoidP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_prod</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> E</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">f</span> (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span> (<span class="id">E</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> f</span><span class="id"> rmorphM</span><span class="id"> rmorph1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorphXn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> ?rmorph1</span><span class="id"> //</span><span class="id"> !exprS</span><span class="id"> rmorphM</span><span class="id"> IHn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_nat</span><span class="id"> n</span><span class="id"> :</span><span class="id"> f</span><span class="id"> n%:R</span><span class="id"> =</span><span class="id"> n%:R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorphMn</span><span class="id"> rmorph1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_eq_nat</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> f</span><span class="id"> -&gt;</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> n%:R</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> n%:R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/inj_eq</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> rmorph_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_eq1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> f</span><span class="id"> -&gt;</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorph_eq_nat</span><span class="id"> 1%N</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> can2_monoid_morphism</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> f</span><span class="id"> f'</span><span class="id"> -&gt;</span><span class="id"> cancel</span><span class="id"> f'</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> monoid_morphism</span><span class="id"> f'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fK</span><span class="id"> f'K</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> apply:</span> (<span class="id">canLR</span><span class="id"> fK</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /=</span> (<span class="id">rmorph1,</span><span class="id"> rmorphM</span>)<span class="id"> ?f'K</span>.<br/>
Qed.</div></details>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;use `can2_monoid_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> can2_rmorphism</span><span class="id"> f'</span> (<span class="id">cff'</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> f</span><span class="id"> f'</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> p</span><span class="id"> =&gt;</span> (<span class="id">p</span>.<span class="id">2,</span><span class="id"> p</span>.<span class="id">1</span>))<span class="id"> \o</span> (<span class="id">can2_monoid_morphism</span><span class="id"> cff'</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Properties</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_pchar</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>)<span class="id"> p</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> -</span>(<span class="id">rmorph_nat</span><span class="id"> f</span>)<span class="id"> =&gt;</span><span class="id"> /andP[-&gt;</span><span class="id"> /=</span><span class="id"> /eqP-&gt;];</span><span class="id"> rewrite</span><span class="id"> rmorph0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Projections</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> T</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> T}</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> idfun_is_monoid_morphism</span><span class="id"> :</span><span class="id"> monoid_morphism</span> (<span class="id">@idfun</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R</span><span class="id"> idfun</span><br/>
&nbsp;&nbsp;<span class="id">idfun_is_monoid_morphism</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> comp_is_monoid_morphism</span><span class="id"> :</span><span class="id"> monoid_morphism</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ?rmorph1</span><span class="id"> ?rmorphM</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> T</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> g</span>)<br/>
&nbsp;&nbsp;<span class="id">comp_is_monoid_morphism</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Projections</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Properties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorphN</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> -</span><span class="id"> x}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfN</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorphB</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfB</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorphMNn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *-</span><span class="id"> n}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfMNn</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> rmorphMsign</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfMsign</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorphN1</span><span class="id"> :</span><span class="id"> f</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> 1</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorphN</span><span class="id"> rmorph1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_sign</span><span class="id"> n</span><span class="id"> :</span><span class="id"> f</span> ((<span class="id">-</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorphXn</span><span class="id"> /=</span><span class="id"> rmorphN1</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Properties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> InSemiAlgebra</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> in_alg_is_nmod_morphism</span><span class="id"> :</span><span class="id"> nmod_morphism</span> (<span class="id">in_alg</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split;</span><span class="id"> [exact:</span><span class="id"> scale0r</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> scalerDl]</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isNmodMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span> (<span class="id">in_alg</span><span class="id"> A</span>)<span class="id"> in_alg_is_nmod_morphism</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> in_alg_is_monoid_morphism</span><span class="id"> :</span><span class="id"> monoid_morphism</span> (<span class="id">in_alg</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ?scale1r</span><span class="id"> //</span><span class="id"> mulr_algl</span><span class="id"> scalerA</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span> (<span class="id">in_alg</span><span class="id"> A</span>)<br/>
&nbsp;&nbsp;<span class="id">in_alg_is_monoid_morphism</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> in_algE</span><span class="id"> a</span><span class="id"> :</span><span class="id"> in_alg</span><span class="id"> A</span><span class="id"> a</span><span class="id"> =</span><span class="id"> a%:A</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> InSemiAlgebra</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> RmorphismTheory</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use rmorph_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> rmorph_char</span><span class="id"> :=</span><span class="id"> rmorph_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Scale</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isPreLaw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">op</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">op_nmod_morphism</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> a,</span><span class="id"> nmod_morphism</span> (<span class="id">op</span><span class="id"> a</span>)<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> PreLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {op</span><span class="id"> of</span><span class="id"> isPreLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> op}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> preLaw</span><span class="id"> :=</span><span class="id"> PreLaw</span>.<span class="id">type</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isSemiLaw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">op</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">op0v</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> v,</span><span class="id"> op</span><span class="id"> 0</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0;</span><br/>
&nbsp;&nbsp;<span class="id">op1v</span><span class="id"> :</span><span class="id"> op</span><span class="id"> 1</span><span class="id"> =1</span><span class="id"> id;</span><br/>
&nbsp;&nbsp;<span class="id">opA</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v,</span><span class="id"> op</span><span class="id"> a</span> (<span class="id">op</span><span class="id"> b</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> op</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> v;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SemiLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{op</span><span class="id"> of</span><span class="id"> isPreLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> op</span><span class="id"> &amp;</span><span class="id"> isSemiLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> op}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semiLaw</span><span class="id"> :=</span><span class="id"> SemiLaw</span>.<span class="id">type</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isLaw</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">op</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> N1op</span><span class="id"> :</span><span class="id"> op</span> (<span class="id">-1</span>)<span class="id"> =1</span><span class="id"> -%R</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Law</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{op</span><span class="id"> of</span><span class="id"> isPreLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> op</span><span class="id"> &amp;</span><span class="id"> isLaw</span><span class="id"> R</span><span class="id"> V</span><span class="id"> op}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> law</span><span class="id"> :=</span><span class="id"> Law</span>.<span class="id">type</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CompSemiLaw</span>.<br/>
<br/>
<span class="vernacular">Context</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> semiLaw</span><span class="id"> R</span><span class="id"> V</span>).<br/>
<span class="vernacular">Context</span> (<span class="id">aR</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">nu</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> R}</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> comp_op0v</span><span class="id"> v</span><span class="id"> :</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>)<span class="id"> 0</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rmorph0</span><span class="id"> op0v</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> comp_op1v</span><span class="id"> :</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>)<span class="id"> 1</span><span class="id"> =1</span><span class="id"> id</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rmorph1</span><span class="id"> op1v</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> comp_opA</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v</span><span class="id"> :</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>)<span class="id"> a</span> ((<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>)<span class="id"> b</span><span class="id"> v</span>)<span class="id"> =</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>) (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> opA</span><span class="id"> rmorphM</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CompSemiLaw</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> compN1op</span><br/>
&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> law</span><span class="id"> R</span><span class="id"> V</span>)<br/>
&nbsp;&nbsp;(<span class="id">aR</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">nu</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> R}</span>)<span class="id"> :</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>) (<span class="id">-1</span>)<span class="id"> =1</span><span class="id"> -%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rmorphN1</span><span class="id"> N1op</span>. Qed.</div></details>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> Exports</span>. <span class="id">HB</span>.<span class="id">reexport</span>. <span class="vernacular">End</span><span class="vernacular"> Exports</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Scale</span>.<br/>
<span class="vernacular">Export</span><span class="id"> Scale</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isPreLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R</span><span class="id"> *%R</span> (<span class="gallina-kwd">fun</span><span class="id"> =&gt;</span><span class="id"> mull_fun_is_nmod_morphism</span><span class="id"> _</span><span class="id"> idfun</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isSemiLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R</span><span class="id"> *%R</span><span class="id"> mul0r</span><span class="id"> mul1r</span><span class="id"> mulrA</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R</span><span class="id"> *%R</span> (<span class="id">@mulN1r</span><span class="id"> R</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isPreLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> *:%R</span> (<span class="gallina-kwd">fun</span><span class="id"> =&gt;</span> (<span class="id">scaler0</span><span class="id"> _</span><span class="id"> _,</span><span class="id"> scalerDr</span><span class="id"> _</span>)).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isSemiLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> *:%R</span><span class="id"> scale0r</span><span class="id"> scale1r</span> (<span class="id">@scalerA</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> *:%R</span> (<span class="id">@scaleN1r</span><span class="id"> R</span><span class="id"> U</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">preLaw</span><span class="id"> R</span><span class="id"> V</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">aR</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">nu</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> R}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isPreLaw</span>.<span class="id">Build</span><span class="id"> aR</span><span class="id"> V</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>) (<span class="gallina-kwd">fun</span><span class="id"> =&gt;</span><span class="id"> Scale</span>.<span class="id">op_nmod_morphism</span><span class="id"> _</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">semiLaw</span><span class="id"> R</span><span class="id"> V</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">aR</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">nu</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> R}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isSemiLaw</span>.<span class="id">Build</span><span class="id"> aR</span><span class="id"> V</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Scale</span>.<span class="id">comp_op0v</span><span class="id"> s</span><span class="id"> nu</span>) (<span class="id">Scale</span>.<span class="id">comp_op1v</span><span class="id"> s</span><span class="id"> nu</span>) (<span class="id">Scale</span>.<span class="id">comp_opA</span><span class="id"> s</span><span class="id"> nu</span>).<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">law</span><span class="id"> R</span><span class="id"> V</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">aR</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">nu</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aR</span><span class="id"> -&gt;</span><span class="id"> R}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Scale</span>.<span class="id">isLaw</span>.<span class="id">Build</span><span class="id"> aR</span><span class="id"> V</span> (<span class="id">nu</span><span class="id"> \;</span><span class="id"> s</span>) (<span class="id">Scale</span>.<span class="id">compN1op</span><span class="id"> s</span><span class="id"> nu</span>).<br/>
<br/>
<span class="id">#[export,</span><span class="id"> non_forgetful_inheritance]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><br/>
&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">preLaw</span><span class="id"> R</span><span class="id"> V</span>)<span class="id"> a</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isNmodMorphism</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> V</span> (<span class="id">s</span><span class="id"> a</span>) (<span class="id">Scale</span>.<span class="id">op_nmod_morphism</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> scalable_for</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> a,</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> u</span><span class="id"> /</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> &gt;-&gt;</span><span class="id"> s</span><span class="id"> a</span><span class="id"> u}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isScalable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">semi_linear_subproof</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span><span class="id"> f;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Linear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{f</span><span class="id"> of</span><span class="id"> @isNmodMorphism</span><span class="id"> U</span><span class="id"> V</span><span class="id"> f</span><span class="id"> &amp;</span><span class="id"> isScalable</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> semilinear_for</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">scalable_for</span><span class="id"> s</span><span class="id"> f</span><span class="id"> *</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmod_morphism_semilinear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">semiLaw</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">semilinear_for</span><span class="id"> s</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> nmod_morphism</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> sf</span><span class="id"> Df;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -[0</span><span class="gallina-kwd"> in</span><span class="id"> LHS]</span>(<span class="id">scale0r</span><span class="id"> 0</span>)<span class="id"> sf</span><span class="id"> Scale</span>.<span class="id">op0v</span>.<br/>
Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> additive_semilinear</span><span class="id"> :=</span><span class="id"> nmod_morphism_semilinear</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalable_semilinear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">preLaw</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">semilinear_for</span><span class="id"> s</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> scalable_for</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSemilinear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">semiLaw</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">linear_subproof</span><span class="id"> :</span><span class="id"> semilinear_for</span><span class="id"> s</span><span class="id"> f;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f</span><span class="id"> of</span><span class="id"> isSemilinear</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isNmodMorphism</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> V</span><span class="id"> f</span><br/>
&nbsp;&nbsp;(<span class="id">additive_semilinear</span><span class="id"> linear_subproof</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f</span> (<span class="id">scalable_semilinear</span><span class="id"> linear_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> linear_for</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> a,</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> u</span><span class="id"> v</span><span class="id"> /</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> +</span><span class="id"> v</span><span class="id"> &gt;-&gt;</span><span class="id"> s</span><span class="id"> a</span><span class="id"> u</span><span class="id"> +</span><span class="id"> v}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> zmod_morphism_linear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> V</span><br/>
&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">law</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> linear_for</span><span class="id"> s</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> zmod_morphism</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Lsf</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -scaleN1r</span><span class="id"> addrC</span><span class="id"> Lsf</span><span class="id"> Scale</span>.<span class="id">N1op</span><span class="id"> addrC</span>. Qed.</div></details>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;use `zmod_morphism_linear` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> additive_linear</span><span class="id"> :=</span><span class="id"> zmod_morphism_linear</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalable_linear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> V</span><br/>
&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">law</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> linear_for</span><span class="id"> s</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> scalable_for</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Lsf</span><span class="id"> a</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> -[a</span><span class="id"> *:v]</span>(<span class="id">addrK</span><span class="id"> v</span>) (<span class="id">zmod_morphism_linear</span><span class="id"> Lsf</span>)<span class="id"> Lsf</span><span class="id"> addrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> semilinear_linear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> V</span><br/>
&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">law</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> linear_for</span><span class="id"> s</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> semilinear_for</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Lsf;</span><span class="id"> split=&gt;</span><span class="id"> [a</span><span class="id"> x|x</span><span class="id"> y];</span><span class="id"> first</span><span class="id"> exact:</span> (<span class="id">scalable_linear</span><span class="id"> Lsf</span>).<br/>
<span class="id">have</span><span class="id"> f0:</span><span class="id"> f</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[0</span><span class="gallina-kwd"> in</span><span class="id"> LHS]subr0</span> (<span class="id">zmod_morphism_linear</span><span class="id"> Lsf</span>)<span class="id"> subrr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[y</span><span class="gallina-kwd"> in</span><span class="id"> LHS]opprK</span><span class="id"> -[-</span><span class="id"> y]add0r</span><span class="id"> !</span>(<span class="id">zmod_morphism_linear</span><span class="id"> Lsf</span>)<span class="id"> f0</span><span class="id"> sub0r</span><span class="id"> opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isLinear</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">law</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">linear_subproof</span><span class="id"> :</span><span class="id"> linear_for</span><span class="id"> s</span><span class="id"> f;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f</span><span class="id"> of</span><span class="id"> isLinear</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isZmodMorphism</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> V</span><span class="id"> f</span><br/>
&nbsp;&nbsp;(<span class="id">zmod_morphism_linear</span><span class="id"> linear_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> f</span><br/>
&nbsp;&nbsp;(<span class="id">scalable_linear</span><span class="id"> linear_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> LinearExports</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> scalable</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">scalable_for</span><span class="id"> *:%R</span><span class="id"> f</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> semilinear</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">semilinear_for</span><span class="id"> *:%R</span><span class="id"> f</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> semiscalar</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">semilinear_for</span><span class="id"> *%R</span><span class="id"> f</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> linear</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">linear_for</span><span class="id"> *:%R</span><span class="id"> f</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> scalar</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">linear_for</span><span class="id"> *%R</span><span class="id"> f</span>).<br/>
<span class="vernacular">Module</span><span class="id"> Linear</span>.<br/>
<span class="vernacular">Section</span><span class="id"> Linear</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> mapUV</span><span class="id"> :=</span> (<span class="id">@Linear</span>.<span class="id">type</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> map_class</span><span class="id"> :=</span><span class="id"> mapUV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> map_at</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :=</span><span class="id"> mapUV</span>.<br/>
<span class="vernacular">Structure</span><span class="id"> map_for</span><span class="id"> a</span><span class="id"> s_a</span><span class="id"> :=</span><span class="id"> MapFor</span><span class="id"> {map_for_map</span><span class="id"> :</span><span class="id"> mapUV;</span><span class="id"> _</span><span class="id"> :</span><span class="id"> s</span><span class="id"> a</span><span class="id"> =</span><span class="id"> s_a}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unify_map_at</span><span class="id"> a</span> (<span class="id">g</span><span class="id"> :</span><span class="id"> map_at</span><span class="id"> a</span>)<span class="id"> :=</span><span class="id"> MapFor</span><span class="id"> g</span> (<span class="id">erefl</span> (<span class="id">s</span><span class="id"> a</span>)).<br/>
<span class="vernacular">Structure</span><span class="id"> wrapped</span><span class="id"> :=</span><span class="id"> Wrap</span><span class="id"> {unwrap</span><span class="id"> :</span><span class="id"> mapUV}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> wrap</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> map_class</span>)<span class="id"> :=</span><span class="id"> Wrap</span><span class="id"> f</span>.<br/>
<span class="vernacular">End</span><span class="id"> Linear</span>.<br/>
<span class="vernacular">End</span><span class="id"> Linear</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'linear' U -&gt; V | s }&quot;</span><span class="id"> :=</span> (<span class="id">@Linear</span>.<span class="id">type</span><span class="id"> _</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'linear' U -&gt; V }&quot;</span><span class="id"> :=</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> |</span><span class="id"> *:%R}</span><span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'scalar' U }&quot;</span><span class="id"> :=</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> _</span><span class="id"> |</span><span class="id"> *%R}</span><br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;{ 'scalar'  U }&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> Linear</span>.<span class="id">map_for_map</span><span class="id"> :</span><span class="id"> Linear</span>.<span class="id">map_for</span><span class="id"> &gt;-&gt;</span><span class="id"> Linear</span>.<span class="id">type</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> Linear</span>.<span class="id">unify_map_at</span><span class="id"> :</span><span class="id"> Linear</span>.<span class="id">map_at</span><span class="id"> &gt;-&gt;</span><span class="id"> Linear</span>.<span class="id">map_for</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> Linear</span>.<span class="id">unify_map_at</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> Linear</span>.<span class="id">unwrap</span><span class="id"> :</span><span class="id"> Linear</span>.<span class="id">wrapped</span><span class="id"> &gt;-&gt;</span><span class="id"> Linear</span>.<span class="id">type</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> Linear</span>.<span class="id">wrap</span><span class="id"> :</span><span class="id"> Linear</span>.<span class="id">map_class</span><span class="id"> &gt;-&gt;</span><span class="id"> Linear</span>.<span class="id">wrapped</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> Linear</span>.<span class="id">wrap</span>.<br/>
<span class="vernacular">End</span><span class="id"> LinearExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> LinearExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LinearTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> GenericProperties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> |</span><span class="id"> s}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> linear0</span><span class="id"> :</span><span class="id"> f</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddf0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linearD</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfD</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linearMn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfMn</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linear_sum</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> E</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">f</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span> (<span class="id">E</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddf_sum</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> linearZ_LR</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> semi_linear_subproof</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> semilinearP</span><span class="id"> :</span><span class="id"> semilinear_for</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> split;</span><span class="id"> [exact:</span><span class="id"> linearZ_LR</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> linearD]</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linearP</span><span class="id"> :</span><span class="id"> linear_for</span><span class="id"> s</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !semilinearP</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> GenericProperties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> GenericProperties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> |</span><span class="id"> s}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> linearN</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> -</span><span class="id"> x}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfN</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linearB</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfB</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linearMNn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *-</span><span class="id"> n}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> raddfMNn</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> GenericProperties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> BidirectionalLinearZ</span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> linearZ</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>)<br/>
&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">h</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">preLaw</span><span class="id"> S</span><span class="id"> V</span>)<br/>
&nbsp;&nbsp;(<span class="id">c</span><span class="id"> :</span><span class="id"> S</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">h_c</span><span class="id"> :=</span><span class="id"> h</span><span class="id"> c</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> Linear</span>.<span class="id">map_for</span><span class="id"> U</span><span class="id"> s</span><span class="id"> a</span><span class="id"> h_c</span>) (<span class="id">u</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">f</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> =</span><span class="id"> h_c</span> (<span class="id">Linear</span>.<span class="id">wrap</span><span class="id"> f</span><span class="id"> u</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> linearZ_LR;</span><span class="id"> case:</span><span class="id"> f</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> /=</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BidirectionalLinearZ</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LmodProperties</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> linearZZ</span><span class="id"> :</span><span class="id"> scalable</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> linearZ_LR</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> semilinearPZ</span><span class="id"> :</span><span class="id"> semilinear</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> semilinearP</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> linearPZ</span><span class="id"> :</span><span class="id"> linear</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> linearP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> can2_scalable</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> f</span><span class="id"> f'</span><span class="id"> -&gt;</span><span class="id"> cancel</span><span class="id"> f'</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> scalable</span><span class="id"> f'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fK</span><span class="id"> f'K</span><span class="id"> a</span><span class="id"> x;</span><span class="id"> apply:</span> (<span class="id">canLR</span><span class="id"> fK</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> linearZZ</span><span class="id"> f'K</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> can2_semilinear</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> f</span><span class="id"> f'</span><span class="id"> -&gt;</span><span class="id"> cancel</span><span class="id"> f'</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> semilinear</span><span class="id"> f'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> fK</span><span class="id"> f'K;</span><span class="id"> split=&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> apply:</span> (<span class="id">canLR</span><span class="id"> fK</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> semilinearPZ</span><span class="id"> !f'K</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> can2_linear</span><span class="id"> f'</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> f</span><span class="id"> f'</span><span class="id"> -&gt;</span><span class="id"> cancel</span><span class="id"> f'</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> linear</span><span class="id"> f'</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fK</span><span class="id"> f'K</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /=;</span><span class="id"> apply:</span> (<span class="id">canLR</span><span class="id"> fK</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> linearP</span><span class="id"> !f'K</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LmodProperties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ScalarProperties</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {scalar</span><span class="id"> U}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalarZ</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> *%R</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> linearZ_LR</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> semiscalarP</span><span class="id"> :</span><span class="id"> semiscalar</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> semilinearP</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> scalarP</span><span class="id"> :</span><span class="id"> scalar</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> linearP</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ScalarProperties</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LinearLSemiMod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Idfun</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> idfun_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">@idfun</span><span class="id"> U</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> U</span><span class="id"> *:%R</span><span class="id"> idfun</span><span class="id"> idfun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Idfun</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Plain</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">W</span><span class="id"> U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> |</span><span class="id"> s}</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> W</span><span class="id"> -&gt;</span><span class="id"> U}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comp_is_scalable</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> v</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !linearZ_LR</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> W</span><span class="id"> V</span><span class="id"> s</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> g</span>)<span class="id"> comp_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Plain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiScale</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">preLaw</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> |</span><span class="id"> s}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> null_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span> (<span class="id">\0</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> v</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> raddf0</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span><span class="id"> \0</span><span class="id"> null_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span> (<span class="id">add_fun</span><span class="id"> f</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> u;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> !linearZ_LR</span><span class="id"> raddfD</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span> (<span class="id">f</span><span class="id"> \+</span><span class="id"> g</span>)<span class="id"> add_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> SemiScale</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LinearLSemiMod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LinearLmod</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> opp_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">-%R</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> U</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> v</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> scalerN</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> U</span><span class="id"> *:%R</span><span class="id"> -%R</span><span class="id"> opp_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LinearLmod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Scale</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> Scale</span>.<span class="id">preLaw</span><span class="id"> R</span><span class="id"> V</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> |</span><span class="id"> s}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span> (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> u;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> !linearZ_LR</span><span class="id"> raddfB</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span> (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>)<span class="id"> sub_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> opp_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable_for</span><span class="id"> s</span> (<span class="id">\-</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> u;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> linearZ_LR</span><span class="id"> raddfN</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> s</span> (<span class="id">\-</span><span class="id"> f</span>)<span class="id"> opp_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Scale</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LinearLSemiAlg</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> A</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> A}</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> mulr_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">a</span><span class="id"> \o*</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> k</span><span class="id"> x</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> linearZ</span><span class="id"> scalerAl</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> A</span><span class="id"> *:%R</span> (<span class="id">a</span><span class="id"> \o*</span><span class="id"> f</span>)<span class="id"> mulr_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LinearLSemiAlg</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> LinearTheory</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> LRMorphism</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">B</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> B</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{f</span><span class="id"> of</span><span class="id"> @RMorphism</span><span class="id"> A</span><span class="id"> B</span><span class="id"> f</span><span class="id"> &amp;</span><span class="id"> isScalable</span><span class="id"> R</span><span class="id"> A</span><span class="id"> B</span><span class="id"> s</span><span class="id"> f}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> LRMorphismExports</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'lrmorphism' A -&gt; B | s }&quot;</span><span class="id"> :=</span> (<span class="id">@LRMorphism</span>.<span class="id">type</span><span class="id"> _</span><span class="id"> A%type</span><span class="id"> B%type</span><span class="id"> s</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'lrmorphism' A -&gt; B }&quot;</span><span class="id"> :=</span><span class="id"> {lrmorphism</span><span class="id"> A%type</span><span class="id"> -&gt;</span><span class="id"> B%type</span><span class="id"> |</span><span class="id"> *:%R}</span><br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">End</span><span class="id"> LRMorphismExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> LRMorphismExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LRMorphismTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>) (<span class="id">C</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> C</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> {lrmorphism</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> B}</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> {lrmorphism</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> C</span><span class="id"> |</span><span class="id"> s}</span>).<br/>
<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> RMorphism</span>.<span class="id">on</span> (<span class="id">@idfun</span><span class="id"> A</span>).<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> RMorphism</span>.<span class="id">on</span> (<span class="id">g</span><span class="id"> \o</span><span class="id"> f</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_alg</span><span class="id"> a</span><span class="id"> :</span><span class="id"> f</span><span class="id"> a%:A</span><span class="id"> =</span><span class="id"> a%:A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> linearZ</span><span class="id"> /=</span><span class="id"> rmorph1</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LRMorphismTheory</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> PzSemiRing_hasCommutativeMul</span><span class="id"> R</span><span class="id"> of</span><span class="id"> PzSemiRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">mulrC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">@mul</span><span class="id"> R</span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SemiRing_hasCommutativeMul</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use PzSemiRing_hasCommutativeMul.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SemiRing_hasCommutativeMul</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use PzSemiRing_hasCommutativeMul instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SemiRing_hasCommutativeMul</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">PzSemiRing_hasCommutativeMul</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comPzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComPzSemiRing</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{R</span><span class="id"> of</span><span class="id"> PzSemiRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> PzSemiRing_hasCommutativeMul</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComPzSemiRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComPzSemiRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComPzSemiRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComPzSemiRingExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Nmodule_isComPzSemiRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule_isComPzSemiRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulr1</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_id</span><span class="id"> mulrC</span><span class="id"> mul1r</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulrDr</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_dist</span><span class="id"> mulrC</span><span class="id"> mulrDl</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> zero</span><span class="id"> mul</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mul0r</span>. Qed.</div></details>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulrC</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comNzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComNzSemiRing</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{R</span><span class="id"> of</span><span class="id"> NzSemiRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> PzSemiRing_hasCommutativeMul</span><span class="id"> R}</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> ComSemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzSemiRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">ComNzSemiRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzSemiRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzSemiRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzSemiRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">ComNzSemiRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> ComSemiRing</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComNzSemiRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComNzSemiRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComNzSemiRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComNzSemiRingExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Nmodule_isComNzSemiRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> zero</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> one</span><span class="id"> !=</span><span class="id"> zero</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Nmodule_isComSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Nmodule_isComNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Nmodule_isComNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Nmodule_isComSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Nmodule_isComNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Nmodule_isComSemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Nmodule_isComNzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Nmodule_isComNzSemiRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulr1</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_id</span><span class="id"> mulrC</span><span class="id"> mul1r</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulrDr</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_dist</span><span class="id"> mulrC</span><span class="id"> mulrDl</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span><span class="id"> mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> zero</span><span class="id"> mul</span>.<br/>
<details>
&nbsp;&nbsp;<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mul0r</span>. Qed.</div></details>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span><span class="id"> oner_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulrC</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComSemiRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comPzSemiRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SemiGroup</span>.<span class="id">isCommutativeLaw</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> *%R</span><span class="id"> mulrC</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrCA</span><span class="id"> :</span><span class="id"> @left_commutative</span><span class="id"> R</span><span class="id"> R</span><span class="id"> *%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulmCA</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrAC</span><span class="id"> :</span><span class="id"> @right_commutative</span><span class="id"> R</span><span class="id"> R</span><span class="id"> *%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulmAC</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrACA</span><span class="id"> :</span><span class="id"> @interchange</span><span class="id"> R</span><span class="id"> *%R</span><span class="id"> *%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulmACA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprMn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> exact/exprMn_comm/mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrXl</span><span class="id"> n</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">big_morph</span><span class="id"> _</span> (<span class="id">exprMn</span><span class="id"> n</span>) (<span class="id">expr1n</span><span class="id"> _</span><span class="id"> n</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodr_undup_exp_count</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>)<span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> undup</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> ^+</span><span class="id"> count_mem</span><span class="id"> i</span><span class="id"> r</span><span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> big_undup_iterop_count</span>.  Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrMl</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> finType}</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> #|A|</span><span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_split</span><span class="id"> ?prodr_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrMr</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> finType}</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> #|A|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_split</span><span class="id"> ?prodr_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprDn</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>) (<span class="id">x</span><span class="id"> ^+</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> i</span>)<span class="id"> *+</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprDn_comm</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrrD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprDn</span><span class="id"> !big_ord_recr</span><span class="id"> big_ord0</span><span class="id"> /=</span><span class="id"> add0r</span><span class="id"> mulr1</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_comm</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>)<span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">comm</span> (<span class="id">f</span><span class="id"> x</span>) (<span class="id">f</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> red;</span><span class="id"> rewrite</span><span class="id"> -!rmorphM</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> ScaleLinear</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">b</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scale_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id"> *:%R</span><span class="id"> b</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> v</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !scalerA</span><span class="id"> mulrC</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> V</span><span class="id"> *:%R</span> (<span class="id"> *:%R</span><span class="id"> b</span>)<span class="id"> scale_is_scalable</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scale_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">b</span><span class="id"> \*:</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> v</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !linearZ</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> V</span><span class="id"> *:%R</span> (<span class="id">b</span><span class="id"> \*:</span><span class="id"> f</span>)<span class="id"> scale_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ScaleLinear</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ComSemiRingTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComNzSemiRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FrobeniusAutomorphism</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">pcharRp</span><span class="id"> :</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_aut_is_nmod_morphism</span><span class="id"> :</span><span class="id"> nmod_morphism</span> (<span class="id">pFrobenius_aut</span><span class="id"> pcharRp</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> [exact:</span><span class="id"> pFrobenius_aut0</span><span class="id"> |</span><span class="id"> exact/pFrobenius_autD_comm/mulrC]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pFrobenius_aut_is_monoid_morphism</span><span class="id"> :</span><span class="id"> monoid_morphism</span> (<span class="id">pFrobenius_aut</span><span class="id"> pcharRp</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y];</span><span class="id"> [exact:</span><span class="id"> pFrobenius_aut1</span><span class="id"> |</span><span class="id"> exact/pFrobenius_autM_comm/mulrC]</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isNmodMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R</span> (<span class="id">pFrobenius_aut</span><span class="id"> pcharRp</span>)<br/>
&nbsp;&nbsp;<span class="id">pFrobenius_aut_is_nmod_morphism</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R</span> (<span class="id">pFrobenius_aut</span><span class="id"> pcharRp</span>)<br/>
&nbsp;&nbsp;<span class="id">pFrobenius_aut_is_monoid_morphism</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FrobeniusAutomorphism</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprDn_pchar</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">pchar</span><span class="id"> R</span>).<span class="id">-nat</span><span class="id"> n</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> pdiv</span><span class="id"> n;</span><span class="id"> have</span><span class="id"> [|n_gt1</span><span class="id"> pcharRn]</span><span class="id"> :=</span><span class="id"> leqP</span><span class="id"> n</span><span class="id"> 1;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">n</span>)<span class="id"> =&gt;</span><span class="id"> [|[]]</span>.<br/>
<span class="id">have</span><span class="id"> pcharRp:</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">pnatPpi</span><span class="id"> pcharRn</span>)<span class="id"> ?pi_pdiv</span>.<br/>
<span class="id">have{pcharRn}</span><span class="id"> /p_natP[e</span><span class="id"> -&gt;]:</span><span class="id"> p</span>.<span class="id">-nat</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eq_pnat</span><span class="id"> _</span> (<span class="id">pcharf_eq</span><span class="id"> pcharRp</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> e</span><span class="id"> IHe;</span><span class="id"> rewrite</span><span class="id"> !expnSr</span><span class="id"> !exprM</span><span class="id"> IHe</span><span class="id"> -pFrobenius_autE</span><span class="id"> rmorphD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ComNzSemiRingTheory</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comPzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComPzRing</span><span class="id"> :=</span><span class="id"> {R</span><span class="id"> of</span><span class="id"> PzRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> ComPzSemiRing</span><span class="id"> R}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> PzRing_hasCommutativeMul</span><span class="id"> R</span><span class="id"> of</span><span class="id"> PzRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">mulrC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">@mul</span><span class="id"> R</span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Ring_hasCommutativeMul</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use PzRing_hasCommutativeMul.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">PzRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Ring_hasCommutativeMul</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use PzRing_hasCommutativeMul instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Ring_hasCommutativeMul</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">PzRing_hasCommutativeMul</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> PzRing_hasCommutativeMul</span><span class="id"> R</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulrC</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isComPzRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule_isComPzRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulr1</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_id</span><span class="id"> mulrC</span><span class="id"> mul1r</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulrDr</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_dist</span><span class="id"> mulrC</span><span class="id"> mulrDl</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Zmodule_isPzRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulrC</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComPzRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComPzRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComPzRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComPzRingExports</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use pFrobenius_aut_is_monoid_morphism instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> pFrobenius_aut_is_multiplicative</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> p</span><span class="id"> =&gt;</span> (<span class="id">p</span>.<span class="id">2,</span><span class="id"> p</span>.<span class="id">1</span>)<span class="id"> \o</span><span class="id"> pFrobenius_aut_is_monoid_morphism</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use exprDn_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> exprDn_char</span><span class="id"> :=</span><span class="id"> exprDn_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comNzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComNzRing</span><span class="id"> :=</span><span class="id"> {R</span><span class="id"> of</span><span class="id"> NzRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> ComNzSemiRing</span><span class="id"> R}</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> ComRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">ComNzRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">ComNzRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> ComRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Zmodule_isComNzRing</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">one</span><span class="id"> :</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mul</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> one</span><span class="id"> mul;</span><br/>
&nbsp;&nbsp;<span class="id">mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul</span><span class="id"> add;</span><br/>
&nbsp;&nbsp;<span class="id">oner_neq0</span><span class="id"> :</span><span class="id"> one</span><span class="id"> !=</span><span class="id"> zero</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Zmodule_isComRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Zmodule_isComNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Zmodule_isComNzRing</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Zmodule_isComRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use Zmodule_isComNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Zmodule_isComRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">Zmodule_isComNzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> Zmodule_isComNzRing</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulr1</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_id</span><span class="id"> mulrC</span><span class="id"> mul1r</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span><span class="id"> mulrDr</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">mulC_dist</span><span class="id"> mulrC</span><span class="id"> mulrDl</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Zmodule_isNzRing</span>.<span class="id">Build</span><span class="id"> R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> oner_neq0</span>.<br/>
&nbsp;&nbsp;<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulrC</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComNzRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComNzRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComNzRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComNzRingExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComPzRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comPzRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprBn</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>) ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> i</span>)<span class="id"> *+</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprBn_comm</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subrXX</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> x</span><span class="id"> ^+</span> (<span class="id">n</span>.<span class="id">-1</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -subrXX_comm</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrrB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrrD</span><span class="id"> mulrN</span><span class="id"> mulNrn</span><span class="id"> sqrrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_sqr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> *</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> subrXX</span><span class="id"> !big_ord_recr</span><span class="id"> big_ord0</span><span class="id"> /=</span><span class="id"> add0r</span><span class="id"> mulr1</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subr_sqrDB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 4</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> sqrrD</span><span class="id"> sqrrB</span><span class="id"> -!</span>(<span class="id">addrAC</span><span class="id"> _</span> (<span class="id">y</span><span class="id"> ^+</span><span class="id"> 2</span>))<span class="id"> opprB</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [LHS]addrC</span><span class="id"> addrA</span><span class="id"> subrK</span><span class="id"> -mulrnDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ComPzRingTheory</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> LSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">scalerAr</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> k</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V</span>)<span class="id">,</span><span class="id"> k</span><span class="id"> *:</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> y</span>)<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;semiAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SemiAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{A</span><span class="id"> of</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span><span class="id"> R</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> LSemiAlgebra</span><span class="id"> R</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SemiAlgExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> SemiAlgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> SemiAlgExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> LSemiAlgebra_isComSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> ComPzSemiRing</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> LSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> LSemiAlgebra_isComSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalarAr</span><span class="id"> k</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> k</span><span class="id"> *:</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> scalerAl</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> scalarAr</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;algType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Algebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{A</span><span class="id"> of</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span><span class="id"> R</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> Lalgebra</span><span class="id"> R</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> AlgExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> Algebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> AlgExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> AlgExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Lalgebra_isAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> V</span><span class="id"> of</span><span class="id"> Lalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">scalerAr</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> k</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> V</span>)<span class="id">,</span><span class="id"> k</span><span class="id"> *:</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> y</span>)<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> Lalgebra_isAlgebra</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> scalerAr</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Lalgebra_isComAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> ComPzRing</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> Lalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> of</span><span class="id"> Lalgebra_isComAlgebra</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiAlgebra_isComSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comSemiAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComSemiAlgebra</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{V</span><span class="id"> of</span><span class="id"> ComNzSemiRing</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> SemiAlgebra</span><span class="id"> R</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComSemiAlgExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComSemiAlgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComSemiAlgExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComSemiAlgExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiAlgebraTheory</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> R^c</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> mulrC</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzSemiRingType</span>)<span class="id"> :=</span><span class="id"> ComPzSemiRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>)<span class="id"> :=</span><span class="id"> ComNzSemiRing</span>.<span class="id">on</span><span class="id"> R^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>)<span class="id"> :=</span><span class="id"> ComNzSemiRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">LSemiAlgebra_isComSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> R^o</span>.<br/>
<span class="vernacular">End</span><span class="id"> SemiAlgebraTheory</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComAlgebra</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {V</span><span class="id"> of</span><span class="id"> ComNzRing</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> Algebra</span><span class="id"> R</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComAlgExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComAlgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComAlgExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComAlgExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> AlgebraTheory</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>)<span class="id"> :=</span><span class="id"> ComPzRing</span>.<span class="id">on</span><span class="id"> R^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>)<span class="id"> :=</span><span class="id"> ComPzRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzRingType</span>)<span class="id"> :=</span><span class="id"> ComNzRing</span>.<span class="id">on</span><span class="id"> R^c</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzRingType</span>)<span class="id"> :=</span><span class="id"> ComNzRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<span class="vernacular">End</span><span class="id"> AlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiAlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> semiAlgType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">k</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerCA</span><span class="id"> k</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> k</span><span class="id"> *:</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> scalerAr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_algr</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> a%:A</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -scalerAr</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_alg</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> a%:A</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /comm</span><span class="id"> mulr_algr</span><span class="id"> mulr_algl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprZn</span><span class="id"> k</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> k</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> *:</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expr0</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !exprS</span><span class="id"> IHn</span><span class="id"> -scalerA</span><span class="id"> scalerAr</span><span class="id"> scalerAl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_prod</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">G</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> A</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *:</span><span class="id"> G</span><span class="id"> i</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *:</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> G</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/big_rec3:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> x</span><span class="id"> a</span><span class="id"> _</span><span class="id"> _</span><span class="id"> -&gt;];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerAl</span><span class="id"> -scalerAr</span><span class="id"> scalerA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_prodl</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> A</span>)<span class="id"> k</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> S</span>) (<span class="id">k</span><span class="id"> *:</span><span class="id"> F</span><span class="id"> i</span>) <span class="id"> =</span><span class="id"> k</span><span class="id"> ^+</span><span class="id"> #|S|</span><span class="id"> *:</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> S</span>)<span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler_prod</span><span class="id"> prodr_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_prodr</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> S</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *:</span><span class="id"> x</span>) <span class="id"> =</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> S</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> *:</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> #|S|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler_prod</span><span class="id"> prodr_const</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SemiAlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> AlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> semiAlgType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> A</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {linear</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> A}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mull_fun_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">a</span><span class="id"> \*o</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> k</span><span class="id"> x</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> linearZ</span><span class="id"> scalerAr</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> U</span><span class="id"> A</span><span class="id"> *:%R</span> (<span class="id">a</span><span class="id"> \*o</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;<span class="id">mull_fun_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> AlgebraTheory</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> NzRing_hasMulInverse</span><span class="id"> R</span><span class="id"> of</span><span class="id"> NzRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">unit_subdef</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">inv</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulVr_subproof</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit_subdef,</span><span class="id"> left_inverse</span><span class="id"> 1</span><span class="id"> inv</span><span class="id"> *%R};</span><br/>
&nbsp;&nbsp;<span class="id">divrr_subproof</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit_subdef,</span><span class="id"> right_inverse</span><span class="id"> 1</span><span class="id"> inv</span><span class="id"> *%R};</span><br/>
&nbsp;&nbsp;<span class="id">unitrP_subproof</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> unit_subdef</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">invr_out_subproof</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [predC</span><span class="id"> unit_subdef],</span><span class="id"> inv</span><span class="id"> =1</span><span class="id"> id}</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Ring_hasMulInverse</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzRing_hasMulInverse.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">NzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> Ring_hasMulInverse</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use NzRing_hasMulInverse instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Ring_hasMulInverse</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">NzRing_hasMulInverse</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;unitRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> UnitRing</span><span class="id"> :=</span><span class="id"> {R</span><span class="id"> of</span><span class="id"> NzRing_hasMulInverse</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> NzRing</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> UnitRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> UnitRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> UnitRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> UnitRingExports</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> unit_pred</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> unitRingType}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="vernacular">Eval</span><span class="id"> cbv</span><span class="id"> [</span><span class="id"> unit_subdef</span><span class="id"> NzRing_hasMulInverse</span>.<span class="id">unit_subdef</span><span class="id"> ]</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> u</span><span class="id"> :</span><span class="id"> R</span><span class="id"> =&gt;</span><span class="id"> unit_subdef</span><span class="id"> u</span>).<br/>
<span class="vernacular">Arguments</span><span class="id"> unit_pred</span><span class="id"> _</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unit</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> unitRingType}</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> a</span><span class="id"> u</span><span class="id"> :</span><span class="id"> R</span><span class="id"> |</span><span class="id"> unit_pred</span><span class="id"> u]</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x ^-1&quot;</span><span class="id"> :=</span> (<span class="id">inv</span><span class="id"> x</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x / y&quot;</span><span class="id"> :=</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y^-1</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x ^- n&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id">^-1</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> unitRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divrr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> right_inverse</span><span class="id"> 1</span> (<span class="id">@inv</span><span class="id"> R</span>)<span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> divrr_subproof</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> mulrV</span><span class="id"> :=</span><span class="id"> divrr</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulVr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> left_inverse</span><span class="id"> 1</span> (<span class="id">@inv</span><span class="id"> R</span>)<span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mulVr_subproof</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_out</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> x^-1</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> invr_out_subproof</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrP</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> y,</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span>) (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [Ux</span><span class="id"> |</span><span class="id"> []];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> unitrP_subproof</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> x^-1;</span><span class="id"> rewrite</span><span class="id"> divrr</span><span class="id"> ?mulVr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> left_loop</span> (<span class="id">@inv</span><span class="id"> R</span>)<span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> mulVr</span><span class="id"> ?mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulVKr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> rev_left_loop</span> (<span class="id">@inv</span><span class="id"> R</span>)<span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> mulrV</span><span class="id"> ?mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> right_loop</span> (<span class="id">@inv</span><span class="id"> R</span>)<span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -mulrA</span><span class="id"> divrr</span><span class="id"> ?mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrVK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> rev_right_loop</span> (<span class="id">@inv</span><span class="id"> R</span>)<span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -mulrA</span><span class="id"> mulVr</span><span class="id"> ?mulr1</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> divrK</span><span class="id"> :=</span><span class="id"> mulrVK</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrI</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @unit</span><span class="id"> R,</span><span class="id"> right_injective</span><span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">mulKr</span><span class="id"> Ux</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulIr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @unit</span><span class="id"> R,</span><span class="id"> left_injective</span><span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">mulrK</span><span class="id"> Ux</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_prodr</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> k</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> -&gt;</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>) (<span class="id">f</span><span class="id"> k</span><span class="id"> /</span><span class="id"> f</span><span class="id"> k</span>.<span class="id">+1</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> n</span><span class="id"> /</span><span class="id"> f</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Uf</span><span class="id"> ltnm;</span><span class="id"> rewrite</span> (<span class="id">telescope_big</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> /</span><span class="id"> f</span><span class="id"> j</span>))<span class="id"> ?ltnm//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> k</span><span class="id"> ltnkm</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> mulrA</span><span class="id"> divrK//</span><span class="id"> Uf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_prodr_eq</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> u</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> k</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> u</span><span class="id"> k</span><span class="id"> =</span><span class="id"> f</span><span class="id"> k</span><span class="id"> /</span><span class="id"> f</span><span class="id"> k</span>.<span class="id">+1</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id"> u</span><span class="id"> k</span><span class="id"> =</span><span class="id"> f</span><span class="id"> n</span><span class="id"> /</span><span class="id"> f</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> uE;</span><span class="id"> under</span><span class="id"> eq_big_nat</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> uE</span><span class="id"> //=;</span><span class="id"> exact:</span><span class="id"> telescope_prodr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> commrV</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> comm</span><span class="id"> x</span><span class="id"> y^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [Uy</span><span class="id"> cxy</span><span class="id"> |</span><span class="id"> /invr_out-&gt;</span><span class="id"> //]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> unit</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">canLR</span> (<span class="id">mulrK</span><span class="id"> Uy</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mulrA</span><span class="id"> cxy</span><span class="id"> mulKr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/eqP=&gt;</span><span class="id"> [Ux</span><span class="id"> |</span><span class="id"> xx1];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> divrr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span><span class="id"> x^-1;</span><span class="id"> rewrite</span><span class="id"> -commrV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invrK</span><span class="id"> :</span><span class="id"> involutive</span> (<span class="id">@inv</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x;</span><span class="id"> case</span><span class="id"> Ux:</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !invr_out</span><span class="id"> ?Ux</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mulrK</span><span class="id"> Ux</span><span class="id"> _^-1</span>)<span class="id"> -mulrA</span><span class="id"> commrV</span><span class="id"> ?mulKr</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> divrr</span><span class="id"> ?mulVr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_inj</span><span class="id"> :</span><span class="id"> injective</span> (<span class="id">@inv</span><span class="id"> R</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> inv_inj</span><span class="id"> invrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrV</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !unitrE</span><span class="id"> invrK</span><span class="id"> commrV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitr1</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> @unit</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span><span class="id"> 1;</span><span class="id"> rewrite</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr1</span><span class="id"> :</span><span class="id"> 1^-1</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}</span>(<span class="id">mulVr</span><span class="id"> unitr1</span>)<span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> div1r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> /</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x^-1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul1r</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> divr1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr1</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr_div</span><span class="id"> m</span><span class="id"> d</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> d%:R</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> @unit</span><span class="id"> R</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> m%:R</span><span class="id"> /</span><span class="id"> d%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdn_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> def_m</span><span class="id"> unit_d;</span><span class="id"> rewrite</span><span class="id"> -{2}def_m</span><span class="id"> natrM</span><span class="id"> mulrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divrI</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> right_injective</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> /mulrI/inj_comp;</span><span class="id"> apply;</span><span class="id"> apply:</span><span class="id"> invr_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divIr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> left_injective</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> -unitrV</span><span class="id"> =&gt;</span><span class="id"> /mulIr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitr0</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> @unit</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/unitrP=&gt;</span><span class="id"> [[x</span><span class="id"> [_</span><span class="id"> /esym/eqP]]];</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr0</span><span class="id"> :</span><span class="id"> 0^-1</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_out</span><span class="id"> ?unitr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrN1</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> @unit</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span> (<span class="id">-1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulrNN</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invrN1</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id">^-1</span><span class="id"> =</span><span class="id"> -1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}</span>(<span class="id">divrr</span><span class="id"> unitrN1</span>)<span class="id"> mulN1r</span><span class="id"> opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_sign</span><span class="id"> n</span><span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^-</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -signr_odd;</span><span class="id"> case:</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">invr1,</span><span class="id"> invrN1</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Uy;</span><span class="id"> wlog</span><span class="id"> Ux:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Uy</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> =&gt;</span><span class="id"> [WHxy|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> Ux;</span><span class="id"> first</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulrK</span><span class="id"> Uy</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> WHxy</span><span class="id"> ?unitrV</span>.<br/>
<span class="id">rewrite</span><span class="id"> Ux;</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span> (<span class="id">y^-1</span><span class="id"> *</span><span class="id"> x^-1</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!mulrA</span><span class="id"> mulKr</span><span class="id"> ?mulrA</span><span class="id"> ?mulrK</span><span class="id"> ?divrr</span><span class="id"> ?mulVr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ux;</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> [Uxy</span><span class="id"> |</span><span class="id"> Uy];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitrMl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulKr</span><span class="id"> Ux</span><span class="id"> y</span>)<span class="id"> unitrMl</span><span class="id"> ?unitrV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitr_prod</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Eunit;</span><span class="id"> elim/big_rec:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [/[!unitr1]</span><span class="id"> |i</span><span class="id"> x</span><span class="id"> /Eunit/unitrMr-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitr_prod_in</span><span class="id"> {I</span><span class="id"> :</span><span class="id"> eqType}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> r,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_seq_cond</span><span class="id"> =&gt;</span><span class="id"> H;</span><span class="id"> apply:</span><span class="id"> unitr_prod</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /andP[];</span><span class="id"> exact:</span><span class="id"> H</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invrM</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">^-1</span><span class="id"> =</span><span class="id"> y^-1</span><span class="id"> *</span><span class="id"> x^-1}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Ux</span><span class="id"> Uy;</span><span class="id"> have</span><span class="id"> Uxy:</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitrMl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">mulrI</span><span class="id"> Uxy</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> divrr</span><span class="id"> ?mulrA</span><span class="id"> ?mulrK</span><span class="id"> ?divrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrM_comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">comm</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cxy;</span><span class="id"> apply/idP/andP=&gt;</span><span class="id"> [Uxy</span><span class="id"> |</span><span class="id"> [Ux</span><span class="id"> Uy]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitrMl</span>.<br/>
<span class="id">suffices</span><span class="id"> Ux:</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitrMr</span><span class="gallina-kwd"> in</span><span class="id"> Uxy</span>.<br/>
<span class="id">apply/unitrP;</span><span class="id"> case/unitrP:</span><span class="id"> Uxy</span><span class="id"> =&gt;</span><span class="id"> z</span><span class="id"> [zxy</span><span class="id"> xyz];</span><span class="gallina-kwd"> exists</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<span class="id">rewrite</span><span class="id"> mulrA</span><span class="id"> xyz</span><span class="id"> -{1}[y]mul1r</span><span class="id"> -{1}zxy</span><span class="id"> cxy</span><span class="id"> -!mulrA</span> (<span class="id">mulrA</span><span class="id"> x</span>) (<span class="id">mulrA</span><span class="id"> _</span><span class="id"> z</span>)<span class="id"> xyz</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul1r</span><span class="id"> -cxy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrX</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Ux;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> ?unitr1</span><span class="id"> //</span><span class="id"> exprS</span><span class="id"> unitrMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrX_pos</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> unitrM_comm;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> commrX</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> Ux:</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> unitrX</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprVn</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x^-1</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^-</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !expr0</span><span class="id"> ?invr1</span>.<br/>
<span class="id">case</span><span class="id"> Ux:</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprSr</span><span class="id"> exprS</span><span class="id"> IHn</span><span class="id"> -invrM</span><span class="id"> //</span><span class="id"> unitrX</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !invr_out</span><span class="id"> ?unitrX_pos</span><span class="id"> ?Ux</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exprB</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/subnK=&gt;</span><span class="id"> {2}&lt;-</span><span class="id"> Ux;</span><span class="id"> rewrite</span><span class="id"> exprD</span><span class="id"> mulrK</span><span class="id"> ?unitrX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_neq0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x^-1</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nx0;</span><span class="id"> case</span><span class="id"> Ux:</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_out</span><span class="id"> ?Ux</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP=&gt;</span><span class="id"> x'0;</span><span class="id"> rewrite</span><span class="id"> -unitrV</span><span class="id"> x'0</span><span class="id"> unitr0</span><span class="gallina-kwd"> in</span><span class="id"> Ux</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> negb_inj;</span><span class="id"> apply/idP/idP;</span><span class="id"> move/invr_neq0;</span><span class="id"> rewrite</span><span class="id"> ?invrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_eq1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">inv_eq</span><span class="id"> invrK</span>)<span class="id"> invr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rev_unitrP</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R^c</span>)<span class="id"> :</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [yx1</span><span class="id"> xy1];</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span><span class="id"> y</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">NzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> R^c</span><span class="id"> mulrV</span><span class="id"> mulVr</span><span class="id"> rev_unitrP</span><span class="id"> invr_out</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> UnitRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> UnitRingTheory</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> invrK</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> invr_inj</span><span class="id"> {R}</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> telescope_prodr_eq</span><span class="id"> {R</span><span class="id"> n</span><span class="id"> m}</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rev_prodrV</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<br/>
&nbsp;&nbsp;(<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">E</span><span class="id"> i</span>)<span class="id">^-1</span><span class="id"> =</span> ((<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">E</span><span class="id"> i</span><span class="id"> :</span><span class="id"> R^c</span>))<span class="id">^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Eunit;</span><span class="id"> symmetry</span>.<br/>
<span class="id">apply:</span> (<span class="id">big_morph_in</span><span class="id"> GRing</span>.<span class="id">unit</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">unitr1</span><span class="id"> R^c</span>) (<span class="id">@invrM</span><span class="id"> _</span>) (<span class="id">invr1</span><span class="id"> _</span>))<span class="id"> Eunit</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xunit;</span><span class="id"> rewrite</span><span class="id"> unitrMr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitRingClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> invr_closed</span><span class="id"> :=</span><span class="id"> {in</span><span class="id"> S,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x^-1</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divr_2closed</span><span class="id"> :=</span><span class="id"> {in</span><span class="id"> S</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divr_closed</span><span class="id"> :=</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> divr_2closed</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sdivr_closed</span><span class="id"> :=</span><span class="id"> -1</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> divr_2closed</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divring_closed</span><span class="id"> :=</span><span class="id"> [/\</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S,</span><span class="id"> subr_2closed</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> divr_2closed]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divr_closedV</span><span class="id"> :</span><span class="id"> divr_closed</span><span class="id"> -&gt;</span><span class="id"> invr_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> Sdiv</span><span class="id"> x</span><span class="id"> Sx;</span><span class="id"> rewrite</span><span class="id"> -[x^-1]mul1r</span><span class="id"> Sdiv</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divr_closedM</span><span class="id"> :</span><span class="id"> divr_closed</span><span class="id"> -&gt;</span><span class="id"> mulr_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> Sdiv;</span><span class="id"> split=&gt;</span><span class="id"> //</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Sx</span><span class="id"> Sy;</span><span class="id"> rewrite</span><span class="id"> -[y]invrK</span><span class="id"> -[y^-1]mul1r</span><span class="id"> !Sdiv</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sdivr_closed_div</span><span class="id"> :</span><span class="id"> sdivr_closed</span><span class="id"> -&gt;</span><span class="id"> divr_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> SN1</span><span class="id"> Sdiv;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">divrr</span> (<span class="id">@unitrN1</span><span class="id"> _</span>))<span class="id"> Sdiv</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sdivr_closedM</span><span class="id"> :</span><span class="id"> sdivr_closed</span><span class="id"> -&gt;</span><span class="id"> smulr_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Sdiv;</span><span class="id"> have</span><span class="id"> [_</span><span class="id"> SM]</span><span class="id"> :=</span><span class="id"> divr_closedM</span> (<span class="id">sdivr_closed_div</span><span class="id"> Sdiv</span>)<span class="id">;</span><span class="id"> case:</span><span class="id"> Sdiv</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divring_closedBM</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> -&gt;</span><span class="id"> subring_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> SB</span><span class="id"> Sdiv;</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> divr_closedM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divring_closed_div</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> -&gt;</span><span class="id"> sdivr_closed</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case=&gt;</span><span class="id"> S1</span><span class="id"> SB</span><span class="id"> Sdiv;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> ?zmod_closedN</span><span class="id"> //</span>.<br/>
<span class="id">exact/subring_closedB/divring_closedBM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> UnitRingClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitRingMorphism</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> S}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_unit</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/unitrP=&gt;</span><span class="id"> y</span><span class="id"> [yx1</span><span class="id"> xy1];</span><span class="id"> apply/unitrP</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">f</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -!rmorphM</span><span class="id"> //</span><span class="id"> yx1</span><span class="id"> xy1</span><span class="id"> rmorph1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorphV</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> {morph</span><span class="id"> f:</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x^-1}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> Ux;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> -[</span>(<span class="id">f</span><span class="id"> x</span>)<span class="id">^-1]mul1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">canRL</span> (<span class="id">mulrK</span> (<span class="id">rmorph_unit</span><span class="id"> Ux</span>)))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -rmorphM</span><span class="id"> mulVr</span><span class="id"> ?rmorph1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rmorph_div</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> f</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> x</span><span class="id"> /</span><span class="id"> f</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Uy;</span><span class="id"> rewrite</span><span class="id"> rmorphM</span><span class="id"> /=</span><span class="id"> rmorphV</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> UnitRingMorphism</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comUnitRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComUnitRing</span><span class="id"> :=</span><span class="id"> {R</span><span class="id"> of</span><span class="id"> ComNzRing</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> UnitRing</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComUnitRingExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> ComUnitRing</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComUnitRingExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComUnitRingExports</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> ComNzRing_hasMulInverse</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComNzRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">unit</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R};</span><br/>
&nbsp;&nbsp;<span class="id">inv</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulVx</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> left_inverse</span><span class="id"> 1</span><span class="id"> inv</span><span class="id"> *%R};</span><br/>
&nbsp;&nbsp;<span class="id">unitPl</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> unit</span><span class="id"> x;</span><br/>
&nbsp;&nbsp;<span class="id">invr_out</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [predC</span><span class="id"> unit],</span><span class="id"> inv</span><span class="id"> =1</span><span class="id"> id}</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComRing_hasMulInverse</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing_hasMulInverse.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> ComRing_hasMulInverse</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing_hasMulInverse instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> ComRing_hasMulInverse</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzRing_hasMulInverse</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComNzRing_hasMulInverse</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> mulC_mulrV</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> right_inverse</span><span class="id"> 1</span><span class="id"> inv</span><span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Ux</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mulVx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> mulC_unitP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> unit</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> yx</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> unitPl</span><span class="id"> yx</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">NzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulVx</span><span class="id"> mulC_mulrV</span><span class="id"> mulC_unitP</span><span class="id"> invr_out</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;unitAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> UnitAlgebra</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {V</span><span class="id"> of</span><span class="id"> Algebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> UnitRing</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> UnitAlgebraExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> UnitAlgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> UnitAlgebraExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> UnitAlgebraExports</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;comUnitAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> ComUnitAlgebra</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {V</span><span class="id"> of</span><span class="id"> ComAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> &amp;</span><span class="id"> UnitRing</span><span class="id"> V}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComUnitAlgebraExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> UnitAlgebra</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> ComUnitAlgebraExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> ComUnitAlgebraExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ComUnitRingTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/unitrM_comm/mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrPr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span>) (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">unitrP</span><span class="id"> x</span>))<span class="id"> =&gt;</span><span class="id"> [[y</span><span class="id"> []]</span><span class="id"> |</span><span class="id"> [y]];</span><span class="gallina-kwd"> exists</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr1_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x^-1</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xy_eq1;</span><span class="id"> rewrite</span><span class="id"> -[LHS]mulr1</span><span class="id"> -xy_eq1;</span><span class="id"> apply/mulKr/unitrPr;</span><span class="gallina-kwd"> exists</span><span class="id"> y</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divr1_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/mulr1_eq/invr_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divKr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> involutive</span> (<span class="gallina-kwd">fun</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Ux</span><span class="id"> y</span><span class="id"> Uy;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> invrM</span><span class="id"> ?unitrV</span><span class="id"> //</span><span class="id"> invrK</span><span class="id"> mulrC</span><span class="id"> divrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expr_div_n</span><span class="id"> x</span><span class="id"> y</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> /</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprMn</span><span class="id"> exprVn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitr_prodP</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span><span class="id"> {in</span><span class="id"> r,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span> (<span class="id">big_morph</span><span class="id"> [in</span><span class="id"> unit]</span><span class="id"> unitrM</span> (<span class="id">@unitr1</span><span class="id"> _</span>) )<span class="id"> big_all_cond</span>.<br/>
<span class="id">exact:</span><span class="id"> 'all_implyP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodrV</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> E</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">E</span><span class="id"> i</span>)<span class="id">^-1</span><span class="id"> =</span> (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /rev_prodrV-&gt;;</span><span class="id"> rewrite</span><span class="id"> rev_prodr</span> (<span class="id">perm_big</span><span class="id"> r</span>)<span class="id">//</span><span class="id"> perm_rev</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> ComUnitRing</span>.<span class="id">on</span><span class="id"> R^c</span>.<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> ComUnitRing</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ComUnitRingTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitAlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> unitAlgType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">k</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_injl</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> unit,</span><span class="id"> @right_injective</span><span class="id"> R</span><span class="id"> A</span><span class="id"> A</span><span class="id"> *:%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> k</span><span class="id"> Uk</span><span class="id"> x1</span><span class="id"> x2</span><span class="id"> Hx1x2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[x1]scale1r</span><span class="id"> -</span>(<span class="id">mulVr</span><span class="id"> Uk</span>)<span class="id"> -scalerA</span><span class="id"> Hx1x2</span><span class="id"> scalerA</span><span class="id"> mulVr</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_unit</span><span class="id"> k</span><span class="id"> x</span><span class="id"> :</span><span class="id"> k</span><span class="id"> \in</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Uk;</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> [Ukx</span><span class="id"> |</span><span class="id"> Ux];</span><span class="id"> apply/unitrP;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">k^-1</span><span class="id"> *:</span><span class="id"> x^-1</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!scalerAl</span><span class="id"> -!scalerAr</span><span class="id"> !scalerA</span><span class="id"> !mulVr</span><span class="id"> //</span><span class="id"> !mulrV</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">k</span><span class="id"> *:</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> x</span>)<span class="id">^-1</span>)<span class="id">;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">mulrI</span><span class="id"> Ukx</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr1</span><span class="id"> mulrA</span><span class="id"> -scalerAr</span><span class="id"> mulrV</span><span class="id"> //</span><span class="id"> -scalerAl</span><span class="id"> mul1r</span>.<br/>
<span class="id">apply:</span> (<span class="id">mulIr</span><span class="id"> Ukx</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul1r</span><span class="id"> -mulrA</span><span class="id"> -scalerAl</span><span class="id"> mulVr</span><span class="id"> //</span><span class="id"> -scalerAr</span><span class="id"> mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invrZ</span><span class="id"> k</span><span class="id"> x</span><span class="id"> :</span><span class="id"> k</span><span class="id"> \in</span><span class="id"> unit</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> x</span>)<span class="id">^-1</span><span class="id"> =</span><span class="id"> k^-1</span><span class="id"> *:</span><span class="id"> x^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Uk</span><span class="id"> Ux;</span><span class="id"> have</span><span class="id"> Ukx:</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scaler_unit</span>.<br/>
<span class="id">apply:</span> (<span class="id">mulIr</span><span class="id"> Ukx</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulVr</span><span class="id"> //</span><span class="id"> -scalerAl</span><span class="id"> -scalerAr</span><span class="id"> scalerA</span><span class="id"> !mulVr</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> divalg_closed</span><span class="id"> :=</span><span class="id"> [/\</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S,</span><span class="id"> linear_closed</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> divr_2closed</span><span class="id"> S]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divalg_closedBdiv</span><span class="id"> :</span><span class="id"> divalg_closed</span><span class="id"> -&gt;</span><span class="id"> divring_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> /linear_closedB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divalg_closedZ</span><span class="id"> :</span><span class="id"> divalg_closed</span><span class="id"> -&gt;</span><span class="id"> subalg_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> S1</span><span class="id"> Slin</span><span class="id"> Sdiv;</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> have</span><span class="id"> []</span><span class="id"> :=</span><span class="id"> @divr_closedM</span><span class="id"> A</span><span class="id"> S</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedPredicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> UnitAlgebraTheory</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> ClosedExports</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> addr_closed</span><span class="id"> :=</span><span class="id"> nmod_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> oppr_closed</span><span class="id"> :=</span><span class="id"> oppr_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> zmod_closed</span><span class="id"> :=</span><span class="id"> zmod_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> mulr_closed</span><span class="id"> :=</span><span class="id"> mulr_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> semiring_closed</span><span class="id"> :=</span><span class="id"> semiring_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> smulr_closed</span><span class="id"> :=</span><span class="id"> smulr_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> subring_closed</span><span class="id"> :=</span><span class="id"> subring_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> scaler_closed</span><span class="id"> :=</span><span class="id"> scaler_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> subsemimod_closed</span><span class="id"> :=</span><span class="id"> subsemimod_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> linear_closed</span><span class="id"> :=</span><span class="id"> linear_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> submod_closed</span><span class="id"> :=</span><span class="id"> submod_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> subalg_closed</span><span class="id"> :=</span><span class="id"> subalg_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> invr_closed</span><span class="id"> :=</span><span class="id"> invr_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> divr_2closed</span><span class="id"> :=</span><span class="id"> divr_2closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> divr_closed</span><span class="id"> :=</span><span class="id"> divr_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> sdivr_closed</span><span class="id"> :=</span><span class="id"> sdivr_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> divring_closed</span><span class="id"> :=</span><span class="id"> divring_closed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> divalg_closed</span><span class="id"> :=</span><span class="id"> divalg_closed</span>.<br/>
<br/>
<span class="vernacular">Coercion</span><span class="id"> zmod_closedD</span><span class="id"> :</span><span class="id"> zmod_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> nmod_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> zmod_closedN</span><span class="id"> :</span><span class="id"> zmod_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> oppr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> semiring_closedD</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> addr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> semiring_closedM</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> mulr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> smulr_closedM</span><span class="id"> :</span><span class="id"> smulr_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> mulr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> smulr_closedN</span><span class="id"> :</span><span class="id"> smulr_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> oppr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subring_closedB</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> zmod_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subring_closedM</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> smulr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subring_closed_semi</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> semiring_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subsemimod_closedD</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> addr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subsemimod_closedZ</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> scaler_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> linear_closedB</span><span class="id"> :</span><span class="id"> linear_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subr_2closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> submod_closedB</span><span class="id"> :</span><span class="id"> submod_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> zmod_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> submod_closed_semi</span><span class="id"> :</span><span class="id"> submod_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subsemimod_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subsemialg_closedZ</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subsemimod_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subsemialg_closedM</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> semiring_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subalg_closedZ</span><span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> submod_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subalg_closedBM</span><span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subring_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> subalg_closed_semi</span><span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subsemialg_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> divr_closedV</span><span class="id"> :</span><span class="id"> divr_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> invr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> divr_closedM</span><span class="id"> :</span><span class="id"> divr_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> mulr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> sdivr_closed_div</span><span class="id"> :</span><span class="id"> sdivr_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> divr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> sdivr_closedM</span><span class="id"> :</span><span class="id"> sdivr_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> smulr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> divring_closedBM</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subring_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> divring_closed_div</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> sdivr_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> divalg_closedBdiv</span><span class="id"> :</span><span class="id"> divalg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> divring_closed</span>.<br/>
<span class="vernacular">Coercion</span><span class="id"> divalg_closedZ</span><span class="id"> :</span><span class="id"> divalg_closed</span><span class="id"> &gt;-&gt;</span><span class="id"> subalg_closed</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> TermDef</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>.<br/>
<br/>
<span class="vernacular">Inductive</span><span class="id"> term</span><span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
<span class="id">|</span><span class="id"> Var</span><span class="id"> of</span><span class="id"> nat</span><br/>
<span class="id">|</span><span class="id"> Const</span><span class="id"> of</span><span class="id"> R</span><br/>
<span class="id">|</span><span class="id"> NatConst</span><span class="id"> of</span><span class="id"> nat</span><br/>
<span class="id">|</span><span class="id"> Add</span><span class="id"> of</span><span class="id"> term</span><span class="id"> &amp;</span><span class="id"> term</span><br/>
<span class="id">|</span><span class="id"> Opp</span><span class="id"> of</span><span class="id"> term</span><br/>
<span class="id">|</span><span class="id"> NatMul</span><span class="id"> of</span><span class="id"> term</span><span class="id"> &amp;</span><span class="id"> nat</span><br/>
<span class="id">|</span><span class="id"> Mul</span><span class="id"> of</span><span class="id"> term</span><span class="id"> &amp;</span><span class="id"> term</span><br/>
<span class="id">|</span><span class="id"> Inv</span><span class="id"> of</span><span class="id"> term</span><br/>
<span class="id">|</span><span class="id"> Exp</span><span class="id"> of</span><span class="id"> term</span><span class="id"> &amp;</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Inductive</span><span class="id"> formula</span><span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
<span class="id">|</span><span class="id"> Bool</span><span class="id"> of</span><span class="id"> bool</span><br/>
<span class="id">|</span><span class="id"> Equal</span><span class="id"> of</span><span class="id"> term</span><span class="id"> &amp;</span><span class="id"> term</span><br/>
<span class="id">|</span><span class="id"> Unit</span><span class="id"> of</span><span class="id"> term</span><br/>
<span class="id">|</span><span class="id"> And</span><span class="id"> of</span><span class="id"> formula</span><span class="id"> &amp;</span><span class="id"> formula</span><br/>
<span class="id">|</span><span class="id"> Or</span><span class="id"> of</span><span class="id"> formula</span><span class="id"> &amp;</span><span class="id"> formula</span><br/>
<span class="id">|</span><span class="id"> Implies</span><span class="id"> of</span><span class="id"> formula</span><span class="id"> &amp;</span><span class="id"> formula</span><br/>
<span class="id">|</span><span class="id"> Not</span><span class="id"> of</span><span class="id"> formula</span><br/>
<span class="id">|</span><span class="id"> Exists</span><span class="id"> of</span><span class="id"> nat</span><span class="id"> &amp;</span><span class="id"> formula</span><br/>
<span class="id">|</span><span class="id"> Forall</span><span class="id"> of</span><span class="id"> nat</span><span class="id"> &amp;</span><span class="id"> formula</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> TermDef</span>.<br/>
<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span><span class="gallina-kwd"> with</span><span class="id"> term</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span><span class="gallina-kwd"> with</span><span class="id"> formula</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Add</span><span class="id"> {R}</span><span class="id"> t1%_T</span><span class="id"> t2%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Opp</span><span class="id"> {R}</span><span class="id"> t1%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> NatMul</span><span class="id"> {R}</span><span class="id"> t1%_T</span><span class="id"> n%_N</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Mul</span><span class="id"> {R}</span><span class="id"> t1%_T</span><span class="id"> t2%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Inv</span><span class="id"> {R}</span><span class="id"> t1%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Exp</span><span class="id"> {R}</span><span class="id"> t1%_T</span><span class="id"> n%_N</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Equal</span><span class="id"> {R}</span><span class="id"> t1%_T</span><span class="id"> t2%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Unit</span><span class="id"> {R}</span><span class="id"> t1%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> And</span><span class="id"> {R}</span><span class="id"> f1%_T</span><span class="id"> f2%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Or</span><span class="id"> {R}</span><span class="id"> f1%_T</span><span class="id"> f2%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Implies</span><span class="id"> {R}</span><span class="id"> f1%_T</span><span class="id"> f2%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Not</span><span class="id"> {R}</span><span class="id"> f1%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Exists</span><span class="id"> {R}</span><span class="id"> i%_N</span><span class="id"> f1%_T</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Forall</span><span class="id"> {R}</span><span class="id"> i%_N</span><span class="id"> f1%_T</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> Bool</span><span class="id"> {R}</span><span class="id"> b</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> Const</span><span class="id"> {R}</span><span class="id"> x</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> True</span><span class="id"> :=</span> (<span class="id">Bool</span><span class="id"> true</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> False</span><span class="id"> :=</span> (<span class="id">Bool</span><span class="id"> false</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''X_' i&quot;</span><span class="id"> :=</span> (<span class="id">Var</span><span class="id"> _</span><span class="id"> i</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;n %:R&quot;</span><span class="id"> :=</span> (<span class="id">NatConst</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x %:T&quot;</span><span class="id"> :=</span> (<span class="id">Const</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;0&quot;</span><span class="id"> :=</span><span class="id"> 0%:R%T</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span><span class="id"> 1%:R%T</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;+&quot;</span><span class="id"> :=</span><span class="id"> Add</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;- t&quot;</span><span class="id"> :=</span> (<span class="id">Opp</span><span class="id"> t</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;t - u&quot;</span><span class="id"> :=</span> (<span class="id">Add</span><span class="id"> t</span> (<span class="id">-</span><span class="id"> u</span>))<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;*&quot;</span><span class="id"> :=</span><span class="id"> Mul</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;*+&quot;</span><span class="id"> :=</span><span class="id"> NatMul</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;t ^-1&quot;</span><span class="id"> :=</span> (<span class="id">Inv</span><span class="id"> t</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;t / u&quot;</span><span class="id"> :=</span> (<span class="id">Mul</span><span class="id"> t</span><span class="id"> u^-1</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;^+&quot;</span><span class="id"> :=</span><span class="id"> Exp</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;==&quot;</span><span class="id"> :=</span><span class="id"> Equal</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;/\&quot;</span><span class="id"> :=</span><span class="id"> And</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;\/&quot;</span><span class="id"> :=</span><span class="id"> Or</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Infix</span> <span class="id">&quot;==&gt;&quot;</span><span class="id"> :=</span><span class="id"> Implies</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;~ f&quot;</span><span class="id"> :=</span> (<span class="id">Not</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x != y&quot;</span><span class="id"> :=</span> (<span class="id">Not</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>))<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''exists' ''X_' i , f&quot;</span><span class="id"> :=</span> (<span class="id">Exists</span><span class="id"> i</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''forall' ''X_' i , f&quot;</span><span class="id"> :=</span> (<span class="id">Forall</span><span class="id"> i</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Substitution</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> tsubst</span> (<span class="id">t</span><span class="id"> :</span><span class="id"> term</span><span class="id"> R</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> *</span><span class="id"> term</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> t</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> 'X_i</span><span class="id"> =&gt;</span><span class="gallina-kwd"> if</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> s</span>.<span class="id">1</span><span class="gallina-kwd"> then</span><span class="id"> s</span>.<span class="id">2</span><span class="gallina-kwd"> else</span><span class="id"> t</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _%:T</span><span class="id"> |</span><span class="id"> _%:R</span><span class="id"> =&gt;</span><span class="id"> t</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> +</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> tsubst</span><span class="id"> t1</span><span class="id"> s</span><span class="id"> +</span><span class="id"> tsubst</span><span class="id"> t2</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -</span><span class="id"> t1</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> tsubst</span><span class="id"> t1</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> tsubst</span><span class="id"> t1</span><span class="id"> s</span><span class="id"> *+</span><span class="id"> n</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> *</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> tsubst</span><span class="id"> t1</span><span class="id"> s</span><span class="id"> *</span><span class="id"> tsubst</span><span class="id"> t2</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1^-1</span><span class="id"> =&gt;</span> (<span class="id">tsubst</span><span class="id"> t1</span><span class="id"> s</span>)<span class="id">^-1</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> tsubst</span><span class="id"> t1</span><span class="id"> s</span><span class="id"> ^+</span><span class="id"> n</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> fsubst</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> *</span><span class="id"> term</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> f</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> tsubst</span><span class="id"> t1</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> tsubst</span><span class="id"> t2</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Unit</span><span class="id"> t1</span><span class="id"> =&gt;</span><span class="id"> Unit</span> (<span class="id">tsubst</span><span class="id"> t1</span><span class="id"> s</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> fsubst</span><span class="id"> f1</span><span class="id"> s</span><span class="id"> /\</span><span class="id"> fsubst</span><span class="id"> f2</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> fsubst</span><span class="id"> f1</span><span class="id"> s</span><span class="id"> \/</span><span class="id"> fsubst</span><span class="id"> f2</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> fsubst</span><span class="id"> f1</span><span class="id"> s</span><span class="id"> ==&gt;</span><span class="id"> fsubst</span><span class="id"> f2</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f1</span><span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> fsubst</span><span class="id"> f1</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'exists</span><span class="id"> 'X_i,</span><span class="id"> f1</span>)<span class="id"> =&gt;</span><span class="id"> 'exists</span><span class="id"> 'X_i,</span><span class="gallina-kwd"> if</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> s</span>.<span class="id">1</span><span class="gallina-kwd"> then</span><span class="id"> f1</span><span class="gallina-kwd"> else</span><span class="id"> fsubst</span><span class="id"> f1</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'forall</span><span class="id"> 'X_i,</span><span class="id"> f1</span>)<span class="id"> =&gt;</span><span class="id"> 'forall</span><span class="id"> 'X_i,</span><span class="gallina-kwd"> if</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> s</span>.<span class="id">1</span><span class="gallina-kwd"> then</span><span class="id"> f1</span><span class="gallina-kwd"> else</span><span class="id"> fsubst</span><span class="id"> f1</span><span class="id"> s</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Substitution</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> EvalTerm</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> unitRingType</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> eval</span> (<span class="id">e</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span>) (<span class="id">t</span><span class="id"> :</span><span class="id"> term</span><span class="id"> R</span>)<span class="id"> {struct</span><span class="id"> t}</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> t</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'X_i</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> e`_i</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">x%:T</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> x</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">n%:R</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> n%:R</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">t1</span><span class="id"> +</span><span class="id"> t2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> +</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t2</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">-</span><span class="id"> t1</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">t1</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> *+</span><span class="id"> n</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">t1</span><span class="id"> *</span><span class="id"> t2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> *</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1^-1%T</span><span class="id"> =&gt;</span> (<span class="id">eval</span><span class="id"> e</span><span class="id"> t1</span>)<span class="id">^-1</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">t1</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> ^+</span><span class="id"> n</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> same_env</span> (<span class="id">e</span><span class="id"> e'</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span>)<span class="id"> :=</span><span class="id"> nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> =1</span><span class="id"> nth</span><span class="id"> 0</span><span class="id"> e'</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_eval</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> t</span><span class="id"> :</span><span class="id"> same_env</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> -&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t</span><span class="id"> =</span><span class="id"> eval</span><span class="id"> e'</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eq_e;</span><span class="id"> elim:</span><span class="id"> t</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> t1</span><span class="id"> -&gt;</span><span class="id"> //</span><span class="id"> t2</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eval_tsubst</span><span class="id"> e</span><span class="id"> t</span><span class="id"> s</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">eval</span><span class="id"> e</span> (<span class="id">tsubst</span><span class="id"> t</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> eval</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> s</span>.<span class="id">1</span> (<span class="id">eval</span><span class="id"> e</span><span class="id"> s</span>.<span class="id">2</span>))<span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> u;</span><span class="id"> elim:</span><span class="id"> t</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> do</span><span class="id"> 2?[move=&gt;</span><span class="id"> ?</span><span class="id"> -&gt;</span><span class="id"> //]</span><span class="id"> =&gt;</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=;</span><span class="id"> case:</span> (_<span class="id"> ==</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> holds</span> (<span class="id">e</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>)<span class="id"> {struct</span><span class="id"> f}</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> b</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">t1</span><span class="id"> ==</span><span class="id"> t2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> =</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Unit</span><span class="id"> t1</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> \in</span><span class="id"> unit</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">f1</span><span class="id"> /\</span><span class="id"> f2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">f1</span><span class="id"> \/</span><span class="id"> f2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f1</span><span class="id"> -&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">~</span><span class="id"> f1</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'exists</span><span class="id"> 'X_i,</span><span class="id"> f1</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> holds</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> i</span><span class="id"> x</span>)<span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'forall</span><span class="id"> 'X_i,</span><span class="id"> f1</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> holds</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> i</span><span class="id"> x</span>)<span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> same_env_sym</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> :</span><span class="id"> same_env</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> -&gt;</span><span class="id"> same_env</span><span class="id"> e'</span><span class="id"> e</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> fsym</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_holds</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> f</span><span class="id"> :</span><span class="id"> same_env</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> -&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> holds</span><span class="id"> e'</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> sv</span><span class="id"> :=</span><span class="id"> set_nth</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<span class="id">have</span><span class="id"> eq_i</span><span class="id"> i</span><span class="id"> v</span><span class="id"> e1</span><span class="id"> e2:</span><span class="id"> same_env</span><span class="id"> e1</span><span class="id"> e2</span><span class="id"> -&gt;</span><span class="id"> same_env</span> (<span class="id">sv</span><span class="id"> e1</span><span class="id"> i</span><span class="id"> v</span>) (<span class="id">sv</span><span class="id"> e2</span><span class="id"> i</span><span class="id"> v</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> eq_e</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !nth_set_nth</span><span class="id"> /=</span><span class="id"> eq_e</span>.<br/>
<span class="id">elim:</span><span class="id"> f</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> t2</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> eq_e;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">eq_eval</span><span class="id"> _</span><span class="id"> eq_e</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> eq_e;</span><span class="id"> rewrite</span> (<span class="id">eq_eval</span><span class="id"> _</span><span class="id"> eq_e</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> eq_e;</span><span class="id"> move/IH2:</span> (<span class="id">eq_e</span>)<span class="id">;</span><span class="id"> move/IH1:</span><span class="id"> eq_e;</span><span class="id"> tauto</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> eq_e;</span><span class="id"> move/IH2:</span> (<span class="id">eq_e</span>)<span class="id">;</span><span class="id"> move/IH1:</span><span class="id"> eq_e;</span><span class="id"> tauto</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> e</span><span class="id"> e'</span><span class="id"> eq_e</span><span class="id"> f12;</span><span class="id"> move/IH1:</span> (<span class="id">same_env_sym</span><span class="id"> eq_e</span>)<span class="id">;</span><span class="id"> eauto</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> e</span><span class="id"> e';</span><span class="id"> move/same_env_sym;</span><span class="id"> move/IH1;</span><span class="id"> tauto</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> e</span><span class="id"> e';</span><span class="id"> move/</span>(<span class="id">eq_i</span><span class="id"> i</span>)<span class="id">=&gt;</span><span class="id"> eq_e</span><span class="id"> [x</span><span class="id"> f_ex];</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> eauto</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> e</span><span class="id"> e';</span><span class="id"> move/</span>(<span class="id">eq_i</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> holds_fsubst</span><span class="id"> e</span><span class="id"> f</span><span class="id"> i</span><span class="id"> v</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">holds</span><span class="id"> e</span> (<span class="id">fsubst</span><span class="id"> f</span> (<span class="id">i,</span><span class="id"> v%:T</span>)<span class="id">%T</span>)<span class="id"> &lt;-&gt;</span><span class="id"> holds</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> i</span><span class="id"> v</span>)<span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> f</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> do</span><span class="id"> [</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !eval_tsubst</span><br/>
<span class="id">|</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> e;</span><span class="id"> move:</span> (<span class="id">IHf1</span><span class="id"> e</span>) (<span class="id">IHf2</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> tauto</span><br/>
<span class="id">|</span><span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> IHf</span><span class="id"> e;</span><span class="id"> move:</span> (<span class="id">IHf</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> tauto</span><br/>
<span class="id">|</span><span class="id"> move=&gt;</span><span class="id"> j</span><span class="id"> f</span><span class="id"> IHf</span><span class="id"> e]</span>.<br/>
<span class="id">-</span><span class="id"> case</span><span class="id"> eq_ji:</span> (<span class="id">j</span><span class="id"> ==</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> first</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> eq_ji</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> []</span><span class="id"> [x</span><span class="id"> f_x];</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> set_set_nth</span><span class="id"> eqxx</span><span class="gallina-kwd"> in</span><span class="id"> f_x</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="id">split=&gt;</span><span class="id"> []</span><span class="id"> [x</span><span class="id"> f_x];</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> move:</span><span class="id"> f_x;</span><span class="id"> rewrite</span><span class="id"> set_set_nth</span><span class="id"> eq_sym</span><span class="id"> eq_ji;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have:=</span><span class="id"> IHf</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> j</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> tauto</span>.<br/>
<span class="id">case</span><span class="id"> eq_ji:</span> (<span class="id">j</span><span class="id"> ==</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> first</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> eq_ji</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> []</span><span class="id"> f_</span><span class="id"> x;</span><span class="id"> move:</span> (<span class="id">f_</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> set_set_nth</span><span class="id"> eqxx</span>.<br/>
<span class="id">split=&gt;</span><span class="id"> []</span><span class="id"> f_</span><span class="id"> x;</span><span class="id"> move:</span> (<span class="id">IHf</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> j</span><span class="id"> x</span>)) (<span class="id">f_</span><span class="id"> x</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> set_set_nth</span><span class="id"> 1?[i</span><span class="id"> ==</span><span class="id"> j]eq_sym</span><span class="id"> eq_ji;</span><span class="id"> tauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> rterm</span> (<span class="id">t</span><span class="id"> :</span><span class="id"> term</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> t</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _^-1</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> +</span><span class="id"> t2</span><span class="id"> |</span><span class="id"> t1</span><span class="id"> *</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> rterm</span><span class="id"> t1</span><span class="id"> &amp;&amp;</span><span class="id"> rterm</span><span class="id"> t2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -</span><span class="id"> t1</span><span class="id"> |</span><span class="id"> t1</span><span class="id"> *+</span><span class="id"> _</span><span class="id"> |</span><span class="id"> t1</span><span class="id"> ^+</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> rterm</span><span class="id"> t1</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> rformula</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> rterm</span><span class="id"> t1</span><span class="id"> &amp;&amp;</span><span class="id"> rterm</span><span class="id"> t2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Unit</span><span class="id"> t1</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> |</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> |</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> rformula</span><span class="id"> f1</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f1</span><span class="id"> |</span> (<span class="id">'exists</span><span class="id"> 'X__,</span><span class="id"> f1</span>)<span class="id"> |</span> (<span class="id">'forall</span><span class="id"> 'X__,</span><span class="id"> f1</span>)<span class="id"> =&gt;</span><span class="id"> rformula</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> ub_var</span> (<span class="id">t</span><span class="id"> :</span><span class="id"> term</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> t</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> 'X_i</span><span class="id"> =&gt;</span><span class="id"> i</span>.<span class="id">+1</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> +</span><span class="id"> t2</span><span class="id"> |</span><span class="id"> t1</span><span class="id"> *</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> maxn</span> (<span class="id">ub_var</span><span class="id"> t1</span>) (<span class="id">ub_var</span><span class="id"> t2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -</span><span class="id"> t1</span><span class="id"> |</span><span class="id"> t1</span><span class="id"> *+</span><span class="id"> _</span><span class="id"> |</span><span class="id"> t1</span><span class="id"> ^+</span><span class="id"> _</span><span class="id"> |</span><span class="id"> t1^-1</span><span class="id"> =&gt;</span><span class="id"> ub_var</span><span class="id"> t1</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> 0%N</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> to_rterm</span> (<span class="id">t</span><span class="id"> :</span><span class="id"> term</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> R</span>)) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> {struct</span><span class="id"> t}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> t</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1^-1</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">'X_</span>(<span class="id">n</span><span class="id"> +</span><span class="id"> size</span><span class="id"> r1</span>)<span class="id">,</span><span class="id"> rcons</span><span class="id"> r1</span><span class="id"> t1'</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> +</span><span class="id"> t2</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t2',</span><span class="id"> r2</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t2</span><span class="id"> r1</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t1'</span><span class="id"> +</span><span class="id"> t2',</span><span class="id"> r2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -</span><span class="id"> t1</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">-</span><span class="id"> t1',</span><span class="id"> r1</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> *+</span><span class="id"> m</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t1'</span><span class="id"> *+</span><span class="id"> m,</span><span class="id"> r1</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> *</span><span class="id"> t2</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t2',</span><span class="id"> r2</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t2</span><span class="id"> r1</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Mul</span><span class="id"> t1'</span><span class="id"> t2',</span><span class="id"> r2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t1'</span><span class="id"> ^+</span><span class="id"> m,</span><span class="id"> r1</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span> (<span class="id">t,</span><span class="id"> r</span>)<br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> to_rterm_id</span><span class="id"> t</span><span class="id"> r</span><span class="id"> n</span><span class="id"> :</span><span class="id"> rterm</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> to_rterm</span><span class="id"> t</span><span class="id"> r</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">t,</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> t</span><span class="id"> r</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2</span><span class="id"> r</span><span class="id"> n</span><span class="id"> /=</span><span class="id"> /andP[rt1</span><span class="id"> rt2];</span><span class="id"> rewrite</span><span class="id"> {}IHt1</span><span class="id"> //</span><span class="id"> IHt2</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> IHt</span><span class="id"> r</span><span class="id"> n</span><span class="id"> /=</span><span class="id"> rt;</span><span class="id"> rewrite</span><span class="id"> {}IHt</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> IHt</span><span class="id"> r</span><span class="id"> n</span><span class="id"> m</span><span class="id"> /=</span><span class="id"> rt;</span><span class="id"> rewrite</span><span class="id"> {}IHt</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2</span><span class="id"> r</span><span class="id"> n</span><span class="id"> /=</span><span class="id"> /andP[rt1</span><span class="id"> rt2];</span><span class="id"> rewrite</span><span class="id"> {}IHt1</span><span class="id"> //</span><span class="id"> IHt2</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> IHt</span><span class="id"> r</span><span class="id"> n</span><span class="id"> m</span><span class="id"> /=</span><span class="id"> rt;</span><span class="id"> rewrite</span><span class="id"> {}IHt</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> eq0_rform</span><span class="id"> t1</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> m</span><span class="id"> :=</span><span class="id"> ub_var</span><span class="id"> t1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t1',</span><span class="id"> r1</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t1</span><span class="id"> [::]</span><span class="id"> m</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="gallina-kwd"> fix</span><span class="id"> loop</span><span class="id"> r</span><span class="id"> i</span><span class="id"> :=</span><span class="gallina-kwd"> match</span><span class="id"> r</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> [::]</span><span class="id"> =&gt;</span><span class="id"> t1'</span><span class="id"> ==</span><span class="id"> 0</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t</span><span class="id"> ::</span><span class="id"> r'</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> f</span><span class="id"> :=</span><span class="id"> 'X_i</span><span class="id"> *</span><span class="id"> t</span><span class="id"> ==</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> t</span><span class="id"> *</span><span class="id"> 'X_i</span><span class="id"> ==</span><span class="id"> 1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">'forall</span><span class="id"> 'X_i,</span> (<span class="id">f</span><span class="id"> \/</span><span class="id"> 'X_i</span><span class="id"> ==</span><span class="id"> t</span><span class="id"> /\</span><span class="id"> ~</span> (<span class="id">'exists</span><span class="id"> 'X_i,</span> <span class="id"> f</span>))<span class="id"> ==&gt;</span><span class="id"> loop</span><span class="id"> r'</span><span class="id"> i</span>.<span class="id">+1</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">in</span><span class="id"> loop</span><span class="id"> r1</span><span class="id"> m</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> to_rform</span><span class="id"> f</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> f</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> eq0_rform</span> (<span class="id">t1</span><span class="id"> -</span><span class="id"> t2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Unit</span><span class="id"> t1</span><span class="id"> =&gt;</span><span class="id"> eq0_rform</span> (<span class="id">t1</span><span class="id"> *</span><span class="id"> t1^-1</span><span class="id"> -</span><span class="id"> 1</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> to_rform</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> to_rform</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> =&gt;</span> <span class="id"> to_rform</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> to_rform</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> to_rform</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> to_rform</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f1</span><span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> to_rform</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'exists</span><span class="id"> 'X_i,</span><span class="id"> f1</span>)<span class="id"> =&gt;</span><span class="id"> 'exists</span><span class="id"> 'X_i,</span><span class="id"> to_rform</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'forall</span><span class="id"> 'X_i,</span><span class="id"> f1</span>)<span class="id"> =&gt;</span><span class="id"> 'forall</span><span class="id"> 'X_i,</span><span class="id"> to_rform</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> to_rform_rformula</span><span class="id"> f</span><span class="id"> :</span><span class="id"> rformula</span> (<span class="id">to_rform</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">suffices</span><span class="id"> eq0_ring</span><span class="id"> t1:</span><span class="id"> rformula</span> (<span class="id">eq0_rform</span><span class="id"> t1</span>)<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> f</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> f1</span><span class="id"> -&gt;</span>.<br/>
<span class="id">rewrite</span><span class="id"> /eq0_rform;</span><span class="id"> move:</span> (<span class="id">ub_var</span><span class="id"> t1</span>)<span class="id"> =&gt;</span><span class="id"> m;</span><span class="id"> set</span><span class="id"> tr</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> m</span>.<br/>
<span class="id">suffices:</span><span class="id"> all</span><span class="id"> rterm</span> (<span class="id">tr</span>.<span class="id">1</span><span class="id"> ::</span><span class="id"> tr</span>.<span class="id">2</span>).<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> tr</span><span class="id"> =&gt;</span><span class="id"> {}t1</span><span class="id"> r</span><span class="id"> /=</span><span class="id"> /andP[t1_r]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> [|t</span><span class="id"> r</span><span class="id"> IHr]</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ?andbT</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /andP[-&gt;];</span><span class="id"> apply:</span><span class="id"> IHr</span>.<br/>
<span class="id">have:</span><span class="id"> all</span><span class="id"> rterm</span><span class="id"> [::]</span><span class="gallina-kwd"> by</span><span class="id"> []</span>.<br/>
<span class="id">rewrite</span><span class="id"> {}/tr;</span><span class="id"> elim:</span><span class="id"> t1</span><span class="id"> [::]</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="id">move/IHt1;</span><span class="id"> case:</span><span class="id"> to_rterm</span><span class="id"> =&gt;</span><span class="id"> {r</span><span class="id"> IHt1}t1</span><span class="id"> r</span><span class="id"> /=</span><span class="id"> /andP[t1_r]</span>.<br/>
&nbsp;&nbsp;<span class="id">move/IHt2;</span><span class="id"> case:</span><span class="id"> to_rterm</span><span class="id"> =&gt;</span><span class="id"> {r</span><span class="id"> IHt2}t2</span><span class="id"> r</span><span class="id"> /=</span><span class="id"> /andP[t2_r]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> t1_r</span><span class="id"> t2_r</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> r</span><span class="id"> /IHt1;</span><span class="id"> case:</span><span class="id"> to_rterm</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> n</span><span class="id"> r</span><span class="id"> /IHt1;</span><span class="id"> case:</span><span class="id"> to_rterm</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="id">move/IHt1;</span><span class="id"> case:</span><span class="id"> to_rterm</span><span class="id"> =&gt;</span><span class="id"> {r</span><span class="id"> IHt1}t1</span><span class="id"> r</span><span class="id"> /=</span><span class="id"> /andP[t1_r]</span>.<br/>
&nbsp;&nbsp;<span class="id">move/IHt2;</span><span class="id"> case:</span><span class="id"> to_rterm</span><span class="id"> =&gt;</span><span class="id"> {r</span><span class="id"> IHt2}t2</span><span class="id"> r</span><span class="id"> /=</span><span class="id"> /andP[t2_r]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> t1_r</span><span class="id"> t2_r</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/IHt1;</span><span class="id"> case:</span><span class="id"> to_rterm</span><span class="id"> =&gt;</span><span class="id"> {r</span><span class="id"> IHt1}t1</span><span class="id"> r</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> all_rcons</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> n</span><span class="id"> r</span><span class="id"> /IHt1;</span><span class="id"> case:</span><span class="id"> to_rterm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> to_rformP</span><span class="id"> e</span><span class="id"> f</span><span class="id"> :</span><span class="id"> holds</span><span class="id"> e</span> (<span class="id">to_rform</span><span class="id"> f</span>)<span class="id"> &lt;-&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">suffices{e</span><span class="id"> f}</span><span class="id"> equal0_equiv</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> t2:</span><br/>
&nbsp;&nbsp;<span class="id">holds</span><span class="id"> e</span> (<span class="id">eq0_rform</span> (<span class="id">t1</span><span class="id"> -</span><span class="id"> t2</span>))<span class="id"> &lt;-&gt;</span> (<span class="id">eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t2</span>).<br/>
<span class="id">-</span><span class="id"> elim:</span><span class="id"> f</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> try</span><span class="id"> tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> t2</span><span class="id"> e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> [move/equal0_equiv/eqP</span><span class="id"> |</span><span class="id"> move/eqP/equal0_equiv]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> unitrE;</span><span class="id"> apply:</span><span class="id"> equal0_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> e;</span><span class="id"> move:</span> (<span class="id">IHf1</span><span class="id"> e</span>) (<span class="id">IHf2</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> e;</span><span class="id"> move:</span> (<span class="id">IHf1</span><span class="id"> e</span>) (<span class="id">IHf2</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> e;</span><span class="id"> move:</span> (<span class="id">IHf1</span><span class="id"> e</span>) (<span class="id">IHf2</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> e;</span><span class="id"> move:</span> (<span class="id">IHf1</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> e;</span><span class="id"> split=&gt;</span><span class="id"> []</span><span class="id"> [x]</span><span class="id"> /IHf1;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> e;</span><span class="id"> split=&gt;</span><span class="id"> Hx</span><span class="id"> x;</span><span class="id"> apply/IHf1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">add0r</span> (<span class="id">eval</span><span class="id"> e</span><span class="id"> t2</span>))<span class="id"> -</span>(<span class="id">can2_eq</span> (<span class="id">subrK</span><span class="id"> _</span>) (<span class="id">addrK</span><span class="id"> _</span>)).<br/>
<span class="id">rewrite</span><span class="id"> -/</span>(<span class="id">eval</span><span class="id"> e</span> (<span class="id">t1</span><span class="id"> -</span><span class="id"> t2</span>))<span class="id">;</span><span class="id"> move:</span> (<span class="id">t1</span><span class="id"> -</span><span class="id"> t2</span>)<span class="id">%T</span><span class="id"> =&gt;</span><span class="id"> {t1</span><span class="id"> t2}</span><span class="id"> t</span>.<br/>
<span class="id">have</span><span class="id"> sub_var_tsubst</span><span class="id"> s</span><span class="id"> t0:</span><span class="id"> s</span>.<span class="id">1</span><span class="id"> &gt;=</span><span class="id"> ub_var</span><span class="id"> t0</span><span class="id"> -&gt;</span><span class="id"> tsubst</span><span class="id"> t0</span><span class="id"> s</span><span class="id"> =</span><span class="id"> t0</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> t0</span><span class="id"> {t}</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n;</span><span class="id"> case:</span><span class="id"> ltngtP</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2;</span><span class="id"> rewrite</span><span class="id"> geq_max</span><span class="id"> =&gt;</span><span class="id"> /andP[/IHt1-&gt;</span><span class="id"> /IHt2-&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> /IHt1-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> n</span><span class="id"> /IHt1-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2;</span><span class="id"> rewrite</span><span class="id"> geq_max</span><span class="id"> =&gt;</span><span class="id"> /andP[/IHt1-&gt;</span><span class="id"> /IHt2-&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> /IHt1-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> n</span><span class="id"> /IHt1-&gt;</span>.<br/>
<span class="id">pose</span><span class="gallina-kwd"> fix</span><span class="id"> rsub</span><span class="id"> t'</span><span class="id"> m</span><span class="id"> r</span><span class="id"> :</span><span class="id"> term</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> r</span><span class="id"> is</span><span class="id"> u</span><span class="id"> ::</span><span class="id"> r'</span><span class="gallina-kwd"> then</span><span class="id"> tsubst</span> (<span class="id">rsub</span><span class="id"> t'</span><span class="id"> m</span>.<span class="id">+1</span><span class="id"> r'</span>) (<span class="id">m,</span><span class="id"> u^-1</span>)<span class="id">%T</span><span class="gallina-kwd"> else</span><span class="id"> t'</span>.<br/>
<span class="id">pose</span><span class="gallina-kwd"> fix</span><span class="id"> ub_sub</span><span class="id"> m</span><span class="id"> r</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> r</span><span class="id"> is</span><span class="id"> u</span><span class="id"> ::</span><span class="id"> r'</span><span class="gallina-kwd"> then</span><span class="id"> ub_var</span><span class="id"> u</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> /\</span><span class="id"> ub_sub</span><span class="id"> m</span>.<span class="id">+1</span><span class="id"> r'</span><span class="gallina-kwd"> else</span><span class="id"> true</span>.<br/>
<span class="id">suffices{t}</span><span class="id"> rsub_to_r</span><span class="id"> t</span><span class="id"> r0</span><span class="id"> m:</span><span class="id"> m</span><span class="id"> &gt;=</span><span class="id"> ub_var</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> ub_sub</span><span class="id"> m</span><span class="id"> r0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">t',</span><span class="id"> r</span>)<span class="id"> :=</span><span class="id"> to_rterm</span><span class="id"> t</span><span class="id"> r0</span><span class="id"> m</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">[/\</span><span class="id"> take</span> (<span class="id">size</span><span class="id"> r0</span>)<span class="id"> r</span><span class="id"> =</span><span class="id"> r0,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ub_var</span><span class="id"> t'</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> +</span><span class="id"> size</span><span class="id"> r,</span><span class="id"> ub_sub</span><span class="id"> m</span><span class="id"> r</span><span class="id"> &amp;</span><span class="id"> rsub</span><span class="id"> t'</span><span class="id"> m</span><span class="id"> r</span><span class="id"> =</span><span class="id"> t]</span>.<br/>
<span class="id">-</span><span class="id"> have:=</span><span class="id"> rsub_to_r</span><span class="id"> t</span><span class="id"> [::]</span><span class="id"> _</span> (<span class="id">leqnn</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /eq0_rform</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">to_rterm</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> [t1'</span><span class="id"> r1]</span><span class="id"> [//|_</span><span class="id"> _</span><span class="id"> ub_r1</span><span class="id"> def_t]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{2}def_t</span><span class="id"> {def_t}</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> r1</span> (<span class="id">ub_var</span><span class="id"> t</span>)<span class="id"> e</span><span class="id"> ub_r1</span><span class="id"> =&gt;</span><span class="id"> [|u</span><span class="id"> r1</span><span class="id"> IHr1]</span><span class="id"> m</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> [_|[ub_u</span><span class="id"> ub_r1]]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> /eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> eval_tsubst</span><span class="id"> /=;</span><span class="id"> set</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> u;</span><span class="id"> split=&gt;</span><span class="id"> t_eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/IHr1=&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> t_eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> eqxx</span><span class="id"> -</span>(<span class="id">eval_tsubst</span><span class="id"> e</span><span class="id"> u</span> (<span class="id">m,</span><span class="id"> Const</span><span class="id"> _</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sub_var_tsubst</span><span class="id"> //=</span><span class="id"> -/y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case</span><span class="id"> Uy:</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id">;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulVr</span><span class="id"> ?divrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split=&gt;</span><span class="id"> [|[z]];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_out</span><span class="id"> ?Uy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -!</span>(<span class="id">eval_tsubst</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">m,</span><span class="id"> Const</span><span class="id"> _</span>))<span class="id"> !sub_var_tsubst</span><span class="id"> //</span><span class="id"> -/y</span><span class="id"> =&gt;</span><span class="id"> yz1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/unitrP:</span><span class="id"> Uy;</span><span class="gallina-kwd"> exists</span><span class="id"> z</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> def_x;</span><span class="id"> apply/IHr1=&gt;</span><span class="id"> //;</span><span class="id"> suff</span><span class="id"> -&gt;:</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y^-1</span><span class="gallina-kwd"> by</span><span class="id"> [];</span><span class="id"> move:</span><span class="id"> def_x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> eqxx</span><span class="id"> -</span>(<span class="id">eval_tsubst</span><span class="id"> e</span><span class="id"> u</span> (<span class="id">m,</span><span class="id"> Const</span><span class="id"> _</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sub_var_tsubst</span><span class="id"> //=</span><span class="id"> -/y;</span><span class="id"> case=&gt;</span><span class="id"> [[xy1</span><span class="id"> yx1]</span><span class="id"> |</span><span class="id"> [xy</span><span class="id"> nUy]]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[y^-1]mul1r</span><span class="id"> -[1]xy1</span><span class="id"> mulrK</span><span class="id"> //;</span><span class="id"> apply/unitrP;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> invr_out</span><span class="id"> //;</span><span class="id"> apply/unitrP=&gt;</span><span class="id"> [[z</span><span class="id"> yz1]];</span><span class="id"> case:</span><span class="id"> nUy;</span><span class="gallina-kwd"> exists</span><span class="id"> z</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> eqxx</span><span class="id"> -!</span>(<span class="id">eval_tsubst</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">m,</span><span class="id"> _%:T</span>)<span class="id">%T</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !sub_var_tsubst</span>.<br/>
<span class="id">have</span><span class="id"> rsub_id</span><span class="id"> r</span><span class="id"> t0</span><span class="id"> n:</span><span class="id"> ub_var</span><span class="id"> t0</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> rsub</span><span class="id"> t0</span><span class="id"> n</span><span class="id"> r</span><span class="id"> =</span><span class="id"> t0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> t1</span><span class="id"> r</span><span class="id"> IHr</span><span class="id"> n</span><span class="id"> let0n;</span><span class="id"> rewrite</span><span class="id"> IHr</span><span class="id"> ?sub_var_tsubst</span><span class="id"> ?leqW</span>.<br/>
<span class="id">have</span><span class="id"> rsub_acc</span><span class="id"> r</span><span class="id"> s</span><span class="id"> t1</span><span class="id"> m1:</span><br/>
&nbsp;&nbsp;<span class="id">ub_var</span><span class="id"> t1</span><span class="id"> &lt;=</span><span class="id"> m1</span><span class="id"> +</span><span class="id"> size</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> rsub</span><span class="id"> t1</span><span class="id"> m1</span> (<span class="id">r</span><span class="id"> ++</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> rsub</span><span class="id"> t1</span><span class="id"> m1</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> r</span><span class="id"> t1</span><span class="id"> m1</span><span class="id"> =&gt;</span><span class="id"> [|t1</span><span class="id"> r</span><span class="id"> IHr]</span><span class="id"> t2</span><span class="id"> m1</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addn0;</span><span class="id"> apply:</span><span class="id"> rsub_id</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> letmr;</span><span class="id"> rewrite</span><span class="id"> IHr</span><span class="id"> ?addSnnS</span>.<br/>
<span class="id">elim:</span><span class="id"> t</span><span class="id"> r0</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> try</span><span class="id"> do</span><span class="id"> [</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> r</span><span class="id"> m</span><span class="id"> hlt</span><span class="id"> hub;</span><span class="id"> rewrite</span><span class="id"> take_size</span> (<span class="id">ltn_addr</span><span class="id"> _</span><span class="id"> hlt</span>)<span class="id"> rsub_id</span><br/>
<span class="id">|</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> r</span><span class="id"> m</span><span class="id"> hlt</span><span class="id"> hub;</span><span class="id"> rewrite</span><span class="id"> leq0n</span><span class="id"> take_size</span><span class="id"> rsub_id</span><br/>
<span class="id">|</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> t2</span><span class="id"> IHt2</span><span class="id"> r</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> geq_max;</span><span class="id"> case/andP=&gt;</span><span class="id"> hub1</span><span class="id"> hub2</span><span class="id"> hmr;</span><br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> to_rterm</span><span class="id"> {hub1</span><span class="id"> hmr}</span>(<span class="id">IHt1</span><span class="id"> r</span><span class="id"> m</span><span class="id"> hub1</span><span class="id"> hmr</span>)<span class="id"> =&gt;</span><span class="id"> t1'</span><span class="id"> r1;</span><br/>
&nbsp;&nbsp;<span class="id">case=&gt;</span><span class="id"> htake1</span><span class="id"> hub1'</span><span class="id"> hsub1</span><span class="id"> &lt;-;</span><br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> to_rterm</span><span class="id"> {IHt2</span><span class="id"> hub2</span><span class="id"> hsub1}</span>(<span class="id">IHt2</span><span class="id"> r1</span><span class="id"> m</span><span class="id"> hub2</span><span class="id"> hsub1</span>)<span class="id"> =&gt;</span><span class="id"> t2'</span><span class="id"> r2</span><span class="id"> /=;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> geq_max;</span><span class="id"> case=&gt;</span><span class="id"> htake2</span><span class="id"> -&gt;</span><span class="id"> hsub2</span><span class="id"> /=</span><span class="id"> &lt;-;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{1</span><span class="id"> 2}</span>(<span class="id">cat_take_drop</span> (<span class="id">size</span><span class="id"> r1</span>)<span class="id"> r2</span>)<span class="id"> htake2;</span><span class="id"> set</span><span class="id"> r3</span><span class="id"> :=</span><span class="id"> drop</span><span class="id"> _</span><span class="id"> _;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> size_cat</span><span class="id"> addnA</span> (<span class="id">leq_trans</span><span class="id"> _</span> (<span class="id">leq_addr</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> //;</span><br/>
&nbsp;&nbsp;<span class="id">split=&gt;</span><span class="id"> {hsub2}//;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">first</span><span class="gallina-kwd"> by</span><span class="id"> [rewrite</span><span class="id"> takel_cat</span><span class="id"> //</span><span class="id"> -htake1</span><span class="id"> size_take</span><span class="id"> geq_min</span><span class="id"> leqnn</span><span class="id"> orbT];</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">rsub_acc</span><span class="id"> r1</span><span class="id"> r3</span><span class="id"> t1'</span>)<span class="id"> {hub1'}//</span><span class="id"> -{htake1}htake2</span><span class="id"> {r3}cat_take_drop;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> r2</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> u</span><span class="id"> r2</span><span class="id"> IHr2</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> IHr2</span><br/>
<span class="id">|</span><span class="id"> do</span><span class="id"> [</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> r</span><span class="id"> m;</span><span class="id"> do</span><span class="id"> 2!move=&gt;</span><span class="id"> /IHt1{}IHt1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> IHt1</span><span class="id"> n</span><span class="id"> r</span><span class="id"> m;</span><span class="id"> do</span><span class="id"> 2!move=&gt;</span><span class="id"> /IHt1{}IHt1];</span><br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> to_rterm</span><span class="id"> IHt1</span><span class="id"> =&gt;</span><span class="id"> t1'</span><span class="id"> r1</span><span class="id"> [-&gt;</span><span class="id"> -&gt;</span><span class="id"> hsub1</span><span class="id"> &lt;-];</span><span class="id"> split=&gt;</span><span class="id"> {hsub1}//;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> r1</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> u</span><span class="id"> r1</span><span class="id"> IHr1</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> IHr1]</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> t1</span><span class="id"> IH</span><span class="id"> r</span><span class="id"> m</span><span class="id"> letm</span><span class="id"> /IH</span><span class="id"> {IH}</span><span class="id"> /</span>(_<span class="id"> letm</span>)<span class="id"> {letm}</span>.<br/>
<span class="id">case:</span><span class="id"> to_rterm</span><span class="id"> =&gt;</span><span class="id"> t1'</span><span class="id"> r1</span><span class="id"> /=</span><span class="id"> [def_r</span><span class="id"> ub_t1'</span><span class="id"> ub_r1</span><span class="id"> &lt;-]</span>.<br/>
<span class="id">rewrite</span><span class="id"> size_rcons</span><span class="id"> addnS</span><span class="id"> leqnn</span><span class="id"> -{1}cats1</span><span class="id"> takel_cat</span><span class="id"> ?def_r;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -def_r</span><span class="id"> size_take</span><span class="id"> geq_min</span><span class="id"> leqnn</span><span class="id"> orbT</span>.<br/>
<span class="id">elim:</span><span class="id"> r1</span><span class="id"> m</span><span class="id"> ub_r1</span><span class="id"> ub_t1'</span><span class="id"> {def_r}</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|u</span><span class="id"> r1</span><span class="id"> IHr1]</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> [_|[-&gt;]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addn0</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -addSnnS</span><span class="id"> =&gt;</span><span class="id"> /IHr1</span><span class="id"> IH</span><span class="id"> /IH[_</span><span class="id"> _</span><span class="id"> ub_r1</span><span class="id"> -&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> qf_form</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> _</span><span class="id"> |</span><span class="id"> _</span><span class="id"> ==</span><span class="id"> _</span><span class="id"> |</span><span class="id"> Unit</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> |</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> |</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> qf_form</span><span class="id"> f1</span><span class="id"> &amp;&amp;</span><span class="id"> qf_form</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f1</span><span class="id"> =&gt;</span><span class="id"> qf_form</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> qf_eval</span><span class="id"> e</span><span class="id"> :=</span><span class="gallina-kwd"> fix</span><span class="id"> loop</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> bool</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> b</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> t2</span><span class="id"> =&gt;</span> (<span class="id">eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t2</span>)<span class="id">%bool</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Unit</span><span class="id"> t1</span><span class="id"> =&gt;</span><span class="id"> eval</span><span class="id"> e</span><span class="id"> t1</span><span class="id"> \in</span><span class="id"> unit</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> loop</span><span class="id"> f1</span><span class="id"> &amp;&amp;</span><span class="id"> loop</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> =&gt;</span><span class="id"> loop</span><span class="id"> f1</span><span class="id"> ||</span><span class="id"> loop</span><span class="id"> f2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="id">loop</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> loop</span><span class="id"> f2</span>)<span class="id">%bool</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f1</span><span class="id"> =&gt;</span><span class="id"> ~~</span><span class="id"> loop</span><span class="id"> f1</span><br/>
&nbsp;&nbsp;<span class="id">|_</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> qf_evalP</span><span class="id"> e</span><span class="id"> f</span><span class="id"> :</span><span class="id"> qf_form</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> reflect</span> (<span class="id">holds</span><span class="id"> e</span><span class="id"> f</span>) (<span class="id">qf_eval</span><span class="id"> e</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> f</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> try</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> apply:</span><span class="id"> idP</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> t2</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> eqP</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> /=</span><span class="id"> /andP[/IHf1[]</span><span class="id"> f1T];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> right;</span><span class="id"> case</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/IHf2;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right;</span><span class="id"> case]</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> /=</span><span class="id"> /andP[/IHf1[]</span><span class="id"> f1F];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> do</span><span class="id"> 2</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/IHf2;</span><span class="id"> [left;</span><span class="id"> right</span><span class="id"> |</span><span class="id"> right;</span><span class="id"> case]</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> f2</span><span class="id"> IHf2</span><span class="id"> /=</span><span class="id"> /andP[/IHf1[]</span><span class="id"> f1T];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/IHf2;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right;</span><span class="id"> move/</span>(_<span class="id"> f1T</span>)<span class="id">]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IHf1</span><span class="id"> /IHf1[];</span><span class="id"> [right</span><span class="id"> |</span><span class="id"> left]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> bc</span><span class="id"> :</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> R</span>)<span class="id"> *</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> R</span>).<br/>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> and_dnf</span><span class="id"> bcs1</span><span class="id"> bcs2</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\big[cat/nil]_</span>(<span class="id">bc1</span><span class="id"> &lt;-</span><span class="id"> bcs1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">map</span> (<span class="gallina-kwd">fun</span><span class="id"> bc2</span><span class="id"> =&gt;</span> (<span class="id">bc1</span>.<span class="id">1</span><span class="id"> ++</span><span class="id"> bc2</span>.<span class="id">1,</span><span class="id"> bc1</span>.<span class="id">2</span><span class="id"> ++</span><span class="id"> bc2</span>.<span class="id">2</span>))<span class="id"> bcs2</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> qf_to_dnf</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>) (<span class="id">neg</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> {struct</span><span class="id"> f}</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> Bool</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="gallina-kwd"> if</span><span class="id"> b</span> (<span class="id">+</span>)<span class="id"> neg</span><span class="gallina-kwd"> then</span><span class="id"> [::</span> (<span class="id">[::],</span><span class="id"> [::]</span>)<span class="id">]</span><span class="gallina-kwd"> else</span><span class="id"> [::]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> t1</span><span class="id"> ==</span><span class="id"> t2</span><span class="id"> =&gt;</span><span class="id"> [::</span><span class="gallina-kwd"> if</span><span class="id"> neg</span><span class="gallina-kwd"> then</span> (<span class="id">[::],</span><span class="id"> [::</span><span class="id"> t1</span><span class="id"> -</span><span class="id"> t2]</span>)<span class="gallina-kwd"> else</span> (<span class="id">[::</span><span class="id"> t1</span><span class="id"> -</span><span class="id"> t2],</span><span class="id"> [::]</span>)<span class="id">]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">if</span><span class="id"> neg</span><span class="gallina-kwd"> then</span><span class="id"> cat</span><span class="gallina-kwd"> else</span><span class="id"> and_dnf</span>)<span class="id"> [rec</span><span class="id"> f1,</span><span class="id"> neg]</span><span class="id"> [rec</span><span class="id"> f2,</span><span class="id"> neg]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">if</span><span class="id"> neg</span><span class="gallina-kwd"> then</span><span class="id"> and_dnf</span><span class="gallina-kwd"> else</span><span class="id"> cat</span>)<span class="id"> [rec</span><span class="id"> f1,</span><span class="id"> neg]</span><span class="id"> [rec</span><span class="id"> f2,</span><span class="id"> neg]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">if</span><span class="id"> neg</span><span class="gallina-kwd"> then</span><span class="id"> and_dnf</span><span class="gallina-kwd"> else</span><span class="id"> cat</span>)<span class="id"> [rec</span><span class="id"> f1,</span><span class="id"> ~~</span><span class="id"> neg]</span><span class="id"> [rec</span><span class="id"> f2,</span><span class="id"> neg]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f1</span><span class="id"> =&gt;</span><span class="id"> [rec</span><span class="id"> f1,</span><span class="id"> ~~</span><span class="id"> neg]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span> <span class="gallina-kwd"> if</span><span class="id"> neg</span><span class="gallina-kwd"> then</span><span class="id"> [::</span> (<span class="id">[::],</span><span class="id"> [::]</span>)<span class="id">]</span><span class="gallina-kwd"> else</span><span class="id"> [::]</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span><span class="gallina-kwd"> where</span> <span class="id">&quot;[ 'rec' f , neg ]&quot;</span><span class="id"> :=</span> (<span class="id">qf_to_dnf</span><span class="id"> f</span><span class="id"> neg</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> dnf_to_form</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> pos_lit</span><span class="id"> t</span><span class="id"> :=</span><span class="id"> And</span> (<span class="id">t</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> neg_lit</span><span class="id"> t</span><span class="id"> :=</span><span class="id"> And</span> (<span class="id">t</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> cls</span><span class="id"> bc</span><span class="id"> :=</span><span class="id"> Or</span> (<span class="id">foldr</span><span class="id"> pos_lit</span><span class="id"> True</span><span class="id"> bc</span>.<span class="id">1</span><span class="id"> /\</span><span class="id"> foldr</span><span class="id"> neg_lit</span><span class="id"> True</span><span class="id"> bc</span>.<span class="id">2</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">foldr</span><span class="id"> cls</span><span class="id"> False</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cat_dnfP</span><span class="id"> e</span><span class="id"> bcs1</span><span class="id"> bcs2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qf_eval</span><span class="id"> e</span> (<span class="id">dnf_to_form</span> (<span class="id">bcs1</span><span class="id"> ++</span><span class="id"> bcs2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> qf_eval</span><span class="id"> e</span> (<span class="id">dnf_to_form</span><span class="id"> bcs1</span><span class="id"> \/</span><span class="id"> dnf_to_form</span><span class="id"> bcs2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> bcs1</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> bc1</span><span class="id"> bcs1</span><span class="id"> IH1;</span><span class="id"> rewrite</span><span class="id"> -orbA;</span><span class="id"> congr</span><span class="id"> orb;</span><span class="id"> rewrite</span><span class="id"> IH1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and_dnfP</span><span class="id"> e</span><span class="id"> bcs1</span><span class="id"> bcs2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qf_eval</span><span class="id"> e</span> (<span class="id">dnf_to_form</span> (<span class="id">and_dnf</span><span class="id"> bcs1</span><span class="id"> bcs2</span>))<br/>
&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> qf_eval</span><span class="id"> e</span> (<span class="id">dnf_to_form</span><span class="id"> bcs1</span><span class="id"> /\</span><span class="id"> dnf_to_form</span><span class="id"> bcs2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> bcs1</span><span class="id"> =&gt;</span><span class="id"> [|bc1</span><span class="id"> bcs1</span><span class="id"> IH1]</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /and_dnf</span><span class="id"> big_nil</span>.<br/>
<span class="id">rewrite</span><span class="id"> /and_dnf</span><span class="id"> big_cons</span><span class="id"> -/</span>(<span class="id">and_dnf</span><span class="id"> bcs1</span><span class="id"> bcs2</span>)<span class="id"> cat_dnfP</span> <span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> {}IH1</span><span class="id"> /=</span><span class="id"> andb_orl;</span><span class="id"> congr</span><span class="id"> orb</span>.<br/>
<span class="id">elim:</span><span class="id"> bcs2</span><span class="id"> bc1</span><span class="id"> {bcs1}</span><span class="id"> =&gt;</span><span class="id"> [|bc2</span><span class="id"> bcs2</span><span class="id"> IH]</span><span class="id"> bc1</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> andbF</span>.<br/>
<span class="id">rewrite</span><span class="id"> {}IH</span><span class="id"> /=</span><span class="id"> andb_orr;</span><span class="id"> congr</span><span class="id"> orb</span><span class="id"> =&gt;</span><span class="id"> {bcs2}</span>.<br/>
<span class="id">suffices</span><span class="id"> aux</span> (<span class="id">l1</span><span class="id"> l2</span><span class="id"> :</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> R</span>))<span class="id"> g</span><span class="id"> :</span><span class="gallina-kwd"> let</span><span class="id"> redg</span><span class="id"> :=</span><span class="id"> foldr</span> (<span class="id">And</span><span class="id"> \o</span><span class="id"> g</span>)<span class="id"> True</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">qf_eval</span><span class="id"> e</span> (<span class="id">redg</span> (<span class="id">l1</span><span class="id"> ++</span><span class="id"> l2</span>))<span class="id"> =</span><span class="id"> qf_eval</span><span class="id"> e</span> (<span class="id">redg</span><span class="id"> l1</span><span class="id"> /\</span><span class="id"> redg</span><span class="id"> l2</span>)<span class="id">%T</span>.<br/>
<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> 2!aux</span><span class="id"> /=</span><span class="id"> 2!andbA</span><span class="id"> -andbA</span><span class="id"> -andbCA</span><span class="id"> andbA</span><span class="id"> andbCA</span><span class="id"> andbA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> l1</span><span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> t1</span><span class="id"> l1</span><span class="id"> IHl1]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> -andbA</span><span class="id"> IHl1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> qf_to_dnfP</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> qev</span><span class="id"> f</span><span class="id"> b</span><span class="id"> :=</span><span class="id"> qf_eval</span><span class="id"> e</span> (<span class="id">dnf_to_form</span> (<span class="id">qf_to_dnf</span><span class="id"> f</span><span class="id"> b</span>))<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> f,</span><span class="id"> qf_form</span><span class="id"> f</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> qev</span><span class="id"> f</span><span class="id"> false</span><span class="id"> =</span><span class="id"> qf_eval</span><span class="id"> e</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> qev;</span><span class="id"> have</span><span class="id"> qevT</span><span class="id"> f:</span><span class="id"> qev</span><span class="id"> f</span><span class="id"> true</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> qev</span><span class="id"> f</span><span class="id"> false</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> {}/qev;</span><span class="id"> elim:</span><span class="id"> f</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> do</span><span class="id"> [by</span><span class="id"> case</span><span class="id"> |</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> |</span><span class="id"> ]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> t2;</span><span class="id"> rewrite</span><span class="id"> !andbT</span><span class="id"> !orbF</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> and_dnfP</span><span class="id"> cat_dnfP</span><span class="id"> negb_and</span><span class="id"> -IH1</span><span class="id"> -IH2</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> and_dnfP</span><span class="id"> cat_dnfP</span><span class="id"> negb_or</span><span class="id"> -IH1</span><span class="id"> -IH2</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> and_dnfP</span><span class="id"> cat_dnfP</span><span class="id"> /=</span><span class="id"> negb_or</span><span class="id"> IH1</span><span class="id"> -IH2</span><span class="id"> negbK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> negbK</span>.<br/>
<span class="id">rewrite</span><span class="id"> /qev;</span><span class="id"> elim=&gt;</span><span class="id"> //=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> t2</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> subr_eq0</span><span class="id"> !andbT</span><span class="id"> orbF</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2;</span><span class="id"> rewrite</span><span class="id"> andbCA</span><span class="id"> -andbA</span><span class="id"> andbCA</span><span class="id"> andbA;</span><span class="id"> case/andP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> and_dnfP</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> /IH1-&gt;</span><span class="id"> /IH2-&gt;</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2;</span><span class="id"> rewrite</span><span class="id"> andbCA</span><span class="id"> -andbA</span><span class="id"> andbCA</span><span class="id"> andbA;</span><span class="id"> case/andP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cat_dnfP</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> /IH1-&gt;</span><span class="id"> =&gt;</span><span class="id"> /IH2-&gt;</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2;</span><span class="id"> rewrite</span><span class="id"> andbCA</span><span class="id"> -andbA</span><span class="id"> andbCA</span><span class="id"> andbA;</span><span class="id"> case/andP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cat_dnfP</span><span class="id"> /=</span><span class="id"> [qf_eval</span><span class="id"> _</span><span class="id"> _]qevT</span><span class="id"> -implybE</span><span class="id"> =&gt;</span><span class="id"> /IH1</span><span class="id"> &lt;-</span><span class="id"> /IH2-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> /IH1</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> -qevT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dnf_to_form_qf</span><span class="id"> bcs</span><span class="id"> :</span><span class="id"> qf_form</span> (<span class="id">dnf_to_form</span><span class="id"> bcs</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> elim:</span><span class="id"> bcs</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [[clT</span><span class="id"> clF]</span><span class="id"> _</span><span class="id"> -&gt;]</span><span class="id"> /=;</span><span class="id"> elim:</span><span class="id"> clT</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> elim:</span><span class="id"> clF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> dnf_rterm</span><span class="id"> cl</span><span class="id"> :=</span><span class="id"> all</span><span class="id"> rterm</span><span class="id"> cl</span>.<span class="id">1</span><span class="id"> &amp;&amp;</span><span class="id"> all</span><span class="id"> rterm</span><span class="id"> cl</span>.<span class="id">2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> qf_to_dnf_rterm</span><span class="id"> f</span><span class="id"> b</span><span class="id"> :</span><span class="id"> rformula</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> all</span><span class="id"> dnf_rterm</span> (<span class="id">qf_to_dnf</span><span class="id"> f</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> ok</span><span class="id"> :=</span><span class="id"> all</span><span class="id"> dnf_rterm</span>.<br/>
<span class="id">have</span><span class="id"> cat_ok</span><span class="id"> bcs1</span><span class="id"> bcs2:</span><span class="id"> ok</span><span class="id"> bcs1</span><span class="id"> -&gt;</span><span class="id"> ok</span><span class="id"> bcs2</span><span class="id"> -&gt;</span><span class="id"> ok</span> (<span class="id">bcs1</span><span class="id"> ++</span><span class="id"> bcs2</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ok1</span><span class="id"> ok2;</span><span class="id"> rewrite</span><span class="id"> [ok</span><span class="id"> _]all_cat;</span><span class="id"> apply/andP</span>.<br/>
<span class="id">have</span><span class="id"> and_ok</span><span class="id"> bcs1</span><span class="id"> bcs2:</span><span class="id"> ok</span><span class="id"> bcs1</span><span class="id"> -&gt;</span><span class="id"> ok</span><span class="id"> bcs2</span><span class="id"> -&gt;</span><span class="id"> ok</span> (<span class="id">and_dnf</span><span class="id"> bcs1</span><span class="id"> bcs2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /and_dnf</span><span class="id"> unlock;</span><span class="id"> elim:</span><span class="id"> bcs1</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> cl1</span><span class="id"> bcs1</span><span class="id"> IH1;</span><span class="id"> rewrite</span><span class="id"> -andbA</span>.<br/>
&nbsp;&nbsp;<span class="id">case/and3P=&gt;</span><span class="id"> ok11</span><span class="id"> ok12</span><span class="id"> ok1</span><span class="id"> ok2;</span><span class="id"> rewrite</span><span class="id"> cat_ok</span><span class="id"> ?{}IH1</span><span class="id"> {bcs1</span><span class="id"> ok1}//</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> bcs2</span><span class="id"> ok2</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> cl2</span><span class="id"> bcs2</span><span class="id"> IH2</span><span class="id"> /andP[ok2</span><span class="id"> /IH2-&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /dnf_rterm</span><span class="id"> !all_cat</span><span class="id"> ok11</span><span class="id"> ok12</span><span class="id"> /=</span><span class="id"> !andbT</span>.<br/>
<span class="id">elim:</span><span class="id"> f</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> [</span><span class="gallina-kwd"> by</span><span class="id"> do</span><span class="id"> 2!case</span><span class="id"> |</span><span class="id"> |</span><span class="id"> |</span><span class="id"> |</span><span class="id"> |</span><span class="gallina-kwd"> by</span><span class="id"> auto</span><span class="id"> |</span><span class="id"> |</span><span class="id"> ];</span><br/>
&nbsp;&nbsp;<span class="id">try</span><span class="gallina-kwd"> by</span><span class="id"> repeat</span><span class="id"> case/andP</span><span class="id"> ||</span><span class="id"> intro;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> auto</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /dnf_rterm</span><span class="id"> =&gt;</span><span class="id"> ??</span><span class="id"> []</span><span class="id"> /=</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dnf_to_rform</span><span class="id"> bcs</span><span class="id"> :</span><span class="id"> rformula</span> (<span class="id">dnf_to_form</span><span class="id"> bcs</span>)<span class="id"> =</span><span class="id"> all</span><span class="id"> dnf_rterm</span><span class="id"> bcs</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> bcs</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [[cl1</span><span class="id"> cl2]</span><span class="id"> bcs</span><span class="id"> -&gt;];</span><span class="id"> rewrite</span><span class="id"> {2}/dnf_rterm</span><span class="id"> /=;</span><span class="id"> congr</span> (_<span class="id"> &amp;&amp;</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span> (<span class="id">congr</span><span class="id"> andb;</span><span class="id"> [elim:</span><span class="id"> cl1</span><span class="id"> |</span><span class="id"> elim:</span><span class="id"> cl2]</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> t</span><span class="id"> cl</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> andbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> If</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">pred_f</span><span class="id"> then_f</span><span class="id"> else_f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> If</span><span class="id"> :=</span> (<span class="id">pred_f</span><span class="id"> /\</span><span class="id"> then_f</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> pred_f</span><span class="id"> /\</span><span class="id"> else_f</span>)<span class="id">%T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> If_form_qf</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qf_form</span><span class="id"> pred_f</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> then_f</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> else_f</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> If</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /=</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> If_form_rf</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rformula</span><span class="id"> pred_f</span><span class="id"> -&gt;</span><span class="id"> rformula</span><span class="id"> then_f</span><span class="id"> -&gt;</span><span class="id"> rformula</span><span class="id"> else_f</span><span class="id"> -&gt;</span><span class="id"> rformula</span><span class="id"> If</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /=</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eval_If</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> ev</span><span class="id"> :=</span><span class="id"> qf_eval</span><span class="id"> e</span><span class="gallina-kwd"> in</span><span class="id"> ev</span><span class="id"> If</span><span class="id"> =</span> (<span class="gallina-kwd">if</span><span class="id"> ev</span><span class="id"> pred_f</span><span class="gallina-kwd"> then</span><span class="id"> ev</span><span class="id"> then_f</span><span class="gallina-kwd"> else</span><span class="id"> ev</span><span class="id"> else_f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?orbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> If</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pick</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">pred_f</span><span class="id"> then_f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> formula</span><span class="id"> R</span>) (<span class="id">else_f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> Pick</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\big[Or/False]_</span>(<span class="id">p</span><span class="id"> :</span><span class="id"> {ffun</span><span class="id"> pred</span><span class="id"> I}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">\big[And/True]_i</span> (<span class="gallina-kwd">if</span><span class="id"> p</span><span class="id"> i</span><span class="gallina-kwd"> then</span><span class="id"> pred_f</span><span class="id"> i</span><span class="gallina-kwd"> else</span><span class="id"> ~</span><span class="id"> pred_f</span><span class="id"> i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">if</span><span class="id"> pick</span><span class="id"> p</span><span class="id"> is</span><span class="id"> Some</span><span class="id"> i</span><span class="gallina-kwd"> then</span><span class="id"> then_f</span><span class="id"> i</span><span class="gallina-kwd"> else</span><span class="id"> else_f</span>))<span class="id">%T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Pick_form_qf</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> qf_form</span> (<span class="id">pred_f</span><span class="id"> i</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> qf_form</span> (<span class="id">then_f</span><span class="id"> i</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">qf_form</span><span class="id"> else_f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">qf_form</span><span class="id"> Pick</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> qfp</span><span class="id"> qft</span><span class="id"> qfe;</span><span class="id"> have</span><span class="id"> mA</span><span class="id"> :=</span> (<span class="id">big_morph</span><span class="id"> qf_form</span>)<span class="id"> true</span><span class="id"> andb</span>.<br/>
<span class="id">rewrite</span><span class="id"> mA</span><span class="id"> //</span><span class="id"> big1</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> p</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> mA</span><span class="id"> //</span><span class="id"> big1</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> pick</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fun_if</span><span class="id"> if_same</span><span class="id"> /=</span><span class="id"> qfp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eval_Pick</span><span class="id"> e</span> (<span class="id">qev</span><span class="id"> :=</span><span class="id"> qf_eval</span><span class="id"> e</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> P</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> qev</span> (<span class="id">pred_f</span><span class="id"> i</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">qev</span><span class="id"> Pick</span><span class="id"> =</span> (<span class="gallina-kwd">if</span><span class="id"> pick</span><span class="id"> P</span><span class="id"> is</span><span class="id"> Some</span><span class="id"> i</span><span class="gallina-kwd"> then</span><span class="id"> qev</span> (<span class="id">then_f</span><span class="id"> i</span>)<span class="gallina-kwd"> else</span><span class="id"> qev</span><span class="id"> else_f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> P;</span><span class="id"> rewrite</span> ((<span class="id">big_morph</span><span class="id"> qev</span>)<span class="id"> false</span><span class="id"> orb</span>)<span class="id"> //=</span><span class="id"> big_orE</span><span class="id"> /=</span>.<br/>
<span class="id">apply/existsP/idP=&gt;</span><span class="id"> [[p]</span><span class="id"> |</span><span class="id"> true_at_P]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> ((<span class="id">big_morph</span><span class="id"> qev</span>)<span class="id"> true</span><span class="id"> andb</span>)<span class="id"> //=</span><span class="id"> big_andE</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">case/andP=&gt;</span><span class="id"> /forallP-eq_p_P</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@eq_pick</span><span class="id"> _</span><span class="id"> _</span><span class="id"> P</span>)<span class="id"> =&gt;</span><span class="id"> [|i];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> pick</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/</span>(_<span class="id"> i</span>)<span class="id">:</span><span class="id"> eq_p_P</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> case:</span> (<span class="id">p</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> /negPf</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> [ffun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P</span><span class="id"> i]</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> ((<span class="id">big_morph</span><span class="id"> qev</span>)<span class="id"> true</span><span class="id"> andb</span>)<span class="id"> //=</span><span class="id"> big_andE</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/forallP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ffunE;</span><span class="id"> case</span><span class="id"> Pi:</span> (<span class="id">P</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> apply:</span><span class="id"> negbT</span>.<br/>
<span class="id">rewrite</span> (<span class="id">@eq_pick</span><span class="id"> _</span><span class="id"> _</span><span class="id"> P</span>)<span class="id"> =&gt;</span><span class="id"> [|i];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> pick</span><span class="id"> true_at_P</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ffunE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pick</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MultiQuant</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> R</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> nat</span>) (<span class="id">e</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> foldExistsP</span><span class="id"> I</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists2</span><span class="id"> e',</span><span class="id"> {in</span><span class="id"> [predC</span><span class="id"> I],</span><span class="id"> same_env</span><span class="id"> e</span><span class="id"> e'}</span><span class="id"> &amp;</span><span class="id"> holds</span><span class="id"> e'</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;-&gt;</span><span class="id"> holds</span><span class="id"> e</span> (<span class="id">foldr</span><span class="id"> Exists</span><span class="id"> f</span><span class="id"> I</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> I</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|i</span><span class="id"> I</span><span class="id"> IHi]</span><span class="id"> e</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> [[e'</span><span class="id"> eq_e]</span><span class="id"> |];</span><span class="id"> [apply:</span><span class="id"> eq_holds</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> eq_e</span><span class="id"> |</span><span class="gallina-kwd"> exists</span><span class="id"> e]</span>.<br/>
<span class="id">split=&gt;</span><span class="id"> [[e'</span><span class="id"> eq_e</span><span class="id"> f_e']</span><span class="id"> |</span><span class="id"> [x]];</span><span class="id"> last</span><span class="id"> set</span><span class="id"> e_x</span><span class="id"> :=</span><span class="id"> set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> i</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> e'`_i;</span><span class="id"> apply/IHi;</span><span class="gallina-kwd"> exists</span><span class="id"> e'</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have:=</span><span class="id"> eq_e</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> !inE;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>.<br/>
<span class="id">case/IHi=&gt;</span><span class="id"> e'</span><span class="id"> eq_e</span><span class="id"> f_e';</span><span class="gallina-kwd"> exists</span><span class="id"> e'</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have:=</span><span class="id"> eq_e</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> !inE;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> foldForallP</span><span class="id"> I</span><span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> e',</span><span class="id"> {in</span><span class="id"> [predC</span><span class="id"> I],</span><span class="id"> same_env</span><span class="id"> e</span><span class="id"> e'}</span><span class="id"> -&gt;</span><span class="id"> holds</span><span class="id"> e'</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;-&gt;</span><span class="id"> holds</span><span class="id"> e</span> (<span class="id">foldr</span><span class="id"> Forall</span><span class="id"> f</span><span class="id"> I</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> I</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [|i</span><span class="id"> I</span><span class="id"> IHi]</span><span class="id"> e</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> [|f_e</span><span class="id"> e'</span><span class="id"> eq_e];</span><span class="id"> [apply</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> eq_holds</span><span class="id"> f_e</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> eq_e]</span>.<br/>
<span class="id">split=&gt;</span><span class="id"> [f_e'</span><span class="id"> x</span><span class="id"> |</span><span class="id"> f_e</span><span class="id"> e'</span><span class="id"> eq_e];</span><span class="id"> first</span><span class="id"> set</span><span class="id"> e_x</span><span class="id"> :=</span><span class="id"> set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> i</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/IHi=&gt;</span><span class="id"> e'</span><span class="id"> eq_e;</span><span class="id"> apply:</span><span class="id"> f_e'</span><span class="id"> =&gt;</span><span class="id"> j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have:=</span><span class="id"> eq_e</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> !inE;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
<span class="id">move/IHi:</span> (<span class="id">f_e</span><span class="id"> e'`_i</span>)<span class="id">;</span><span class="id"> apply=&gt;</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have:=</span><span class="id"> eq_e</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> !inE;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MultiQuant</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="vernacular"> EvalTerm</span>.<br/>
<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> dnf_rterm</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> integral_domain_axiom</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> ComUnitRing_isIntegral</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComUnitRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">mulf_eq0_subproof</span><span class="id"> :</span><span class="id"> integral_domain_axiom</span><span class="id"> R;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[mathcomp</span>(<span class="id">axiom=</span><span class="id">&quot;integral_domain_axiom&quot;</span>)<span class="id">,</span><span class="id"> short</span>(<span class="id">type=</span><span class="id">&quot;idomainType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> IntegralDomain</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{R</span><span class="id"> of</span><span class="id"> ComUnitRing_isIntegral</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> ComUnitRing</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> IntegralDomainExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> IntegralDomain</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> IntegralDomainExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> IntegralDomainExports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> IntegralDomainTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> idomainType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulf_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP/idP;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> mulf_eq0_subproof</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/pred2P=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span> (<span class="id">mulr0,</span><span class="id"> mul0r</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodf_eq0</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>)) (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[i</span><span class="id"> Pi</span><span class="id"> /eqP</span><span class="id"> Fi0]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //=</span><span class="id"> Fi0</span><span class="id"> mul0r</span>.<br/>
<span class="id">elim:</span> (<span class="id">index_enum</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> r</span><span class="id"> IHr];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_nil</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_cons</span><span class="id"> /=;</span><span class="id"> have</span><span class="id"> [Pi</span><span class="id"> |</span><span class="id"> _]</span><span class="id"> :=</span><span class="id"> ifP;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> IHr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulf_eq0;</span><span class="id"> case/orP=&gt;</span><span class="id"> //</span><span class="id"> Fi0;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodf_seq_eq0</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> has</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>))<span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">big_morph</span><span class="id"> _</span><span class="id"> mulf_eq0</span> (<span class="id">oner_eq0</span><span class="id"> _</span>))<span class="id"> big_has_cond</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulf_neq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> mulf_eq0;</span><span class="id"> apply/norP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodf_neq0</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> 0</span>)) (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">sameP</span> (<span class="id">prodf_eq0</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> exists_inP</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> exists_inPn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodf_seq_neq0</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> all</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P</span><span class="id"> i</span><span class="id"> ==&gt;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> 0</span>))<span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> prodf_seq_eq0</span><span class="id"> -all_predC;</span><span class="id"> apply:</span><span class="id"> eq_all</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> implybE</span><span class="id"> negb_and</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expf_eq0</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> mulf_eq0</span><span class="id"> IHn</span><span class="id"> andKb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrf_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> expf_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expf_neq0</span><span class="id"> x</span><span class="id"> m</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x_nz;</span><span class="id"> rewrite</span><span class="id"> expf_eq0;</span><span class="id"> apply/nandP;</span><span class="id"> right</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natf_neq0_pchar</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">n%:R</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">pchar</span><span class="id"> R</span>)<span class="id">^'</span>.<span class="id">-nat</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> /prod_prime_decomp-&gt;]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big_seq;</span><span class="id"> elim/big_rec:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|[p</span><span class="id"> e]</span><span class="id"> s</span><span class="id"> /=];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">case/mem_prime_decomp=&gt;</span><span class="id"> p_pr</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> pnatM</span><span class="id"> pnatX</span><span class="id"> eqn0Ngt</span><span class="id"> orbC</span><span class="id"> =&gt;</span><span class="id"> &lt;-</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> natrM</span><span class="id"> natrX</span><span class="id"> mulf_eq0</span><span class="id"> expf_eq0</span><span class="id"> negb_or</span><span class="id"> negb_and</span><span class="id"> pnatE</span><span class="id"> ?inE</span><span class="id"> p_pr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natf0_pchar</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> n%:R</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> p,</span><span class="id"> p</span><span class="id"> \in</span><span class="id"> pchar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n_gt0</span><span class="id"> nR_0;</span><span class="gallina-kwd"> exists</span> (<span class="id">pdiv</span><span class="id"> n`_</span>(<span class="id">pchar</span><span class="id"> R</span>)).<br/>
<span class="id">apply:</span><span class="id"> pnatP</span> (<span class="id">pdiv_dvd</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?part_pnat</span><span class="id"> //</span><span class="id"> ?pdiv_prime</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltn_neqAle</span><span class="id"> eq_sym</span><span class="id"> partn_eq1</span><span class="id"> //</span><span class="id"> -natf_neq0_pchar</span><span class="id"> nR_0</span><span class="id"> /=</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pcharf'_nat</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">pchar</span><span class="id"> R</span>)<span class="id">^'</span>.<span class="id">-nat</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">n%:R</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> :=</span><span class="id"> posnP</span><span class="id"> n;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="id">apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [|nz_n];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/pnatP=&gt;</span><span class="id"> //</span><span class="id"> p</span><span class="id"> p_pr</span><span class="id"> p_dvd_n;</span><span class="id"> apply:</span><span class="id"> contra</span><span class="id"> nz_n</span><span class="id"> =&gt;</span><span class="id"> /dvdn_pcharf</span><span class="id"> &lt;-</span>.<br/>
<span class="id">apply:</span><span class="id"> contraL</span><span class="id"> =&gt;</span><span class="id"> n0;</span><span class="id"> have</span><span class="id"> [//</span><span class="id"> |</span><span class="id"> p</span><span class="id"> pcharRp]</span><span class="id"> :=</span><span class="id"> natf0_pchar</span><span class="id"> _</span><span class="id"> n0</span>.<br/>
<span class="id">have</span><span class="id"> [p_pr</span><span class="id"> _]</span><span class="id"> :=</span><span class="id"> andP</span><span class="id"> pcharRp;</span><span class="id"> rewrite</span> (<span class="id">eq_pnat</span><span class="id"> _</span> (<span class="id">eq_negn</span> (<span class="id">pcharf_eq</span><span class="id"> pcharRp</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> p'natE</span><span class="id"> //</span> (<span class="id">dvdn_pcharf</span><span class="id"> pcharRp</span>)<span class="id"> n0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pcharf0P</span><span class="id"> :</span><span class="id"> pchar</span><span class="id"> R</span><span class="id"> =i</span><span class="id"> pred0</span><span class="id"> &lt;-&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> n,</span> (<span class="id">n%:R</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%N</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> pcharF0</span><span class="id"> n;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> pcharF0</span><span class="id"> andbC;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="id"> :=</span><span class="id"> posnP;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/negP;</span><span class="id"> case/natf0_pchar=&gt;</span><span class="id"> //</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> pcharF0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqf_sqr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> subr_sqr</span><span class="id"> mulf_eq0</span><span class="id"> subr_eq0</span><span class="id"> addr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulfI</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id"> *%R</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nz_x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> contra_eq</span><span class="id"> =&gt;</span><span class="id"> neq_yz</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> -mulrBr</span><span class="id"> mulf_neq0</span><span class="id"> ?subr_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulIf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id"> *%R^~</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nz_x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">mulrC</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulfI</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divfI</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="gallina-kwd">fun</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/mulfI/inj_comp;</span><span class="id"> apply;</span><span class="id"> apply:</span><span class="id"> invr_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divIf</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -invr_eq0;</span><span class="id"> apply:</span><span class="id"> mulIf</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrf_eq1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> subr_sqr_1</span><span class="id"> mulf_eq0</span><span class="id"> subr_eq0</span><span class="id"> addr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expfS_eq1</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> ||</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>)<span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -![_</span><span class="id"> ==</span><span class="id"> 1]subr_eq0</span><span class="id"> subrX1</span><span class="id"> mulf_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lregP</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">lreg</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [/mulfI</span><span class="id"> |</span><span class="id"> /lreg_neq0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rregP</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">rreg</span><span class="id"> x</span>) (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [/mulIf</span><span class="id"> |</span><span class="id"> /rreg_neq0]</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> IntegralDomain</span>.<span class="id">on</span><span class="id"> R^o</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> IntegralDomainTheory</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use natf_neq0_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> natf_neq0</span><span class="id"> :=</span><span class="id"> natf_neq0_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use natf0_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> natf0_char</span><span class="id"> :=</span><span class="id"> natf0_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf'_nat instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> charf'_nat</span><span class="id"> :=</span><span class="id"> pcharf'_nat</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf0P instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> charf0P</span><span class="id"> :=</span><span class="id"> pcharf0P</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> lregP</span><span class="id"> {R</span><span class="id"> x}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> rregP</span><span class="id"> {R</span><span class="id"> x}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> field_axiom</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> UnitRing_isField</span><span class="id"> R</span><span class="id"> of</span><span class="id"> UnitRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">fieldP</span><span class="id"> :</span><span class="id"> field_axiom</span><span class="id"> R;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[mathcomp</span>(<span class="id">axiom=</span><span class="id">&quot;field_axiom&quot;</span>)<span class="id">,</span><span class="id"> short</span>(<span class="id">type=</span><span class="id">&quot;fieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Field</span><span class="id"> :=</span><span class="id"> {</span><span class="id"> R</span><span class="id"> of</span><span class="id"> IntegralDomain</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> UnitRing_isField</span><span class="id"> R</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> FieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> Field</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> FieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> FieldExports</span>.<br/>
<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> regular_field</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> fieldType</span>)<span class="id"> :=</span><span class="id"> Field</span>.<span class="id">on</span><span class="id"> F^o</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> IdomainMixin</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id">:</span><span class="id"> Field</span>.<span class="id">axiom</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> IntegralDomain</span>.<span class="id">axiom</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> m</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xy0;</span><span class="id"> apply/norP=&gt;</span><span class="id"> [[]]</span><span class="id"> /m</span><span class="id"> Ux</span><span class="id"> /m</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">unitrMr</span><span class="id"> _</span><span class="id"> Ux</span>)<span class="id"> xy0</span><span class="id"> unitr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> ComUnitRing_isField</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComUnitRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">fieldP</span><span class="id"> :</span><span class="id"> field_axiom</span><span class="id"> R;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComUnitRing_isField</span><span class="id"> R</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">ComUnitRing_isIntegral</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">IdomainMixin</span><span class="id"> fieldP</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> UnitRing_isField</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> fieldP</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> ComNzRing_isField</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComNzRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">inv</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R;</span><br/>
&nbsp;&nbsp;<span class="id">mulVf</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> inv</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1;</span><br/>
&nbsp;&nbsp;<span class="id">invr0</span><span class="id"> :</span><span class="id"> inv</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ComRing_isField</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing_isField.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzRing_isField</span>.<span class="id">Build</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> ComRing_isField</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use ComNzRing_isField instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> ComRing_isField</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">ComNzRing_isField</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> of</span><span class="id"> ComNzRing_isField</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> intro_unit</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> yx1;</span><span class="id"> apply:</span><span class="id"> contraNneq</span> (<span class="id">@oner_neq0</span><span class="id"> R</span>)<span class="id"> =&gt;</span><span class="id"> x0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -yx1</span><span class="id"> x0</span><span class="id"> mulr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> inv_out</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> predC</span> (<span class="id">predC1</span><span class="id"> 0</span>)<span class="id">,</span><span class="id"> inv</span><span class="id"> =1</span><span class="id"> id}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> /negbNE/eqP-&gt;;</span><span class="id"> exact:</span><span class="id"> invr0</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :</span><span class="id"> ComNzRing_hasMulInverse</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">ComNzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> mulVf</span><span class="id"> intro_unit</span><span class="id"> inv_out</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :</span><span class="id"> ComUnitRing_isField</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">ComUnitRing_isField</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> x_neq_0</span><span class="id"> =&gt;</span><span class="id"> x_neq_0</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> F</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitfE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> [/</span>(<span class="id">memPn</span><span class="id"> _</span>)<span class="id">-&gt;</span><span class="id"> |</span><span class="id"> /fieldP];</span><span class="id"> rewrite</span><span class="id"> ?unitr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulVf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x^-1</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> mulVr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> divff</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> divrr</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> mulfV</span><span class="id"> :=</span><span class="id"> divff</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> mulKf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cancel</span> (<span class="id"> *%R</span><span class="id"> x</span>) (<span class="id"> *%R</span><span class="id"> x^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> mulKr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulVKf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cancel</span> (<span class="id"> *%R</span><span class="id"> x^-1</span>) (<span class="id"> *%R</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> mulVKr</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulfK</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cancel</span> (<span class="id"> *%R^~</span><span class="id"> x</span>) (<span class="id"> *%R^~</span><span class="id"> x^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> mulrK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulfVK</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cancel</span> (<span class="id"> *%R^~</span><span class="id"> x^-1</span>) (<span class="id"> *%R^~</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> divrK</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> divfK</span><span class="id"> :=</span><span class="id"> mulfVK</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invfM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> @inv</span><span class="id"> F</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> have</span><span class="id"> [-&gt;|nzx]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mul0r,</span><span class="id"> invr0</span>).<br/>
<span class="id">have</span><span class="id"> [-&gt;|nzy]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> y</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mulr0,</span><span class="id"> invr0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> invrM</span><span class="id"> ?unitfE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invf_div</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span>)<span class="id">^-1</span><span class="id"> =</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invfM</span><span class="id"> invrK</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divKf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> involutive</span> (<span class="gallina-kwd">fun</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nz_x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> invf_div</span><span class="id"> mulrC</span><span class="id"> divfK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expfB_cond</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> +</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/subnK=&gt;</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> addnA</span><span class="id"> addnK</span><span class="id"> !exprD</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_x]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr0</span><span class="id"> !mul0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulfK</span><span class="id"> ?expf_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expfB</span><span class="id"> m</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> lt_n_m;</span><span class="id"> apply:</span><span class="id"> expfB_cond;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> ltnW</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodfV</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">E</span><span class="id"> i</span>)<span class="id">^-1</span><span class="id"> =</span> (<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">big_morph</span><span class="id"> _</span><span class="id"> invfM</span> (<span class="id">invr1</span><span class="id"> F</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> prodf_div</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">E</span><span class="id"> D</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">E</span><span class="id"> i</span><span class="id"> /</span><span class="id"> D</span><span class="id"> i</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> E</span><span class="id"> i</span><span class="id"> /</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> D</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_split</span><span class="id"> prodfV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_prodf</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> k</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>) (<span class="id">f</span><span class="id"> k</span>.<span class="id">+1</span><span class="id"> /</span><span class="id"> f</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> m</span><span class="id"> /</span><span class="id"> f</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nz_f</span><span class="id"> ltnm;</span><span class="id"> apply:</span><span class="id"> invr_inj;</span><span class="id"> rewrite</span><span class="id"> prodf_div</span><span class="id"> !invf_div</span><span class="id"> -prodf_div</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> telescope_prodr</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> k</span><span class="id"> /nz_f;</span><span class="id"> rewrite</span><span class="id"> unitfE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_prodf_eq</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> u</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> k</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> n</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> k,</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> u</span><span class="id"> k</span><span class="id"> =</span><span class="id"> f</span><span class="id"> k</span>.<span class="id">+1</span><span class="id"> /</span><span class="id"> f</span><span class="id"> k</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\prod_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id"> u</span><span class="id"> k</span><span class="id"> =</span><span class="id"> f</span><span class="id"> m</span><span class="id"> /</span><span class="id"> f</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> uE;</span><span class="id"> under</span><span class="id"> eq_big_nat</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> uE</span><span class="id"> //=;</span><span class="id"> exact:</span><span class="id"> telescope_prodf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addf_div</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">y1</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y2</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> /</span><span class="id"> y1</span><span class="id"> +</span><span class="id"> x2</span><span class="id"> /</span><span class="id"> y2</span><span class="id"> =</span> (<span class="id">x1</span><span class="id"> *</span><span class="id"> y2</span><span class="id"> +</span><span class="id"> x2</span><span class="id"> *</span><span class="id"> y1</span>)<span class="id"> /</span> (<span class="id">y1</span><span class="id"> *</span><span class="id"> y2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nzy1</span><span class="id"> nzy2;</span><span class="id"> rewrite</span><span class="id"> invfM</span><span class="id"> mulrDl</span><span class="id"> !mulrA</span><span class="id"> mulrAC</span><span class="id"> !mulfK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulf_div</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span> (<span class="id">x1</span><span class="id"> /</span><span class="id"> y1</span>)<span class="id"> *</span> (<span class="id">x2</span><span class="id"> /</span><span class="id"> y2</span>)<span class="id"> =</span> (<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span>)<span class="id"> /</span> (<span class="id">y1</span><span class="id"> *</span><span class="id"> y2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrACA</span><span class="id"> -invfM</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_div</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> t</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> z</span><span class="id"> /</span><span class="id"> t</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> t</span><span class="id"> ==</span><span class="id"> z</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> yD0</span><span class="id"> tD0;</span><span class="id"> rewrite</span><span class="id"> -[x</span><span class="gallina-kwd"> in</span><span class="id"> RHS]</span>(<span class="id">divfK</span><span class="id"> yD0</span>)<span class="id"> -[z</span><span class="gallina-kwd"> in</span><span class="id"> RHS]</span>(<span class="id">divfK</span><span class="id"> tD0</span>)<span class="id"> mulrAC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP/eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|/</span>(<span class="id">mulIf</span><span class="id"> yD0</span>)<span class="id">/</span>(<span class="id">mulIf</span><span class="id"> tD0</span>)<span class="id">]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqr_sum_div</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> c</span><span class="id"> a</span><span class="id"> :</span><span class="id"> c</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\big[+%R/0]_</span>(<span class="id">x</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x</span>) (<span class="id">f</span><span class="id"> x</span><span class="id"> /</span><span class="id"> c</span>)<span class="id"> ==</span><span class="id"> a</span><br/>
&nbsp;&nbsp;<span class="id">=</span> (<span class="id">\big[+%R/0]_</span>(<span class="id">x</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> f</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> a</span><span class="id"> *</span><span class="id"> c</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -mulr_suml</span><span class="id"> -</span>(<span class="id">divr1</span><span class="id"> a</span>)<span class="id"> eqr_div</span><span class="id"> ?oner_eq0//</span><span class="id"> mulr1</span><span class="id"> divr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pchar0_natf_div</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">pchar</span><span class="id"> F</span><span class="id"> =i</span><span class="id"> pred0</span><span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> m</span><span class="id"> d,</span><span class="id"> d</span><span class="id"> %|</span><span class="id"> m</span><span class="id"> -&gt;</span> (<span class="id">m</span><span class="id"> %/</span><span class="id"> d</span>)<span class="id">%:R</span><span class="id"> =</span><span class="id"> m%:R</span><span class="id"> /</span><span class="id"> d%:R</span><span class="id"> :&gt;</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/pcharf0P=&gt;</span><span class="id"> pchar0F</span><span class="id"> m</span><span class="id"> [|d]</span><span class="id"> d_dv_m;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divn0</span><span class="id"> invr0</span><span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> natr_div</span><span class="id"> //</span><span class="id"> unitfE</span><span class="id"> pchar0F</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldMorphismInj</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> R}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_x]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> eqxx</span>.<br/>
<span class="id">apply/eqP;</span><span class="id"> move/</span>(<span class="id">congr1</span> (<span class="id"> *%R</span> (<span class="id">f</span><span class="id"> x^-1</span>)))<span class="id">/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rmorphM</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> mulr0</span><span class="id"> rmorph1</span><span class="id"> ?oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/raddf_inj</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> fmorph_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_eq</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> inj_eq</span><span class="id"> fmorph_inj</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_eq1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">inj_eq</span><span class="id"> fmorph_inj</span>)<span class="id"> rmorph1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_pchar</span><span class="id"> :</span><span class="id"> pchar</span><span class="id"> R</span><span class="id"> =i</span><span class="id"> pchar</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> -fmorph_eq0</span><span class="id"> rmorph_nat</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FieldMorphismInj</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldMorphismInv</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> R}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_unit</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rmorph0</span><span class="id"> unitr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -unitfE;</span><span class="id"> apply:</span><span class="id"> rmorph_unit</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorphV</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f:</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x^-1}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_x]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">invr0,</span><span class="id"> rmorph0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rmorphV</span><span class="id"> ?unitfE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fmorph_div</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> rmorphM</span><span class="id"> /=</span><span class="id"> fmorphV</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FieldMorphismInv</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ModuleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> F</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> F</span>) (<span class="id">v</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerK</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cancel</span> (<span class="id"> *:%R</span><span class="id"> a</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id"> *:%R</span><span class="id"> a^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nz_a</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> scalerA</span><span class="id"> mulVf</span><span class="id"> //</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerKV</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cancel</span> (<span class="id"> *:%R</span><span class="id"> a^-1</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>) (<span class="id"> *:%R</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -invr_eq0</span><span class="id"> -{3}[a]invrK;</span><span class="id"> apply:</span><span class="id"> scalerK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerI</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id"> *:%R</span><span class="id"> a</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> V</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> nz_a;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">scalerK</span><span class="id"> nz_a</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scaler_eq0</span><span class="id"> a</span><span class="id"> v</span><span class="id"> :</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">v</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_a]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> a;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scale0r</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">can2_eq</span> (<span class="id">scalerK</span><span class="id"> nz_a</span>) (<span class="id">scalerKV</span><span class="id"> nz_a</span>))<span class="id"> scaler0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ModuleTheory</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pchar_lalg</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> pchar</span><span class="id"> A</span><span class="id"> =i</span><span class="id"> pchar</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> inE</span><span class="id"> -scaler_nat</span><span class="id"> scaler_eq0</span><span class="id"> oner_eq0</span><span class="id"> orbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FieldTheory</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pchar0_natf_div instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> char0_natf_div</span><span class="id"> :=</span><span class="id"> pchar0_natf_div</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use fmorph_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> fmorph_char</span><span class="id"> :=</span><span class="id"> fmorph_pchar</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pchar_lalg instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> char_lalg</span><span class="id"> :=</span><span class="id"> pchar_lalg</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> fmorph_inj</span><span class="id"> {F</span><span class="id"> R}</span><span class="id"> f</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> telescope_prodf_eq</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> m}</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> decidable_field_axiom</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> pred</span> (<span class="id">formula</span><span class="id"> R</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> e</span><span class="id"> f,</span><span class="id"> reflect</span> (<span class="id">holds</span><span class="id"> e</span><span class="id"> f</span>) (<span class="id">s</span><span class="id"> e</span><span class="id"> f</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> Field_isDecField</span><span class="id"> R</span><span class="id"> of</span><span class="id"> UnitRing</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">sat</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> pred</span> (<span class="id">formula</span><span class="id"> R</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">satP</span><span class="id"> :</span><span class="id"> decidable_field_axiom</span><span class="id"> sat;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[mathcomp</span>(<span class="id">axiom=</span><span class="id">&quot;decidable_field_axiom&quot;</span>)<span class="id">,</span><span class="id"> short</span>(<span class="id">type=</span><span class="id">&quot;decFieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> DecidableField</span><span class="id"> :=</span><span class="id"> {</span><span class="id"> F</span><span class="id"> of</span><span class="id"> Field</span><span class="id"> F</span><span class="id"> &amp;</span><span class="id"> Field_isDecField</span><span class="id"> F</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> DecFieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="id"> DecidableField</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="id"> DecFieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> DecFieldExports</span>.<br/>
<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> decFieldType</span>)<span class="id"> :=</span><span class="id"> DecidableField</span>.<span class="id">on</span><span class="id"> F^o</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> DecidableFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> decFieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> F</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> sol_subproof</span><span class="id"> n</span><span class="id"> f</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> s,</span> (<span class="id">size</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> n</span>)<span class="id"> &amp;&amp;</span><span class="id"> sat</span><span class="id"> s</span><span class="id"> f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sat</span><span class="id"> [::]</span> (<span class="id">foldr</span><span class="id"> Exists</span><span class="id"> f</span> (<span class="id">iota</span><span class="id"> 0</span><span class="id"> n</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">satP</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> [|[s]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">case/andP=&gt;</span><span class="id"> /eqP</span><span class="id"> sz_s</span><span class="id"> /satP</span><span class="id"> f_s;</span><span class="id"> apply/foldExistsP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> mem_iota</span><span class="id"> -leqNgt</span><span class="id"> add0n</span><span class="id"> =&gt;</span><span class="id"> le_n_i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !nth_default</span><span class="id"> ?sz_s</span>.<br/>
<span class="id">case/foldExistsP=&gt;</span><span class="id"> e</span><span class="id"> e0</span><span class="id"> f_e;</span><span class="id"> set</span><span class="id"> s</span><span class="id"> :=</span><span class="id"> take</span><span class="id"> n</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> n</span><span class="id"> 0</span>).<br/>
<span class="id">have</span><span class="id"> sz_s:</span><span class="id"> size</span><span class="id"> s</span><span class="id"> =</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> size_take</span><span class="id"> size_set_nth</span><span class="id"> leq_max</span><span class="id"> leqnn</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> sz_s</span><span class="id"> eqxx;</span><span class="id"> apply/satP;</span><span class="id"> apply:</span><span class="id"> eq_holds</span><span class="id"> f_e</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="id">case:</span> (<span class="id">leqP</span><span class="id"> n</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> [le_n_i</span><span class="id"> |</span><span class="id"> lt_i_n]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -e0</span><span class="id"> ?nth_default</span><span class="id"> ?sz_s</span><span class="id"> //</span><span class="id"> !inE</span><span class="id"> mem_iota</span><span class="id"> -leqNgt</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nth_take</span><span class="id"> //</span><span class="id"> nth_set_nth</span><span class="id"> /=</span><span class="id"> eq_sym</span><span class="id"> eqn_leq</span><span class="id"> leqNgt</span><span class="id"> lt_i_n</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> sol</span><span class="id"> n</span><span class="id"> f</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> sol_subproof</span><span class="id"> n</span><span class="id"> f</span><span class="id"> is</span><span class="id"> ReflectT</span><span class="id"> sP</span><span class="gallina-kwd"> then</span><span class="id"> xchoose</span><span class="id"> sP</span><span class="gallina-kwd"> else</span><span class="id"> nseq</span><span class="id"> n</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> size_sol</span><span class="id"> n</span><span class="id"> f</span><span class="id"> :</span><span class="id"> size</span> (<span class="id">sol</span><span class="id"> n</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /sol;</span><span class="id"> case:</span><span class="id"> sol_subproof</span><span class="id"> =&gt;</span><span class="id"> [sP</span><span class="id"> |</span><span class="id"> _];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> size_nseq</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/andP:</span> (<span class="id">xchooseP</span><span class="id"> sP</span>)<span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> solP</span><span class="id"> n</span><span class="id"> f</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> s,</span><span class="id"> size</span><span class="id"> s</span><span class="id"> =</span><span class="id"> n</span><span class="id"> &amp;</span><span class="id"> holds</span><span class="id"> s</span><span class="id"> f</span>) (<span class="id">sat</span> (<span class="id">sol</span><span class="id"> n</span><span class="id"> f</span>)<span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /sol;</span><span class="id"> case:</span><span class="id"> sol_subproof</span><span class="id"> =&gt;</span><span class="id"> [sP</span><span class="id"> |</span><span class="id"> sPn]</span>.<br/>
&nbsp;&nbsp;<span class="id">case/andP:</span> (<span class="id">xchooseP</span><span class="id"> sP</span>)<span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> -&gt;;</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> sP</span><span class="id"> =&gt;</span><span class="id"> s;</span><span class="id"> case/andP;</span><span class="id"> move/eqP=&gt;</span><span class="id"> &lt;-;</span><span class="id"> move/satP;</span><span class="gallina-kwd"> exists</span><span class="id"> s</span>.<br/>
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">satP</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span> (<span class="id">nseq</span><span class="id"> n</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?size_nseq</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> s</span><span class="id"> sz_s;</span><span class="id"> move/satP=&gt;</span><span class="id"> f_s;</span><span class="id"> case:</span><span class="id"> sPn;</span><span class="gallina-kwd"> exists</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> sz_s</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_sat</span><span class="id"> f1</span><span class="id"> f2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> e,</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f1</span><span class="id"> &lt;-&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f2</span>)<span class="id"> -&gt;</span><span class="id"> sat^~</span><span class="id"> f1</span><span class="id"> =1</span><span class="id"> sat^~</span><span class="id"> f2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqf12</span><span class="id"> e;</span><span class="id"> apply/satP/satP;</span><span class="id"> case:</span> (<span class="id">eqf12</span><span class="id"> e</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_sol</span><span class="id"> f1</span><span class="id"> f2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> e,</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f1</span><span class="id"> &lt;-&gt;</span><span class="id"> holds</span><span class="id"> e</span><span class="id"> f2</span>)<span class="id"> -&gt;</span><span class="id"> sol^~</span><span class="id"> f1</span><span class="id"> =1</span><span class="id"> sol^~</span><span class="id"> f2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /sol</span><span class="id"> =&gt;</span><span class="id"> /eq_sat</span><span class="id"> eqf12</span><span class="id"> n</span>.<br/>
<span class="id">do</span><span class="id"> 2![case:</span><span class="id"> sol_subproof]</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [f1s</span><span class="id"> f2s</span><span class="id"> |</span><span class="id"> ns1</span><span class="id"> [s</span><span class="id"> f2s]</span><span class="id"> |</span><span class="id"> [s</span><span class="id"> f1s]</span><span class="id"> []]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eq_xchoose</span><span class="id"> =&gt;</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> eqf12</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ns1;</span><span class="gallina-kwd"> exists</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> -eqf12</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> s;</span><span class="id"> rewrite</span><span class="id"> eqf12</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> DecidableFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> satP</span><span class="id"> {F</span><span class="id"> e</span><span class="id"> f}</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> solP</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> f}</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> QE_Mixin</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> Field</span>.<span class="id">type</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> f</span><span class="id"> :</span><span class="id"> formula</span><span class="id"> F</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> proj</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> F</span>)<span class="id"> *</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> F</span>)<span class="id"> -&gt;</span><span class="id"> formula</span><span class="id"> F</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> wf_QE_proj</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> bc</span> (<span class="id">bc_i</span><span class="id"> :=</span><span class="id"> proj</span><span class="id"> i</span><span class="id"> bc</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="id">dnf_rterm</span><span class="id"> bc</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> bc_i</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> bc_i</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> valid_QE_proj</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> bc</span> (<span class="id">ex_i_bc</span><span class="id"> :=</span> (<span class="id">'exists</span><span class="id"> 'X_i,</span><span class="id"> dnf_to_form</span><span class="id"> [::</span><span class="id"> bc]</span>)<span class="id">%T</span>)<span class="id"> e,</span><br/>
&nbsp;&nbsp;<span class="id">dnf_rterm</span><span class="id"> bc</span><span class="id"> -&gt;</span><span class="id"> reflect</span> (<span class="id">holds</span><span class="id"> e</span><span class="id"> ex_i_bc</span>) (<span class="id">qf_eval</span><span class="id"> e</span> (<span class="id">proj</span><span class="id"> i</span><span class="id"> bc</span>)).<br/>
<br/>
<span class="vernacular">Hypotheses</span> (<span class="id">wf_proj</span><span class="id"> :</span><span class="id"> wf_QE_proj</span>) (<span class="id">ok_proj</span><span class="id"> :</span><span class="id"> valid_QE_proj</span>).<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> elim_aux</span><span class="id"> f</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> foldr</span><span class="id"> Or</span><span class="id"> False</span> (<span class="id">map</span> (<span class="id">proj</span><span class="id"> n</span>) (<span class="id">qf_to_dnf</span><span class="id"> f</span><span class="id"> false</span>)).<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> quantifier_elim</span><span class="id"> f</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> f</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> /\</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="id">quantifier_elim</span><span class="id"> f1</span>)<span class="id"> /\</span> (<span class="id">quantifier_elim</span><span class="id"> f2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> \/</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="id">quantifier_elim</span><span class="id"> f1</span>)<span class="id"> \/</span> (<span class="id">quantifier_elim</span><span class="id"> f2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> f1</span><span class="id"> ==&gt;</span><span class="id"> f2</span><span class="id"> =&gt;</span> (<span class="id">~</span><span class="id"> quantifier_elim</span><span class="id"> f1</span>)<span class="id"> \/</span> (<span class="id">quantifier_elim</span><span class="id"> f2</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> ~</span><span class="id"> f</span><span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> quantifier_elim</span><span class="id"> f</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'exists</span><span class="id"> 'X_n,</span><span class="id"> f</span>)<span class="id"> =&gt;</span><span class="id"> elim_aux</span> (<span class="id">quantifier_elim</span><span class="id"> f</span>)<span class="id"> n</span><br/>
&nbsp;&nbsp;<span class="id">|</span> (<span class="id">'forall</span><span class="id"> 'X_n,</span><span class="id"> f</span>)<span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> elim_aux</span> (<span class="id">~</span><span class="id"> quantifier_elim</span><span class="id"> f</span>)<span class="id"> n</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> f</span><br/>
&nbsp;&nbsp;<span class="id">end%T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> quantifier_elim_wf</span><span class="id"> f</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> qf</span><span class="id"> :=</span><span class="id"> quantifier_elim</span><span class="id"> f</span><span class="gallina-kwd"> in</span><span class="id"> rformula</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> qf</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> qf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">suffices</span><span class="id"> aux_wf</span><span class="id"> f0</span><span class="id"> n</span><span class="id"> :</span><span class="gallina-kwd"> let</span><span class="id"> qf</span><span class="id"> :=</span><span class="id"> elim_aux</span><span class="id"> f0</span><span class="id"> n</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">rformula</span><span class="id"> f0</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> qf</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> qf</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> f</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> do</span><span class="id"> ?[</span> <span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case/andP=&gt;</span><span class="id"> rf1</span><span class="id"> rf2;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case/andP:</span>(<span class="id">IH1</span><span class="id"> rf1</span>)<span class="id">=&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case/andP:</span>(<span class="id">IH2</span><span class="id"> rf2</span>)<span class="id">=&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span><span class="id"> //</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> f1</span><span class="id"> IH</span><span class="id"> rf1;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case/andP:</span> (<span class="id">IH</span><span class="id"> rf1</span>)<span class="id">=&gt;</span><span class="id"> qff</span><span class="id"> rf;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> aux_wf</span><span class="id"> ]</span>.<br/>
<span class="id">rewrite</span><span class="id"> /elim_aux</span><span class="id"> =&gt;</span><span class="id"> rf</span>.<br/>
<span class="id">suffices</span><span class="id"> or_wf</span><span class="id"> fs</span><span class="id"> :</span><span class="gallina-kwd"> let</span><span class="id"> ofs</span><span class="id"> :=</span><span class="id"> foldr</span><span class="id"> Or</span><span class="id"> False</span><span class="id"> fs</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">all</span> (<span class="id">@qf_form</span><span class="id"> F</span>)<span class="id"> fs</span><span class="id"> &amp;&amp;</span><span class="id"> all</span> (<span class="id">@rformula</span><span class="id"> F</span>)<span class="id"> fs</span><span class="id"> -&gt;</span><span class="id"> qf_form</span><span class="id"> ofs</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> ofs</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span><span class="id"> or_wf</span>.<br/>
&nbsp;&nbsp;<span class="id">suffices</span><span class="id"> map_proj_wf</span><span class="id"> bcs:</span><span class="gallina-kwd"> let</span><span class="id"> mbcs</span><span class="id"> :=</span><span class="id"> map</span> (<span class="id">proj</span><span class="id"> n</span>)<span class="id"> bcs</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span><span class="id"> dnf_rterm</span><span class="id"> bcs</span><span class="id"> -&gt;</span><span class="id"> all</span> (<span class="id">@qf_form</span><span class="id"> _</span>)<span class="id"> mbcs</span><span class="id"> &amp;&amp;</span><span class="id"> all</span> (<span class="id">@rformula</span><span class="id"> _</span>)<span class="id"> mbcs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/map_proj_wf/qf_to_dnf_rterm</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> bcs</span><span class="id"> =&gt;</span><span class="id"> [|bc</span><span class="id"> bcs</span><span class="id"> ihb]</span><span class="id"> bcsr</span><span class="id"> //=</span><span class="id"> /andP[rbc</span><span class="id"> rbcs]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> andbAC</span><span class="id"> andbA</span><span class="id"> wf_proj</span><span class="id"> //=</span><span class="id"> andbC</span><span class="id"> ihb</span>.<br/>
<span class="id">elim:</span><span class="id"> fs</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> g</span><span class="id"> gs</span><span class="id"> ihg;</span><span class="id"> rewrite</span><span class="id"> -andbA</span><span class="id"> =&gt;</span><span class="id"> /and4P[-&gt;</span><span class="id"> qgs</span><span class="id"> -&gt;</span><span class="id"> rgs]</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> ihg;</span><span class="id"> rewrite</span><span class="id"> qgs</span><span class="id"> rgs</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> quantifier_elim_rformP</span><span class="id"> e</span><span class="id"> f</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">rformula</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> reflect</span> (<span class="id">holds</span><span class="id"> e</span><span class="id"> f</span>) (<span class="id">qf_eval</span><span class="id"> e</span> (<span class="id">quantifier_elim</span><span class="id"> f</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> rc</span><span class="id"> e</span><span class="id"> n</span><span class="id"> f</span><span class="id"> :=</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> qf_eval</span> (<span class="id">set_nth</span><span class="id"> 0</span><span class="id"> e</span><span class="id"> n</span><span class="id"> x</span>)<span class="id"> f</span>.<br/>
<span class="id">have</span><span class="id"> auxP</span><span class="id"> f0</span><span class="id"> e0</span><span class="id"> n0:</span><span class="id"> qf_form</span><span class="id"> f0</span><span class="id"> &amp;&amp;</span><span class="id"> rformula</span><span class="id"> f0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">rc</span><span class="id"> e0</span><span class="id"> n0</span><span class="id"> f0</span>) (<span class="id">qf_eval</span><span class="id"> e0</span> (<span class="id">elim_aux</span><span class="id"> f0</span><span class="id"> n0</span>)).<br/>
<span class="id">+</span><span class="id"> rewrite</span><span class="id"> /elim_aux</span><span class="id"> =&gt;</span><span class="id"> cf;</span><span class="id"> set</span><span class="id"> bcs</span><span class="id"> :=</span><span class="id"> qf_to_dnf</span><span class="id"> f0</span><span class="id"> false</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@iffP</span> (<span class="id">rc</span><span class="id"> e0</span><span class="id"> n0</span> (<span class="id">dnf_to_form</span><span class="id"> bcs</span>)))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> -qf_to_dnfP</span><span class="id"> //;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> qf_to_dnfP</span><span class="id"> //;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span><span class="id"> all</span><span class="id"> dnf_rterm</span><span class="id"> bcs</span><span class="gallina-kwd"> by</span><span class="id"> case/andP:</span><span class="id"> cf</span><span class="id"> =&gt;</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> qf_to_dnf_rterm</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> {f0</span><span class="id"> cf}bcs</span><span class="id"> =&gt;</span><span class="id"> [|bc</span><span class="id"> bcs</span><span class="id"> IHbcs]</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> right;</span><span class="id"> case</span>.<br/>
&nbsp;&nbsp;<span class="id">case/andP=&gt;</span><span class="id"> r_bc</span><span class="id"> /IHbcs</span><span class="id"> {IHbcs}bcsP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> f_qf</span><span class="id"> :=</span><span class="id"> dnf_to_form_qf</span><span class="id"> [::</span><span class="id"> bc]</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> ok_proj</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [ex_x|no_x]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left;</span><span class="id"> case:</span><span class="id"> ex_x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /</span>(<span class="id">qf_evalP</span><span class="id"> _</span><span class="id"> f_qf</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> orbF</span><span class="id"> =&gt;</span><span class="id"> bc_x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> bc_x</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> bcsP</span>)<span class="id"> =&gt;</span><span class="id"> [[x</span><span class="id"> bcs_x]</span><span class="id"> |</span><span class="id"> [x]]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> bcs_x</span><span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;<span class="id">case/orP</span><span class="id"> =&gt;</span><span class="id"> [bc_x|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> no_x;</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> apply/</span>(<span class="id">qf_evalP</span><span class="id"> _</span><span class="id"> f_qf</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> bc_x</span>.<br/>
<span class="id">elim:</span><span class="id"> f</span><span class="id"> e</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> b</span><span class="id"> e</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> idP</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> t1</span><span class="id"> t2</span><span class="id"> e</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> eqP</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> /andP[/IH1[]</span><span class="id"> f1e];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> right;</span><span class="id"> case</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/IH2;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right;</span><span class="id"> case]</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> /andP[/IH1[]</span><span class="id"> f1e];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> do</span><span class="id"> 2!left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/IH2;</span><span class="id"> [left;</span><span class="id"> right</span><span class="id"> |</span><span class="id"> right;</span><span class="id"> case]</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> IH1</span><span class="id"> f2</span><span class="id"> IH2</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> /andP[/IH1[]</span><span class="id"> f1e];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/IH2;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right;</span><span class="id"> move/</span>(_<span class="id"> f1e</span>)<span class="id">]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> IHf</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> /IHf[];</span><span class="id"> [right</span><span class="id"> |</span><span class="id"> left]</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> f</span><span class="id"> IHf</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> rf;</span><span class="id"> have</span><span class="id"> rqf</span><span class="id"> :=</span><span class="id"> quantifier_elim_wf</span><span class="id"> rf</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">auxP</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> rqf</span>))<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [x];</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> apply/IHf</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> n</span><span class="id"> f</span><span class="id"> IHf</span><span class="id"> e</span><span class="id"> /=</span><span class="id"> rf;</span><span class="id"> have</span><span class="id"> rqf</span><span class="id"> :=</span><span class="id"> quantifier_elim_wf</span><span class="id"> rf</span>.<br/>
<span class="id">case:</span><span class="id"> auxP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [f_x|no_x];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> right=&gt;</span><span class="id"> no_x;</span><span class="id"> case:</span><span class="id"> f_x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /IHf[]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> left=&gt;</span><span class="id"> x;</span><span class="id"> apply/IHf=&gt;</span><span class="id"> //;</span><span class="id"> apply/idPn=&gt;</span><span class="id"> f_x;</span><span class="id"> case:</span><span class="id"> no_x;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> proj_sat</span><span class="id"> e</span><span class="id"> f</span><span class="id"> :=</span><span class="id"> qf_eval</span><span class="id"> e</span> (<span class="id">quantifier_elim</span> (<span class="id">to_rform</span><span class="id"> f</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> proj_satP</span><span class="id"> :</span><span class="id"> DecidableField</span>.<span class="id">axiom</span><span class="id"> proj_sat</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> e</span><span class="id"> f;</span><span class="id"> have</span><span class="id"> fP</span><span class="id"> :=</span><span class="id"> quantifier_elim_rformP</span><span class="id"> e</span> (<span class="id">to_rform_rformula</span><span class="id"> f</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> fP</span>)<span class="id">;</span><span class="id"> move/to_rformP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> QE_Mixin</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> Field_QE_isDecField</span><span class="id"> F</span><span class="id"> of</span><span class="id"> Field</span><span class="id"> F</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">proj</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> F</span>)<span class="id"> *</span><span class="id"> seq</span> (<span class="id">term</span><span class="id"> F</span>)<span class="id"> -&gt;</span><span class="id"> formula</span><span class="id"> F;</span><br/>
&nbsp;&nbsp;<span class="id">wf_proj</span><span class="id"> :</span><span class="id"> wf_QE_proj</span><span class="id"> proj;</span><br/>
&nbsp;&nbsp;<span class="id">ok_proj</span><span class="id"> :</span><span class="id"> valid_QE_proj</span><span class="id"> proj;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> F</span><span class="id"> of</span><span class="id"> Field_QE_isDecField</span><span class="id"> F</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> qe_is_def_field</span><span class="id"> :</span><span class="id"> Field_isDecField</span><span class="id"> F</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Field_isDecField</span>.<span class="id">Build</span><span class="id"> F</span> (<span class="id">proj_satP</span><span class="id"> wf_proj</span><span class="id"> ok_proj</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> closed_field_axiom</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id">,</span><span class="id"> n</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> P</span><span class="id"> i</span><span class="id"> *</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> i</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> DecField_isAlgClosed</span><span class="id"> F</span><span class="id"> of</span><span class="id"> DecidableField</span><span class="id"> F</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">solve_monicpoly</span><span class="id"> :</span><span class="id"> closed_field_axiom</span><span class="id"> F;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[mathcomp</span>(<span class="id">axiom=</span><span class="id">&quot;closed_field_axiom&quot;</span>)<span class="id">,</span><span class="id"> short</span>(<span class="id">type=</span><span class="id">&quot;closedFieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="vernacular"> ClosedField</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> F</span><span class="id"> of</span><span class="id"> DecidableField</span><span class="id"> F</span><span class="id"> &amp;</span><span class="id"> DecField_isAlgClosed</span><span class="id"> F</span><span class="id"> }</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="vernacular"> ClosedFieldExports</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span><span class="gallina-kwd"> with</span><span class="vernacular"> ClosedField</span>.<span class="id">sort</span>.<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedFieldExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="vernacular"> ClosedFieldExports</span>.<br/>
<br/>
<span class="id">#[export]</span><span class="id"> HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> closedFieldType</span>)<span class="id"> :=</span><span class="vernacular"> ClosedField</span>.<span class="id">on</span><span class="id"> F^o</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ClosedFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> closedFieldType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> imaginary_exists</span><span class="id"> :</span><span class="id"> {i</span><span class="id"> :</span><span class="id"> F</span><span class="id"> |</span><span class="id"> i</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> -1}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /sig_eqW[i</span><span class="id"> Di2]</span><span class="id"> :=</span><span class="id"> @solve_monicpoly</span><span class="id"> F</span><span class="id"> 2</span> (<span class="id">nth</span><span class="id"> 0</span><span class="id"> [::</span><span class="id"> -1]</span>)<span class="id"> isT</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> Di2</span><span class="id"> !big_ord_recl</span><span class="id"> big_ord0</span><span class="id"> mul0r</span><span class="id"> mulr1</span><span class="id"> !addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ClosedFieldTheory</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lalgMixin</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> A</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">phant</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> injective</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> scalable</span><span class="id"> f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> mulB,</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> mulB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span><span class="id"> -&gt;</span><br/>
&nbsp;<span class="gallina-kwd">forall</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v,</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">mulB</span><span class="id"> u</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> mulB</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> injf</span><span class="id"> fZ</span><span class="id"> mulB</span><span class="id"> fM</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span><span class="id"> injf;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fZ,</span><span class="id"> fM</span>)<span class="id"> scalerAl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comRingMixin</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">phant</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> injective</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span><span class="id"> -&gt;</span><span class="id"> commutative</span> (<span class="id">@mul</span><span class="id"> T</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> inj_f</span><span class="id"> fM</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span><span class="id"> inj_f;</span><span class="id"> rewrite</span><span class="id"> !fM</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> algMixin</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> algType</span><span class="id"> R</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> A</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">phant</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> injective</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> {morph</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span><span class="id"> -&gt;</span><span class="id"> scalable</span><span class="id"> f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> k</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> B</span>)<span class="id">,</span><span class="id"> k</span><span class="id"> *:</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> inj_f</span><span class="id"> fM</span><span class="id"> fZ</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span><span class="id"> inj_f;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">fM,</span><span class="id"> fZ</span>)<span class="id"> scalerAr</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isMul2Closed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">rpredM</span><span class="id"> :</span><span class="id"> mulr_2closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isMul1Closed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">rpred1</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> \in</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isInvClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">rpredVr</span><span class="id"> :</span><span class="id"> invr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isScaleClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> V}</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">rpredZ</span><span class="id"> :</span><span class="id"> scaler_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> addrClosed</span><span class="id"> :=</span><span class="id"> addrClosed</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> opprClosed</span><span class="id"> :=</span><span class="id"> opprClosed</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;mulr2Closed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Mul2Closed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> isMul2Closed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;mulrClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> MulClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> Mul2Closed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isMul1Closed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;semiring2Closed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> Semiring2Closed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> AddClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> Mul2Closed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;semiringClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SemiringClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> AddClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> MulClosed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;smulClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SmulClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> OppClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> MulClosed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subringClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubringClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> ZmodClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> MulClosed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;divClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> DivClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> MulClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isInvClosed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;sdivClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SdivClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> SmulClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isInvClosed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;submodClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubmodClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;<span class="id">:=</span><span class="id"> {S</span><span class="id"> of</span><span class="id"> AddClosed</span><span class="id"> V</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isScaleClosed</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subalgClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubalgClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;<span class="id">:=</span><span class="id"> {S</span><span class="id"> of</span><span class="id"> SemiringClosed</span><span class="id"> A</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isScaleClosed</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;divringClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> DivringClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> SubringClosed</span><span class="id"> R</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isInvClosed</span><span class="id"> R</span><span class="id"> S}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;divalgClosed&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> DivalgClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> unitAlgType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{S</span><span class="id"> of</span><span class="id"> DivringClosed</span><span class="id"> A</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> isScaleClosed</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S}</span>.<br/>
<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isMulClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> R}</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">rpred1M</span><span class="id"> :</span><span class="id"> mulr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isMulClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMul2Closed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span> (<span class="id">proj2</span><span class="id"> rpred1M</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMul1Closed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span> (<span class="id">proj1</span><span class="id"> rpred1M</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSmulClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">smulr_closed_subproof</span><span class="id"> :</span><span class="id"> smulr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSmulClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMulClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">smulr_closedM</span><span class="id"> smulr_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isOppClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">smulr_closedN</span><span class="id"> smulr_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSemiringClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSemiringClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isAddClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">semiring_closedD</span><span class="id"> semiring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMulClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">semiring_closedM</span><span class="id"> semiring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSubringClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSubringClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isZmodClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subring_closedB</span><span class="id"> subring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSmulClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subring_closedM</span><span class="id"> subring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isDivClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divr_closed_subproof</span><span class="id"> :</span><span class="id"> divr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isDivClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMulClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">divr_closedM</span><span class="id"> divr_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isInvClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">divr_closedV</span><span class="id"> divr_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSdivClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">sdivr_closed_subproof</span><span class="id"> :</span><span class="id"> sdivr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSdivClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isDivClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">sdivr_closed_div</span><span class="id"> sdivr_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSmulClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">sdivr_closedM</span><span class="id"> sdivr_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSubSemiModClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSubSemiModClosed</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isAddClosed</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemimod_closedD</span><span class="id"> subsemimod_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScaleClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemimod_closedZ</span><span class="id"> subsemimod_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSubmodClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSubmodClosed</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isZmodClosed</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemimod_closedB</span><span class="id"> subsemimod_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScaleClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemimod_closedZ</span><span class="id"> subsemimod_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSubSemiAlgClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSubSemiAlgClosed</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubSemiModClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedZ</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSemiringClosed</span>.<span class="id">Build</span><span class="id"> A</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedM</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSubalgClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isSubalgClosed</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubmodClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedZ</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSemiringClosed</span>.<span class="id">Build</span><span class="id"> A</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedM</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isDivringClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isDivringClosed</span><span class="id"> R</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubringClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">divring_closedBM</span><span class="id"> divring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSdivClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">divring_closed_div</span><span class="id"> divring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isDivalgClosed</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> unitAlgType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> bool</span>)<span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divalg_closed_subproof</span><span class="id"> :</span><span class="id"> divalg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> of</span><span class="id"> isDivalgClosed</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isDivringClosed</span>.<span class="id">Build</span><span class="id"> A</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">divalg_closedBdiv</span><span class="id"> divalg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubalgClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><br/>
&nbsp;&nbsp;(<span class="id">subalg_closed_semi</span> (<span class="id">divalg_closedZ</span><span class="id"> divalg_closed_subproof</span>)).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NmodulePred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> nmodType</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Add</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> addrClosed</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred0D</span><span class="id"> :</span><span class="id"> nmod_closed</span><span class="id"> S</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> nmod_closed_subproof</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Add</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> NmodulePred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ZmodulePred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> zmodType</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Opp</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> opprClosed</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Opp</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Sub</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> zmodClosed</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> zmodClosedP</span><span class="id"> :</span><span class="id"> zmod_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> split;</span><span class="id"> [</span><span class="id"> exact:</span> (<span class="id">@rpred0D</span><span class="id"> V</span><span class="id"> S</span>).<span class="id">1</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredB</span><span class="id"> ]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Sub</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ZmodulePred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SemiRingPred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Mul</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> mulrClosed</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred1M</span><span class="id"> :</span><span class="id"> mulr_closed</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">conj</span><span class="id"> rpred1</span><span class="id"> rpredM</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred_prod</span><span class="id"> I</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> F</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> -&gt;</span><span class="id"> \prod_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> IH;</span><span class="id"> elim/big_ind:</span><span class="id"> _;</span><span class="id"> [apply:</span><span class="id"> rpred1</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> rpredM</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredX</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> S,</span><span class="gallina-kwd"> forall</span><span class="id"> u,</span><span class="id"> u</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> u</span><span class="id"> Su;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">card_ord</span><span class="id"> n</span>)<span class="id"> -prodr_const</span><span class="id"> rpred_prod</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Mul</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred_nat</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> semiringClosed</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> \in</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rpredMn</span><span class="id"> ?rpred1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> semiringClosedP</span> (<span class="id">rngS</span><span class="id"> :</span><span class="id"> semiringClosed</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> rngS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> split;</span><span class="id"> [</span><span class="id"> exact:</span><span class="id"> rpred0D</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpred1M</span><span class="id"> ]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SemiRingPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RingPred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredMsign</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> opprClosed</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -signr_odd</span><span class="id"> mulr_sign;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> rpredN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredN1</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> smulClosed</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> -1</span><span class="id"> \in</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rpredN</span><span class="id"> rpred1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred_sign</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> smulClosed</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> :</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> \in</span><span class="id"> S</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rpredX</span><span class="id"> ?rpredN1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subringClosedP</span> (<span class="id">rngS</span><span class="id"> :</span><span class="id"> subringClosed</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> rngS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> split;</span><span class="id"> [</span><span class="id"> exact:</span><span class="id"> rpred1</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredB</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredM</span><span class="id"> ]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RingPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LmodPred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredZnat</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> addrClosed</span><span class="id"> V</span>)<span class="id"> n</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> S,</span><span class="gallina-kwd"> forall</span><span class="id"> u,</span><span class="id"> n%:R</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> u</span><span class="id"> Su;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> scaler_nat</span><span class="id"> rpredMn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemimodClosedP</span> (<span class="id">modS</span><span class="id"> :</span><span class="id"> submodClosed</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> modS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split;</span><span class="id"> [exact:</span><span class="id"> rpred0D</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredZ]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LmodPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LmodPred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredZsign</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> opprClosed</span><span class="id"> V</span>)<span class="id"> n</span><span class="id"> u</span><span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">u</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -signr_odd</span><span class="id"> scaler_sign</span><span class="id"> fun_if</span><span class="id"> if_arg</span><span class="id"> rpredN</span><span class="id"> if_same</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submodClosedP</span> (<span class="id">modS</span><span class="id"> :</span><span class="id"> submodClosed</span><span class="id"> V</span>)<span class="id"> :</span><span class="id"> submod_closed</span><span class="id"> modS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/subsemimod_closed_submod/subsemimodClosedP</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LmodPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LalgPred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subsemialgClosedP</span> (<span class="id">algS</span><span class="id"> :</span><span class="id"> subalgClosed</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> algS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split;</span><span class="id"> [</span><span class="id"> exact:</span><span class="id"> rpred1</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpred0D</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredZ</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredM</span><span class="id"> ]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LalgPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LalgPred</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subalgClosedP</span> (<span class="id">algS</span><span class="id"> :</span><span class="id"> subalgClosed</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> subalg_closed</span><span class="id"> algS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/subsemialg_closed_subalg/subsemialgClosedP</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LalgPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> UnitRingPred</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> unitRingType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Div</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> S</span><span class="id"> :</span><span class="id"> divClosed</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredV</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x^-1</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> /rpredVr;</span><span class="id"> rewrite</span><span class="id"> ?invrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred_div</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> S</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> Sx</span><span class="id"> Sy;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rpredM</span><span class="id"> ?rpredV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredXN</span><span class="id"> n</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> S,</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> x</span><span class="id"> ^-</span><span class="id"> n</span><span class="id"> \in</span><span class="id"> S}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> Sx;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> rpredV</span><span class="id"> rpredX</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit-&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Sx</span><span class="id"> Ux;</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> [Sxy</span><span class="id"> |</span><span class="id"> /</span>(<span class="id">rpredM</span><span class="id"> _</span><span class="id"> _</span><span class="id"> Sx</span>)<span class="id">-&gt;</span><span class="id"> //]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulKr</span><span class="id"> Ux</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> rpredM</span><span class="id"> ?rpredV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Sx</span><span class="id"> Ux;</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> [Sxy</span><span class="id"> |</span><span class="id"> /rpredM-&gt;</span><span class="id"> //]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulrK</span><span class="id"> Ux</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> rpred_div</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred_divr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -rpredV</span><span class="id"> -unitrV;</span><span class="id"> apply:</span><span class="id"> rpredMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpred_divl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">rpredV</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> rpredMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Div</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divringClosedP</span> (<span class="id">divS</span><span class="id"> :</span><span class="id"> divringClosed</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> divS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> split;</span><span class="id"> [</span><span class="id"> exact:</span><span class="id"> rpred1</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpredB</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> rpred_div</span><span class="id"> ]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> unitr_sdivr_closed</span><span class="id"> :</span><span class="id"> @sdivr_closed</span><span class="id"> R</span><span class="id"> unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y</span><span class="id"> Ux</span><span class="id"> Uy];</span><span class="id"> rewrite</span><span class="id"> ?unitrN1</span><span class="id"> //</span><span class="id"> unitrMl</span><span class="id"> ?unitrV</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSdivClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> unit_pred</span><span class="id"> unitr_sdivr_closed</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrN</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rpredN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invrN</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id">^-1</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [Ux</span><span class="id"> |</span><span class="id"> U'x]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !invr_out</span><span class="id"> ?unitrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulN1r</span><span class="id"> invrM</span><span class="id"> ?unitrN1</span><span class="id"> //</span><span class="id"> invrN1</span><span class="id"> mulrN1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divrNN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> /</span> (<span class="id">-</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invrN</span><span class="id"> mulrNN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divrN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span> (<span class="id">-</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invrN</span><span class="id"> mulrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> invr_signM</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span>)<span class="id">^-1</span><span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -signr_odd</span><span class="id"> !mulr_sign;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> invrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> divr_signM</span> (<span class="id">b1</span><span class="id"> b2</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> x1</span><span class="id"> x2:</span><br/>
&nbsp;&nbsp;((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b1</span><span class="id"> *</span><span class="id"> x1</span>)<span class="id"> /</span> ((<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> b2</span><span class="id"> *</span><span class="id"> x2</span>)<span class="id"> =</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">b1</span> (<span class="id">+</span>)<span class="id"> b2</span>)<span class="id"> *</span> (<span class="id">x1</span><span class="id"> /</span><span class="id"> x2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_signM</span><span class="id"> mulr_signM</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> UnitRingPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FieldPred</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> F</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="vernacular"> ModuleTheory</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> F</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> F</span>) (<span class="id">v</span><span class="id"> :</span><span class="id"> V</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rpredZeq</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> submodClosed</span><span class="id"> V</span>)<span class="id"> a</span><span class="id"> v</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">v</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_a]</span><span class="id"> :=</span><span class="id"> eqVneq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scale0r</span><span class="id"> rpred0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/idP/idP;</span><span class="id"> first</span><span class="id"> rewrite</span><span class="id"> -{2}</span>(<span class="id">scalerK</span><span class="id"> nz_a</span><span class="id"> v</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> rpredZ</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="vernacular"> ModuleTheory</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Predicates</span>.<br/>
<br/>
<span class="vernacular">Context</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> divClosed</span><span class="id"> F</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fpredMl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!unitfE;</span><span class="id"> apply:</span><span class="id"> rpredMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fpredMr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!unitfE;</span><span class="id"> apply:</span><span class="id"> rpredMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fpred_divl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!unitfE;</span><span class="id"> apply:</span><span class="id"> rpred_divl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fpred_divr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> \in</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!unitfE;</span><span class="id"> apply:</span><span class="id"> rpred_divr</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Predicates</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FieldPred</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isSubPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> PzSemiRing</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">valM_subproof</span><span class="id"> :</span><span class="id"> monoid_morphism</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> isSubSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use isSubPzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> isSubSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use isSubPzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> isSubSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">isSubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subPzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> PzSemiRing</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> isSubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subNzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubNzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> NzSemiRing</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> isSubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubSemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubNzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzSemiRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">SubNzSemiRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzSemiRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubNzSemiRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzSemiRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubNzSemiRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubSemiRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> multiplicative</span>.<br/>
<span class="vernacular">Context</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>) (<span class="id">U</span><span class="id"> :</span><span class="id"> SubPzSemiRing</span>.<span class="id">type</span><span class="id"> S</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> val</span><span class="id"> :=</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> R</span>).<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> R</span><span class="id"> val</span><span class="id"> valM_subproof</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> val1</span><span class="id"> :</span><span class="id"> val</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorph1</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> valM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> val</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rmorphM</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> valM1</span><span class="id"> :</span><span class="id"> monoid_morphism</span><span class="id"> val</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> valM_subproof</span>. Qed.</div></details>
<span class="vernacular">End</span><span class="id"> multiplicative</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNmodule_isSubPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">mulr_closed_subproof</span><span class="id"> :</span><span class="id"> mulr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNmodule_isSubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMulClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> mulr_closed_subproof</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> inU</span><span class="id"> v</span><span class="id"> Sv</span><span class="id"> :</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> Sub</span><span class="id"> v</span><span class="id"> Sv</span>.<br/>
<span class="vernacular">Let</span><span class="id"> oneU</span><span class="id"> :</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> inU</span> (<span class="id">@rpred1</span><span class="id"> _</span> (<span class="id">MulClosed</span>.<span class="id">clone</span><span class="id"> R</span><span class="id"> S</span><span class="id"> _</span>)).<br/>
<span class="vernacular">Let</span><span class="id"> mulU</span> (<span class="id">u1</span><span class="id"> u2</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :=</span><span class="id"> inU</span> (<span class="id">rpredM</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">valP</span><span class="id"> u1</span>) (<span class="id">valP</span><span class="id"> u2</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mulU</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !SubK</span><span class="id"> mulrA</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mul1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> oneU</span><span class="id"> mulU</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !SubK</span><span class="id"> mul1r</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulr1</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> oneU</span><span class="id"> mulU</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !SubK</span><span class="id"> mulr1</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mulU</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">SubK,</span><span class="id"> raddfD</span>)<span class="id">/=</span><span class="id"> !SubK</span><span class="id"> mulrDl</span>.<br/>
Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulrDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mulU</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">SubK,</span><span class="id"> raddfD</span>)<span class="id">/=</span><span class="id"> !SubK</span><span class="id"> mulrDr</span>.<br/>
Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> 0%R</span><span class="id"> mulU</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> SubK</span><span class="id"> val0</span><span class="id"> mul0r</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> 0%R</span><span class="id"> mulU</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> SubK</span><span class="id"> val0</span><span class="id"> mulr0</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">mulrA</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> mulrDl</span><span class="id"> mulrDr</span><span class="id"> mul0r</span><span class="id"> mulr0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> valM</span><span class="id"> :</span><span class="id"> monoid_morphism</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> y]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> !SubK</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> valM</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubPzSemiRing_isNonZero</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubPzSemiRing_isNonZero</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> oner_neq0</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">inj_eq</span><span class="id"> val_inj</span>)<span class="id"> rmorph0</span><span class="id"> rmorph1</span><span class="id"> oner_neq0</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> oner_neq0</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNmodule_isSubNzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">mulr_closed_subproof</span><span class="id"> :</span><span class="id"> mulr_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubNmodule_isSubSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNmodule_isSubNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubNmodule_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubNmodule_isSubSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNmodule_isSubNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubNmodule_isSubSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNmodule_isSubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNmodule_isSubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">mulr_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subComPzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubComPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> ComPzSemiRing</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubPzSemiRing_isSubComPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubPzSemiRing_isSubComPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrC</span><span class="id"> :</span><span class="id"> @commutative</span><span class="id"> U</span><span class="id"> U</span><span class="id"> *%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !rmorphM</span><span class="id"> mulrC</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> mulrC</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subComNzSemiRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubComNzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> ComNzSemiRing</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubComSemiRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubComNzSemiRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubComSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzSemiRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span> <span class="id"> :=</span> (<span class="id">SubComNzSemiRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzSemiRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubComNzSemiRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzSemiRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubComNzSemiRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubComSemiRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNzSemiRing_isSubComNzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubSemiRing_isSubComSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzSemiRing_isSubComNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzSemiRing_isSubComNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubSemiRing_isSubComSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzSemiRing_isSubComNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubSemiRing_isSubComSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzSemiRing_isSubComNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNzSemiRing_isSubComNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span> <span class="id"> SubPzSemiRing_isSubComPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subPzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubPzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> PzRing</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> isSubZmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubZmodule_isSubPzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubZmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubZmodule_isSubPzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">smulr_closedM</span> (<span class="id">subring_closedM</span><span class="id"> subring_closed_subproof</span>)).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subNzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubNzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> NzRing</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> isSubBaseAddUMagma</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> }</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubNzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">SubNzRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubNzRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubNzRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubZmodule_isSubNzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubZmodule</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubZmodule_isSubRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubZmodule_isSubNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubZmodule_isSubNzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubZmodule_isSubRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubZmodule_isSubNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubZmodule_isSubRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubZmodule_isSubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubZmodule_isSubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">smulr_closedM</span> (<span class="id">subring_closedM</span><span class="id"> subring_closed_subproof</span>)).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subComPzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubComPzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubPzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> ComPzRing</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubPzRing_isSubComPzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubPzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubPzRing_isSubComPzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isSubComPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subComNzRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubComNzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> ComNzRing</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubComRing</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubComNzRing</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubComRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzRing.sort instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">SubComNzRing</span>.<span class="id">sort</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzRing.on instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> on</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">SubComNzRing</span>.<span class="id">on</span><span class="id"> R</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubComNzRing.copy instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> copy</span><span class="id"> T</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubComNzRing</span>.<span class="id">copy</span><span class="id"> T</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubComRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNzRing_isSubComNzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubRing_isSubComRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing_isSubComNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubNzRing_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubRing_isSubComRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing_isSubComNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubRing_isSubComRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_isSubComNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNzRing_isSubComNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzRing_isSubComPzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">mixin</span><span class="vernacular"> Record</span><span class="id"> isSubLSemiModule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> V</span>)<span class="id"> W</span><span class="id"> of</span><span class="id"> SubNmodule</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> LSemiModule</span><span class="id"> R</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">valZ</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> W</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subLSemiModType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubLSemiModule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> V</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubNmodule</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Nmodule_isLSemiModule</span><span class="id"> R</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> isSubLSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subLmodType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubLmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> V</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubZmodule</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Nmodule_isLSemiModule</span><span class="id"> R</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> isSubLSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> linear</span>.<br/>
<span class="vernacular">Context</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<span class="vernacular">Context</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> V</span>) (<span class="id">W</span><span class="id"> :</span><span class="id"> subLSemiModType</span><span class="id"> S</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> val</span><span class="id"> :=</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> W</span><span class="id"> -&gt;</span><span class="id"> V</span>).<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isScalable</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> W</span><span class="id"> V</span><span class="id"> *:%R</span><span class="id"> val</span><span class="id"> valZ</span>.<br/>
<span class="vernacular">End</span><span class="id"> linear</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> isSubLmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> V</span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id">W</span><span class="id"> of</span><span class="id"> SubZmodule</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> Lmodule</span><span class="id"> R</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;<span class="id">valZ</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> W</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> isSubLmodule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> valZ</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNmodule_isSubLSemiModule</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubNmodule</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubNmodule_isSubLSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isSubSemiModClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> subsemimod_closed_subproof</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> inW</span><span class="id"> v</span><span class="id"> Sv</span><span class="id"> :</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> Sub</span><span class="id"> v</span><span class="id"> Sv</span>.<br/>
<span class="vernacular">Let</span><span class="id"> scaleW</span><span class="id"> a</span> (<span class="id">w</span><span class="id"> :</span><span class="id"> W</span>)<span class="id"> :=</span><span class="id"> inW</span> (<span class="id">rpredZ</span><span class="id"> a</span><span class="id"> _</span> (<span class="id">valP</span><span class="id"> w</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerA'</span><span class="id"> a</span><span class="id"> b</span><span class="id"> v</span><span class="id"> :</span><span class="id"> scaleW</span><span class="id"> a</span> (<span class="id">scaleW</span><span class="id"> b</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> scaleW</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !SubK</span><span class="id"> scalerA</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> scale0r</span><span class="id"> v</span><span class="id"> :</span><span class="id"> scaleW</span><span class="id"> 0</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> SubK</span><span class="id"> scale0r</span><span class="id"> raddf0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> scale1r</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> 1</span><span class="id"> scaleW</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> SubK</span><span class="id"> scale1r</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> scalerDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> scaleW</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> SubK</span><span class="id"> !raddfD/=</span><span class="id"> !SubK</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> scalerDl</span><span class="id"> v</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> scaleW^~</span><span class="id"> v</span><span class="id"> :</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> raddfD/=</span><span class="id"> !SubK</span><span class="id"> scalerDl</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">scalerA'</span><span class="id"> scale0r</span><span class="id"> scale1r</span><span class="id"> scalerDr</span><span class="id"> scalerDl</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> valZ</span><span class="id"> :</span><span class="id"> scalable</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> W</span><span class="id"> -&gt;</span><span class="id"> _</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> k</span><span class="id"> w;</span><span class="id"> rewrite</span><span class="id"> SubK</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> valZ</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubZmodule_isSubLmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubZmodule</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubZmodule_isSubLmodule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subLSemiAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubLSemiAlgebra</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{W</span><span class="id"> of</span><span class="id"> SubNzSemiRing</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> @SubLSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> LSemiAlgebra</span><span class="id"> R</span><span class="id"> W}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subLalgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubLalgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{W</span><span class="id"> of</span><span class="id"> SubNzRing</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> @SubLmodule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> Lalgebra</span><span class="id"> R</span><span class="id"> W}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra</span><br/>
&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNzSemiRing</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> @SubLSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerAl</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> W</span>)<span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> u</span><span class="id"> *</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">linearZ,</span><span class="id"> rmorphM</span>)<span class="id"> /=</span><span class="id"> linearZ</span><span class="id"> scalerAl</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiModule_isLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> W</span><span class="id"> scalerAl</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNzRing_SubLmodule_isSubLalgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">V</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubNzRing</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> @SubLmodule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubRing_SubLmodule_isSubLalgebra</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing_SubLmodule_isSubLalgebra.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_SubLmodule_isSubLalgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubRing_SubLmodule_isSubLalgebra</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubNzRing_SubLmodule_isSubLalgebra instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubRing_SubLmodule_isSubLalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_SubLmodule_isSubLalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubNzRing_SubLmodule_isSubLalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subSemiAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubSemiAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> semiAlgType</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{W</span><span class="id"> of</span><span class="id"> @SubLSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> SemiAlgebra</span><span class="id"> R</span><span class="id"> W}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subAlgType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> algType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{W</span><span class="id"> of</span><span class="id"> @SubLalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> &amp;</span><span class="id"> Algebra</span><span class="id"> R</span><span class="id"> W}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubLSemiAlgebra_isSubSemiAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">V</span><span class="id"> :</span><span class="id"> semiAlgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> @SubLSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubLSemiAlgebra_isSubSemiAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> scalerAr</span> (<span class="id">k</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> W</span>)<span class="id"> :</span><span class="id"> k</span><span class="id"> *:</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">k</span><span class="id"> *:</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">linearZ,</span><span class="id"> rmorphM</span>)<span class="id">/=</span><span class="id"> linearZ</span><span class="id"> scalerAr</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> W</span><span class="id"> scalerAr</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubLalgebra_isSubAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">V</span><span class="id"> :</span><span class="id"> algType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> @SubLalgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubLalgebra_isSubAlgebra</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubLSemiAlgebra_isSubSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subUnitRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubUnitRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> UnitRing</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubNzRing_isSubUnitRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubNzRing_isSubUnitRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isDivringClosed</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> divring_closed_subproof</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> inU</span><span class="id"> v</span><span class="id"> Sv</span><span class="id"> :</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> Sub</span><span class="id"> v</span><span class="id"> Sv</span>.<br/>
<span class="vernacular">Let</span><span class="id"> invU</span> (<span class="id">u</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :=</span><span class="id"> inU</span> (<span class="id">rpredVr</span><span class="id"> _</span> (<span class="id">valP</span><span class="id"> u</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulVr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> val</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit],</span><span class="id"> left_inverse</span><span class="id"> 1</span><span class="id"> invU</span><span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> /[!inE]</span><span class="id"> xu;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> rmorphM</span><span class="id"> rmorph1</span><span class="id"> /=</span><span class="id"> SubK</span><span class="id"> mulVr</span>.<br/>
Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> divrr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> val</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit],</span><span class="id"> right_inverse</span><span class="id"> 1</span><span class="id"> invU</span><span class="id"> *%R}</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> /[!inE]</span><span class="id"> xu;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> rmorphM</span><span class="id"> rmorph1</span><span class="id"> /=</span><span class="id"> SubK</span><span class="id"> mulrV</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> unitrP</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> val</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> unit</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> -[/</span>(<span class="id">congr1</span><span class="id"> val</span>)<span class="id"> yx1</span><span class="id"> /</span>(<span class="id">congr1</span><span class="id"> val</span>)<span class="id"> xy1]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> rev_unitrP</span> (<span class="id">val</span><span class="id"> y</span>)<span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !rmorphM</span><span class="id"> rmorph1</span><span class="id"> /=</span><span class="gallina-kwd"> in</span><span class="id"> yx1</span><span class="id"> xy1</span>.<br/>
Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> invr_out</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> val</span><span class="id"> x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> unit],</span><span class="id"> invU</span><span class="id"> =1</span><span class="id"> id}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> /[!inE]</span><span class="id"> xNU;</span><span class="id"> apply:</span><span class="id"> val_inj;</span><span class="id"> rewrite</span><span class="id"> SubK</span><span class="id"> invr_out</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> NzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">mulVr</span><span class="id"> divrr</span><span class="id"> unitrP</span><span class="id"> invr_out</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subComUnitRingType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubComUnitRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubComNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> SubUnitRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subIdomainType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubIntegralDomain</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> idomainType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubComNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> IntegralDomain</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubComUnitRing_isSubIntegralDomain</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> idomainType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubComUnitRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubComUnitRing_isSubIntegralDomain</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> id</span><span class="id"> :</span><span class="id"> IntegralDomain</span>.<span class="id">axiom</span><span class="id"> U</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span>(<span class="id">congr1</span><span class="id"> val</span>)<span class="id">/eqP;</span><span class="id"> rewrite</span><span class="id"> rmorphM</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">inj_eq</span><span class="id"> val_inj</span>)<span class="id"> rmorph0</span><span class="id"> -mulf_eq0</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> ComUnitRing_isIntegral</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> id</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=</span><span class="id">&quot;subFieldType&quot;</span>)<span class="id">]</span><br/>
<span class="id">HB</span>.<span class="id">structure</span><span class="vernacular"> Definition</span><span class="id"> SubField</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> fieldType</span>) (<span class="id">S</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> F</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">{U</span><span class="id"> of</span><span class="id"> SubIntegralDomain</span><span class="id"> F</span><span class="id"> S</span><span class="id"> U</span><span class="id"> &amp;</span><span class="id"> Field</span><span class="id"> U}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubIntegralDomain_isSubField</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> fieldType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubIntegralDomain</span><span class="id"> F</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subfield_subproof</span><span class="id"> :</span><span class="id"> {mono</span> (<span class="id">val</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> F</span>)<span class="id"> :</span><span class="id"> u</span><span class="id"> /</span><span class="id"> u</span><span class="id"> \in</span><span class="id"> unit}</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> F</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubIntegralDomain_isSubField</span><span class="id"> F</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> fieldP</span><span class="id"> :</span><span class="id"> Field</span>.<span class="id">axiom</span><span class="id"> U</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> u;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">inj_eq</span><span class="id"> val_inj</span>)<span class="id"> rmorph0</span><span class="id"> -unitfE</span><span class="id"> subfield_subproof</span>.<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> UnitRing_isField</span>.<span class="id">Build</span><span class="id"> U</span><span class="id"> fieldP</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubNmodule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">semiring_closedD</span><span class="id"> semiring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">semiring_closedM</span><span class="id"> semiring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubNzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubChoice_isSubSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubChoice_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubChoice_isSubSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubChoice_isSubSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubComPzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubComPzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isSubComPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubComNzSemiRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span><span class="id"> :</span><span class="id"> semiring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubChoice_isSubComSemiRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubComNzSemiRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubChoice_isSubComSemiRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubComNzSemiRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubChoice_isSubComSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubComNzSemiRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubComPzSemiRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">semiring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubPzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubPzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubZmodule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">subring_closedB</span><span class="id"> subring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubZmodule_isSubPzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubNzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubChoice_isSubRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubChoice_isSubNzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubChoice_isSubRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubChoice_isSubRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubPzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubComPzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubComPzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubPzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzRing_isSubComPzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubComNzRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comNzRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span><span class="id"> :</span><span class="id"> subring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubChoice_isSubComRing</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubComNzRing.Build instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span> (<span class="id">SubChoice_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">End</span><span class="id"> SubChoice_isSubComRing</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use SubChoice_isSubComNzRing instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> SubChoice_isSubComRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubComNzRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubComPzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">subring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubPzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubLSemiModule</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice_isSubLSemiModule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubNmodule</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;(<span class="id">subsemimod_closedD</span><span class="id"> subsemimod_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubLmodule</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span><span class="id"> :</span><span class="id"> subsemimod_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice_isSubLmodule</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubZmodule</span>.<span class="id">Build</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;(<span class="id">subsemimod_closedB</span><span class="id"> subsemimod_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubZmodule_isSubLmodule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> V</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">subsemimod_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubLSemiAlgebra</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice_isSubLSemiAlgebra</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedM</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNmodule_isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedZ</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubLalgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice_isSubLalgebra</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubNzRing</span>.<span class="id">Build</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedBM</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubZmodule_isSubLmodule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;(<span class="id">subsemialg_closedZ</span><span class="id"> subsemialg_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNzRing_SubLmodule_isSubLalgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubSemiAlgebra</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> semiAlgType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice_isSubSemiAlgebra</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubLSemiAlgebra_isSubSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubAlgebra</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> algType</span><span class="id"> R</span>)<span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span><span class="id"> :</span><span class="id"> subsemialg_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><span class="id"> of</span><span class="id"> SubChoice_isSubAlgebra</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubLalgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span><br/>
&nbsp;&nbsp;<span class="id">subsemialg_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubLalgebra_isSubAlgebra</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> A</span><span class="id"> S</span><span class="id"> W</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubUnitRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> unitRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubUnitRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubNzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">divring_closedBM</span><span class="id"> divring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNzRing_isSubUnitRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubComUnitRing</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> comUnitRingType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubComUnitRing</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;(<span class="id">divring_closedBM</span><span class="id"> divring_closed_subproof</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubNzRing_isSubUnitRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">factory</span><span class="vernacular"> Record</span><span class="id"> SubChoice_isSubIntegralDomain</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> idomainType</span>)<span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span><span class="id"> SubChoice</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span><span class="id"> :</span><span class="id"> divring_closed</span><span class="id"> S</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">builders</span><span class="vernacular"> Context</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><span class="id"> of</span><span class="id"> SubChoice_isSubIntegralDomain</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubChoice_isSubComUnitRing</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span><br/>
&nbsp;&nbsp;<span class="id">divring_closed_subproof</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> SubComUnitRing_isSubIntegralDomain</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> S</span><span class="id"> U</span>.<br/>
<span class="id">HB</span>.<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> SubExports</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNmodule_isSubNzSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNmodule_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">@rpred1M</span><span class="id"> _</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNmodule_isSubNzSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ SubNmodule_isSubNzSemiRing of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNmodule_isSubSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNmodule_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">@rpred1M</span><span class="id"> _</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNmodule_isSubSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubNzSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">semiringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubNzSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubChoice_isSubNzSemiRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">semiringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNzSemiRing_isSubComNzSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzSemiRing_isSubComNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNzSemiRing_isSubComNzSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubNzSemiRing_isSubComNzSemiRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubSemiRing_isSubComSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzSemiRing_isSubComNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubSemiRing_isSubComSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubComNzSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">semiringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubComNzSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubChoice_isSubComNzSemiRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubComSemiRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzSemiRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">semiringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubComSemiRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubZmodule_isSubNzRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubZmodule_isSubNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubZmodule_isSubNzRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubZmodule_isSubNzRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubZmodule_isSubRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubZmodule_isSubNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubZmodule_isSubRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubNzRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubNzRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubChoice_isSubNzRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNzRing_isSubComNzRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNzRing_isSubComNzRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubNzRing_isSubComNzRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubRing_isSubComRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubRing_isSubComRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubComNzRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubComNzRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubChoice_isSubComNzRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubComRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComNzRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubComRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNmodule_isSubLSemiModule' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNmodule_isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemimodClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNmodule_isSubLSemiModule'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubLSemiModule' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubLSemiModule</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemimodClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubLSemiModule'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubZmodule_isSubLmodule' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubZmodule_isSubLmodule</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemimodClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubZmodule_isSubLmodule'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubLmodule' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubLmodule</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemimodClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubLmodule'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNzSemiRing_SubLSemiModule_isSubLSemiAlgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubLSemiAlgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemialgClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubLSemiAlgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNzRing_SubLmodule_isSubLalgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_SubLmodule_isSubLalgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNzRing_SubLmodule_isSubLalgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubNzRing_SubLmodule_isSubLalgebra' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubRing_SubLmodule_isSubLalgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_SubLmodule_isSubLalgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubRing_SubLmodule_isSubLalgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubLalgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubLalgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemialgClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubLalgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubLSemiAlgebra_isSubSemiAlgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubLSemiAlgebra_isSubSemiAlgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubLSemiAlgebra_isSubSemiAlgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubSemiAlgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubSemiAlgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemialgClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubSemiAlgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubLalgebra_isSubAlgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubLalgebra_isSubAlgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubLalgebra_isSubAlgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubAlgebra' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubAlgebra</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">subsemialgClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubAlgebra'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubNzRing_isSubUnitRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_isSubUnitRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">divringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubNzRing_isSubUnitRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Use [ 'SubNzRing_isSubUnitRing' of U by &lt;: ] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubRing_isSubUnitRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubNzRing_isSubUnitRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">divringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubRing_isSubUnitRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubUnitRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubUnitRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">divringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubUnitRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubComUnitRing' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubComUnitRing</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">divringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubComUnitRing'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubComUnitRing_isSubIntegralDomain' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubComUnitRing_isSubIntegralDomain</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubComUnitRing_isSubIntegralDomain'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubChoice_isSubIntegralDomain' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubChoice_isSubIntegralDomain</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">divringClosedP</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubChoice_isSubIntegralDomain'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'SubIntegralDomain_isSubField' 'of' U 'by' &lt;: ]&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">SubIntegralDomain_isSubField</span>.<span class="id">Build</span><span class="id"> _</span><span class="id"> _</span><span class="id"> U</span> (<span class="id">frefl</span><span class="id"> _</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;[ 'SubIntegralDomain_isSubField'  'of'  U  'by'  &lt;: ]&quot;</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> form_scope</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> SubExports</span>.<br/>
<span class="id">HB</span>.<span class="id">export</span><span class="id"> SubExports</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> Theory</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> addrA</span><span class="id"> :=</span><span class="id"> @addrA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrC</span><span class="id"> :=</span><span class="id"> @addrC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> add0r</span><span class="id"> :=</span><span class="id"> @add0r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addNr</span><span class="id"> :=</span><span class="id"> @addNr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addr0</span><span class="id"> :=</span><span class="id"> addr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrN</span><span class="id"> :=</span><span class="id"> addrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrr</span><span class="id"> :=</span><span class="id"> subrr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrCA</span><span class="id"> :=</span><span class="id"> addrCA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrAC</span><span class="id"> :=</span><span class="id"> addrAC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrACA</span><span class="id"> :=</span><span class="id"> addrACA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addKr</span><span class="id"> :=</span><span class="id"> addKr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addNKr</span><span class="id"> :=</span><span class="id"> addNKr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrK</span><span class="id"> :=</span><span class="id"> addrK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrNK</span><span class="id"> :=</span><span class="id"> addrNK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrK</span><span class="id"> :=</span><span class="id"> subrK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrKC</span><span class="id"> :=</span><span class="id"> subrKC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subKr</span><span class="id"> :=</span><span class="id"> subKr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrI</span><span class="id"> :=</span><span class="id"> @addrI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addIr</span><span class="id"> :=</span><span class="id"> @addIr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrI</span><span class="id"> :=</span><span class="id"> @subrI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subIr</span><span class="id"> :=</span><span class="id"> @subIr</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addrI</span><span class="id"> {V}</span><span class="id"> y</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addIr</span><span class="id"> {V}</span><span class="id"> x</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> subrI</span><span class="id"> {V}</span><span class="id"> y</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> subIr</span><span class="id"> {V}</span><span class="id"> x</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> opprK</span><span class="id"> :=</span><span class="id"> @opprK</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> opprK</span><span class="id"> {V}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_inj</span><span class="id"> :=</span><span class="id"> @oppr_inj</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> oppr_inj</span><span class="id"> {V}</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> oppr0</span><span class="id"> :=</span><span class="id"> oppr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_eq0</span><span class="id"> :=</span><span class="id"> oppr_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> opprD</span><span class="id"> :=</span><span class="id"> opprD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> opprB</span><span class="id"> :=</span><span class="id"> opprB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrKA</span><span class="id"> :=</span><span class="id"> addrKA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrKA</span><span class="id"> :=</span><span class="id"> subrKA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr0</span><span class="id"> :=</span><span class="id"> subr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sub0r</span><span class="id"> :=</span><span class="id"> sub0r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr_eq</span><span class="id"> :=</span><span class="id"> subr_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addr0_eq</span><span class="id"> :=</span><span class="id"> addr0_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr0_eq</span><span class="id"> :=</span><span class="id"> subr0_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr_eq0</span><span class="id"> :=</span><span class="id"> subr_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addr_eq0</span><span class="id"> :=</span><span class="id"> addr_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eqr_opp</span><span class="id"> :=</span><span class="id"> eqr_opp</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eqr_oppLR</span><span class="id"> :=</span><span class="id"> eqr_oppLR</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sumrN</span><span class="id"> :=</span><span class="id"> sumrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sumrB</span><span class="id"> :=</span><span class="id"> sumrB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sumrMnl</span><span class="id"> :=</span><span class="id"> sumrMnl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sumrMnr</span><span class="id"> :=</span><span class="id"> sumrMnr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sumr_const</span><span class="id"> :=</span><span class="id"> sumr_const</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sumr_const_nat</span><span class="id"> :=</span><span class="id"> sumr_const_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> telescope_sumr</span><span class="id"> :=</span><span class="id"> telescope_sumr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> telescope_sumr_eq</span><span class="id"> :=</span><span class="id"> @telescope_sumr_eq</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> telescope_sumr_eq</span><span class="id"> {V</span><span class="id"> n</span><span class="id"> m}</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr0n</span><span class="id"> :=</span><span class="id"> mulr0n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr1n</span><span class="id"> :=</span><span class="id"> mulr1n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr2n</span><span class="id"> :=</span><span class="id"> mulr2n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrS</span><span class="id"> :=</span><span class="id"> mulrS</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrSr</span><span class="id"> :=</span><span class="id"> mulrSr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrb</span><span class="id"> :=</span><span class="id"> mulrb</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mul0rn</span><span class="id"> :=</span><span class="id"> mul0rn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulNrn</span><span class="id"> :=</span><span class="id"> mulNrn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnDl</span><span class="id"> :=</span><span class="id"> mulrnDl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnDr</span><span class="id"> :=</span><span class="id"> mulrnDr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnBl</span><span class="id"> :=</span><span class="id"> mulrnBl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnBr</span><span class="id"> :=</span><span class="id"> mulrnBr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnA</span><span class="id"> :=</span><span class="id"> mulrnA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnAC</span><span class="id"> :=</span><span class="id"> mulrnAC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> iter_addr</span><span class="id"> :=</span><span class="id"> iter_addr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> iter_addr_0</span><span class="id"> :=</span><span class="id"> iter_addr_0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrA</span><span class="id"> :=</span><span class="id"> @mulrA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mul1r</span><span class="id"> :=</span><span class="id"> @mul1r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr1</span><span class="id"> :=</span><span class="id"> @mulr1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrDl</span><span class="id"> :=</span><span class="id"> @mulrDl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrDr</span><span class="id"> :=</span><span class="id"> @mulrDr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> oner_neq0</span><span class="id"> :=</span><span class="id"> @oner_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> oner_eq0</span><span class="id"> :=</span><span class="id"> oner_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mul0r</span><span class="id"> :=</span><span class="id"> @mul0r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr0</span><span class="id"> :=</span><span class="id"> @mulr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrN</span><span class="id"> :=</span><span class="id"> mulrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulNr</span><span class="id"> :=</span><span class="id"> mulNr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrNN</span><span class="id"> :=</span><span class="id"> mulrNN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulN1r</span><span class="id"> :=</span><span class="id"> mulN1r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrN1</span><span class="id"> :=</span><span class="id"> mulrN1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_suml</span><span class="id"> :=</span><span class="id"> mulr_suml</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_sumr</span><span class="id"> :=</span><span class="id"> mulr_sumr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrBl</span><span class="id"> :=</span><span class="id"> mulrBl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrBr</span><span class="id"> :=</span><span class="id"> mulrBr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnAl</span><span class="id"> :=</span><span class="id"> mulrnAl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrnAr</span><span class="id"> :=</span><span class="id"> mulrnAr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_natl</span><span class="id"> :=</span><span class="id"> mulr_natl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_natr</span><span class="id"> :=</span><span class="id"> mulr_natr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natrD</span><span class="id"> :=</span><span class="id"> natrD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> nat1r</span><span class="id"> :=</span><span class="id"> nat1r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natr1</span><span class="id"> :=</span><span class="id"> natr1</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> natr1</span><span class="id"> {R}</span><span class="id"> n</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> nat1r</span><span class="id"> {R}</span><span class="id"> n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natrB</span><span class="id"> :=</span><span class="id"> natrB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natr_sum</span><span class="id"> :=</span><span class="id"> natr_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natrM</span><span class="id"> :=</span><span class="id"> natrM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natrX</span><span class="id"> :=</span><span class="id"> natrX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr0</span><span class="id"> :=</span><span class="id"> expr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprS</span><span class="id"> :=</span><span class="id"> exprS</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr1</span><span class="id"> :=</span><span class="id"> expr1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr2</span><span class="id"> :=</span><span class="id"> expr2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr0n</span><span class="id"> :=</span><span class="id"> expr0n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr1n</span><span class="id"> :=</span><span class="id"> expr1n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprD</span><span class="id"> :=</span><span class="id"> exprD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprSr</span><span class="id"> :=</span><span class="id"> exprSr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr_sum</span><span class="id"> :=</span><span class="id"> expr_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr_sym</span><span class="id"> :=</span><span class="id"> commr_sym</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr_refl</span><span class="id"> :=</span><span class="id"> commr_refl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr0</span><span class="id"> :=</span><span class="id"> commr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr1</span><span class="id"> :=</span><span class="id"> commr1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrN</span><span class="id"> :=</span><span class="id"> commrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrN1</span><span class="id"> :=</span><span class="id"> commrN1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrD</span><span class="id"> :=</span><span class="id"> commrD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrB</span><span class="id"> :=</span><span class="id"> commrB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr_sum</span><span class="id"> :=</span><span class="id"> commr_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr_prod</span><span class="id"> :=</span><span class="id"> commr_prod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrMn</span><span class="id"> :=</span><span class="id"> commrMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrM</span><span class="id"> :=</span><span class="id"> commrM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr_nat</span><span class="id"> :=</span><span class="id"> commr_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrX</span><span class="id"> :=</span><span class="id"> commrX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprMn_comm</span><span class="id"> :=</span><span class="id"> exprMn_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commr_sign</span><span class="id"> :=</span><span class="id"> commr_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprMn_n</span><span class="id"> :=</span><span class="id"> exprMn_n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprM</span><span class="id"> :=</span><span class="id"> exprM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprAC</span><span class="id"> :=</span><span class="id"> exprAC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr_mod</span><span class="id"> :=</span><span class="id"> expr_mod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr_dvd</span><span class="id"> :=</span><span class="id"> expr_dvd</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signr_odd</span><span class="id"> :=</span><span class="id"> signr_odd</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signr_eq0</span><span class="id"> :=</span><span class="id"> signr_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_sign</span><span class="id"> :=</span><span class="id"> mulr_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signr_addb</span><span class="id"> :=</span><span class="id"> signr_addb</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signrN</span><span class="id"> :=</span><span class="id"> signrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signrE</span><span class="id"> :=</span><span class="id"> signrE</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_signM</span><span class="id"> :=</span><span class="id"> mulr_signM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprNn</span><span class="id"> :=</span><span class="id"> exprNn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrrN</span><span class="id"> :=</span><span class="id"> sqrrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrr_sign</span><span class="id"> :=</span><span class="id"> sqrr_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signrMK</span><span class="id"> :=</span><span class="id"> signrMK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrI_eq0</span><span class="id"> :=</span><span class="id"> mulrI_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lreg_neq0</span><span class="id"> :=</span><span class="id"> lreg_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrI0_lreg</span><span class="id"> :=</span><span class="id"> mulrI0_lreg</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lregN</span><span class="id"> :=</span><span class="id"> lregN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lreg1</span><span class="id"> :=</span><span class="id"> lreg1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lregM</span><span class="id"> :=</span><span class="id"> lregM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lregX</span><span class="id"> :=</span><span class="id"> lregX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lreg_sign</span><span class="id"> :=</span><span class="id"> lreg_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> lregP</span><span class="id"> {R</span><span class="id"> x}</span><span class="id"> :=</span><span class="id"> @lregP</span><span class="id"> R</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulIr_eq0</span><span class="id"> :=</span><span class="id"> mulIr_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulIr0_rreg</span><span class="id"> :=</span><span class="id"> mulIr0_rreg</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rreg_neq0</span><span class="id"> :=</span><span class="id"> rreg_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rregN</span><span class="id"> :=</span><span class="id"> rregN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rreg1</span><span class="id"> :=</span><span class="id"> rreg1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rregM</span><span class="id"> :=</span><span class="id"> rregM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> revrX</span><span class="id"> :=</span><span class="id"> revrX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rregX</span><span class="id"> :=</span><span class="id"> rregX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rregP</span><span class="id"> {R</span><span class="id"> x}</span><span class="id"> :=</span><span class="id"> @rregP</span><span class="id"> R</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprDn_comm</span><span class="id"> :=</span><span class="id"> exprDn_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprBn_comm</span><span class="id"> :=</span><span class="id"> exprBn_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrXX_comm</span><span class="id"> :=</span><span class="id"> subrXX_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprD1n</span><span class="id"> :=</span><span class="id"> exprD1n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrX1</span><span class="id"> :=</span><span class="id"> subrX1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrrD1</span><span class="id"> :=</span><span class="id"> sqrrD1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrrB1</span><span class="id"> :=</span><span class="id"> sqrrB1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr_sqr_1</span><span class="id"> :=</span><span class="id"> subr_sqr_1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pcharf0</span><span class="id"> :=</span><span class="id"> pcharf0</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> charf0</span><span class="id"> :=</span><span class="id"> pcharf0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pcharf_prime</span><span class="id"> :=</span><span class="id"> pcharf_prime</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf_prime instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> charf_prime</span><span class="id"> :=</span><span class="id"> pcharf_prime</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrn_pchar</span><span class="id"> :=</span><span class="id"> mulrn_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use mulrn_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> mulrn_char</span><span class="id"> :=</span><span class="id"> mulrn_pchar</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> dvdn_pcharf</span><span class="id"> :=</span><span class="id"> dvdn_pcharf</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use dvdn_pcharf instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> dvdn_charf</span><span class="id"> :=</span><span class="id"> dvdn_pcharf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pcharf_eq</span><span class="id"> :=</span><span class="id"> pcharf_eq</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf_eq instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> charf_eq</span><span class="id"> :=</span><span class="id"> pcharf_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> bin_lt_pcharf_0</span><span class="id"> :=</span><span class="id"> bin_lt_pcharf_0</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use bin_lt_pcharf_0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> bin_lt_charf_0</span><span class="id"> :=</span><span class="id"> bin_lt_pcharf_0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autE</span><span class="id"> :=</span><span class="id"> pFrobenius_autE</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autE instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autE</span><span class="id"> :=</span><span class="id"> pFrobenius_autE</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_aut0</span><span class="id"> :=</span><span class="id"> pFrobenius_aut0</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_aut0</span><span class="id"> :=</span><span class="id"> pFrobenius_aut0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_aut1</span><span class="id"> :=</span><span class="id"> pFrobenius_aut1</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut1 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_aut1</span><span class="id"> :=</span><span class="id"> pFrobenius_aut1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autD_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autD_comm</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autD_comm instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autD_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autD_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autMn</span><span class="id"> :=</span><span class="id"> pFrobenius_autMn</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autMn instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autMn</span><span class="id"> :=</span><span class="id"> pFrobenius_autMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_aut_nat</span><span class="id"> :=</span><span class="id"> pFrobenius_aut_nat</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut_nat instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_aut_nat</span><span class="id"> :=</span><span class="id"> pFrobenius_aut_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autM_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autM_comm</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autM_comm instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autM_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autM_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autX</span><span class="id"> :=</span><span class="id"> pFrobenius_autX</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autX instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autX</span><span class="id"> :=</span><span class="id"> pFrobenius_autX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autN</span><span class="id"> :=</span><span class="id"> pFrobenius_autN</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autN instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autN</span><span class="id"> :=</span><span class="id"> pFrobenius_autN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pFrobenius_autB_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autB_comm</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_autB_comm instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> Frobenius_autB_comm</span><span class="id"> :=</span><span class="id"> pFrobenius_autB_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprNn_pchar</span><span class="id"> :=</span><span class="id"> exprNn_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use exprNn_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> exprNn_char</span><span class="id"> :=</span><span class="id"> exprNn_pchar</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrr_pchar2</span><span class="id"> :=</span><span class="id"> addrr_pchar2</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use addrr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> addrr_char2</span><span class="id"> :=</span><span class="id"> addrr_pchar2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> oppr_pchar2</span><span class="id"> :=</span><span class="id"> oppr_pchar2</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use oppr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> oppr_char2</span><span class="id"> :=</span><span class="id"> oppr_pchar2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addrK_pchar2</span><span class="id"> :=</span><span class="id"> addrK_pchar2</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use addrK_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> addrK_char2</span><span class="id"> :=</span><span class="id"> addrK_pchar2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addKr_pchar2</span><span class="id"> :=</span><span class="id"> addKr_pchar2</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use addKr_pchar2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> addKr_char2</span><span class="id"> :=</span><span class="id"> addKr_pchar2</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> iter_mulr</span><span class="id"> :=</span><span class="id"> iter_mulr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> iter_mulr_1</span><span class="id"> :=</span><span class="id"> iter_mulr_1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodr_const</span><span class="id"> :=</span><span class="id"> prodr_const</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodr_const_nat</span><span class="id"> :=</span><span class="id"> prodr_const_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrC</span><span class="id"> :=</span><span class="id"> @mulrC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrCA</span><span class="id"> :=</span><span class="id"> mulrCA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrAC</span><span class="id"> :=</span><span class="id"> mulrAC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrACA</span><span class="id"> :=</span><span class="id"> mulrACA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprMn</span><span class="id"> :=</span><span class="id"> exprMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrXl</span><span class="id"> :=</span><span class="id"> prodrXl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrXr</span><span class="id"> :=</span><span class="id"> prodrXr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrN</span><span class="id"> :=</span><span class="id"> prodrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrMn_const</span><span class="id"> :=</span><span class="id"> prodrMn_const</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrM_comm</span><span class="id"> :=</span><span class="id"> prodrM_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrMl_comm</span><span class="id"> :=</span><span class="id"> prodrMl_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrMr_comm</span><span class="id"> :=</span><span class="id"> prodrMr_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrMl</span><span class="id"> :=</span><span class="id"> prodrMl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrMr</span><span class="id"> :=</span><span class="id"> prodrMr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrMn</span><span class="id"> :=</span><span class="id"> prodrMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rev_prodr</span><span class="id"> :=</span><span class="id"> rev_prodr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natr_prod</span><span class="id"> :=</span><span class="id"> natr_prod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodr_undup_exp_count</span><span class="id"> :=</span><span class="id"> prodr_undup_exp_count</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprDn</span><span class="id"> :=</span><span class="id"> exprDn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprBn</span><span class="id"> :=</span><span class="id"> exprBn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subrXX</span><span class="id"> :=</span><span class="id"> subrXX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrrD</span><span class="id"> :=</span><span class="id"> sqrrD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrrB</span><span class="id"> :=</span><span class="id"> sqrrB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr_sqr</span><span class="id"> :=</span><span class="id"> subr_sqr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subr_sqrDB</span><span class="id"> :=</span><span class="id"> subr_sqrDB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprDn_pchar</span><span class="id"> :=</span><span class="id"> exprDn_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use exprDn_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> exprDn_char</span><span class="id"> :=</span><span class="id"> exprDn_pchar</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrV</span><span class="id"> :=</span><span class="id"> mulrV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divrr</span><span class="id"> :=</span><span class="id"> divrr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulVr</span><span class="id"> :=</span><span class="id"> mulVr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_out</span><span class="id"> :=</span><span class="id"> invr_out</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrP</span><span class="id"> {R</span><span class="id"> x}</span><span class="id"> :=</span><span class="id"> @unitrP</span><span class="id"> R</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulKr</span><span class="id"> :=</span><span class="id"> mulKr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulVKr</span><span class="id"> :=</span><span class="id"> mulVKr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrK</span><span class="id"> :=</span><span class="id"> mulrK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrVK</span><span class="id"> :=</span><span class="id"> mulrVK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divrK</span><span class="id"> :=</span><span class="id"> divrK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulrI</span><span class="id"> :=</span><span class="id"> mulrI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulIr</span><span class="id"> :=</span><span class="id"> mulIr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divrI</span><span class="id"> :=</span><span class="id"> divrI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divIr</span><span class="id"> :=</span><span class="id"> divIr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> telescope_prodr</span><span class="id"> :=</span><span class="id"> telescope_prodr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> telescope_prodr_eq</span><span class="id"> :=</span><span class="id"> @telescope_prodr_eq</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> telescope_prodr_eq</span><span class="id"> {R</span><span class="id"> n</span><span class="id"> m}</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> commrV</span><span class="id"> :=</span><span class="id"> commrV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrE</span><span class="id"> :=</span><span class="id"> unitrE</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invrK</span><span class="id"> :=</span><span class="id"> @invrK</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> invrK</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_inj</span><span class="id"> :=</span><span class="id"> @invr_inj</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> invr_inj</span><span class="id"> {R}</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrV</span><span class="id"> :=</span><span class="id"> unitrV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitr1</span><span class="id"> :=</span><span class="id"> unitr1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr1</span><span class="id"> :=</span><span class="id"> invr1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divr1</span><span class="id"> :=</span><span class="id"> divr1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> div1r</span><span class="id"> :=</span><span class="id"> div1r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natr_div</span><span class="id"> :=</span><span class="id"> natr_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitr0</span><span class="id"> :=</span><span class="id"> unitr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr0</span><span class="id"> :=</span><span class="id"> invr0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrN1</span><span class="id"> :=</span><span class="id"> unitrN1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrN</span><span class="id"> :=</span><span class="id"> unitrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invrN1</span><span class="id"> :=</span><span class="id"> invrN1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invrN</span><span class="id"> :=</span><span class="id"> invrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divrNN</span><span class="id"> :=</span><span class="id"> divrNN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divrN</span><span class="id"> :=</span><span class="id"> divrN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_sign</span><span class="id"> :=</span><span class="id"> invr_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrMl</span><span class="id"> :=</span><span class="id"> unitrMl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrMr</span><span class="id"> :=</span><span class="id"> unitrMr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invrM</span><span class="id"> :=</span><span class="id"> invrM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitr_prod</span><span class="id"> :=</span><span class="id"> unitr_prod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitr_prod_in</span><span class="id"> :=</span><span class="id"> unitr_prod_in</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_eq0</span><span class="id"> :=</span><span class="id"> invr_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_eq1</span><span class="id"> :=</span><span class="id"> invr_eq1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_neq0</span><span class="id"> :=</span><span class="id"> invr_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rev_unitrP</span><span class="id"> :=</span><span class="id"> rev_unitrP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rev_prodrV</span><span class="id"> :=</span><span class="id"> rev_prodrV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrM_comm</span><span class="id"> :=</span><span class="id"> unitrM_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrX</span><span class="id"> :=</span><span class="id"> unitrX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrX_pos</span><span class="id"> :=</span><span class="id"> unitrX_pos</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprVn</span><span class="id"> :=</span><span class="id"> exprVn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprB</span><span class="id"> :=</span><span class="id"> exprB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invr_signM</span><span class="id"> :=</span><span class="id"> invr_signM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divr_signM</span><span class="id"> :=</span><span class="id"> divr_signM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred0D</span><span class="id"> :=</span><span class="id"> @rpred0D</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred0</span><span class="id"> :=</span><span class="id"> rpred0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredD</span><span class="id"> :=</span><span class="id"> rpredD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredNr</span><span class="id"> :=</span><span class="id"> @rpredNr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_sum</span><span class="id"> :=</span><span class="id"> rpred_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredMn</span><span class="id"> :=</span><span class="id"> rpredMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredN</span><span class="id"> :=</span><span class="id"> rpredN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredB</span><span class="id"> :=</span><span class="id"> rpredB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredBC</span><span class="id"> :=</span><span class="id"> rpredBC</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredMNn</span><span class="id"> :=</span><span class="id"> rpredMNn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredDr</span><span class="id"> :=</span><span class="id"> rpredDr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredDl</span><span class="id"> :=</span><span class="id"> rpredDl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredBr</span><span class="id"> :=</span><span class="id"> rpredBr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredBl</span><span class="id"> :=</span><span class="id"> rpredBl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> zmodClosedP</span><span class="id"> :=</span><span class="id"> zmodClosedP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredMsign</span><span class="id"> :=</span><span class="id"> rpredMsign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred1M</span><span class="id"> :=</span><span class="id"> @rpred1M</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred1</span><span class="id"> :=</span><span class="id"> @rpred1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredM</span><span class="id"> :=</span><span class="id"> @rpredM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_prod</span><span class="id"> :=</span><span class="id"> rpred_prod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredX</span><span class="id"> :=</span><span class="id"> rpredX</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_nat</span><span class="id"> :=</span><span class="id"> rpred_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredN1</span><span class="id"> :=</span><span class="id"> rpredN1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_sign</span><span class="id"> :=</span><span class="id"> rpred_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semiringClosedP</span><span class="id"> :=</span><span class="id"> semiringClosedP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subringClosedP</span><span class="id"> :=</span><span class="id"> subringClosedP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredZsign</span><span class="id"> :=</span><span class="id"> rpredZsign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredZnat</span><span class="id"> :=</span><span class="id"> rpredZnat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> submodClosedP</span><span class="id"> :=</span><span class="id"> submodClosedP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> subalgClosedP</span><span class="id"> :=</span><span class="id"> subalgClosedP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredZ</span><span class="id"> :=</span><span class="id"> @rpredZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredVr</span><span class="id"> :=</span><span class="id"> @rpredVr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredV</span><span class="id"> :=</span><span class="id"> rpredV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_div</span><span class="id"> :=</span><span class="id"> rpred_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredXN</span><span class="id"> :=</span><span class="id"> rpredXN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredZeq</span><span class="id"> :=</span><span class="id"> rpredZeq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pchar_lalg</span><span class="id"> :=</span><span class="id"> pchar_lalg</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pchar_lalg instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> char_lalg</span><span class="id"> :=</span><span class="id"> pchar_lalg</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredMr</span><span class="id"> :=</span><span class="id"> rpredMr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpredMl</span><span class="id"> :=</span><span class="id"> rpredMl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_divr</span><span class="id"> :=</span><span class="id"> rpred_divr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rpred_divl</span><span class="id"> :=</span><span class="id"> rpred_divl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divringClosedP</span><span class="id"> :=</span><span class="id"> divringClosedP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eq_eval</span><span class="id"> :=</span><span class="id"> eq_eval</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eval_tsubst</span><span class="id"> :=</span><span class="id"> eval_tsubst</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eq_holds</span><span class="id"> :=</span><span class="id"> eq_holds</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> holds_fsubst</span><span class="id"> :=</span><span class="id"> holds_fsubst</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrM</span><span class="id"> :=</span><span class="id"> unitrM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitr_prodP</span><span class="id"> :=</span><span class="id"> unitr_prodP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodrV</span><span class="id"> :=</span><span class="id"> prodrV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitrPr</span><span class="id"> {R</span><span class="id"> x}</span><span class="id"> :=</span><span class="id"> @unitrPr</span><span class="id"> R</span><span class="id"> x</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expr_div_n</span><span class="id"> :=</span><span class="id"> expr_div_n</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr1_eq</span><span class="id"> :=</span><span class="id"> mulr1_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divr1_eq</span><span class="id"> :=</span><span class="id"> divr1_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divKr</span><span class="id"> :=</span><span class="id"> divKr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulf_eq0</span><span class="id"> :=</span><span class="id"> mulf_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodf_eq0</span><span class="id"> :=</span><span class="id"> prodf_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodf_seq_eq0</span><span class="id"> :=</span><span class="id"> prodf_seq_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulf_neq0</span><span class="id"> :=</span><span class="id"> mulf_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodf_neq0</span><span class="id"> :=</span><span class="id"> prodf_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodf_seq_neq0</span><span class="id"> :=</span><span class="id"> prodf_seq_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expf_eq0</span><span class="id"> :=</span><span class="id"> expf_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrf_eq0</span><span class="id"> :=</span><span class="id"> sqrf_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expf_neq0</span><span class="id"> :=</span><span class="id"> expf_neq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natf_neq0_pchar</span><span class="id"> :=</span><span class="id"> natf_neq0_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use natf_neq0_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> natf_neq0</span><span class="id"> :=</span><span class="id"> natf_neq0_pchar</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> natf0_pchar</span><span class="id"> :=</span><span class="id"> natf0_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use natf0_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> natf0_char</span><span class="id"> :=</span><span class="id"> natf0_pchar</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pcharf'_nat</span><span class="id"> :=</span><span class="id"> pcharf'_nat</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf'_nat instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> charf'_nat</span><span class="id"> :=</span><span class="id"> pcharf'_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pcharf0P</span><span class="id"> :=</span><span class="id"> pcharf0P</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pcharf0P instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> charf0P</span><span class="id"> :=</span><span class="id"> pcharf0P</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eqf_sqr</span><span class="id"> :=</span><span class="id"> eqf_sqr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulfI</span><span class="id"> :=</span><span class="id"> mulfI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulIf</span><span class="id"> :=</span><span class="id"> mulIf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divfI</span><span class="id"> :=</span><span class="id"> divfI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divIf</span><span class="id"> :=</span><span class="id"> divIf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> sqrf_eq1</span><span class="id"> :=</span><span class="id"> sqrf_eq1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expfS_eq1</span><span class="id"> :=</span><span class="id"> expfS_eq1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fieldP</span><span class="id"> :=</span><span class="id"> @fieldP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> unitfE</span><span class="id"> :=</span><span class="id"> unitfE</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulVf</span><span class="id"> :=</span><span class="id"> mulVf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulfV</span><span class="id"> :=</span><span class="id"> mulfV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divff</span><span class="id"> :=</span><span class="id"> divff</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulKf</span><span class="id"> :=</span><span class="id"> mulKf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulVKf</span><span class="id"> :=</span><span class="id"> mulVKf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulfK</span><span class="id"> :=</span><span class="id"> mulfK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulfVK</span><span class="id"> :=</span><span class="id"> mulfVK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divfK</span><span class="id"> :=</span><span class="id"> divfK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> divKf</span><span class="id"> :=</span><span class="id"> divKf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invfM</span><span class="id"> :=</span><span class="id"> invfM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invf_div</span><span class="id"> :=</span><span class="id"> invf_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expfB_cond</span><span class="id"> :=</span><span class="id"> expfB_cond</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expfB</span><span class="id"> :=</span><span class="id"> expfB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodfV</span><span class="id"> :=</span><span class="id"> prodfV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> prodf_div</span><span class="id"> :=</span><span class="id"> prodf_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> telescope_prodf</span><span class="id"> :=</span><span class="id"> telescope_prodf</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> telescope_prodf_eq</span><span class="id"> :=</span><span class="id"> @telescope_prodf_eq</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> telescope_prodf_eq</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> m}</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> addf_div</span><span class="id"> :=</span><span class="id"> addf_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulf_div</span><span class="id"> :=</span><span class="id"> mulf_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eqr_div</span><span class="id"> :=</span><span class="id"> eqr_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eqr_sum_div</span><span class="id"> :=</span><span class="id"> eqr_sum_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pchar0_natf_div</span><span class="id"> :=</span><span class="id"> pchar0_natf_div</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pchar0_natf_div instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> char0_natf_div</span><span class="id"> :=</span><span class="id"> pchar0_natf_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fpredMr</span><span class="id"> :=</span><span class="id"> fpredMr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fpredMl</span><span class="id"> :=</span><span class="id"> fpredMl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fpred_divr</span><span class="id"> :=</span><span class="id"> fpred_divr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fpred_divl</span><span class="id"> :=</span><span class="id"> fpred_divl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> satP</span><span class="id"> {F</span><span class="id"> e</span><span class="id"> f}</span><span class="id"> :=</span><span class="id"> @satP</span><span class="id"> F</span><span class="id"> e</span><span class="id"> f</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eq_sat</span><span class="id"> :=</span><span class="id"> eq_sat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> solP</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> f}</span><span class="id"> :=</span><span class="id"> @solP</span><span class="id"> F</span><span class="id"> n</span><span class="id"> f</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eq_sol</span><span class="id"> :=</span><span class="id"> eq_sol</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> size_sol</span><span class="id"> :=</span><span class="id"> size_sol</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> solve_monicpoly</span><span class="id"> :=</span><span class="id"> @solve_monicpoly</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `nmod_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> semi_additive</span><span class="id"> :=</span><span class="id"> semi_additive</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> nmod_morphism</span><span class="id"> :=</span><span class="id"> nmod_morphism</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `zmod_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> additive</span><span class="id"> :=</span><span class="id"> additive</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> zmod_morphism</span><span class="id"> :=</span><span class="id"> zmod_morphism</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddf0</span><span class="id"> :=</span><span class="id"> raddf0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddf_eq0</span><span class="id"> :=</span><span class="id"> raddf_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddf_inj</span><span class="id"> :=</span><span class="id"> raddf_inj</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfN</span><span class="id"> :=</span><span class="id"> raddfN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfD</span><span class="id"> :=</span><span class="id"> raddfD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfB</span><span class="id"> :=</span><span class="id"> raddfB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddf_sum</span><span class="id"> :=</span><span class="id"> raddf_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfMn</span><span class="id"> :=</span><span class="id"> raddfMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfMNn</span><span class="id"> :=</span><span class="id"> raddfMNn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfMnat</span><span class="id"> :=</span><span class="id"> raddfMnat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfMsign</span><span class="id"> :=</span><span class="id"> raddfMsign</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `can2_nmod_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> can2_semi_additive</span><span class="id"> :=</span><span class="id"> can2_semi_additive</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> can2_nmod_morphism</span><span class="id"> :=</span><span class="id"> can2_nmod_morphism</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `can2_zmod_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> can2_additive</span><span class="id"> :=</span><span class="id"> can2_additive</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> can2_zmod_morphism</span><span class="id"> :=</span><span class="id"> can2_zmod_morphism</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `monoid_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> multiplicative</span><span class="id"> :=</span><span class="id"> multiplicative</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> monoid_morphism</span><span class="id"> :=</span><span class="id"> monoid_morphism</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph0</span><span class="id"> :=</span><span class="id"> rmorph0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphN</span><span class="id"> :=</span><span class="id"> rmorphN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphD</span><span class="id"> :=</span><span class="id"> rmorphD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphB</span><span class="id"> :=</span><span class="id"> rmorphB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_sum</span><span class="id"> :=</span><span class="id"> rmorph_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphMn</span><span class="id"> :=</span><span class="id"> rmorphMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphMNn</span><span class="id"> :=</span><span class="id"> rmorphMNn</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `rmorphism_monoidP` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> rmorphismMP</span><span class="id"> :=</span><span class="id"> rmorphismMP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphism_monoidP</span><span class="id"> :=</span><span class="id"> rmorphism_monoidP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph1</span><span class="id"> :=</span><span class="id"> rmorph1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_eq1</span><span class="id"> :=</span><span class="id"> rmorph_eq1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphM</span><span class="id"> :=</span><span class="id"> rmorphM</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphMsign</span><span class="id"> :=</span><span class="id"> rmorphMsign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_nat</span><span class="id"> :=</span><span class="id"> rmorph_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_eq_nat</span><span class="id"> :=</span><span class="id"> rmorph_eq_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_prod</span><span class="id"> :=</span><span class="id"> rmorph_prod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphXn</span><span class="id"> :=</span><span class="id"> rmorphXn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphN1</span><span class="id"> :=</span><span class="id"> rmorphN1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_sign</span><span class="id"> :=</span><span class="id"> rmorph_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_pchar</span><span class="id"> :=</span><span class="id"> rmorph_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use rmorph_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_char</span><span class="id"> :=</span><span class="id"> rmorph_pchar</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;use `can2_monoid_morphism` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> can2_rmorphism</span><span class="id"> :=</span><span class="id"> can2_rmorphism</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> can2_monoid_morphism</span><span class="id"> :=</span><span class="id"> can2_monoid_morphism</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_comm</span><span class="id"> :=</span><span class="id"> rmorph_comm</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_unit</span><span class="id"> :=</span><span class="id"> rmorph_unit</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphV</span><span class="id"> :=</span><span class="id"> rmorphV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_div</span><span class="id"> :=</span><span class="id"> rmorph_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_eq0</span><span class="id"> :=</span><span class="id"> fmorph_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_inj</span><span class="id"> :=</span><span class="id"> @fmorph_inj</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> fmorph_inj</span><span class="id"> {F</span><span class="id"> R}</span><span class="id"> f</span><span class="id"> [x1</span><span class="id"> x2]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_eq</span><span class="id"> :=</span><span class="id"> fmorph_eq</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_eq1</span><span class="id"> :=</span><span class="id"> fmorph_eq1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_pchar</span><span class="id"> :=</span><span class="id"> fmorph_pchar</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use fmorph_pchar instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_char</span><span class="id"> :=</span><span class="id"> fmorph_pchar</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_unit</span><span class="id"> :=</span><span class="id"> fmorph_unit</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorphV</span><span class="id"> :=</span><span class="id"> fmorphV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> fmorph_div</span><span class="id"> :=</span><span class="id"> fmorph_div</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerA</span><span class="id"> :=</span><span class="id"> scalerA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scale1r</span><span class="id"> :=</span><span class="id"> @scale1r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerDr</span><span class="id"> :=</span><span class="id"> @scalerDr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerDl</span><span class="id"> :=</span><span class="id"> @scalerDl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler0</span><span class="id"> :=</span><span class="id"> scaler0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scale0r</span><span class="id"> :=</span><span class="id"> @scale0r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaleNr</span><span class="id"> :=</span><span class="id"> scaleNr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaleN1r</span><span class="id"> :=</span><span class="id"> scaleN1r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerN</span><span class="id"> :=</span><span class="id"> scalerN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerBl</span><span class="id"> :=</span><span class="id"> scalerBl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerBr</span><span class="id"> :=</span><span class="id"> scalerBr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_nat</span><span class="id"> :=</span><span class="id"> scaler_nat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerMnl</span><span class="id"> :=</span><span class="id"> scalerMnl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerMnr</span><span class="id"> :=</span><span class="id"> scalerMnr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_suml</span><span class="id"> :=</span><span class="id"> scaler_suml</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_sumr</span><span class="id"> :=</span><span class="id"> scaler_sumr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_eq0</span><span class="id"> :=</span><span class="id"> scaler_eq0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerK</span><span class="id"> :=</span><span class="id"> scalerK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerKV</span><span class="id"> :=</span><span class="id"> scalerKV</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerI</span><span class="id"> :=</span><span class="id"> scalerI</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerAl</span><span class="id"> :=</span><span class="id"> @scalerAl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_algl</span><span class="id"> :=</span><span class="id"> mulr_algl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_sign</span><span class="id"> :=</span><span class="id"> scaler_sign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> signrZK</span><span class="id"> :=</span><span class="id"> signrZK</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerCA</span><span class="id"> :=</span><span class="id"> scalerCA</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalerAr</span><span class="id"> :=</span><span class="id"> @scalerAr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_algr</span><span class="id"> :=</span><span class="id"> mulr_algr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> comm_alg</span><span class="id"> :=</span><span class="id"> comm_alg</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> exprZn</span><span class="id"> :=</span><span class="id"> exprZn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_prodl</span><span class="id"> :=</span><span class="id"> scaler_prodl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_prodr</span><span class="id"> :=</span><span class="id"> scaler_prodr</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_prod</span><span class="id"> :=</span><span class="id"> scaler_prod</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_injl</span><span class="id"> :=</span><span class="id"> scaler_injl</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scaler_unit</span><span class="id"> :=</span><span class="id"> scaler_unit</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> invrZ</span><span class="id"> :=</span><span class="id"> invrZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfZnat</span><span class="id"> :=</span><span class="id"> raddfZnat</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> raddfZsign</span><span class="id"> :=</span><span class="id"> raddfZsign</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> in_algE</span><span class="id"> :=</span><span class="id"> in_algE</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalable_for</span><span class="id"> :=</span><span class="id"> scalable_for</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semilinear_for</span><span class="id"> :=</span><span class="id"> semilinear_for</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linear_for</span><span class="id"> :=</span><span class="id"> linear_for</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><span class="id"> deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;use `nmod_morphism_semilinear` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> additive_semilinear</span><span class="id"> :=</span><span class="id"> additive_semilinear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> nmod_morphism_semilinear</span><span class="id"> :=</span><span class="id"> nmod_morphism_semilinear</span>.<br/>
<span class="id">#[warning=</span><span class="id">&quot;-deprecated-since-mathcomp-2.5.0&quot;</span><span class="id">,</span><span class="id"> deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.5.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;use `zmod_morphism_linear` instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Definition</span><span class="id"> additive_linear</span><span class="id"> :=</span><span class="id"> additive_linear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> zmod_morphism_linear</span><span class="id"> :=</span><span class="id"> zmod_morphism_linear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalable_semilinear</span><span class="id"> :=</span><span class="id"> scalable_semilinear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalable_linear</span><span class="id"> :=</span><span class="id"> scalable_linear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linear0</span><span class="id"> :=</span><span class="id"> linear0</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearN</span><span class="id"> :=</span><span class="id"> linearN</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearD</span><span class="id"> :=</span><span class="id"> linearD</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearB</span><span class="id"> :=</span><span class="id"> linearB</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linear_sum</span><span class="id"> :=</span><span class="id"> linear_sum</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearMn</span><span class="id"> :=</span><span class="id"> linearMn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearMNn</span><span class="id"> :=</span><span class="id"> linearMNn</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semilinearP</span><span class="id"> :=</span><span class="id"> semilinearP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearP</span><span class="id"> :=</span><span class="id"> linearP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearZ_LR</span><span class="id"> :=</span><span class="id"> linearZ_LR</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearZ</span><span class="id"> :=</span><span class="id"> linearZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semilinearPZ</span><span class="id"> :=</span><span class="id"> semilinearPZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearPZ</span><span class="id"> :=</span><span class="id"> linearPZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> linearZZ</span><span class="id"> :=</span><span class="id"> linearZZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> semiscalarP</span><span class="id"> :=</span><span class="id"> semiscalarP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalarP</span><span class="id"> :=</span><span class="id"> scalarP</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> scalarZ</span><span class="id"> :=</span><span class="id"> scalarZ</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> can2_scalable</span><span class="id"> :=</span><span class="id"> can2_scalable</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> can2_linear</span><span class="id"> :=</span><span class="id"> can2_linear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> can2_semilinear</span><span class="id"> :=</span><span class="id"> can2_semilinear</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> rmorph_alg</span><span class="id"> :=</span><span class="id"> rmorph_alg</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> imaginary_exists</span><span class="id"> :=</span><span class="id"> imaginary_exists</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> raddf</span><span class="id"> :=</span> (<span class="id">raddf0,</span><span class="id"> raddfN,</span><span class="id"> raddfD,</span><span class="id"> raddfMn</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> rmorphE</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">rmorphD,</span><span class="id"> rmorph0,</span><span class="id"> rmorphB,</span><span class="id"> rmorphN,</span><span class="id"> rmorphMNn,</span><span class="id"> rmorphMn,</span><span class="id"> rmorph1,</span><span class="id"> rmorphXn</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> linearE</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">linearD,</span><span class="id"> linear0,</span><span class="id"> linearB,</span><span class="id"> linearMNn,</span><span class="id"> linearMn,</span><span class="id"> linearZ</span>).<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> null_fun</span><span class="id"> V</span><span class="id"> :=</span> (<span class="id">null_fun</span><span class="id"> V</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> in_alg</span><span class="id"> A</span><span class="id"> :=</span> (<span class="id">in_alg</span><span class="id"> A</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Theory</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> AllExports</span>. <span class="id">HB</span>.<span class="id">reexport</span>. <span class="vernacular">End</span><span class="id"> AllExports</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> GRing</span>.<br/>
<br/>
<span class="vernacular">Export</span><span class="id"> AllExports</span>.<br/>
<span class="vernacular">Export</span><span class="id"> Scale</span>.<span class="vernacular">Exports</span>.<br/>
<span class="vernacular">Export</span><span class="vernacular"> ClosedExports</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try pzSemiRingType (the potentially-zero counterpart) first, or use nzSemiRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> semiRingType</span><span class="id"> :=</span> (<span class="id">nzSemiRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try pzRingType (the potentially-zero counterpart) first, or use nzRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> ringType</span><span class="id"> :=</span> (<span class="id">nzRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try comPzSemiRingType (the potentially-zero counterpart) first, or use comNzSemiRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> comSemiRingType</span><span class="id"> :=</span> (<span class="id">comNzSemiRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try comPzRingType (the potentially-zero counterpart) first, or use comNzRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> comRingType</span><span class="id"> :=</span> (<span class="id">comNzRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try subPzSemiRingType (the potentially-zero counterpart) first, or use subNzSemiRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> subSemiRingType</span><span class="id"> :=</span> (<span class="id">subNzSemiRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try subComPzSemiRingType (the potentially-zero counterpart) first, or use subComNzSemiRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> subComSemiRingType</span><span class="id"> :=</span> (<span class="id">subComNzSemiRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try subPzRingType (the potentially-zero counterpart) first, or use subNzRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> subRingType</span><span class="id"> :=</span> (<span class="id">subNzRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">note=</span><span class="id">&quot;Try subComPzRingType (the potentially-zero counterpart) first, or use subComNzRingType instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> subComNzRingType</span><span class="id"> :=</span> (<span class="id">subComNzRingType</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> addrClosed</span><span class="id"> :=</span><span class="id"> addrClosed</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> opprClosed</span><span class="id"> :=</span><span class="id"> opprClosed</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> Ione</span><span class="id"> :=</span><span class="id"> IOne</span><span class="id"> :</span><span class="id"> Ione</span>.<br/>
<span class="vernacular">Inductive</span><span class="id"> Inatmul</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> INatmul</span><span class="id"> :</span><span class="id"> Ione</span><span class="id"> -&gt;</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> Inatmul</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> IOpp</span><span class="id"> :</span><span class="id"> Inatmul</span><span class="id"> -&gt;</span><span class="id"> Inatmul</span>.<br/>
<span class="vernacular">Variant</span><span class="id"> Idummy_placeholder</span><span class="id"> :=</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> parse</span> (<span class="id">x</span><span class="id"> :</span><span class="vernacular"> Number</span>.<span class="id">int</span>)<span class="id"> :</span><span class="id"> Inatmul</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="vernacular"> Number</span>.<span class="id">IntDecimal</span> (<span class="id">Decimal</span>.<span class="id">Pos</span><span class="id"> u</span>)<span class="id"> =&gt;</span><span class="id"> INatmul</span><span class="id"> IOne</span> (<span class="id">Nat</span>.<span class="id">of_uint</span><span class="id"> u</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="vernacular"> Number</span>.<span class="id">IntDecimal</span> (<span class="id">Decimal</span>.<span class="id">Neg</span><span class="id"> u</span>)<span class="id"> =&gt;</span><span class="id"> IOpp</span> (<span class="id">INatmul</span><span class="id"> IOne</span> (<span class="id">Nat</span>.<span class="id">of_uint</span><span class="id"> u</span>))<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="vernacular"> Number</span>.<span class="id">IntHexadecimal</span> (<span class="id">Hexadecimal</span>.<span class="id">Pos</span><span class="id"> u</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">INatmul</span><span class="id"> IOne</span> (<span class="id">Nat</span>.<span class="id">of_hex_uint</span><span class="id"> u</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="vernacular"> Number</span>.<span class="id">IntHexadecimal</span> (<span class="id">Hexadecimal</span>.<span class="id">Neg</span><span class="id"> u</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">IOpp</span> (<span class="id">INatmul</span><span class="id"> IOne</span> (<span class="id">Nat</span>.<span class="id">of_hex_uint</span><span class="id"> u</span>))<br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> print</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> Inatmul</span>)<span class="id"> :</span><span class="id"> option</span><span class="vernacular"> Number</span>.<span class="id">int</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> INatmul</span><span class="id"> IOne</span><span class="id"> n</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="vernacular">Number</span>.<span class="id">IntDecimal</span> (<span class="id">Decimal</span>.<span class="id">Pos</span> (<span class="id">Nat</span>.<span class="id">to_uint</span><span class="id"> n</span>)))<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> IOpp</span> (<span class="id">INatmul</span><span class="id"> IOne</span><span class="id"> n</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Some</span> (<span class="vernacular">Number</span>.<span class="id">IntDecimal</span> (<span class="id">Decimal</span>.<span class="id">Neg</span> (<span class="id">Nat</span>.<span class="id">to_uint</span><span class="id"> n</span>)))<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> None</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> GRing</span>.<span class="id">one</span><span class="id"> {_}</span>.<br/>
<span class="gallina-kwd">Set</span><span class="id"> Warnings</span> <span class="id">&quot;-via-type-remapping,-via-type-mismatch&quot;</span>.<br/>
<span class="vernacular">Number</span><span class="vernacular"> Notation</span><span class="id"> Idummy_placeholder</span><span class="id"> parse</span><span class="id"> print</span> (<span class="id">via</span><span class="id"> Inatmul</span><br/>
&nbsp;&nbsp;<span class="id">mapping</span><span class="id"> [[natmul]</span><span class="id"> =&gt;</span><span class="id"> INatmul,</span><span class="id"> [opp]</span><span class="id"> =&gt;</span><span class="id"> IOpp,</span><span class="id"> [one]</span><span class="id"> =&gt;</span><span class="id"> IOne]</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> ring_scope</span>.<br/>
<span class="gallina-kwd">Set</span><span class="id"> Warnings</span> <span class="id">&quot;via-type-remapping,via-type-mismatch&quot;</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> GRing</span>.<span class="id">one</span><span class="id"> :</span><span class="id"> clear</span><span class="id"> implicits</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;0&quot;</span><span class="id"> :=</span> (<span class="id">@zero</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;-%R&quot;</span><span class="id"> :=</span> (<span class="id">@opp</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;- x&quot;</span><span class="id"> :=</span> (<span class="id">opp</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;+%R&quot;</span><span class="id"> :=</span> (<span class="id">@add</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x + y&quot;</span><span class="id"> :=</span> (<span class="id">add</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x - y&quot;</span><span class="id"> :=</span> (<span class="id">add</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> y</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> natmul</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x *+ n&quot;</span><span class="id"> :=</span> (<span class="id">natmul</span><span class="id"> x</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x *- n&quot;</span><span class="id"> :=</span> (<span class="id">opp</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;s `_ i&quot;</span><span class="id"> :=</span> (<span class="id">seq</span>.<span class="id">nth</span><span class="id"> 0%R</span><span class="id"> s%R</span><span class="id"> i</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> support</span><span class="id"> :=</span><span class="id"> 0</span>.<span class="id">-support</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span> (<span class="id">@one</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;- 1&quot;</span><span class="id"> :=</span> (<span class="id">opp</span><span class="id"> 1</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;n %:R&quot;</span><span class="id"> :=</span> (<span class="id">natmul</span><span class="id"> 1</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> GRing</span>.<span class="id">pchar</span><span class="id"> R%_type</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'pchar' R ]&quot;</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">pchar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use [pchar R] instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[ 'char' R ]&quot;</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">pchar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> has_pchar0</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">pchar</span><span class="id"> R</span><span class="id"> =i</span><span class="id"> pred0</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use has_pchar0 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> has_char0</span><span class="id"> R</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">pchar</span><span class="id"> R</span><span class="id"> =i</span><span class="id"> pred0</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> pFrobenius_aut</span><span class="id"> chRp</span><span class="id"> :=</span> (<span class="id">pFrobenius_aut</span><span class="id"> chRp</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp 2.4.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use pFrobenius_aut instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> Frobenius_aut</span><span class="id"> chRp</span><span class="id"> :=</span> (<span class="id">pFrobenius_aut</span><span class="id"> chRp</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;*%R&quot;</span><span class="id"> :=</span> (<span class="id">@mul</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x * y&quot;</span><span class="id"> :=</span> (<span class="id">mul</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> exp</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x ^+ n&quot;</span><span class="id"> :=</span> (<span class="id">exp</span><span class="id"> x</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x ^-1&quot;</span><span class="id"> :=</span> (<span class="id">inv</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x ^- n&quot;</span><span class="id"> :=</span> (<span class="id">inv</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x / y&quot;</span><span class="id"> :=</span> (<span class="id">mul</span><span class="id"> x</span><span class="id"> y^-1</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;*:%R&quot;</span><span class="id"> :=</span> (<span class="id">@scale</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;a *: m&quot;</span><span class="id"> :=</span> (<span class="id">scale</span><span class="id"> a</span><span class="id"> m</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;k %:A&quot;</span><span class="id"> :=</span> (<span class="id">scale</span><span class="id"> k</span><span class="id"> 1</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\0&quot;</span><span class="id"> :=</span> (<span class="id">null_fun</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \+ g&quot;</span><span class="id"> :=</span> (<span class="id">add_fun</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \- g&quot;</span><span class="id"> :=</span> (<span class="id">sub_fun</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\- f&quot;</span><span class="id"> :=</span> (<span class="id">opp_fun</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;a \*: f&quot;</span><span class="id"> :=</span> (<span class="id">scale_fun</span><span class="id"> a</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x \*o f&quot;</span><span class="id"> :=</span> (<span class="id">mull_fun</span><span class="id"> x</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x \o* f&quot;</span><span class="id"> :=</span> (<span class="id">mulr_fun</span><span class="id"> x</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \* g&quot;</span><span class="id"> :=</span> (<span class="id">mul_fun</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> mull_fun</span><span class="id"> {_</span><span class="id"> _}</span> <span class="id"> a</span><span class="id"> f</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mulr_fun</span><span class="id"> {_</span><span class="id"> _}</span><span class="id"> a</span><span class="id"> f</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> scale_fun</span><span class="id"> {_</span><span class="id"> _</span><span class="id"> _}</span><span class="id"> a</span><span class="id"> f</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mul_fun</span><span class="id"> {_</span><span class="id"> _}</span><span class="id"> f</span><span class="id"> g</span><span class="id"> _</span><span class="id"> /</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ i F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_i</span><span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span>)<span class="id"> F%R</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%R/0%R]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i &lt;- r | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i &lt;- r ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( m &lt;= i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( m &lt;= i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ i F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_i</span><span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i : t | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i : t ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span>)<span class="id"> F%R</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i 'in' A | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\prod_ ( i 'in' A ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[*%R/1%R]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F%R</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;R ^c&quot;</span><span class="id"> :=</span> (<span class="id">converse</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;R ^o&quot;</span><span class="id"> :=</span> (<span class="id">regular</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span><span class="gallina-kwd"> with</span><span class="id"> term</span>.<br/>
<span class="vernacular">Bind</span><span class="vernacular"> Scope</span><span class="id"> term_scope</span><span class="gallina-kwd"> with</span><span class="id"> formula</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''X_' i&quot;</span><span class="id"> :=</span> (<span class="id">Var</span><span class="id"> _</span><span class="id"> i</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;n %:R&quot;</span><span class="id"> :=</span> (<span class="id">NatConst</span><span class="id"> _</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;0&quot;</span><span class="id"> :=</span><span class="id"> 0%:R%T</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span><span class="id"> 1%:R%T</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:T&quot;</span><span class="id"> :=</span> (<span class="id">Const</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;+&quot;</span><span class="id"> :=</span><span class="id"> Add</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;- t&quot;</span><span class="id"> :=</span> (<span class="id">Opp</span><span class="id"> t</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;t - u&quot;</span><span class="id"> :=</span> (<span class="id">Add</span><span class="id"> t</span> (<span class="id">-</span><span class="id"> u</span>))<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;*&quot;</span><span class="id"> :=</span><span class="id"> Mul</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;*+&quot;</span><span class="id"> :=</span><span class="id"> NatMul</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;t ^-1&quot;</span><span class="id"> :=</span> (<span class="id">Inv</span><span class="id"> t</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;t / u&quot;</span><span class="id"> :=</span> (<span class="id">Mul</span><span class="id"> t</span><span class="id"> u^-1</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;^+&quot;</span><span class="id"> :=</span><span class="id"> Exp</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;==&quot;</span><span class="id"> :=</span><span class="id"> Equal</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x != y&quot;</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">Not</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>))<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;/\&quot;</span><span class="id"> :=</span><span class="id"> And</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;\/&quot;</span><span class="id"> :=</span><span class="id"> Or</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Infix</span> <span class="id">&quot;==&gt;&quot;</span><span class="id"> :=</span><span class="id"> Implies</span><span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;~ f&quot;</span><span class="id"> :=</span> (<span class="id">Not</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''exists' ''X_' i , f&quot;</span><span class="id"> :=</span> (<span class="id">Exists</span><span class="id"> i</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''forall' ''X_' i , f&quot;</span><span class="id"> :=</span> (<span class="id">Forall</span><span class="id"> i</span><span class="id"> f</span>)<span class="id"> :</span><span class="id"> term_scope</span>.<br/>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Sum</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">rT</span><span class="id"> :</span><span class="id"> nmodType</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> rT}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sum_ffunE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim/big_rec2:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [|i</span><span class="id"> _</span><span class="id"> y</span><span class="id"> _</span><span class="id"> &lt;-];</span><span class="id"> rewrite</span><span class="id"> !ffunE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sum_ffun</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> [ffun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> sum_ffunE</span><span class="id"> ffunE</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Sum</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinFunSemiRing</span>.<br/>
<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ffun_one</span><span class="id"> :</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span><span class="id"> :=</span><span class="id"> [ffun</span><span class="id"> =&gt;</span><span class="id"> 1]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> ffun_mul</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span>)<span class="id"> :=</span><span class="id"> [ffun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> *</span><span class="id"> g</span><span class="id"> x]</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> ffun_mulA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> ffun_mul</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> f2</span><span class="id"> f3;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mulrA</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_mul_1l</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> ffun_one</span><span class="id"> ffun_mul</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mul1r</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_mul_1r</span><span class="id"> :</span><span class="id"> right_id</span><span class="id"> ffun_one</span><span class="id"> ffun_mul</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mulr1</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_mul_addl</span><span class="id"> :</span> <span class="id"> left_distributive</span><span class="id"> ffun_mul</span> (<span class="id">@ffun_add</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> f2</span><span class="id"> f3;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mulrDl</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_mul_addr</span><span class="id"> :</span> <span class="id"> right_distributive</span><span class="id"> ffun_mul</span> (<span class="id">@ffun_add</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> f2</span><span class="id"> f3;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mulrDr</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_mul_0l</span><span class="id"> :</span> <span class="id"> left_zero</span> (<span class="id">@ffun_zero</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> ffun_mul</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mul0r</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_mul_0r</span><span class="id"> :</span> <span class="id"> right_zero</span> (<span class="id">@ffun_zero</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> ffun_mul</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mulr0</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isPzSemiRing</span>.<span class="id">Build</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span><br/>
&nbsp;&nbsp;<span class="id">ffun_mulA</span><span class="id"> ffun_mul_1l</span><span class="id"> ffun_mul_1r</span><span class="id"> ffun_mul_addl</span><span class="id"> ffun_mul_addr</span><br/>
&nbsp;&nbsp;<span class="id">ffun_mul_0l</span><span class="id"> ffun_mul_0r</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> ffun_semiring</span><span class="id"> :</span><span class="id"> pzSemiRingType</span><span class="id"> :=</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span>.<br/>
<span class="vernacular">End</span><span class="id"> FinFunSemiRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinFunSemiRing</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> aT</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> ffun1_nonzero</span><span class="id"> :</span><span class="id"> ffun_one</span><span class="id"> aT</span><span class="id"> R</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> /ffunP/</span>(_<span class="id"> a</span>)<span class="id">/eqP;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FinFunSemiRing</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Zmodule_isPzRing</span>.<span class="id">Build</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span><br/>
&nbsp;&nbsp;(<span class="id">@ffun_mulA</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">@ffun_mul_1l</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">@ffun_mul_1r</span><span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;(<span class="id">@ffun_mul_addl</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">@ffun_mul_addr</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinFunRing</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> nzRingType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> aT</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">PzSemiRing_isNonZero</span>.<span class="id">Build</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span> (<span class="id">@ffun1_nonzero</span><span class="id"> _</span><span class="id"> _</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ffun_ring</span><span class="id"> :</span><span class="id"> nzRingType</span><span class="id"> :=</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FinFunRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinFunComRing</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> comPzRingType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> aT</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> ffun_mulC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">@ffun_mul</span><span class="id"> aT</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f1</span><span class="id"> f2;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FinFunComRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FinFunLSemiMod</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">rT</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> rT}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ffun_scale</span><span class="id"> k</span><span class="id"> f</span><span class="id"> :=</span><span class="id"> [ffun</span><span class="id"> a</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> *:</span><span class="id"> f</span><span class="id"> a]</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> ffun_scaleA</span><span class="id"> k1</span><span class="id"> k2</span><span class="id"> f</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">ffun_scale</span><span class="id"> k1</span> (<span class="id">ffun_scale</span><span class="id"> k2</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> ffun_scale</span> (<span class="id">k1</span><span class="id"> *</span><span class="id"> k2</span>)<span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> scalerA</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_scale0r</span><span class="id"> f</span><span class="id"> :</span><span class="id"> ffun_scale</span><span class="id"> 0</span><span class="id"> f</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> scale0r</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_scale1</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> 1</span><span class="id"> ffun_scale</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> scale1r</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_scale_addr</span><span class="id"> k</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">ffun_scale</span><span class="id"> k</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> g;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> scalerDr</span>. Qed.</div></details>
<span class="vernacular">Fact</span><span class="id"> ffun_scale_addl</span><span class="id"> u</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">ffun_scale</span>)<span class="id">^~</span><span class="id"> u</span><span class="id"> :</span><span class="id"> k1</span><span class="id"> k2</span><span class="id"> /</span><span class="id"> k1</span><span class="id"> +</span><span class="id"> k2}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> k1</span><span class="id"> k2;</span><span class="id"> apply/ffunP=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> scalerDl</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> rT}</span><br/>
&nbsp;&nbsp;<span class="id">ffun_scaleA</span><span class="id"> ffun_scale0r</span><span class="id"> ffun_scale1</span><span class="id"> ffun_scale_addr</span><span class="id"> ffun_scale_addl</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FinFunLSemiMod</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">aT</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">rT</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">LSemiModule</span>.<span class="id">on</span><span class="id"> {ffun</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> rT}</span>.<br/>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairSemiRing</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mul_pair</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id"> :=</span> (<span class="id">x</span>.<span class="id">1</span><span class="id"> *</span><span class="id"> y</span>.<span class="id">1,</span><span class="id"> x</span>.<span class="id">2</span><span class="id"> *</span><span class="id"> y</span>.<span class="id">2</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mulA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> mul_pair</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mul1l</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">1,</span><span class="id"> 1</span>)<span class="id"> mul_pair</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> x1</span><span class="id"> x2;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mul1r</span><span class="id"> :</span><span class="id"> right_id</span> (<span class="id">1,</span><span class="id"> 1</span>)<span class="id"> mul_pair</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> x1</span><span class="id"> x2;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mulDl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> mul_pair</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulrDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mulDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> mul_pair</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulrDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mul0r</span><span class="id"> :</span><span class="id"> left_zero</span><span class="id"> 0</span><span class="id"> mul_pair</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mulr0</span><span class="id"> :</span><span class="id"> right_zero</span><span class="id"> 0</span><span class="id"> mul_pair</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulr0</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isPzSemiRing</span>.<span class="id">Build</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_mulA</span><span class="id"> pair_mul1l</span><span class="id"> pair_mul1r</span><span class="id"> pair_mulDl</span><span class="id"> pair_mulDr</span><span class="id"> pair_mul0r</span><span class="id"> pair_mulr0</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> fst_is_monoid_morphism</span><span class="id"> :</span><span class="id"> monoid_morphism</span><span class="id"> fst</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span><span class="id"> R1</span><span class="id"> fst</span><br/>
&nbsp;&nbsp;<span class="id">fst_is_monoid_morphism</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> snd_is_monoid_morphism</span><span class="id"> :</span><span class="id"> monoid_morphism</span><span class="id"> snd</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> isMonoidMorphism</span>.<span class="id">Build</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span><span class="id"> R2</span><span class="id"> snd</span><br/>
&nbsp;&nbsp;<span class="id">snd_is_monoid_morphism</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairSemiRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairSemiRing</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> nzSemiRingType</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_one_neq0</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> xpair_eqE</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_isNonZero</span>.<span class="id">Build</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_one_neq0</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairSemiRing</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairComSemiRing</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> comPzSemiRingType</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_mulC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">@mul_pair</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PzSemiRing_hasCommutativeMul</span>.<span class="id">Build</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_mulC</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairComSemiRing</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> comNzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">NzSemiRing</span>.<span class="id">on</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> pzRingType</span>)<span class="id"> :=</span><span class="id"> PzSemiRing</span>.<span class="id">on</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> nzRingType</span>)<span class="id"> :=</span><span class="id"> NzSemiRing</span>.<span class="id">on</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> comPzRingType</span>)<span class="id"> :=</span><span class="id"> PzRing</span>.<span class="id">on</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> comNzRingType</span>)<span class="id"> :=</span><span class="id"> NzRing</span>.<span class="id">on</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairLSemiMod</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">V1</span><span class="id"> V2</span><span class="id"> :</span><span class="id"> lSemiModType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> scale_pair</span><span class="id"> a</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> V1</span><span class="id"> *</span><span class="id"> V2</span>)<span class="id"> :</span><span class="id"> V1</span><span class="id"> *</span><span class="id"> V2</span><span class="id"> :=</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span>.<span class="id">1,</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span>.<span class="id">2</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scaleA</span><span class="id"> a</span><span class="id"> b</span><span class="id"> u</span><span class="id"> :</span><span class="id"> scale_pair</span><span class="id"> a</span> (<span class="id">scale_pair</span><span class="id"> b</span><span class="id"> u</span>)<span class="id"> =</span><span class="id"> scale_pair</span> (<span class="id">a</span><span class="id"> *</span><span class="id"> b</span>)<span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scalerA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scale0</span><span class="id"> u</span><span class="id"> :</span><span class="id"> scale_pair</span><span class="id"> 0</span><span class="id"> u</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> u</span><span class="id"> =&gt;</span><span class="id"> u1</span><span class="id"> u2;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scale0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scale1</span><span class="id"> u</span><span class="id"> :</span><span class="id"> scale_pair</span><span class="id"> 1</span><span class="id"> u</span><span class="id"> =</span><span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> u</span><span class="id"> =&gt;</span><span class="id"> u1</span><span class="id"> u2;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scale1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scaleDr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> scale_pair</span><span class="id"> +%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> u</span><span class="id"> v;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scalerDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scaleDl</span><span class="id"> u</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> scale_pair^~</span><span class="id"> u:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scalerDl</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isLSemiModule</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">V1</span><span class="id"> *</span><span class="id"> V2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_scaleA</span><span class="id"> pair_scale0</span><span class="id"> pair_scale1</span><span class="id"> pair_scaleDr</span><span class="id"> pair_scaleDl</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> fst_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span><span class="id"> fst</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">V1</span><span class="id"> *</span><span class="id"> V2</span>)<span class="id">%type</span><span class="id"> V1</span><span class="id"> *:%R</span><span class="id"> fst</span><span class="id"> fst_is_scalable</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> snd_is_scalable</span><span class="id"> :</span><span class="id"> scalable</span><span class="id"> snd</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isScalable</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">V1</span><span class="id"> *</span><span class="id"> V2</span>)<span class="id">%type</span><span class="id"> V2</span><span class="id"> *:%R</span><span class="id"> snd</span><span class="id"> snd_is_scalable</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairLSemiMod</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairLSemiAlg</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> lSemiAlgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scaleAl</span><span class="id"> a</span> (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> *</span><span class="id"> v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scalerAl</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiModule_isLSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_scaleAl</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> RMorphism</span>.<span class="id">on</span> (<span class="id">@fst</span><span class="id"> A1</span><span class="id"> A2</span>).<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> RMorphism</span>.<span class="id">on</span> (<span class="id">@snd</span><span class="id"> A1</span><span class="id"> A2</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairLSemiAlg</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairSemiAlg</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> semiAlgType</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> pair_scaleAr</span><span class="id"> a</span> (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id"> :</span><span class="id"> a</span><span class="id"> *:</span> (<span class="id">u</span><span class="id"> *</span><span class="id"> v</span>)<span class="id"> =</span><span class="id"> u</span><span class="id"> *</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> v</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> scalerAr</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> LSemiAlgebra_isSemiAlgebra</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_scaleAr</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairSemiAlg</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PairUnitRing</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> unitRingType</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> pair_unitr</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[qualify</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> |</span> (<span class="id">x</span>.<span class="id">1</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span>.<span class="id">2</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> GRing</span>.<span class="id">unit</span>)<span class="id">]</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> pair_invr</span><span class="id"> x</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> pair_unitr</span><span class="gallina-kwd"> then</span> (<span class="id">x</span>.<span class="id">1^-1,</span><span class="id"> x</span>.<span class="id">2^-1</span>)<span class="gallina-kwd"> else</span><span class="id"> x</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pair_mulVl</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pair_unitr,</span><span class="id"> left_inverse</span><span class="id"> 1</span><span class="id"> pair_invr</span><span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /pair_invr=&gt;</span><span class="id"> x;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /andP[Ux1</span><span class="id"> Ux2]</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulVr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pair_mulVr</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> pair_unitr,</span><span class="id"> right_inverse</span><span class="id"> 1</span><span class="id"> pair_invr</span><span class="id"> *%R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /pair_invr=&gt;</span><span class="id"> x;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /andP[Ux1</span><span class="id"> Ux2]</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulrV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pair_unitP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> /\</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> pair_unitr</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case=&gt;</span><span class="id"> [[y1x</span><span class="id"> y2x]</span><span class="id"> [x1y</span><span class="id"> x2y]];</span><span class="id"> apply/andP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> apply/unitrP;</span><span class="id"> [exists</span><span class="id"> y</span>.<span class="id">1</span><span class="id"> |</span><span class="gallina-kwd"> exists</span><span class="id"> y</span>.<span class="id">2]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pair_invr_out</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [predC</span><span class="id"> pair_unitr],</span><span class="id"> pair_invr</span><span class="id"> =1</span><span class="id"> id}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /pair_invr</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /negPf/=</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> NzRing_hasMulInverse</span>.<span class="id">Build</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span><br/>
&nbsp;&nbsp;<span class="id">pair_mulVl</span><span class="id"> pair_mulVr</span><span class="id"> pair_unitP</span><span class="id"> pair_invr_out</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> PairUnitRing</span>.<br/>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R1</span><span class="id"> R2</span><span class="id"> :</span><span class="id"> comUnitRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">UnitRing</span>.<span class="id">on</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> comSemiAlgType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SemiAlgebra</span>.<span class="id">on</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">V1</span><span class="id"> V2</span><span class="id"> :</span><span class="id"> lmodType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">LSemiModule</span>.<span class="id">on</span> (<span class="id">V1</span><span class="id"> *</span><span class="id"> V2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> lalgType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">LSemiAlgebra</span>.<span class="id">on</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> algType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SemiAlgebra</span>.<span class="id">on</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> comAlgType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Algebra</span>.<span class="id">on</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> unitAlgType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Algebra</span>.<span class="id">on</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span>.<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzRingType</span>) (<span class="id">A1</span><span class="id"> A2</span><span class="id"> :</span><span class="id"> comUnitAlgType</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Algebra</span>.<span class="id">on</span> (<span class="id">A1</span><span class="id"> *</span><span class="id"> A2</span>)<span class="id">%type</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pairMnE</span> (<span class="id">M1</span><span class="id"> M2</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> M1</span><span class="id"> *</span><span class="id"> M2</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">x</span>.<span class="id">1</span><span class="id"> *+</span><span class="id"> n,</span><span class="id"> x</span>.<span class="id">2</span><span class="id"> *+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> !mulrS</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Zmodule_isComNzRing</span>.<span class="id">Build</span><span class="id"> bool</span><br/>
&nbsp;&nbsp;<span class="id">andbA</span><span class="id"> andbC</span><span class="id"> andTb</span><span class="id"> andb_addl</span><span class="id"> isT</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> mulVb</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span><span class="id"> b</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> *</span><span class="id"> b</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> b</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> invb_out</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x;</span><span class="id"> case:</span><span class="id"> y</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> ComNzRing_hasMulInverse</span>.<span class="id">Build</span><span class="id"> bool</span><br/>
&nbsp;&nbsp;<span class="id">mulVb</span><span class="id"> invb_out</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="gallina-kwd"> fun</span><span class="id"> =&gt;</span><span class="id"> erefl</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bool_fieldP</span><span class="id"> :</span><span class="id"> Field</span>.<span class="id">axiom</span><span class="id"> bool</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> ComUnitRing_isField</span>.<span class="id">Build</span><span class="id"> bool</span><span class="id"> bool_fieldP</span>.<br/>
<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Nmodule_isComNzSemiRing</span>.<span class="id">Build</span><span class="id"> nat</span><br/>
&nbsp;&nbsp;<span class="id">mulnA</span><span class="id"> mulnC</span><span class="id"> mul1n</span><span class="id"> mulnDl</span><span class="id"> mul0n</span><span class="id"> erefl</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> pzSemiRingType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">isMonoidMorphism</span>.<span class="id">Build</span><span class="id"> nat</span><span class="id"> R</span> (<span class="id">natmul</span><span class="id"> 1</span>) (<span class="id">mulr1n</span><span class="id"> 1,</span><span class="id"> natrM</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> natr0E</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> natr1E</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> natn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R</span><span class="id"> =</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [//|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> -nat1r</span><span class="id"> IHn</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> natrDE</span><span class="id"> n</span><span class="id"> m</span><span class="id"> :</span><span class="id"> n</span><span class="id"> +</span><span class="id"> m</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> natrME</span><span class="id"> n</span><span class="id"> m</span><span class="id"> :</span><span class="id"> n</span><span class="id"> *</span><span class="id"> m</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> *</span><span class="id"> m</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> natrXE</span><span class="id"> n</span><span class="id"> m</span><span class="id"> :</span><span class="id"> n</span><span class="id"> ^+</span><span class="id"> m</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> ^</span><span class="id"> m</span>)<span class="id">%N</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> natrE</span><span class="id"> :=</span> (<span class="id">natr0E,</span><span class="id"> natr1E,</span><span class="id"> natn,</span><span class="id"> natrDE,</span><span class="id"> natrME,</span><span class="id"> natrXE</span>).<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/affeldt-aist/rocqnavi/">rocqnavi</a></div>
    </div>
  </div>
    </main>
</body>
</html>
