
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.mxalgebra</title>
<meta name="description" content="Documentation of Coq module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.mxalgebra" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="rocqnavi.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="rocqnavi.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="Corelib"><summary>Corelib</summary>
          <ul>
          <li><details id="Corelib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Corelib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Corelib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Corelib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Corelib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Corelib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Corelib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Corelib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Corelib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Corelib.Classes.Init.html">Init</a></li>
<li><a href="Corelib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Corelib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Corelib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Corelib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Corelib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Corelib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Corelib.Compat.Coq820.html">Coq820</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Corelib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Corelib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Corelib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Corelib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Corelib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Corelib.Init.Byte.html">Byte</a></li>
<li><a href="Corelib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Corelib.Init.Decimal.html">Decimal</a></li>
<li><a href="Corelib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Corelib.Init.Logic.html">Logic</a></li>
<li><a href="Corelib.Init.Ltac.html">Ltac</a></li>
<li><a href="Corelib.Init.Nat.html">Nat</a></li>
<li><a href="Corelib.Init.Notations.html">Notations</a></li>
<li><a href="Corelib.Init.Number.html">Number</a></li>
<li><a href="Corelib.Init.Peano.html">Peano</a></li>
<li><a href="Corelib.Init.Prelude.html">Prelude</a></li>
<li><a href="Corelib.Init.Specif.html">Specif</a></li>
<li><a href="Corelib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Corelib.Init.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Init.Tauto.html">Tauto</a></li>
<li><a href="Corelib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Corelib.Lists.ListDef.html">ListDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Corelib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Corelib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Corelib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Corelib.Numbers.BinNums.html">BinNums</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Corelib.Program.Basics.html">Basics</a></li>
<li><a href="Corelib.Program.Tactics.html">Tactics</a></li>
<li><a href="Corelib.Program.Utils.html">Utils</a></li>
<li><a href="Corelib.Program.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Corelib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Corelib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Corelib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Corelib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Corelib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Corelib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Corelib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Corelib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Corelib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Corelib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Corelib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Corelib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Corelib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Corelib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Corelib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Corelib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="HB"><summary>HB</summary>
          <ul>
          <li><a href="HB.structures.html">structures</a></li>
          </ul>
          </details>
          </li>
<li><details id="Ltac2"><summary>Ltac2</summary>
          <ul>
          <li><details id="Ltac2.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Ltac2.Compat.Coq818.html">Coq818</a></li>
<li><a href="Ltac2.Compat.Coq819.html">Coq819</a></li>
          </ul>
          </details>
          </li>
<li><a href="Ltac2.Array.html">Array</a></li>
<li><a href="Ltac2.Bool.html">Bool</a></li>
<li><a href="Ltac2.Char.html">Char</a></li>
<li><a href="Ltac2.Constant.html">Constant</a></li>
<li><a href="Ltac2.Constr.html">Constr</a></li>
<li><a href="Ltac2.Constructor.html">Constructor</a></li>
<li><a href="Ltac2.Control.html">Control</a></li>
<li><a href="Ltac2.Env.html">Env</a></li>
<li><a href="Ltac2.Evar.html">Evar</a></li>
<li><a href="Ltac2.FMap.html">FMap</a></li>
<li><a href="Ltac2.FSet.html">FSet</a></li>
<li><a href="Ltac2.Float.html">Float</a></li>
<li><a href="Ltac2.Fresh.html">Fresh</a></li>
<li><a href="Ltac2.Ident.html">Ident</a></li>
<li><a href="Ltac2.Ind.html">Ind</a></li>
<li><a href="Ltac2.Init.html">Init</a></li>
<li><a href="Ltac2.Int.html">Int</a></li>
<li><a href="Ltac2.Lazy.html">Lazy</a></li>
<li><a href="Ltac2.List.html">List</a></li>
<li><a href="Ltac2.Ltac1.html">Ltac1</a></li>
<li><a href="Ltac2.Ltac2.html">Ltac2</a></li>
<li><a href="Ltac2.Message.html">Message</a></li>
<li><a href="Ltac2.Meta.html">Meta</a></li>
<li><a href="Ltac2.Notations.html">Notations</a></li>
<li><a href="Ltac2.Option.html">Option</a></li>
<li><a href="Ltac2.Pattern.html">Pattern</a></li>
<li><a href="Ltac2.Printf.html">Printf</a></li>
<li><a href="Ltac2.Proj.html">Proj</a></li>
<li><a href="Ltac2.Pstring.html">Pstring</a></li>
<li><a href="Ltac2.RedFlags.html">RedFlags</a></li>
<li><a href="Ltac2.Ref.html">Ref</a></li>
<li><a href="Ltac2.Std.html">Std</a></li>
<li><a href="Ltac2.String.html">String</a></li>
<li><a href="Ltac2.TransparentState.html">TransparentState</a></li>
<li><a href="Ltac2.Uint63.html">Uint63</a></li>
<li><a href="Ltac2.Unification.html">Unification</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib"><summary>Stdlib</summary>
          <ul>
          <li><details id="Stdlib.All"><summary>All</summary>
          <ul>
          <li><a href="Stdlib.All.All.html">All</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Arith"><summary>Arith</summary>
          <ul>
          <li><a href="Stdlib.Arith.Arith.html">Arith</a></li>
<li><a href="Stdlib.Arith.Arith_base.html">Arith_base</a></li>
<li><a href="Stdlib.Arith.Between.html">Between</a></li>
<li><a href="Stdlib.Arith.Bool_nat.html">Bool_nat</a></li>
<li><a href="Stdlib.Arith.Cantor.html">Cantor</a></li>
<li><a href="Stdlib.Arith.Compare.html">Compare</a></li>
<li><a href="Stdlib.Arith.Compare_dec.html">Compare_dec</a></li>
<li><a href="Stdlib.Arith.EqNat.html">EqNat</a></li>
<li><a href="Stdlib.Arith.Euclid.html">Euclid</a></li>
<li><a href="Stdlib.Arith.Factorial.html">Factorial</a></li>
<li><a href="Stdlib.Arith.PeanoNat.html">PeanoNat</a></li>
<li><a href="Stdlib.Arith.Peano_dec.html">Peano_dec</a></li>
<li><a href="Stdlib.Arith.Wf_nat.html">Wf_nat</a></li>
<li><a href="Stdlib.Arith.Zerob.html">Zerob</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Array"><summary>Array</summary>
          <ul>
          <li><a href="Stdlib.Array.ArrayAxioms.html">ArrayAxioms</a></li>
<li><a href="Stdlib.Array.PArray.html">PArray</a></li>
<li><a href="Stdlib.Array.PrimArray.html">PrimArray</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.BinNums"><summary>BinNums</summary>
          <ul>
          <li><a href="Stdlib.BinNums.IntDef.html">IntDef</a></li>
<li><a href="Stdlib.BinNums.NatDef.html">NatDef</a></li>
<li><a href="Stdlib.BinNums.PosDef.html">PosDef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Bool"><summary>Bool</summary>
          <ul>
          <li><a href="Stdlib.Bool.Bool.html">Bool</a></li>
<li><a href="Stdlib.Bool.BoolEq.html">BoolEq</a></li>
<li><a href="Stdlib.Bool.DecBool.html">DecBool</a></li>
<li><a href="Stdlib.Bool.IfProp.html">IfProp</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Classes"><summary>Classes</summary>
          <ul>
          <li><a href="Stdlib.Classes.CEquivalence.html">CEquivalence</a></li>
<li><a href="Stdlib.Classes.CMorphisms.html">CMorphisms</a></li>
<li><a href="Stdlib.Classes.CRelationClasses.html">CRelationClasses</a></li>
<li><a href="Stdlib.Classes.DecidableClass.html">DecidableClass</a></li>
<li><a href="Stdlib.Classes.EquivDec.html">EquivDec</a></li>
<li><a href="Stdlib.Classes.Equivalence.html">Equivalence</a></li>
<li><a href="Stdlib.Classes.Init.html">Init</a></li>
<li><a href="Stdlib.Classes.Morphisms.html">Morphisms</a></li>
<li><a href="Stdlib.Classes.Morphisms_Prop.html">Morphisms_Prop</a></li>
<li><a href="Stdlib.Classes.Morphisms_Relations.html">Morphisms_Relations</a></li>
<li><a href="Stdlib.Classes.RelationClasses.html">RelationClasses</a></li>
<li><a href="Stdlib.Classes.RelationPairs.html">RelationPairs</a></li>
<li><a href="Stdlib.Classes.SetoidClass.html">SetoidClass</a></li>
<li><a href="Stdlib.Classes.SetoidDec.html">SetoidDec</a></li>
<li><a href="Stdlib.Classes.SetoidTactics.html">SetoidTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Compat"><summary>Compat</summary>
          <ul>
          <li><a href="Stdlib.Compat.AdmitAxiom.html">AdmitAxiom</a></li>
<li><a href="Stdlib.Compat.Coq818.html">Coq818</a></li>
<li><a href="Stdlib.Compat.Coq819.html">Coq819</a></li>
<li><a href="Stdlib.Compat.Coq820.html">Coq820</a></li>
<li><a href="Stdlib.Compat.Stdlib818.html">Stdlib818</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.FSets"><summary>FSets</summary>
          <ul>
          <li><a href="Stdlib.FSets.FMapAVL.html">FMapAVL</a></li>
<li><a href="Stdlib.FSets.FMapFacts.html">FMapFacts</a></li>
<li><a href="Stdlib.FSets.FMapFullAVL.html">FMapFullAVL</a></li>
<li><a href="Stdlib.FSets.FMapInterface.html">FMapInterface</a></li>
<li><a href="Stdlib.FSets.FMapList.html">FMapList</a></li>
<li><a href="Stdlib.FSets.FMapPositive.html">FMapPositive</a></li>
<li><a href="Stdlib.FSets.FMapWeakList.html">FMapWeakList</a></li>
<li><a href="Stdlib.FSets.FMaps.html">FMaps</a></li>
<li><a href="Stdlib.FSets.FSetAVL.html">FSetAVL</a></li>
<li><a href="Stdlib.FSets.FSetBridge.html">FSetBridge</a></li>
<li><a href="Stdlib.FSets.FSetCompat.html">FSetCompat</a></li>
<li><a href="Stdlib.FSets.FSetDecide.html">FSetDecide</a></li>
<li><a href="Stdlib.FSets.FSetEqProperties.html">FSetEqProperties</a></li>
<li><a href="Stdlib.FSets.FSetFacts.html">FSetFacts</a></li>
<li><a href="Stdlib.FSets.FSetInterface.html">FSetInterface</a></li>
<li><a href="Stdlib.FSets.FSetList.html">FSetList</a></li>
<li><a href="Stdlib.FSets.FSetPositive.html">FSetPositive</a></li>
<li><a href="Stdlib.FSets.FSetProperties.html">FSetProperties</a></li>
<li><a href="Stdlib.FSets.FSetToFiniteSet.html">FSetToFiniteSet</a></li>
<li><a href="Stdlib.FSets.FSetWeakList.html">FSetWeakList</a></li>
<li><a href="Stdlib.FSets.FSets.html">FSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Floats"><summary>Floats</summary>
          <ul>
          <li><a href="Stdlib.Floats.FloatAxioms.html">FloatAxioms</a></li>
<li><a href="Stdlib.Floats.FloatClass.html">FloatClass</a></li>
<li><a href="Stdlib.Floats.FloatLemmas.html">FloatLemmas</a></li>
<li><a href="Stdlib.Floats.FloatOps.html">FloatOps</a></li>
<li><a href="Stdlib.Floats.Floats.html">Floats</a></li>
<li><a href="Stdlib.Floats.PrimFloat.html">PrimFloat</a></li>
<li><a href="Stdlib.Floats.SpecFloat.html">SpecFloat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Init"><summary>Init</summary>
          <ul>
          <li><a href="Stdlib.Init.Byte.html">Byte</a></li>
<li><a href="Stdlib.Init.Datatypes.html">Datatypes</a></li>
<li><a href="Stdlib.Init.Decimal.html">Decimal</a></li>
<li><a href="Stdlib.Init.Hexadecimal.html">Hexadecimal</a></li>
<li><a href="Stdlib.Init.Logic.html">Logic</a></li>
<li><a href="Stdlib.Init.Ltac.html">Ltac</a></li>
<li><a href="Stdlib.Init.Nat.html">Nat</a></li>
<li><a href="Stdlib.Init.Notations.html">Notations</a></li>
<li><a href="Stdlib.Init.Number.html">Number</a></li>
<li><a href="Stdlib.Init.Peano.html">Peano</a></li>
<li><a href="Stdlib.Init.Prelude.html">Prelude</a></li>
<li><a href="Stdlib.Init.Specif.html">Specif</a></li>
<li><a href="Stdlib.Init.Sumbool.html">Sumbool</a></li>
<li><a href="Stdlib.Init.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Init.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.Init.Wf.html">Wf</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Lists"><summary>Lists</summary>
          <ul>
          <li><a href="Stdlib.Lists.List.html">List</a></li>
<li><a href="Stdlib.Lists.ListDec.html">ListDec</a></li>
<li><a href="Stdlib.Lists.ListDef.html">ListDef</a></li>
<li><a href="Stdlib.Lists.ListSet.html">ListSet</a></li>
<li><a href="Stdlib.Lists.ListTactics.html">ListTactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Logic"><summary>Logic</summary>
          <ul>
          <li><a href="Stdlib.Logic.Adjointification.html">Adjointification</a></li>
<li><a href="Stdlib.Logic.Berardi.html">Berardi</a></li>
<li><a href="Stdlib.Logic.ChoiceFacts.html">ChoiceFacts</a></li>
<li><a href="Stdlib.Logic.Classical.html">Classical</a></li>
<li><a href="Stdlib.Logic.ClassicalChoice.html">ClassicalChoice</a></li>
<li><a href="Stdlib.Logic.ClassicalDescription.html">ClassicalDescription</a></li>
<li><a href="Stdlib.Logic.ClassicalEpsilon.html">ClassicalEpsilon</a></li>
<li><a href="Stdlib.Logic.ClassicalFacts.html">ClassicalFacts</a></li>
<li><a href="Stdlib.Logic.ClassicalUniqueChoice.html">ClassicalUniqueChoice</a></li>
<li><a href="Stdlib.Logic.Classical_Pred_Type.html">Classical_Pred_Type</a></li>
<li><a href="Stdlib.Logic.Classical_Prop.html">Classical_Prop</a></li>
<li><a href="Stdlib.Logic.ConstructiveEpsilon.html">ConstructiveEpsilon</a></li>
<li><a href="Stdlib.Logic.Decidable.html">Decidable</a></li>
<li><a href="Stdlib.Logic.Description.html">Description</a></li>
<li><a href="Stdlib.Logic.Diaconescu.html">Diaconescu</a></li>
<li><a href="Stdlib.Logic.Epsilon.html">Epsilon</a></li>
<li><a href="Stdlib.Logic.Eqdep.html">Eqdep</a></li>
<li><a href="Stdlib.Logic.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="Stdlib.Logic.Eqdep_dec.html">Eqdep_dec</a></li>
<li><a href="Stdlib.Logic.ExtensionalFunctionRepresentative.html">ExtensionalFunctionRepresentative</a></li>
<li><a href="Stdlib.Logic.ExtensionalityFacts.html">ExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.FunctionalExtensionality.html">FunctionalExtensionality</a></li>
<li><a href="Stdlib.Logic.HLevels.html">HLevels</a></li>
<li><a href="Stdlib.Logic.Hurkens.html">Hurkens</a></li>
<li><a href="Stdlib.Logic.IndefiniteDescription.html">IndefiniteDescription</a></li>
<li><a href="Stdlib.Logic.JMeq.html">JMeq</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevance.html">ProofIrrelevance</a></li>
<li><a href="Stdlib.Logic.ProofIrrelevanceFacts.html">ProofIrrelevanceFacts</a></li>
<li><a href="Stdlib.Logic.PropExtensionality.html">PropExtensionality</a></li>
<li><a href="Stdlib.Logic.PropExtensionalityFacts.html">PropExtensionalityFacts</a></li>
<li><a href="Stdlib.Logic.PropFacts.html">PropFacts</a></li>
<li><a href="Stdlib.Logic.RelationalChoice.html">RelationalChoice</a></li>
<li><a href="Stdlib.Logic.SetIsType.html">SetIsType</a></li>
<li><a href="Stdlib.Logic.SetoidChoice.html">SetoidChoice</a></li>
<li><a href="Stdlib.Logic.StrictProp.html">StrictProp</a></li>
<li><a href="Stdlib.Logic.WKL.html">WKL</a></li>
<li><a href="Stdlib.Logic.WeakFan.html">WeakFan</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.MSets"><summary>MSets</summary>
          <ul>
          <li><a href="Stdlib.MSets.MSetAVL.html">MSetAVL</a></li>
<li><a href="Stdlib.MSets.MSetDecide.html">MSetDecide</a></li>
<li><a href="Stdlib.MSets.MSetEqProperties.html">MSetEqProperties</a></li>
<li><a href="Stdlib.MSets.MSetFacts.html">MSetFacts</a></li>
<li><a href="Stdlib.MSets.MSetGenTree.html">MSetGenTree</a></li>
<li><a href="Stdlib.MSets.MSetInterface.html">MSetInterface</a></li>
<li><a href="Stdlib.MSets.MSetList.html">MSetList</a></li>
<li><a href="Stdlib.MSets.MSetPositive.html">MSetPositive</a></li>
<li><a href="Stdlib.MSets.MSetProperties.html">MSetProperties</a></li>
<li><a href="Stdlib.MSets.MSetRBT.html">MSetRBT</a></li>
<li><a href="Stdlib.MSets.MSetToFiniteSet.html">MSetToFiniteSet</a></li>
<li><a href="Stdlib.MSets.MSetWeakList.html">MSetWeakList</a></li>
<li><a href="Stdlib.MSets.MSets.html">MSets</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.NArith"><summary>NArith</summary>
          <ul>
          <li><a href="Stdlib.NArith.BinNat.html">BinNat</a></li>
<li><a href="Stdlib.NArith.BinNatDef.html">BinNatDef</a></li>
<li><a href="Stdlib.NArith.NArith.html">NArith</a></li>
<li><a href="Stdlib.NArith.NArith_base.html">NArith_base</a></li>
<li><a href="Stdlib.NArith.Ndec.html">Ndec</a></li>
<li><a href="Stdlib.NArith.Ndiv_def.html">Ndiv_def</a></li>
<li><a href="Stdlib.NArith.Ngcd_def.html">Ngcd_def</a></li>
<li><a href="Stdlib.NArith.Nnat.html">Nnat</a></li>
<li><a href="Stdlib.NArith.Nsqrt_def.html">Nsqrt_def</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers"><summary>Numbers</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic"><summary>Cyclic</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Cyclic.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Abstract.CyclicAxioms.html">CyclicAxioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.DoubleType.html">DoubleType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Abstract.NZCyclic.html">NZCyclic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Cyclic.Int63"><summary>Int63</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Cyclic.Int63.CarryType.html">CarryType</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Cyclic63.html">Cyclic63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.PrimInt63.html">PrimInt63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Ring63.html">Ring63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63.html">Sint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Sint63Axioms.html">Sint63Axioms</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63.html">Uint63</a></li>
<li><a href="Stdlib.Numbers.Cyclic.Int63.Uint63Axioms.html">Uint63Axioms</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer"><summary>Integer</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Integer.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Abstract.ZAdd.html">ZAdd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAddOrder.html">ZAddOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZAxioms.html">ZAxioms</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBase.html">ZBase</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZBits.html">ZBits</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivEucl.html">ZDivEucl</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivFloor.html">ZDivFloor</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZDivTrunc.html">ZDivTrunc</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZGcd.html">ZGcd</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLcm.html">ZLcm</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZLt.html">ZLt</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMaxMin.html">ZMaxMin</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMul.html">ZMul</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZMulOrder.html">ZMulOrder</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZParity.html">ZParity</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZPow.html">ZPow</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZProperties.html">ZProperties</a></li>
<li><a href="Stdlib.Numbers.Integer.Abstract.ZSgnAbs.html">ZSgnAbs</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.Binary.ZBinary.html">ZBinary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Integer.NatPairs"><summary>NatPairs</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Integer.NatPairs.ZNatPairs.html">ZNatPairs</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.NatInt"><summary>NatInt</summary>
          <ul>
          <li><a href="Stdlib.Numbers.NatInt.NZAdd.html">NZAdd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAddOrder.html">NZAddOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZAxioms.html">NZAxioms</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBase.html">NZBase</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZBits.html">NZBits</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDiv.html">NZDiv</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZDomain.html">NZDomain</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZGcd.html">NZGcd</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZLog.html">NZLog</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMul.html">NZMul</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZMulOrder.html">NZMulOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZOrder.html">NZOrder</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZParity.html">NZParity</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZPow.html">NZPow</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZProperties.html">NZProperties</a></li>
<li><a href="Stdlib.Numbers.NatInt.NZSqrt.html">NZSqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural"><summary>Natural</summary>
          <ul>
          <li><details id="Stdlib.Numbers.Natural.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Abstract.NAdd.html">NAdd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAddOrder.html">NAddOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NAxioms.html">NAxioms</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBase.html">NBase</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NBits.html">NBits</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDefOps.html">NDefOps</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv.html">NDiv</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NDiv0.html">NDiv0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NGcd.html">NGcd</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NIso.html">NIso</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm.html">NLcm</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLcm0.html">NLcm0</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NLog.html">NLog</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMaxMin.html">NMaxMin</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NMulOrder.html">NMulOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NOrder.html">NOrder</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NParity.html">NParity</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NPow.html">NPow</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NProperties.html">NProperties</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSqrt.html">NSqrt</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NStrongRec.html">NStrongRec</a></li>
<li><a href="Stdlib.Numbers.Natural.Abstract.NSub.html">NSub</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Numbers.Natural.Binary"><summary>Binary</summary>
          <ul>
          <li><a href="Stdlib.Numbers.Natural.Binary.NBinary.html">NBinary</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Numbers.AltBinNotations.html">AltBinNotations</a></li>
<li><a href="Stdlib.Numbers.BinNums.html">BinNums</a></li>
<li><a href="Stdlib.Numbers.DecimalFacts.html">DecimalFacts</a></li>
<li><a href="Stdlib.Numbers.DecimalN.html">DecimalN</a></li>
<li><a href="Stdlib.Numbers.DecimalNat.html">DecimalNat</a></li>
<li><a href="Stdlib.Numbers.DecimalPos.html">DecimalPos</a></li>
<li><a href="Stdlib.Numbers.DecimalQ.html">DecimalQ</a></li>
<li><a href="Stdlib.Numbers.DecimalR.html">DecimalR</a></li>
<li><a href="Stdlib.Numbers.DecimalString.html">DecimalString</a></li>
<li><a href="Stdlib.Numbers.DecimalZ.html">DecimalZ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalFacts.html">HexadecimalFacts</a></li>
<li><a href="Stdlib.Numbers.HexadecimalN.html">HexadecimalN</a></li>
<li><a href="Stdlib.Numbers.HexadecimalNat.html">HexadecimalNat</a></li>
<li><a href="Stdlib.Numbers.HexadecimalPos.html">HexadecimalPos</a></li>
<li><a href="Stdlib.Numbers.HexadecimalQ.html">HexadecimalQ</a></li>
<li><a href="Stdlib.Numbers.HexadecimalR.html">HexadecimalR</a></li>
<li><a href="Stdlib.Numbers.HexadecimalString.html">HexadecimalString</a></li>
<li><a href="Stdlib.Numbers.HexadecimalZ.html">HexadecimalZ</a></li>
<li><a href="Stdlib.Numbers.NaryFunctions.html">NaryFunctions</a></li>
<li><a href="Stdlib.Numbers.NumPrelude.html">NumPrelude</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.PArith"><summary>PArith</summary>
          <ul>
          <li><a href="Stdlib.PArith.BinPos.html">BinPos</a></li>
<li><a href="Stdlib.PArith.BinPosDef.html">BinPosDef</a></li>
<li><a href="Stdlib.PArith.PArith.html">PArith</a></li>
<li><a href="Stdlib.PArith.POrderedType.html">POrderedType</a></li>
<li><a href="Stdlib.PArith.Pnat.html">Pnat</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Program"><summary>Program</summary>
          <ul>
          <li><a href="Stdlib.Program.Basics.html">Basics</a></li>
<li><a href="Stdlib.Program.Combinators.html">Combinators</a></li>
<li><a href="Stdlib.Program.Equality.html">Equality</a></li>
<li><a href="Stdlib.Program.Program.html">Program</a></li>
<li><a href="Stdlib.Program.Subset.html">Subset</a></li>
<li><a href="Stdlib.Program.Syntax.html">Syntax</a></li>
<li><a href="Stdlib.Program.Tactics.html">Tactics</a></li>
<li><a href="Stdlib.Program.Utils.html">Utils</a></li>
<li><a href="Stdlib.Program.Wf.html">Wf</a></li>
<li><a href="Stdlib.Program.WfExtensionality.html">WfExtensionality</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.QArith"><summary>QArith</summary>
          <ul>
          <li><a href="Stdlib.QArith.QArith.html">QArith</a></li>
<li><a href="Stdlib.QArith.QArith_base.html">QArith_base</a></li>
<li><a href="Stdlib.QArith.QOrderedType.html">QOrderedType</a></li>
<li><a href="Stdlib.QArith.Qabs.html">Qabs</a></li>
<li><a href="Stdlib.QArith.Qcabs.html">Qcabs</a></li>
<li><a href="Stdlib.QArith.Qcanon.html">Qcanon</a></li>
<li><a href="Stdlib.QArith.Qfield.html">Qfield</a></li>
<li><a href="Stdlib.QArith.Qminmax.html">Qminmax</a></li>
<li><a href="Stdlib.QArith.Qpower.html">Qpower</a></li>
<li><a href="Stdlib.QArith.Qreduction.html">Qreduction</a></li>
<li><a href="Stdlib.QArith.Qring.html">Qring</a></li>
<li><a href="Stdlib.QArith.Qround.html">Qround</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals"><summary>Reals</summary>
          <ul>
          <li><details id="Stdlib.Reals.Abstract"><summary>Abstract</summary>
          <ul>
          <li><a href="Stdlib.Reals.Abstract.ConstructiveAbs.html">ConstructiveAbs</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLUB.html">ConstructiveLUB</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveLimits.html">ConstructiveLimits</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveMinMax.html">ConstructiveMinMax</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructivePower.html">ConstructivePower</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveReals.html">ConstructiveReals</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveRealsMorphisms.html">ConstructiveRealsMorphisms</a></li>
<li><a href="Stdlib.Reals.Abstract.ConstructiveSum.html">ConstructiveSum</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Reals.Cauchy"><summary>Cauchy</summary>
          <ul>
          <li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyAbs.html">ConstructiveCauchyAbs</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyReals.html">ConstructiveCauchyReals</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveCauchyRealsMult.html">ConstructiveCauchyRealsMult</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveExtra.html">ConstructiveExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.ConstructiveRcomplete.html">ConstructiveRcomplete</a></li>
<li><a href="Stdlib.Reals.Cauchy.PosExtra.html">PosExtra</a></li>
<li><a href="Stdlib.Reals.Cauchy.QExtra.html">QExtra</a></li>
          </ul>
          </details>
          </li>
<li><a href="Stdlib.Reals.Alembert.html">Alembert</a></li>
<li><a href="Stdlib.Reals.AltSeries.html">AltSeries</a></li>
<li><a href="Stdlib.Reals.ArithProp.html">ArithProp</a></li>
<li><a href="Stdlib.Reals.Binomial.html">Binomial</a></li>
<li><a href="Stdlib.Reals.Cauchy_prod.html">Cauchy_prod</a></li>
<li><a href="Stdlib.Reals.ClassicalConstructiveReals.html">ClassicalConstructiveReals</a></li>
<li><a href="Stdlib.Reals.ClassicalDedekindReals.html">ClassicalDedekindReals</a></li>
<li><a href="Stdlib.Reals.Cos_plus.html">Cos_plus</a></li>
<li><a href="Stdlib.Reals.Cos_rel.html">Cos_rel</a></li>
<li><a href="Stdlib.Reals.DiscrR.html">DiscrR</a></li>
<li><a href="Stdlib.Reals.Exp_prop.html">Exp_prop</a></li>
<li><a href="Stdlib.Reals.Integration.html">Integration</a></li>
<li><a href="Stdlib.Reals.MVT.html">MVT</a></li>
<li><a href="Stdlib.Reals.Machin.html">Machin</a></li>
<li><a href="Stdlib.Reals.NewtonInt.html">NewtonInt</a></li>
<li><a href="Stdlib.Reals.Nsatz.html">Nsatz</a></li>
<li><a href="Stdlib.Reals.PSeries_reg.html">PSeries_reg</a></li>
<li><a href="Stdlib.Reals.PartSum.html">PartSum</a></li>
<li><a href="Stdlib.Reals.Qreals.html">Qreals</a></li>
<li><a href="Stdlib.Reals.RIneq.html">RIneq</a></li>
<li><a href="Stdlib.Reals.RList.html">RList</a></li>
<li><a href="Stdlib.Reals.ROrderedType.html">ROrderedType</a></li>
<li><a href="Stdlib.Reals.R_Ifp.html">R_Ifp</a></li>
<li><a href="Stdlib.Reals.R_sqr.html">R_sqr</a></li>
<li><a href="Stdlib.Reals.R_sqrt.html">R_sqrt</a></li>
<li><a href="Stdlib.Reals.Ranalysis.html">Ranalysis</a></li>
<li><a href="Stdlib.Reals.Ranalysis1.html">Ranalysis1</a></li>
<li><a href="Stdlib.Reals.Ranalysis2.html">Ranalysis2</a></li>
<li><a href="Stdlib.Reals.Ranalysis3.html">Ranalysis3</a></li>
<li><a href="Stdlib.Reals.Ranalysis4.html">Ranalysis4</a></li>
<li><a href="Stdlib.Reals.Ranalysis5.html">Ranalysis5</a></li>
<li><a href="Stdlib.Reals.Ranalysis_reg.html">Ranalysis_reg</a></li>
<li><a href="Stdlib.Reals.Ratan.html">Ratan</a></li>
<li><a href="Stdlib.Reals.Raxioms.html">Raxioms</a></li>
<li><a href="Stdlib.Reals.Rbase.html">Rbase</a></li>
<li><a href="Stdlib.Reals.Rbasic_fun.html">Rbasic_fun</a></li>
<li><a href="Stdlib.Reals.Rcomplete.html">Rcomplete</a></li>
<li><a href="Stdlib.Reals.Rdefinitions.html">Rdefinitions</a></li>
<li><a href="Stdlib.Reals.Rderiv.html">Rderiv</a></li>
<li><a href="Stdlib.Reals.Reals.html">Reals</a></li>
<li><a href="Stdlib.Reals.Rfunctions.html">Rfunctions</a></li>
<li><a href="Stdlib.Reals.Rgeom.html">Rgeom</a></li>
<li><a href="Stdlib.Reals.RiemannInt.html">RiemannInt</a></li>
<li><a href="Stdlib.Reals.RiemannInt_SF.html">RiemannInt_SF</a></li>
<li><a href="Stdlib.Reals.Rlimit.html">Rlimit</a></li>
<li><a href="Stdlib.Reals.Rlogic.html">Rlogic</a></li>
<li><a href="Stdlib.Reals.Rminmax.html">Rminmax</a></li>
<li><a href="Stdlib.Reals.Rpow_def.html">Rpow_def</a></li>
<li><a href="Stdlib.Reals.Rpower.html">Rpower</a></li>
<li><a href="Stdlib.Reals.Rprod.html">Rprod</a></li>
<li><a href="Stdlib.Reals.Rregisternames.html">Rregisternames</a></li>
<li><a href="Stdlib.Reals.Rseries.html">Rseries</a></li>
<li><a href="Stdlib.Reals.Rsigma.html">Rsigma</a></li>
<li><a href="Stdlib.Reals.Rsqrt_def.html">Rsqrt_def</a></li>
<li><a href="Stdlib.Reals.Rtopology.html">Rtopology</a></li>
<li><a href="Stdlib.Reals.Rtrigo.html">Rtrigo</a></li>
<li><a href="Stdlib.Reals.Rtrigo1.html">Rtrigo1</a></li>
<li><a href="Stdlib.Reals.Rtrigo_alt.html">Rtrigo_alt</a></li>
<li><a href="Stdlib.Reals.Rtrigo_calc.html">Rtrigo_calc</a></li>
<li><a href="Stdlib.Reals.Rtrigo_def.html">Rtrigo_def</a></li>
<li><a href="Stdlib.Reals.Rtrigo_facts.html">Rtrigo_facts</a></li>
<li><a href="Stdlib.Reals.Rtrigo_fun.html">Rtrigo_fun</a></li>
<li><a href="Stdlib.Reals.Rtrigo_reg.html">Rtrigo_reg</a></li>
<li><a href="Stdlib.Reals.Runcountable.html">Runcountable</a></li>
<li><a href="Stdlib.Reals.SeqProp.html">SeqProp</a></li>
<li><a href="Stdlib.Reals.SeqSeries.html">SeqSeries</a></li>
<li><a href="Stdlib.Reals.SplitAbsolu.html">SplitAbsolu</a></li>
<li><a href="Stdlib.Reals.SplitRmult.html">SplitRmult</a></li>
<li><a href="Stdlib.Reals.Sqrt_reg.html">Sqrt_reg</a></li>
<li><a href="Stdlib.Reals.Zfloor.html">Zfloor</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Relations"><summary>Relations</summary>
          <ul>
          <li><a href="Stdlib.Relations.Operators_Properties.html">Operators_Properties</a></li>
<li><a href="Stdlib.Relations.Relation_Definitions.html">Relation_Definitions</a></li>
<li><a href="Stdlib.Relations.Relation_Operators.html">Relation_Operators</a></li>
<li><a href="Stdlib.Relations.Relations.html">Relations</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Setoids"><summary>Setoids</summary>
          <ul>
          <li><a href="Stdlib.Setoids.Setoid.html">Setoid</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sets"><summary>Sets</summary>
          <ul>
          <li><a href="Stdlib.Sets.Classical_sets.html">Classical_sets</a></li>
<li><a href="Stdlib.Sets.Constructive_sets.html">Constructive_sets</a></li>
<li><a href="Stdlib.Sets.Cpo.html">Cpo</a></li>
<li><a href="Stdlib.Sets.Ensembles.html">Ensembles</a></li>
<li><a href="Stdlib.Sets.Finite_sets.html">Finite_sets</a></li>
<li><a href="Stdlib.Sets.Finite_sets_facts.html">Finite_sets_facts</a></li>
<li><a href="Stdlib.Sets.Image.html">Image</a></li>
<li><a href="Stdlib.Sets.Infinite_sets.html">Infinite_sets</a></li>
<li><a href="Stdlib.Sets.Integers.html">Integers</a></li>
<li><a href="Stdlib.Sets.Multiset.html">Multiset</a></li>
<li><a href="Stdlib.Sets.Partial_Order.html">Partial_Order</a></li>
<li><a href="Stdlib.Sets.Permut.html">Permut</a></li>
<li><a href="Stdlib.Sets.Powerset.html">Powerset</a></li>
<li><a href="Stdlib.Sets.Powerset_Classical_facts.html">Powerset_Classical_facts</a></li>
<li><a href="Stdlib.Sets.Powerset_facts.html">Powerset_facts</a></li>
<li><a href="Stdlib.Sets.Relations_1.html">Relations_1</a></li>
<li><a href="Stdlib.Sets.Relations_1_facts.html">Relations_1_facts</a></li>
<li><a href="Stdlib.Sets.Relations_2.html">Relations_2</a></li>
<li><a href="Stdlib.Sets.Relations_2_facts.html">Relations_2_facts</a></li>
<li><a href="Stdlib.Sets.Relations_3.html">Relations_3</a></li>
<li><a href="Stdlib.Sets.Relations_3_facts.html">Relations_3_facts</a></li>
<li><a href="Stdlib.Sets.Uniset.html">Uniset</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Sorting"><summary>Sorting</summary>
          <ul>
          <li><a href="Stdlib.Sorting.CPermutation.html">CPermutation</a></li>
<li><a href="Stdlib.Sorting.Heap.html">Heap</a></li>
<li><a href="Stdlib.Sorting.Mergesort.html">Mergesort</a></li>
<li><a href="Stdlib.Sorting.PermutEq.html">PermutEq</a></li>
<li><a href="Stdlib.Sorting.PermutSetoid.html">PermutSetoid</a></li>
<li><a href="Stdlib.Sorting.Permutation.html">Permutation</a></li>
<li><a href="Stdlib.Sorting.SetoidList.html">SetoidList</a></li>
<li><a href="Stdlib.Sorting.SetoidPermutation.html">SetoidPermutation</a></li>
<li><a href="Stdlib.Sorting.Sorted.html">Sorted</a></li>
<li><a href="Stdlib.Sorting.Sorting.html">Sorting</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Streams"><summary>Streams</summary>
          <ul>
          <li><a href="Stdlib.Streams.StreamMemo.html">StreamMemo</a></li>
<li><a href="Stdlib.Streams.Streams.html">Streams</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Strings"><summary>Strings</summary>
          <ul>
          <li><a href="Stdlib.Strings.Ascii.html">Ascii</a></li>
<li><a href="Stdlib.Strings.BinaryString.html">BinaryString</a></li>
<li><a href="Stdlib.Strings.Byte.html">Byte</a></li>
<li><a href="Stdlib.Strings.HexString.html">HexString</a></li>
<li><a href="Stdlib.Strings.OctalString.html">OctalString</a></li>
<li><a href="Stdlib.Strings.PString.html">PString</a></li>
<li><a href="Stdlib.Strings.PrimString.html">PrimString</a></li>
<li><a href="Stdlib.Strings.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="Stdlib.Strings.String.html">String</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Structures"><summary>Structures</summary>
          <ul>
          <li><a href="Stdlib.Structures.BoolOrder.html">BoolOrder</a></li>
<li><a href="Stdlib.Structures.DecidableType.html">DecidableType</a></li>
<li><a href="Stdlib.Structures.DecidableTypeEx.html">DecidableTypeEx</a></li>
<li><a href="Stdlib.Structures.Equalities.html">Equalities</a></li>
<li><a href="Stdlib.Structures.EqualitiesFacts.html">EqualitiesFacts</a></li>
<li><a href="Stdlib.Structures.GenericMinMax.html">GenericMinMax</a></li>
<li><a href="Stdlib.Structures.OrderedType.html">OrderedType</a></li>
<li><a href="Stdlib.Structures.OrderedTypeAlt.html">OrderedTypeAlt</a></li>
<li><a href="Stdlib.Structures.OrderedTypeEx.html">OrderedTypeEx</a></li>
<li><a href="Stdlib.Structures.Orders.html">Orders</a></li>
<li><a href="Stdlib.Structures.OrdersAlt.html">OrdersAlt</a></li>
<li><a href="Stdlib.Structures.OrdersEx.html">OrdersEx</a></li>
<li><a href="Stdlib.Structures.OrdersFacts.html">OrdersFacts</a></li>
<li><a href="Stdlib.Structures.OrdersLists.html">OrdersLists</a></li>
<li><a href="Stdlib.Structures.OrdersTac.html">OrdersTac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Unicode"><summary>Unicode</summary>
          <ul>
          <li><a href="Stdlib.Unicode.Utf8.html">Utf8</a></li>
<li><a href="Stdlib.Unicode.Utf8_core.html">Utf8_core</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Vectors"><summary>Vectors</summary>
          <ul>
          <li><a href="Stdlib.Vectors.Bvector.html">Bvector</a></li>
<li><a href="Stdlib.Vectors.Fin.html">Fin</a></li>
<li><a href="Stdlib.Vectors.FinFun.html">FinFun</a></li>
<li><a href="Stdlib.Vectors.Vector.html">Vector</a></li>
<li><a href="Stdlib.Vectors.VectorDef.html">VectorDef</a></li>
<li><a href="Stdlib.Vectors.VectorEq.html">VectorEq</a></li>
<li><a href="Stdlib.Vectors.VectorSpec.html">VectorSpec</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.Wellfounded"><summary>Wellfounded</summary>
          <ul>
          <li><a href="Stdlib.Wellfounded.Disjoint_Union.html">Disjoint_Union</a></li>
<li><a href="Stdlib.Wellfounded.Inclusion.html">Inclusion</a></li>
<li><a href="Stdlib.Wellfounded.Inverse_Image.html">Inverse_Image</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Exponentiation.html">Lexicographic_Exponentiation</a></li>
<li><a href="Stdlib.Wellfounded.Lexicographic_Product.html">Lexicographic_Product</a></li>
<li><a href="Stdlib.Wellfounded.List_Extension.html">List_Extension</a></li>
<li><a href="Stdlib.Wellfounded.Transitive_Closure.html">Transitive_Closure</a></li>
<li><a href="Stdlib.Wellfounded.Union.html">Union</a></li>
<li><a href="Stdlib.Wellfounded.Well_Ordering.html">Well_Ordering</a></li>
<li><a href="Stdlib.Wellfounded.Wellfounded.html">Wellfounded</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ZArith"><summary>ZArith</summary>
          <ul>
          <li><a href="Stdlib.ZArith.BinInt.html">BinInt</a></li>
<li><a href="Stdlib.ZArith.BinIntDef.html">BinIntDef</a></li>
<li><a href="Stdlib.ZArith.Int.html">Int</a></li>
<li><a href="Stdlib.ZArith.Wf_Z.html">Wf_Z</a></li>
<li><a href="Stdlib.ZArith.ZArith.html">ZArith</a></li>
<li><a href="Stdlib.ZArith.ZArith_base.html">ZArith_base</a></li>
<li><a href="Stdlib.ZArith.ZArith_dec.html">ZArith_dec</a></li>
<li><a href="Stdlib.ZArith.Zabs.html">Zabs</a></li>
<li><a href="Stdlib.ZArith.Zbitwise.html">Zbitwise</a></li>
<li><a href="Stdlib.ZArith.Zbool.html">Zbool</a></li>
<li><a href="Stdlib.ZArith.Zcompare.html">Zcompare</a></li>
<li><a href="Stdlib.ZArith.Zcomplements.html">Zcomplements</a></li>
<li><a href="Stdlib.ZArith.Zdiv.html">Zdiv</a></li>
<li><a href="Stdlib.ZArith.Zdiv_facts.html">Zdiv_facts</a></li>
<li><a href="Stdlib.ZArith.Zeuclid.html">Zeuclid</a></li>
<li><a href="Stdlib.ZArith.Zeven.html">Zeven</a></li>
<li><a href="Stdlib.ZArith.Zgcd_alt.html">Zgcd_alt</a></li>
<li><a href="Stdlib.ZArith.Zhints.html">Zhints</a></li>
<li><a href="Stdlib.ZArith.Zmax.html">Zmax</a></li>
<li><a href="Stdlib.ZArith.Zmin.html">Zmin</a></li>
<li><a href="Stdlib.ZArith.Zminmax.html">Zminmax</a></li>
<li><a href="Stdlib.ZArith.Zmisc.html">Zmisc</a></li>
<li><a href="Stdlib.ZArith.Znat.html">Znat</a></li>
<li><a href="Stdlib.ZArith.Znumtheory.html">Znumtheory</a></li>
<li><a href="Stdlib.ZArith.Zorder.html">Zorder</a></li>
<li><a href="Stdlib.ZArith.Zpow_alt.html">Zpow_alt</a></li>
<li><a href="Stdlib.ZArith.Zpow_def.html">Zpow_def</a></li>
<li><a href="Stdlib.ZArith.Zpow_facts.html">Zpow_facts</a></li>
<li><a href="Stdlib.ZArith.Zpower.html">Zpower</a></li>
<li><a href="Stdlib.ZArith.Zquot.html">Zquot</a></li>
<li><a href="Stdlib.ZArith.Zwf.html">Zwf</a></li>
<li><a href="Stdlib.ZArith.auxiliary.html">auxiliary</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.btauto"><summary>btauto</summary>
          <ul>
          <li><a href="Stdlib.btauto.Algebra.html">Algebra</a></li>
<li><a href="Stdlib.btauto.Btauto.html">Btauto</a></li>
<li><a href="Stdlib.btauto.Reflect.html">Reflect</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.derive"><summary>derive</summary>
          <ul>
          <li><a href="Stdlib.derive.Derive.html">Derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.extraction"><summary>extraction</summary>
          <ul>
          <li><a href="Stdlib.extraction.ExtrHaskellBasic.html">ExtrHaskellBasic</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInt.html">ExtrHaskellNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatInteger.html">ExtrHaskellNatInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellNatNum.html">ExtrHaskellNatNum</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellString.html">ExtrHaskellString</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInt.html">ExtrHaskellZInt</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZInteger.html">ExtrHaskellZInteger</a></li>
<li><a href="Stdlib.extraction.ExtrHaskellZNum.html">ExtrHaskellZNum</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlFloats.html">ExtrOCamlFloats</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlInt63.html">ExtrOCamlInt63</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPArray.html">ExtrOCamlPArray</a></li>
<li><a href="Stdlib.extraction.ExtrOCamlPString.html">ExtrOCamlPString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlBasic.html">ExtrOcamlBasic</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlChar.html">ExtrOcamlChar</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlIntConv.html">ExtrOcamlIntConv</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatBigInt.html">ExtrOcamlNatBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNatInt.html">ExtrOcamlNatInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlNativeString.html">ExtrOcamlNativeString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlString.html">ExtrOcamlString</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZBigInt.html">ExtrOcamlZBigInt</a></li>
<li><a href="Stdlib.extraction.ExtrOcamlZInt.html">ExtrOcamlZInt</a></li>
<li><a href="Stdlib.extraction.Extraction.html">Extraction</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.funind"><summary>funind</summary>
          <ul>
          <li><a href="Stdlib.funind.FunInd.html">FunInd</a></li>
<li><a href="Stdlib.funind.Recdef.html">Recdef</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.micromega"><summary>micromega</summary>
          <ul>
          <li><a href="Stdlib.micromega.DeclConstant.html">DeclConstant</a></li>
<li><a href="Stdlib.micromega.DeclConstantZ.html">DeclConstantZ</a></li>
<li><a href="Stdlib.micromega.Env.html">Env</a></li>
<li><a href="Stdlib.micromega.EnvRing.html">EnvRing</a></li>
<li><a href="Stdlib.micromega.Fourier.html">Fourier</a></li>
<li><a href="Stdlib.micromega.Fourier_util.html">Fourier_util</a></li>
<li><a href="Stdlib.micromega.Lia.html">Lia</a></li>
<li><a href="Stdlib.micromega.Lqa.html">Lqa</a></li>
<li><a href="Stdlib.micromega.Lra.html">Lra</a></li>
<li><a href="Stdlib.micromega.OrderedRing.html">OrderedRing</a></li>
<li><a href="Stdlib.micromega.Psatz.html">Psatz</a></li>
<li><a href="Stdlib.micromega.QMicromega.html">QMicromega</a></li>
<li><a href="Stdlib.micromega.RMicromega.html">RMicromega</a></li>
<li><a href="Stdlib.micromega.Refl.html">Refl</a></li>
<li><a href="Stdlib.micromega.RingMicromega.html">RingMicromega</a></li>
<li><a href="Stdlib.micromega.Tauto.html">Tauto</a></li>
<li><a href="Stdlib.micromega.VarMap.html">VarMap</a></li>
<li><a href="Stdlib.micromega.ZArith_hints.html">ZArith_hints</a></li>
<li><a href="Stdlib.micromega.ZCoeff.html">ZCoeff</a></li>
<li><a href="Stdlib.micromega.ZMicromega.html">ZMicromega</a></li>
<li><a href="Stdlib.micromega.Zify.html">Zify</a></li>
<li><a href="Stdlib.micromega.ZifyBool.html">ZifyBool</a></li>
<li><a href="Stdlib.micromega.ZifyClasses.html">ZifyClasses</a></li>
<li><a href="Stdlib.micromega.ZifyComparison.html">ZifyComparison</a></li>
<li><a href="Stdlib.micromega.ZifyInst.html">ZifyInst</a></li>
<li><a href="Stdlib.micromega.ZifyN.html">ZifyN</a></li>
<li><a href="Stdlib.micromega.ZifyNat.html">ZifyNat</a></li>
<li><a href="Stdlib.micromega.ZifyPow.html">ZifyPow</a></li>
<li><a href="Stdlib.micromega.ZifySint63.html">ZifySint63</a></li>
<li><a href="Stdlib.micromega.ZifyUint63.html">ZifyUint63</a></li>
<li><a href="Stdlib.micromega.Ztac.html">Ztac</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.nsatz"><summary>nsatz</summary>
          <ul>
          <li><a href="Stdlib.nsatz.NsatzTactic.html">NsatzTactic</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.omega"><summary>omega</summary>
          <ul>
          <li><a href="Stdlib.omega.OmegaLemmas.html">OmegaLemmas</a></li>
<li><a href="Stdlib.omega.PreOmega.html">PreOmega</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.rtauto"><summary>rtauto</summary>
          <ul>
          <li><a href="Stdlib.rtauto.Bintree.html">Bintree</a></li>
<li><a href="Stdlib.rtauto.Rtauto.html">Rtauto</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.setoid_ring"><summary>setoid_ring</summary>
          <ul>
          <li><a href="Stdlib.setoid_ring.Algebra_syntax.html">Algebra_syntax</a></li>
<li><a href="Stdlib.setoid_ring.ArithRing.html">ArithRing</a></li>
<li><a href="Stdlib.setoid_ring.BinList.html">BinList</a></li>
<li><a href="Stdlib.setoid_ring.Cring.html">Cring</a></li>
<li><a href="Stdlib.setoid_ring.Field.html">Field</a></li>
<li><a href="Stdlib.setoid_ring.Field_tac.html">Field_tac</a></li>
<li><a href="Stdlib.setoid_ring.Field_theory.html">Field_theory</a></li>
<li><a href="Stdlib.setoid_ring.InitialRing.html">InitialRing</a></li>
<li><a href="Stdlib.setoid_ring.Integral_domain.html">Integral_domain</a></li>
<li><a href="Stdlib.setoid_ring.NArithRing.html">NArithRing</a></li>
<li><a href="Stdlib.setoid_ring.Ncring.html">Ncring</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_initial.html">Ncring_initial</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_polynom.html">Ncring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ncring_tac.html">Ncring_tac</a></li>
<li><a href="Stdlib.setoid_ring.RealField.html">RealField</a></li>
<li><a href="Stdlib.setoid_ring.Ring.html">Ring</a></li>
<li><a href="Stdlib.setoid_ring.Ring_base.html">Ring_base</a></li>
<li><a href="Stdlib.setoid_ring.Ring_polynom.html">Ring_polynom</a></li>
<li><a href="Stdlib.setoid_ring.Ring_tac.html">Ring_tac</a></li>
<li><a href="Stdlib.setoid_ring.Ring_theory.html">Ring_theory</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Q.html">Rings_Q</a></li>
<li><a href="Stdlib.setoid_ring.Rings_R.html">Rings_R</a></li>
<li><a href="Stdlib.setoid_ring.Rings_Z.html">Rings_Z</a></li>
<li><a href="Stdlib.setoid_ring.ZArithRing.html">ZArithRing</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssr"><summary>ssr</summary>
          <ul>
          <li><a href="Stdlib.ssr.ssrbool.html">ssrbool</a></li>
<li><a href="Stdlib.ssr.ssrclasses.html">ssrclasses</a></li>
<li><a href="Stdlib.ssr.ssreflect.html">ssreflect</a></li>
<li><a href="Stdlib.ssr.ssrfun.html">ssrfun</a></li>
<li><a href="Stdlib.ssr.ssrsetoid.html">ssrsetoid</a></li>
<li><a href="Stdlib.ssr.ssrunder.html">ssrunder</a></li>
          </ul>
          </details>
          </li>
<li><details id="Stdlib.ssrmatching"><summary>ssrmatching</summary>
          <ul>
          <li><a href="Stdlib.ssrmatching.ssrmatching.html">ssrmatching</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi"><summary>elpi</summary>
          <ul>
          <li><details id="elpi.apps"><summary>apps</summary>
          <ul>
          <li><details id="elpi.apps.NES"><summary>NES</summary>
          <ul>
          <li><details id="elpi.apps.NES.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.NES.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.NES.NES.html">NES</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.coercion"><summary>coercion</summary>
          <ul>
          <li><a href="elpi.apps.coercion.coercion.html">coercion</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.cs"><summary>cs</summary>
          <ul>
          <li><a href="elpi.apps.cs.cs.html">cs</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive"><summary>derive</summary>
          <ul>
          <li><details id="elpi.apps.derive.derive"><summary>derive</summary>
          <ul>
          <li><a href="elpi.apps.derive.derive.EqdepFacts.html">EqdepFacts</a></li>
<li><a href="elpi.apps.derive.derive.bcongr.html">bcongr</a></li>
<li><a href="elpi.apps.derive.derive.cast.html">cast</a></li>
<li><a href="elpi.apps.derive.derive.eq.html">eq</a></li>
<li><a href="elpi.apps.derive.derive.eqK.html">eqK</a></li>
<li><a href="elpi.apps.derive.derive.eqOK.html">eqOK</a></li>
<li><a href="elpi.apps.derive.derive.eqType_ast.html">eqType_ast</a></li>
<li><a href="elpi.apps.derive.derive.eqb.html">eqb</a></li>
<li><a href="elpi.apps.derive.derive.eqbOK.html">eqbOK</a></li>
<li><a href="elpi.apps.derive.derive.eqb_core_defs.html">eqb_core_defs</a></li>
<li><a href="elpi.apps.derive.derive.eqbcorrect.html">eqbcorrect</a></li>
<li><a href="elpi.apps.derive.derive.eqcorrect.html">eqcorrect</a></li>
<li><a href="elpi.apps.derive.derive.experimental.html">experimental</a></li>
<li><a href="elpi.apps.derive.derive.fields.html">fields</a></li>
<li><a href="elpi.apps.derive.derive.idx2inv.html">idx2inv</a></li>
<li><a href="elpi.apps.derive.derive.induction.html">induction</a></li>
<li><a href="elpi.apps.derive.derive.invert.html">invert</a></li>
<li><a href="elpi.apps.derive.derive.isK.html">isK</a></li>
<li><a href="elpi.apps.derive.derive.legacy.html">legacy</a></li>
<li><a href="elpi.apps.derive.derive.lens.html">lens</a></li>
<li><a href="elpi.apps.derive.derive.lens_laws.html">lens_laws</a></li>
<li><a href="elpi.apps.derive.derive.map.html">map</a></li>
<li><a href="elpi.apps.derive.derive.param1.html">param1</a></li>
<li><a href="elpi.apps.derive.derive.param1_congr.html">param1_congr</a></li>
<li><a href="elpi.apps.derive.derive.param1_functor.html">param1_functor</a></li>
<li><a href="elpi.apps.derive.derive.param1_trivial.html">param1_trivial</a></li>
<li><a href="elpi.apps.derive.derive.param2.html">param2</a></li>
<li><a href="elpi.apps.derive.derive.projK.html">projK</a></li>
<li><a href="elpi.apps.derive.derive.std.html">std</a></li>
<li><a href="elpi.apps.derive.derive.tag.html">tag</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.derive.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.derive.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.derive.derive.html">derive</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.eltac"><summary>eltac</summary>
          <ul>
          <li><a href="elpi.apps.eltac.apply.html">apply</a></li>
<li><a href="elpi.apps.eltac.assumption.html">assumption</a></li>
<li><a href="elpi.apps.eltac.case.html">case</a></li>
<li><a href="elpi.apps.eltac.clear.html">clear</a></li>
<li><a href="elpi.apps.eltac.constructor.html">constructor</a></li>
<li><a href="elpi.apps.eltac.cycle.html">cycle</a></li>
<li><a href="elpi.apps.eltac.discriminate.html">discriminate</a></li>
<li><a href="elpi.apps.eltac.fail.html">fail</a></li>
<li><a href="elpi.apps.eltac.generalize.html">generalize</a></li>
<li><a href="elpi.apps.eltac.injection.html">injection</a></li>
<li><a href="elpi.apps.eltac.intro.html">intro</a></li>
<li><a href="elpi.apps.eltac.rewrite.html">rewrite</a></li>
<li><a href="elpi.apps.eltac.tactics.html">tactics</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.locker"><summary>locker</summary>
          <ul>
          <li><details id="elpi.apps.locker.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.locker.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.locker.locker.html">locker</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.rbuild"><summary>rbuild</summary>
          <ul>
          <li><details id="elpi.apps.rbuild.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.rbuild.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.rbuild.rbuild.html">rbuild</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi.apps.tc"><summary>tc</summary>
          <ul>
          <li><details id="elpi.apps.tc.elpi"><summary>elpi</summary>
          <ul>
          <li><a href="elpi.apps.tc.elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.apps.tc.add_commands.html">add_commands</a></li>
<li><a href="elpi.apps.tc.db.html">db</a></li>
<li><a href="elpi.apps.tc.tc.html">tc</a></li>
<li><a href="elpi.apps.tc.wip.html">wip</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="elpi.core"><summary>core</summary>
          <ul>
          <li><a href="elpi.core.Bool.html">Bool</a></li>
<li><a href="elpi.core.ListDef.html">ListDef</a></li>
<li><a href="elpi.core.Morphisms.html">Morphisms</a></li>
<li><a href="elpi.core.PosDef.html">PosDef</a></li>
<li><a href="elpi.core.PrimFloat.html">PrimFloat</a></li>
<li><a href="elpi.core.PrimInt63.html">PrimInt63</a></li>
<li><a href="elpi.core.PrimString.html">PrimString</a></li>
<li><a href="elpi.core.PrimStringAxioms.html">PrimStringAxioms</a></li>
<li><a href="elpi.core.RelationClasses.html">RelationClasses</a></li>
<li><a href="elpi.core.Setoid.html">Setoid</a></li>
<li><a href="elpi.core.Uint63Axioms.html">Uint63Axioms</a></li>
<li><a href="elpi.core.ssrbool.html">ssrbool</a></li>
<li><a href="elpi.core.ssreflect.html">ssreflect</a></li>
<li><a href="elpi.core.ssrfun.html">ssrfun</a></li>
          </ul>
          </details>
          </li>
<li><a href="elpi.elpi.html">elpi</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_elpi"><summary>elpi_elpi</summary>
          <ul>
          <li><a href="elpi_elpi.dummy.html">dummy</a></li>
          </ul>
          </details>
          </li>
<li><details id="elpi_examples"><summary>elpi_examples</summary>
          <ul>
          <li><a href="elpi_examples.example_abs_evars.html">example_abs_evars</a></li>
<li><a href="elpi_examples.example_curry_howard_tactics.html">example_curry_howard_tactics</a></li>
<li><a href="elpi_examples.example_data_base.html">example_data_base</a></li>
<li><a href="elpi_examples.example_fuzzer.html">example_fuzzer</a></li>
<li><a href="elpi_examples.example_generalize.html">example_generalize</a></li>
<li><a href="elpi_examples.example_import_projections.html">example_import_projections</a></li>
<li><a href="elpi_examples.example_record_expansion.html">example_record_expansion</a></li>
<li><a href="elpi_examples.example_record_to_sigma.html">example_record_to_sigma</a></li>
<li><a href="elpi_examples.example_reduction_surgery.html">example_reduction_surgery</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_HOAS.html">tutorial_coq_elpi_HOAS</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_command.html">tutorial_coq_elpi_command</a></li>
<li><a href="elpi_examples.tutorial_coq_elpi_tactic.html">tutorial_coq_elpi_tactic</a></li>
<li><a href="elpi_examples.tutorial_elpi_lang.html">tutorial_elpi_lang</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp"><summary>mathcomp</summary>
          <ul>
          <li><details id="mathcomp.algebra"><summary>algebra</summary>
          <ul>
          <li><details id="mathcomp.algebra.num_theory"><summary>num_theory</summary>
          <ul>
          <li><a href="mathcomp.algebra.num_theory.numdomain.html">numdomain</a></li>
<li><a href="mathcomp.algebra.num_theory.numfield.html">numfield</a></li>
<li><a href="mathcomp.algebra.num_theory.orderedzmod.html">orderedzmod</a></li>
<li><a href="mathcomp.algebra.num_theory.ssrnum.html">ssrnum</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.algebra.all_algebra.html">all_algebra</a></li>
<li><a href="mathcomp.algebra.archimedean.html">archimedean</a></li>
<li><a href="mathcomp.algebra.countalg.html">countalg</a></li>
<li><a href="mathcomp.algebra.finalg.html">finalg</a></li>
<li><a href="mathcomp.algebra.fraction.html">fraction</a></li>
<li><a href="mathcomp.algebra.intdiv.html">intdiv</a></li>
<li><a href="mathcomp.algebra.interval.html">interval</a></li>
<li><a href="mathcomp.algebra.interval_inference.html">interval_inference</a></li>
<li><a href="mathcomp.algebra.matrix.html">matrix</a></li>
<li><a href="mathcomp.algebra.mxalgebra.html">mxalgebra</a></li>
<li><a href="mathcomp.algebra.mxpoly.html">mxpoly</a></li>
<li><a href="mathcomp.algebra.mxred.html">mxred</a></li>
<li><a href="mathcomp.algebra.poly.html">poly</a></li>
<li><a href="mathcomp.algebra.polyXY.html">polyXY</a></li>
<li><a href="mathcomp.algebra.polydiv.html">polydiv</a></li>
<li><a href="mathcomp.algebra.qpoly.html">qpoly</a></li>
<li><a href="mathcomp.algebra.rat.html">rat</a></li>
<li><a href="mathcomp.algebra.ring_quotient.html">ring_quotient</a></li>
<li><a href="mathcomp.algebra.sesquilinear.html">sesquilinear</a></li>
<li><a href="mathcomp.algebra.spectral.html">spectral</a></li>
<li><a href="mathcomp.algebra.ssralg.html">ssralg</a></li>
<li><a href="mathcomp.algebra.ssrint.html">ssrint</a></li>
<li><a href="mathcomp.algebra.vector.html">vector</a></li>
<li><a href="mathcomp.algebra.zmodp.html">zmodp</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis"><summary>analysis</summary>
          <ul>
          <li><details id="mathcomp.analysis.homotopy_theory"><summary>homotopy_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.homotopy_theory.continuous_path.html">continuous_path</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.homotopy.html">homotopy</a></li>
<li><a href="mathcomp.analysis.homotopy_theory.wedge_sigT.html">wedge_sigT</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.lebesgue_integral_theory"><summary>lebesgue_integral_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_Rintegral.html">lebesgue_Rintegral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integrable.html">lebesgue_integrable</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral.html">lebesgue_integral</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_definition.html">lebesgue_integral_definition</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_differentiation.html">lebesgue_integral_differentiation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_dominated_convergence.html">lebesgue_integral_dominated_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_fubini.html">lebesgue_integral_fubini</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_monotone_convergence.html">lebesgue_integral_monotone_convergence</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_nonneg.html">lebesgue_integral_nonneg</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.lebesgue_integral_under.html">lebesgue_integral_under</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.measurable_fun_approximation.html">measurable_fun_approximation</a></li>
<li><a href="mathcomp.analysis.lebesgue_integral_theory.simple_functions.html">simple_functions</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.measure_theory"><summary>measure_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.measure_theory.counting_measure.html">counting_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.dirac_measure.html">dirac_measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_function.html">measurable_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measurable_structure.html">measurable_structure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure.html">measure</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_extension.html">measure_extension</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_function.html">measure_function</a></li>
<li><a href="mathcomp.analysis.measure_theory.measure_negligible.html">measure_negligible</a></li>
<li><a href="mathcomp.analysis.measure_theory.probability_measure.html">probability_measure</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.normedtype_theory"><summary>normedtype_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.normedtype_theory.complete_normed_module.html">complete_normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.ereal_normedtype.html">ereal_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.matrix_normedtype.html">matrix_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normed_module.html">normed_module</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.normedtype.html">normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.num_normedtype.html">num_normedtype</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.pseudometric_normed_Zmodule.html">pseudometric_normed_Zmodule</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.urysohn.html">urysohn</a></li>
<li><a href="mathcomp.analysis.normedtype_theory.vitali_lemma.html">vitali_lemma</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis.showcase.pnt.html">pnt</a></li>
<li><a href="mathcomp.analysis.showcase.summability.html">summability</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis.topology_theory"><summary>topology_theory</summary>
          <ul>
          <li><a href="mathcomp.analysis.topology_theory.bool_topology.html">bool_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.compact.html">compact</a></li>
<li><a href="mathcomp.analysis.topology_theory.connected.html">connected</a></li>
<li><a href="mathcomp.analysis.topology_theory.discrete_topology.html">discrete_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.matrix_topology.html">matrix_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.nat_topology.html">nat_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.num_topology.html">num_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.one_point_compactification.html">one_point_compactification</a></li>
<li><a href="mathcomp.analysis.topology_theory.order_topology.html">order_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.product_topology.html">product_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.pseudometric_structure.html">pseudometric_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.quotient_topology.html">quotient_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.separation_axioms.html">separation_axioms</a></li>
<li><a href="mathcomp.analysis.topology_theory.sigT_topology.html">sigT_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subspace_topology.html">subspace_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.subtype_topology.html">subtype_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.supremum_topology.html">supremum_topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology.html">topology</a></li>
<li><a href="mathcomp.analysis.topology_theory.topology_structure.html">topology_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.uniform_structure.html">uniform_structure</a></li>
<li><a href="mathcomp.analysis.topology_theory.weak_topology.html">weak_topology</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis.all_analysis.html">all_analysis</a></li>
<li><a href="mathcomp.analysis.borel_hierarchy.html">borel_hierarchy</a></li>
<li><a href="mathcomp.analysis.cantor.html">cantor</a></li>
<li><a href="mathcomp.analysis.charge.html">charge</a></li>
<li><a href="mathcomp.analysis.convex.html">convex</a></li>
<li><a href="mathcomp.analysis.derive.html">derive</a></li>
<li><a href="mathcomp.analysis.ereal.html">ereal</a></li>
<li><a href="mathcomp.analysis.ess_sup_inf.html">ess_sup_inf</a></li>
<li><a href="mathcomp.analysis.esum.html">esum</a></li>
<li><a href="mathcomp.analysis.exp.html">exp</a></li>
<li><a href="mathcomp.analysis.ftc.html">ftc</a></li>
<li><a href="mathcomp.analysis.function_spaces.html">function_spaces</a></li>
<li><a href="mathcomp.analysis.gauss_integral.html">gauss_integral</a></li>
<li><a href="mathcomp.analysis.hoelder.html">hoelder</a></li>
<li><a href="mathcomp.analysis.kernel.html">kernel</a></li>
<li><a href="mathcomp.analysis.landau.html">landau</a></li>
<li><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></li>
<li><a href="mathcomp.analysis.lebesgue_stieltjes_measure.html">lebesgue_stieltjes_measure</a></li>
<li><a href="mathcomp.analysis.measurable_realfun.html">measurable_realfun</a></li>
<li><a href="mathcomp.analysis.numfun.html">numfun</a></li>
<li><a href="mathcomp.analysis.pi_irrational.html">pi_irrational</a></li>
<li><a href="mathcomp.analysis.probability.html">probability</a></li>
<li><a href="mathcomp.analysis.realfun.html">realfun</a></li>
<li><a href="mathcomp.analysis.sequences.html">sequences</a></li>
<li><a href="mathcomp.analysis.trigo.html">trigo</a></li>
<li><a href="mathcomp.analysis.tvs.html">tvs</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.analysis_stdlib"><summary>analysis_stdlib</summary>
          <ul>
          <li><details id="mathcomp.analysis_stdlib.showcase"><summary>showcase</summary>
          <ul>
          <li><a href="mathcomp.analysis_stdlib.showcase.uniform_bigO.html">uniform_bigO</a></li>
          </ul>
          </details>
          </li>
<li><a href="mathcomp.analysis_stdlib.Rstruct_topology.html">Rstruct_topology</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.bigenough"><summary>bigenough</summary>
          <ul>
          <li><a href="mathcomp.bigenough.bigenough.html">bigenough</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.boot"><summary>boot</summary>
          <ul>
          <li><a href="mathcomp.boot.all_boot.html">all_boot</a></li>
<li><a href="mathcomp.boot.bigop.html">bigop</a></li>
<li><a href="mathcomp.boot.binomial.html">binomial</a></li>
<li><a href="mathcomp.boot.choice.html">choice</a></li>
<li><a href="mathcomp.boot.div.html">div</a></li>
<li><a href="mathcomp.boot.eqtype.html">eqtype</a></li>
<li><a href="mathcomp.boot.finfun.html">finfun</a></li>
<li><a href="mathcomp.boot.fingraph.html">fingraph</a></li>
<li><a href="mathcomp.boot.finset.html">finset</a></li>
<li><a href="mathcomp.boot.fintype.html">fintype</a></li>
<li><a href="mathcomp.boot.generic_quotient.html">generic_quotient</a></li>
<li><a href="mathcomp.boot.monoid.html">monoid</a></li>
<li><a href="mathcomp.boot.nmodule.html">nmodule</a></li>
<li><a href="mathcomp.boot.path.html">path</a></li>
<li><a href="mathcomp.boot.prime.html">prime</a></li>
<li><a href="mathcomp.boot.seq.html">seq</a></li>
<li><a href="mathcomp.boot.ssrAC.html">ssrAC</a></li>
<li><a href="mathcomp.boot.ssrbool.html">ssrbool</a></li>
<li><a href="mathcomp.boot.ssreflect.html">ssreflect</a></li>
<li><a href="mathcomp.boot.ssrfun.html">ssrfun</a></li>
<li><a href="mathcomp.boot.ssrmatching.html">ssrmatching</a></li>
<li><a href="mathcomp.boot.ssrnat.html">ssrnat</a></li>
<li><a href="mathcomp.boot.ssrnotations.html">ssrnotations</a></li>
<li><a href="mathcomp.boot.tuple.html">tuple</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.classical"><summary>classical</summary>
          <ul>
          <li><a href="mathcomp.classical.all_classical.html">all_classical</a></li>
<li><a href="mathcomp.classical.boolp.html">boolp</a></li>
<li><a href="mathcomp.classical.cardinality.html">cardinality</a></li>
<li><a href="mathcomp.classical.classical_orders.html">classical_orders</a></li>
<li><a href="mathcomp.classical.classical_sets.html">classical_sets</a></li>
<li><a href="mathcomp.classical.contra.html">contra</a></li>
<li><a href="mathcomp.classical.filter.html">filter</a></li>
<li><a href="mathcomp.classical.fsbigop.html">fsbigop</a></li>
<li><a href="mathcomp.classical.functions.html">functions</a></li>
<li><a href="mathcomp.classical.internal_Eqdep_dec.html">internal_Eqdep_dec</a></li>
<li><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></li>
<li><a href="mathcomp.classical.set_interval.html">set_interval</a></li>
<li><a href="mathcomp.classical.unstable.html">unstable</a></li>
<li><a href="mathcomp.classical.wochoice.html">wochoice</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.experimental_reals"><summary>experimental_reals</summary>
          <ul>
          <li><a href="mathcomp.experimental_reals.discrete.html">discrete</a></li>
<li><a href="mathcomp.experimental_reals.distr.html">distr</a></li>
<li><a href="mathcomp.experimental_reals.realseq.html">realseq</a></li>
<li><a href="mathcomp.experimental_reals.realsum.html">realsum</a></li>
<li><a href="mathcomp.experimental_reals.xfinmap.html">xfinmap</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.field"><summary>field</summary>
          <ul>
          <li><a href="mathcomp.field.algC.html">algC</a></li>
<li><a href="mathcomp.field.algebraics_fundamentals.html">algebraics_fundamentals</a></li>
<li><a href="mathcomp.field.algnum.html">algnum</a></li>
<li><a href="mathcomp.field.all_field.html">all_field</a></li>
<li><a href="mathcomp.field.closed_field.html">closed_field</a></li>
<li><a href="mathcomp.field.cyclotomic.html">cyclotomic</a></li>
<li><a href="mathcomp.field.falgebra.html">falgebra</a></li>
<li><a href="mathcomp.field.fieldext.html">fieldext</a></li>
<li><a href="mathcomp.field.finfield.html">finfield</a></li>
<li><a href="mathcomp.field.galois.html">galois</a></li>
<li><a href="mathcomp.field.qfpoly.html">qfpoly</a></li>
<li><a href="mathcomp.field.separable.html">separable</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.fingroup"><summary>fingroup</summary>
          <ul>
          <li><a href="mathcomp.fingroup.action.html">action</a></li>
<li><a href="mathcomp.fingroup.all_fingroup.html">all_fingroup</a></li>
<li><a href="mathcomp.fingroup.automorphism.html">automorphism</a></li>
<li><a href="mathcomp.fingroup.fingroup.html">fingroup</a></li>
<li><a href="mathcomp.fingroup.gproduct.html">gproduct</a></li>
<li><a href="mathcomp.fingroup.morphism.html">morphism</a></li>
<li><a href="mathcomp.fingroup.perm.html">perm</a></li>
<li><a href="mathcomp.fingroup.presentation.html">presentation</a></li>
<li><a href="mathcomp.fingroup.quotient.html">quotient</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.finmap"><summary>finmap</summary>
          <ul>
          <li><a href="mathcomp.finmap.finmap.html">finmap</a></li>
<li><a href="mathcomp.finmap.multiset.html">multiset</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.order"><summary>order</summary>
          <ul>
          <li><a href="mathcomp.order.all_order.html">all_order</a></li>
<li><a href="mathcomp.order.order.html">order</a></li>
<li><a href="mathcomp.order.preorder.html">preorder</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals"><summary>reals</summary>
          <ul>
          <li><a href="mathcomp.reals.all_reals.html">all_reals</a></li>
<li><a href="mathcomp.reals.constructive_ereal.html">constructive_ereal</a></li>
<li><a href="mathcomp.reals.prodnormedzmodule.html">prodnormedzmodule</a></li>
<li><a href="mathcomp.reals.real_interval.html">real_interval</a></li>
<li><a href="mathcomp.reals.reals.html">reals</a></li>
<li><a href="mathcomp.reals.signed.html">signed</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.reals_stdlib"><summary>reals_stdlib</summary>
          <ul>
          <li><a href="mathcomp.reals_stdlib.Rstruct.html">Rstruct</a></li>
<li><a href="mathcomp.reals_stdlib.nsatz_realtype.html">nsatz_realtype</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.solvable"><summary>solvable</summary>
          <ul>
          <li><a href="mathcomp.solvable.abelian.html">abelian</a></li>
<li><a href="mathcomp.solvable.all_solvable.html">all_solvable</a></li>
<li><a href="mathcomp.solvable.alt.html">alt</a></li>
<li><a href="mathcomp.solvable.burnside_app.html">burnside_app</a></li>
<li><a href="mathcomp.solvable.center.html">center</a></li>
<li><a href="mathcomp.solvable.commutator.html">commutator</a></li>
<li><a href="mathcomp.solvable.cyclic.html">cyclic</a></li>
<li><a href="mathcomp.solvable.extraspecial.html">extraspecial</a></li>
<li><a href="mathcomp.solvable.extremal.html">extremal</a></li>
<li><a href="mathcomp.solvable.finmodule.html">finmodule</a></li>
<li><a href="mathcomp.solvable.frobenius.html">frobenius</a></li>
<li><a href="mathcomp.solvable.gfunctor.html">gfunctor</a></li>
<li><a href="mathcomp.solvable.gseries.html">gseries</a></li>
<li><a href="mathcomp.solvable.hall.html">hall</a></li>
<li><a href="mathcomp.solvable.jordanholder.html">jordanholder</a></li>
<li><a href="mathcomp.solvable.maximal.html">maximal</a></li>
<li><a href="mathcomp.solvable.nilpotent.html">nilpotent</a></li>
<li><a href="mathcomp.solvable.pgroup.html">pgroup</a></li>
<li><a href="mathcomp.solvable.primitive_action.html">primitive_action</a></li>
<li><a href="mathcomp.solvable.sylow.html">sylow</a></li>
          </ul>
          </details>
          </li>
<li><details id="mathcomp.ssreflect"><summary>ssreflect</summary>
          <ul>
          <li><a href="mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp._opam.lib.coq.user-contrib.mathcomp.algebra.mxalgebra</h1>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> ssreflect</span><span class="id"> ssrbool</span><span class="id"> ssrfun</span><span class="id"> eqtype</span><span class="id"> ssrnat</span><span class="id"> seq</span><span class="id"> choice</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> fintype</span><span class="id"> finfun</span><span class="id"> bigop</span><span class="id"> finset</span><span class="id"> fingroup</span><span class="id"> perm</span><span class="id"> order</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> div</span><span class="id"> prime</span><span class="id"> binomial</span><span class="id"> ssralg</span><span class="id"> finalg</span><span class="id"> zmodp</span><span class="id"> matrix</span>.<br/>
<br/>
<pre class="ssrdoc">
In this file we develop the rank and row space theory of matrices, based
on an extended Gaussian elimination procedure similar to LUP
decomposition. This provides us with a concrete but generic model of
finite dimensional vector spaces and F-algebras, in which vectors, linear
functions, families, bases, subspaces, ideals and subrings are all
represented using matrices. This model can be used as a foundation for
the usual theory of abstract linear algebra, but it can also be used to
develop directly substantial theories, such as the theory of finite group
linear representation.
  Here we define the following concepts and notations:
Gaussian_elimination A == a permuted triangular decomposition (L, U, r)
                  of A, with L a column permutation of a lower triangular
                  invertible matrix, U a row permutation of an upper
                  triangular invertible matrix, and r the rank of A, all
                  satisfying the identity L *m pid_mx r *m U = A.
       \rank A == the rank of A.
   row_free A &lt;=&gt; the rows of A are linearly free (i.e., the rank and
                  height of A are equal).
   row_full A &lt;=&gt; the row-space of A spans all row-vectors (i.e., the
                  rank and width of A are equal).
   col_ebase A == the extended column basis of A (the first matrix L
                  returned by Gaussian_elimination A).
   row_ebase A == the extended row base of A (the second matrix U
                  returned by Gaussian_elimination A).
    col_base A == a basis for the columns of A: a row-full matrix
                  consisting of the first \rank A columns of col_ebase A.
    row_base A == a basis for the rows of A: a row-free matrix consisting
                  of the first \rank A rows of row_ebase A.
      pinvmx A == a partial inverse for A in its row space (or on its
                  column space, equivalently). In particular, if u is a
                  row vector in the row_space of A, then u *m pinvmx A is
                  the row vector of the coefficients of a decomposition
                  of u as a sub of rows of A.
       kermx A == the row kernel of A : a square matrix whose row space
                  consists of all u such that u *m A = 0 (it consists of
                  the inverse of col_ebase A, with the top \rank A rows
                  zeroed out). Also, kermx A is a partial right inverse
                  to col_ebase A, in the row space annihilated by A.
     cokermx A == the cokernel of A : a square matrix whose column space
                  consists of all v such that A *m v = 0 (it consists of
                  the inverse of row_ebase A, with the leftmost \rank A
                  columns zeroed out).
  maxrankfun A == injective function f so that rowsub f A is a submatrix
                  of A with the same rank as A.
fullrankfun fA == injective function f so that rowsub f A is row full,
                  where fA is a proof of row_full A
eigenvalue g a &lt;=&gt; a is an eigenvalue of the square matrix g.
eigenspace g a == a square matrix whose row space is the eigenspace of
                  the eigenvalue a of g (or 0 if a is not an eigenvalue).
We use a different scope %MS for matrix row-space set-like operations; to
avoid confusion, this scope should not be opened globally. Note that the
the arguments of \rank _ and the operations below have default scope %MS.
   (A &lt;= B)%MS &lt;=&gt; the row-space of A is included in the row-space of B.
                  We test for this by testing if cokermx B annihilates A.
    (A &lt; B)%MS &lt;=&gt; the row-space of A is properly included in the
                  row-space of B.
 (A &lt;= B &lt;= C)%MS == (A &lt;= B)%MS &amp;&amp; (B &lt;= C)%MS, and similarly for
                  (A &lt; B &lt;= C)%MS, (A &lt; B &lt;= C)%MS and (A &lt; B &lt; C)%MS.
   (A == B)%MS == (A &lt;= B &lt;= A)%MS (A and B have the same row-space).
  (A :=: B)%MS == A and B behave identically wrt. \rank and &lt;=. This
                  triple rewrite rule is the Prop version of (A == B)%MS.
                  Note that :=: cannot be treated as a setoid-style
                  Equivalence because its arguments can have different
                  types: A and B need not have the same number of rows,
                  and often don't (e.g., in row_base A :=: A).
      &lt;&lt;A&gt;&gt;%MS == a square matrix with the same row-space as A; &lt;&lt;A&gt;&gt;%MS
                  is a canonical representation of the subspace generated
                  by A, viewed as a list of row-vectors: if (A == B)%MS,
                  then &lt;&lt;A&gt;&gt;%MS = &lt;&lt;B&gt;&gt;%MS.
    (A + B)%MS == a square matrix whose row-space is the sum of the
                  row-spaces of A and B; thus (A + B == col_mx A B)%MS.
 (\sum_i &lt;expr i&gt;)%MS == the "big" version of (_ + _)%MS; as the latter
                  has a canonical abelian monoid structure, most generic
                  bigop lemmas apply (the other bigop indexing notations
                  are also defined).
  (A :&amp;: B)%MS == a square matrix whose row-space is the intersection of
                  the row-spaces of A and B.
 (\bigcap_i &lt;expr i&gt;)%MS == the "big" version of (_ :&amp;: _)%MS, which also
                  has a canonical abelian monoid structure.
        A^C%MS == a square matrix whose row-space is a complement to the
                  the row-space of A (it consists of row_ebase A with the
                  top \rank A rows zeroed out).
  (A :\: B)%MS == a square matrix whose row-space is a complement of the
                  the row-space of (A :&amp;: B)%MS in the row-space of A.
                  We have (A :\: B := A :&amp;: (capmx_gen A B)^C)%MS, where
                  capmx_gen A B is a rectangular matrix equivalent to
                  (A :&amp;: B)%MS, i.e., (capmx_gen A B == A :&amp;: B)%MS.
   proj_mx A B == a square matrix that projects (A + B)%MS onto A
                  parallel to B, when (A :&amp;: B)%MS = 0 (A and B must also
                  be square).
    mxdirect S == the sum expression S is a direct sum. This is a NON
                  EXTENSIONAL notation: the exact boolean expression is
                  inferred from the syntactic form of S (expanding
                  definitions, however); both (\sum_(i | _) _)%MS and
                  (_ + _)%MS sums are recognized. This construct uses a
                  variant of the reflexive ("quote") canonical structure,
                  mxsum_expr. The structure also recognizes sums of
                  matrix ranks, so that lemmas concerning the rank of
                  direct sums can be used bidirectionally.
stablemx V f &lt;=&gt; the matrix f represents an endomorphism that preserves V
              := (V *m f &lt;= V)%MS
The next set of definitions let us represent F-algebras using matrices:
  'A[F]_(m, n) == the type of matrices encoding (sub)algebras of square
                  n x n matrices, via mxvec; as in the matrix type
                  notation, m and F can be omitted (m defaults to n ^ 2).
               := 'M[F]_(m, n ^ 2).
  (A \in R)%MS &lt;=&gt; the square matrix A belongs to the linear set of
                   matrices (most often, a sub-algebra) encoded by the
                   row space of R. This is simply notation, so all the
                   lemmas and rewrite rules for (_ &lt;= _)%MS can apply.
               := (mxvec A &lt;= R)%MS.
    (R * S)%MS == a square n^2 x n^2 matrix whose row-space encodes the
                  linear set of n x n matrices generated by the pointwise
                  product of the sets of matrices encoded by R and S.
      'C(R)%MS == a square matrix encoding the centraliser of the set of
                  square matrices encoded by R.
    'C_S(R)%MS := (S :&amp;: 'C(R))%MS (the centraliser of R in S).
      'Z(R)%MS == the center of R (i.e., 'C_R(R)%MS).
 left_mx_ideal R S &lt;=&gt; S is a left ideal for R (R * S &lt;= S)%MS.
right_mx_ideal R S &lt;=&gt; S is a right ideal for R (S * R &lt;= S)%MS.
      mx_ideal R S &lt;=&gt; S is a bilateral ideal for R.
     mxring_id R e &lt;-&gt; e is an identity element for R (Prop predicate).
   has_mxring_id R &lt;=&gt; R has a nonzero identity element (bool predicate).
          mxring R &lt;=&gt; R encodes a nontrivial subring.
</pre>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> group_scope</span>.<br/>
<span class="vernacular">Import</span><span class="id"> GRing</span>.<span class="id">Theory</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\rank A&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> A</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> format</span> <span class="id">&quot;\rank  A&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^C&quot;</span>    (<span class="id">format</span> <span class="id">&quot;A ^C&quot;</span>).<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''A_' ( m , n )&quot;</span><span class="id"> :=</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span><span class="id"> ^</span><span class="id"> 2</span>)<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">&quot;''A_' ( m ,  n )&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''A_' ( n )&quot;</span><span class="id"> :=</span><span class="id"> 'A_</span>(<span class="id">n</span><span class="id"> ^</span><span class="id"> 2,</span><span class="id"> n</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''A_' n&quot;</span><span class="id"> :=</span><span class="id"> 'A_</span>(<span class="id">n</span>) (<span class="id">n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 0,</span><span class="id"> format</span> <span class="id">&quot;''A_' n&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''A' [ F ]_ ( m , n )&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span><span class="id"> ^</span><span class="id"> 2</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''A' [ F ]_ ( n )&quot;</span><span class="id"> :=</span><span class="id"> 'A[F]_</span>(<span class="id">n</span><span class="id"> ^</span><span class="id"> 2,</span><span class="id"> n</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''A' [ F ]_ n&quot;</span><span class="id"> :=</span><span class="id"> 'A[F]_</span>(<span class="id">n</span>) (<span class="id">n</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Delimit</span><span class="vernacular"> Scope</span><span class="id"> matrix_set_scope</span><span class="gallina-kwd"> with</span><span class="id"> MS</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> simp</span><span class="id"> :=</span> (<span class="id">Monoid</span>.<span class="id">Theory</span>.<span class="id">simpm,</span><span class="id"> oppr0</span>).<br/>
<br/>
<pre class="ssrdoc">
(******************** Rank and row-space theory *****************************
</pre>
<br/>
<br/>
<span class="vernacular">Fixpoint</span><span class="id"> Gaussian_elimination_</span><span class="id"> {F</span><span class="id"> :</span><span class="id"> fieldType}</span><span class="id"> {m</span><span class="id"> n}</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="id"> 'M_m</span><span class="id"> *</span><span class="id"> 'M_n</span><span class="id"> *</span><span class="id"> nat</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> m,</span><span class="id"> n</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span>.<span class="id">+1,</span><span class="id"> _</span>.<span class="id">+1</span><span class="id"> =&gt;</span><span class="gallina-kwd"> fun</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> _,</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> _</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> [pick</span><span class="id"> ij</span><span class="id"> |</span><span class="id"> A</span><span class="id"> ij</span>.<span class="id">1</span><span class="id"> ij</span>.<span class="id">2</span><span class="id"> !=</span><span class="id"> 0]</span><span class="id"> is</span><span class="id"> Some</span> (<span class="id">i,</span><span class="id"> j</span>)<span class="gallina-kwd"> then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> A</span><span class="id"> i</span><span class="id"> j</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> A1</span><span class="id"> :=</span><span class="id"> xrow</span><span class="id"> i</span><span class="id"> 0</span> (<span class="id">xcol</span><span class="id"> j</span><span class="id"> 0</span><span class="id"> A</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> u</span><span class="id"> :=</span><span class="id"> ursubmx</span><span class="id"> A1</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> a^-1</span><span class="id"> *:</span><span class="id"> dlsubmx</span><span class="id"> A1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">L,</span><span class="id"> U,</span><span class="id"> r</span>)<span class="id"> :=</span><span class="id"> Gaussian_elimination_</span> (<span class="id">drsubmx</span><span class="id"> A1</span><span class="id"> -</span><span class="id"> v</span><span class="id"> *m</span><span class="id"> u</span>)<span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xrow</span><span class="id"> i</span><span class="id"> 0</span> (<span class="id">block_mx</span><span class="id"> 1</span><span class="id"> 0</span><span class="id"> v</span><span class="id"> L</span>)<span class="id">,</span><span class="id"> xcol</span><span class="id"> j</span><span class="id"> 0</span> (<span class="id">block_mx</span><span class="id"> a%:M</span><span class="id"> u</span><span class="id"> 0</span><span class="id"> U</span>)<span class="id">,</span><span class="id"> r</span>.<span class="id">+1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> (<span class="id">1%:M,</span><span class="id"> 1%:M,</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _,</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="gallina-kwd"> fun</span><span class="id"> _</span><span class="id"> =&gt;</span> (<span class="id">1%:M,</span><span class="id"> 1%:M,</span><span class="id"> 0</span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> Gaussian_elimination</span><span class="id"> :=</span><span class="id"> @Gaussian_elimination_</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> Gaussian_elimination_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> Gaussian_elimination</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> mxrank</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> fieldType</span>)<span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> [||</span><span class="id"> m</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> |</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> 0]%N</span><span class="gallina-kwd"> then</span><span class="id"> 0</span><span class="gallina-kwd"> else</span> (<span class="id">@Gaussian_elimination</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>).<span class="id">2</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> mxrank_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> mxrank</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RowSpaceTheoryDefs</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> r</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' ( m , n )&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' n&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">n,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> mxrank</span><span class="id"> :=</span> (<span class="id">@mxrank</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> LUr</span><span class="id"> :=</span><span class="id"> @Gaussian_elimination</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> col_ebase</span><span class="id"> :=</span><span class="id"> LUr</span>.<span class="id">1</span>.<span class="id">1</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> row_ebase</span><span class="id"> :=</span><span class="id"> LUr</span>.<span class="id">1</span>.<span class="id">2</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> row_free</span><span class="id"> :=</span><span class="id"> mxrank</span><span class="id"> ==</span><span class="id"> m</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> row_full</span><span class="id"> :=</span><span class="id"> mxrank</span><span class="id"> ==</span><span class="id"> n</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> row_base</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">mxrank,</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> pid_mx</span><span class="id"> mxrank</span><span class="id"> *m</span><span class="id"> row_ebase</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> col_base</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> mxrank</span>)<span class="id"> :=</span><span class="id"> col_ebase</span><span class="id"> *m</span><span class="id"> pid_mx</span><span class="id"> mxrank</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> complmx</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><span class="id"> copid_mx</span><span class="id"> mxrank</span><span class="id"> *m</span><span class="id"> row_ebase</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> kermx</span><span class="id"> :</span><span class="id"> 'M_m</span><span class="id"> :=</span><span class="id"> copid_mx</span><span class="id"> mxrank</span><span class="id"> *m</span><span class="id"> invmx</span><span class="id"> col_ebase</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> cokermx</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><span class="id"> invmx</span><span class="id"> row_ebase</span><span class="id"> *m</span><span class="id"> copid_mx</span><span class="id"> mxrank</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> pinvmx</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> m</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">invmx</span><span class="id"> row_ebase</span><span class="id"> *m</span><span class="id"> pid_mx</span><span class="id"> mxrank</span><span class="id"> *m</span><span class="id"> invmx</span><span class="id"> col_ebase</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> RowSpaceTheoryDefs</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><br/>
<span class="vernacular">Definition</span><span class="id"> submx</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> cokermx</span><span class="id"> B</span><span class="id"> ==</span><span class="id"> 0</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> submx_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> submx</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> mxrank</span><span class="id"> {F}</span><span class="id"> {m%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> complmx</span><span class="id"> {F}</span><span class="id"> {m%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> submx</span><span class="id"> {F}</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\rank A&quot;</span><span class="id"> :=</span> (<span class="id">mxrank</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> nat_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^C&quot;</span><span class="id"> :=</span> (<span class="id">complmx</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A &lt;= B&quot;</span><span class="id"> :=</span> (<span class="id">submx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A &lt;= B &lt;= C&quot;</span><span class="id"> :=</span> ((<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id"> &amp;&amp;</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>))<span class="id">%MS</span><span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A == B&quot;</span><span class="id"> :=</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ltmx</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span><span class="id"> ~~</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> ltmx</span><span class="id"> {F}</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A &lt; B&quot;</span><span class="id"> :=</span> (<span class="id">ltmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> eqmx</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">prod</span> (<span class="id">\rank</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m3</span> (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>))<span class="id"> *</span> ((<span class="id">C</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">C</span><span class="id"> &lt;=</span><span class="id"> B</span>)))<span class="id">%MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eqmx</span><span class="id"> {F}</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A :=: B&quot;</span><span class="id"> :=</span> (<span class="id">eqmx</span><span class="id"> A%MS</span><span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">V%MS</span><span class="id"> *m</span><span class="id"> f%R</span><span class="id"> &lt;=</span><span class="id"> V%MS</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> LtmxIdentities</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> r</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' ( m , n )&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' n&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">n,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmxE</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span> ((<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span><span class="id"> ~~</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmxW</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/andP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmxEneq</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span><span class="id"> ~~</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> andb_id2l</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxElt</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> ||</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -andb_orr</span><span class="id"> orbN</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> LtmxIdentities</span>.<br/>
<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> qidmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> m</span><span class="id"> ==</span><span class="id"> n</span><span class="gallina-kwd"> then</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> pid_mx</span><span class="id"> n</span><span class="gallina-kwd"> else</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> equivmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> idA</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">B</span><span class="id"> ==</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span> (<span class="id">qidmx</span><span class="id"> B</span><span class="id"> ==</span><span class="id"> idA</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> equivmx_spec</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> idA</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">prod</span> (<span class="id">B</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span> (<span class="id">qidmx</span><span class="id"> B</span><span class="id"> =</span><span class="id"> idA</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> genmx_witness</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> row_full</span><span class="id"> A</span><span class="gallina-kwd"> then</span><span class="id"> 1%:M</span><span class="gallina-kwd"> else</span><span class="id"> pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)<span class="id"> *m</span><span class="id"> row_ebase</span><span class="id"> A</span>.<br/>
<span class="id">HB</span>.<span class="id">lock</span><br/>
<span class="vernacular">Definition</span><span class="id"> genmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">choose</span> (<span class="id">equivmx</span><span class="id"> A</span> (<span class="id">row_full</span><span class="id"> A</span>)) (<span class="id">genmx_witness</span><span class="id"> A</span>).<br/>
<span class="vernacular">Canonical</span><span class="id"> genmx_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> genmx</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> genmx</span><span class="id"> {F}</span><span class="id"> {n</span><span class="id"> m}%_N</span><span class="id"> A%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;&lt;&lt; A &gt;&gt;&quot;</span><span class="id"> :=</span> (<span class="id">genmx</span><span class="id"> A%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> addsmx_nop</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">conform_mx</span><span class="id"> &lt;&lt;A&gt;&gt;%MS</span><span class="id"> A</span>.<br/>
<span class="id">HB</span>.<span class="id">lock</span><br/>
<span class="vernacular">Definition</span><span class="id"> addsmx</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> addsmx_nop</span><span class="id"> B</span><span class="gallina-kwd"> else</span><span class="gallina-kwd"> if</span><span class="id"> B</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> addsmx_nop</span><span class="id"> A</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;<span class="id">&lt;&lt;col_mx</span><span class="id"> A</span><span class="id"> B&gt;&gt;%MS</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> addsmx_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> addsmx</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> addsmx</span><span class="id"> {F}</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A + B&quot;</span><span class="id"> :=</span> (<span class="id">addsmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\sum_ ( i | P ) B&quot;</span><span class="id"> :=</span> (<span class="id">\big[addsmx/0]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span>)<span class="id"> B%MS</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r | P ) B&quot;</span><span class="id"> :=</span> (<span class="id">\big[addsmx/0]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span>)<span class="id"> B%MS</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> capmx_witness</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> row_full</span><span class="id"> A</span><span class="gallina-kwd"> then</span><span class="id"> conform_mx</span><span class="id"> 1%:M</span><span class="id"> A</span><span class="gallina-kwd"> else</span><span class="id"> &lt;&lt;A&gt;&gt;%MS</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> capmx_norm</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">choose</span> (<span class="id">equivmx</span><span class="id"> A</span> (<span class="id">qidmx</span><span class="id"> A</span>)) (<span class="id">capmx_witness</span><span class="id"> A</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Definition</span><span class="id"> capmx_nop</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">conform_mx</span> (<span class="id">capmx_norm</span><span class="id"> A</span>)<span class="id"> A</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> capmx_gen</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">lsubmx</span> (<span class="id">kermx</span> (<span class="id">col_mx</span><span class="id"> A</span><span class="id"> B</span>))<span class="id"> *m</span><span class="id"> A</span>.<br/>
<span class="id">HB</span>.<span class="id">lock</span><br/>
<span class="vernacular">Definition</span><span class="id"> capmx</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> qidmx</span><span class="id"> A</span><span class="gallina-kwd"> then</span><span class="id"> capmx_nop</span><span class="id"> B</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> qidmx</span><span class="id"> B</span><span class="gallina-kwd"> then</span><span class="id"> capmx_nop</span><span class="id"> A</span><span class="gallina-kwd"> else</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> row_full</span><span class="id"> B</span><span class="gallina-kwd"> then</span><span class="id"> capmx_norm</span><span class="id"> A</span><span class="gallina-kwd"> else</span><span class="id"> capmx_norm</span> (<span class="id">capmx_gen</span><span class="id"> A</span><span class="id"> B</span>).<br/>
<span class="vernacular">Canonical</span><span class="id"> capmx_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> capmx</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> capmx</span><span class="id"> {F}</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A :&amp;: B&quot;</span><span class="id"> :=</span> (<span class="id">capmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\bigcap_ ( i | P ) B&quot;</span><span class="id"> :=</span> (<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span>)<span class="id"> B</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><br/>
<span class="vernacular">Definition</span><span class="id"> diffmx</span><span class="id"> F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">&lt;&lt;capmx_gen</span><span class="id"> A</span> (<span class="id">capmx_gen</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">^C&gt;&gt;%MS</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> diffmx_unlockable</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> diffmx</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> diffmx</span><span class="id"> {F}</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A :\: B&quot;</span><span class="id"> :=</span> (<span class="id">diffmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RowSpaceTheory</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> r</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' ( m , n )&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''M_' n&quot;</span><span class="id"> :=</span><span class="id"> 'M[F]_</span>(<span class="id">n,</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> proj_mx</span><span class="id"> n</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> :=</span><span class="id"> pinvmx</span> (<span class="id">col_mx</span><span class="id"> U</span><span class="id"> V</span>)<span class="id"> *m</span><span class="id"> col_mx</span><span class="id"> U</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> GaussE</span><span class="id"> :=</span><span class="id"> Gaussian_elimination_</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> mxrankE</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">GaussE</span><span class="id"> A</span>).<span class="id">2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxrank</span>.<span class="id">unlock</span><span class="id"> unlock</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|m]</span><span class="id"> [|n]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_leq_row</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> m</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxrankE</span>.<br/>
<span class="id">elim:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> [|n]</span><span class="id"> //=</span><span class="id"> A;</span><span class="id"> case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]</span><span class="id"> _|]</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span> (_<span class="id"> -</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> B;</span><span class="id"> case:</span><span class="id"> GaussE</span> (<span class="id">IHm</span><span class="id"> _</span><span class="id"> B</span>)<span class="id"> =&gt;</span><span class="id"> [[L</span><span class="id"> U]</span><span class="id"> r]</span><span class="id"> /=</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_leq_rank</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row_free</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_free</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_row</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_leq_col</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxrankE</span>.<br/>
<span class="id">elim:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> [|n]</span><span class="id"> //=</span><span class="id"> A;</span><span class="id"> case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]</span><span class="id"> _|]</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span> (_<span class="id"> -</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> B;</span><span class="id"> case:</span><span class="id"> GaussE</span> (<span class="id">IHm</span><span class="id"> _</span><span class="id"> B</span>)<span class="id"> =&gt;</span><span class="id"> [[L</span><span class="id"> U]</span><span class="id"> r]</span><span class="id"> /=</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_leq_rank</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_full</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_col</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_row_full</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> row_full</span><span class="id"> A</span><span class="id"> =</span><span class="id"> row_full</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_full</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> unitmx1F</span><span class="id"> :=</span><span class="id"> @unitmx1</span><span class="id"> F</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> row_ebase_unit</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_ebase</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /row_ebase</span><span class="id"> unlock;</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> [|n]</span><span class="id"> //=</span><span class="id"> A</span>.<br/>
<span class="id">case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]</span><span class="id"> /=</span><span class="id"> nzAij</span><span class="id"> |</span><span class="id"> //=];</span><span class="id"> move:</span> (_<span class="id"> -</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> B</span>.<br/>
<span class="id">case:</span><span class="id"> GaussE</span> (<span class="id">IHm</span><span class="id"> _</span><span class="id"> B</span>)<span class="id"> =&gt;</span><span class="id"> [[L</span><span class="id"> U]</span><span class="id"> r]</span><span class="id"> /=</span><span class="id"> uU</span>.<br/>
<span class="id">rewrite</span><span class="id"> unitmxE</span><span class="id"> xcolE</span><span class="id"> det_mulmx</span> (<span class="id">@det_ublock</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id"> det_scalar1</span><span class="id"> !unitrM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> nzAij</span><span class="id"> -!unitmxE</span><span class="id"> uU</span><span class="id"> unitmx_perm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_ebase_unit</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> col_ebase</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /col_ebase</span><span class="id"> unlock;</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> [|n]</span><span class="id"> //=</span><span class="id"> A</span>.<br/>
<span class="id">case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]</span><span class="id"> _|]</span><span class="id"> //=;</span><span class="id"> move:</span> (_<span class="id"> -</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> B</span>.<br/>
<span class="id">case:</span><span class="id"> GaussE</span> (<span class="id">IHm</span><span class="id"> _</span><span class="id"> B</span>)<span class="id"> =&gt;</span><span class="id"> [[L</span><span class="id"> U]</span><span class="id"> r]</span><span class="id"> /=</span><span class="id"> uL</span>.<br/>
<span class="id">rewrite</span><span class="id"> unitmxE</span><span class="id"> xrowE</span><span class="id"> det_mulmx</span> (<span class="id">@det_lblock</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id"> det1</span><span class="id"> mul1r</span><span class="id"> unitrM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -unitmxE</span><span class="id"> unitmx_perm</span>.<br/>
Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> rank_leq_row</span><span class="id"> rank_leq_col</span><span class="id"> row_ebase_unit</span><span class="id"> col_ebase_unit</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_ebase</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">col_ebase</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)<span class="id"> *m</span><span class="id"> row_ebase</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxrankE</span><span class="id"> /col_ebase</span><span class="id"> /row_ebase</span><span class="id"> unlock</span>.<br/>
<span class="id">elim:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [n</span><span class="id"> A</span><span class="id"> |</span><span class="id"> m</span><span class="id"> IHm];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [A]flatmx0</span><span class="id"> [_</span><span class="id"> *m</span><span class="id"> _]flatmx0</span>.<br/>
<span class="id">case=&gt;</span><span class="id"> [A</span><span class="id"> |</span><span class="id"> n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> *m</span><span class="id"> _]thinmx0</span><span class="id"> [A]thinmx0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">add1n</span><span class="id"> m</span>)<span class="id"> -?</span>(<span class="id">add1n</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> A</span><span class="id"> /=</span>.<br/>
<span class="id">case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [[i0</span><span class="id"> j0]</span><span class="id"> |</span><span class="id"> A0]</span><span class="id"> /=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/matrixP=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> pid_mx_0</span><span class="id"> mulmx0</span><span class="id"> mul0mx</span><span class="id"> mxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/eqP:</span> (<span class="id">A0</span> (<span class="id">i,</span><span class="id"> j</span>)).<br/>
<span class="id">set</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> A</span><span class="id"> i0</span><span class="id"> j0</span><span class="id"> =&gt;</span><span class="id"> nz_a;</span><span class="id"> set</span><span class="id"> A1</span><span class="id"> :=</span><span class="id"> xrow</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>.<br/>
<span class="id">set</span><span class="id"> u</span><span class="id"> :=</span><span class="id"> ursubmx</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> *:</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> _</span><span class="id"> -</span><span class="id"> _</span>.<br/>
<span class="id">move:</span> (<span class="id">rank_leq_col</span><span class="id"> B</span>) (<span class="id">rank_leq_row</span><span class="id"> B</span>)<span class="id"> {IHm}</span>(<span class="id">IHm</span><span class="id"> n</span><span class="id"> B</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mxrankE</span>.<br/>
<span class="id">case:</span> (<span class="id">GaussE</span><span class="id"> B</span>)<span class="id"> =&gt;</span><span class="id"> [[L</span><span class="id"> U]</span><span class="id"> r]</span><span class="id"> /=</span><span class="id"> r_m</span><span class="id"> r_n</span><span class="id"> defB</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;:</span><span class="id"> pid_mx</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> =</span><span class="id"> block_mx</span><span class="id"> 1</span><span class="id"> 0</span><span class="id"> 0</span> (<span class="id">pid_mx</span><span class="id"> r</span>)<span class="id"> :&gt;</span><span class="id"> 'M[F]_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> m,</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> n</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">subnKC</span><span class="id"> r_m</span>)<span class="id"> -</span>(<span class="id">subnKC</span><span class="id"> r_n</span>)<span class="id"> pid_mx_block</span><span class="id"> -col_mx0</span><span class="id"> -row_mx0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> block_mxA</span><span class="id"> castmx_id</span><span class="id"> col_mx0</span><span class="id"> row_mx0</span><span class="id"> -scalar_mx_block</span><span class="id"> -pid_mx_block</span>.<br/>
<span class="id">rewrite</span><span class="id"> xcolE</span><span class="id"> xrowE</span><span class="id"> mulmxA</span><span class="id"> -xcolE</span><span class="id"> -!mulmxA</span>.<br/>
<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">addr0,</span><span class="id"> add0r,</span><span class="id"> mulmx0,</span><span class="id"> mul0mx,</span><span class="id"> mulmx_block,</span><span class="id"> mul1mx</span>)<span class="id"> mulmxA</span><span class="id"> defB</span>.<br/>
<span class="id">rewrite</span><span class="id"> addrC</span><span class="id"> subrK</span><span class="id"> mul_mx_scalar</span><span class="id"> scalerA</span><span class="id"> divff</span><span class="id"> //</span><span class="id"> scale1r</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;:</span><span class="id"> a%:M</span><span class="id"> =</span><span class="id"> ulsubmx</span><span class="id"> A1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> A1]mx11_scalar</span><span class="id"> !mxE</span><span class="id"> !lshift0</span><span class="id"> !tpermR</span>.<br/>
<span class="id">rewrite</span><span class="id"> submxK</span><span class="id"> /A1</span><span class="id"> xrowE</span><span class="id"> !xcolE</span><span class="id"> -!mulmxA</span><span class="id"> mulmxA</span><span class="id"> -!perm_mxM</span><span class="id"> !tperm2</span><span class="id"> !perm_mx1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmx1</span><span class="id"> mul1mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_base</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> col_base</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> row_base</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> -[col_base</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> _]mulmxA</span><span class="id"> pid_mx_id</span><span class="id"> ?mulmx_ebase</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx1_min_rank</span><span class="id"> r</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> M</span><span class="id"> N</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">M</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> N</span><span class="id"> =</span><span class="id"> 1%:M</span><span class="id"> :&gt;</span><span class="id"> 'M_r</span><span class="id"> -&gt;</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> A</span>)<span class="id"> mulmxA</span><span class="id"> -mulmxA;</span><span class="id"> move/mulmx1_min</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> mulmx1_min_rank</span><span class="id"> [r</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_max_rank</span><span class="id"> r</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> r</span>)) (<span class="id">N</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">r,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">M</span><span class="id"> *m</span><span class="id"> N</span>)<span class="id"> &lt;=</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> MN</span><span class="id"> :=</span><span class="id"> M</span><span class="id"> *m</span><span class="id"> N;</span><span class="id"> set</span><span class="id"> rMN</span><span class="id"> :=</span><span class="id"> \rank</span><span class="id"> _</span>.<br/>
<span class="id">pose</span><span class="id"> L</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">rMN,</span><span class="id"> m</span>)<span class="id"> :=</span><span class="id"> pid_mx</span><span class="id"> rMN</span><span class="id"> *m</span><span class="id"> invmx</span> (<span class="id">col_ebase</span><span class="id"> MN</span>).<br/>
<span class="id">pose</span><span class="id"> U</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> rMN</span>)<span class="id"> :=</span><span class="id"> invmx</span> (<span class="id">row_ebase</span><span class="id"> MN</span>)<span class="id"> *m</span><span class="id"> pid_mx</span><span class="id"> rMN</span>.<br/>
<span class="id">suffices:</span><span class="id"> L</span><span class="id"> *m</span><span class="id"> M</span><span class="id"> *m</span> (<span class="id">N</span><span class="id"> *m</span><span class="id"> U</span>)<span class="id"> =</span><span class="id"> 1%:M</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> mulmx1_min</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmxA</span><span class="id"> -</span>(<span class="id">mulmxA</span><span class="id"> L</span>)<span class="id"> -[M</span><span class="id"> *m</span><span class="id"> N]mulmx_ebase</span><span class="id"> -/MN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulmxA</span><span class="id"> mulmxKV</span><span class="id"> //</span><span class="id"> mulmxK</span><span class="id"> //</span><span class="id"> !pid_mx_id</span><span class="id"> /rMN</span><span class="id"> ?pid_mx_1</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> mulmx_max_rank</span><span class="id"> [r</span><span class="id"> m</span><span class="id"> n]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_tr</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> A^T</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> -{3}[A]trmxK</span><span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> A</span>)<span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> A^T</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !trmx_mul</span><span class="id"> !mulmx_max_rank</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_add</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%R</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> A</span>)<span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> B</span>)<span class="id"> -mul_row_col</span><span class="id"> mulmx_max_rank</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrankM_maxl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> A</span>)<span class="id"> -mulmxA</span><span class="id"> mulmx_max_rank</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrankM_maxr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mxrank_tr</span><span class="id"> -</span>(<span class="id">mxrank_tr</span><span class="id"> B</span>)<span class="id"> trmx_mul</span><span class="id"> mxrankM_maxl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_scale</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span>)<span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mul_scalar_mx</span><span class="id"> mxrankM_maxr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_scale_nz</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> \rank</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nza;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> -{3}[A]scale1r</span><span class="id"> -</span>(<span class="id">mulVf</span><span class="id"> nza</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scalerA</span><span class="id"> !mxrank_scale</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_opp</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span> (<span class="id">-</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -scaleN1r</span><span class="id"> mxrank_scale_nz</span><span class="id"> //</span><span class="id"> oppr_eq0</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> \rank</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 0%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -leqn0</span><span class="id"> -</span>(<span class="id">@mulmx0</span><span class="id"> _</span><span class="id"> m</span><span class="id"> 0</span><span class="id"> n</span><span class="id"> 0</span>)<span class="id"> mulmx_max_rank</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">\rank</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP/eqP=&gt;</span><span class="id"> [rA0</span><span class="id"> |</span><span class="id"> -&gt;{A}];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> mxrank0</span>.<br/>
<span class="id">move:</span> (<span class="id">col_base</span><span class="id"> A</span>) (<span class="id">row_base</span><span class="id"> A</span>) (<span class="id">mulmx_base</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> rA0</span><span class="id"> =&gt;</span><span class="id"> Ac</span><span class="id"> Ar</span><span class="id"> &lt;-</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [Ac]thinmx0</span><span class="id"> mul0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_coker</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> cokermx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1}[A]mulmx_ebase</span><span class="id"> -!mulmxA</span><span class="id"> mulKVmx</span><span class="id"> //</span><span class="id"> mul_pid_mx_copid</span><span class="id"> ?mulmx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxE</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> cokermx</span><span class="id"> B</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unlock</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxKpV</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> pinvmx</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> submxE</span><span class="id"> !mulmxA</span><span class="id"> mulmxBr</span><span class="id"> mulmx1</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> defA</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{4}[B]mulmx_ebase</span><span class="id"> -!mulmxA</span><span class="id"> mulKmx</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">mulmxA</span> (<span class="id">pid_mx</span><span class="id"> _</span>))<span class="id"> pid_mx_id</span><span class="id"> //</span><span class="id"> !mulmxA</span><span class="id"> -{}defA</span><span class="id"> mulmxKV</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxVp</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_free</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> pinvmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fA;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> *m</span><span class="id"> _]mulmx_ebase</span><span class="id"> !mulmxA</span><span class="id"> mulmxK</span><span class="id"> ?row_ebase_unit//</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> *m</span><span class="id"> _]mulmxA</span><span class="id"> mul_pid_mx</span><span class="id"> !minnn</span> (<span class="id">minn_idPr</span><span class="id"> _</span>)<span class="id"> ?rank_leq_col//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eqP</span><span class="id"> fA</span>)<span class="id"> pid_mx_1</span><span class="id"> mulmx1</span><span class="id"> mulmxV</span><span class="id"> ?col_ebase_unit</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxKp</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_free</span><span class="id"> B</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">cancel</span> ((<span class="id">@mulmx</span><span class="id"> _</span><span class="id"> p</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">^~</span><span class="id"> B</span>) (<span class="id">mulmx^~</span> (<span class="id">pinvmx</span><span class="id"> B</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> mulmxVp</span><span class="id"> ?mulmx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> D,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> D</span><span class="id"> *m</span><span class="id"> B</span>) (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [/mulmxKpV</span><span class="id"> |</span><span class="id"> [D</span><span class="id"> -&gt;]];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> pinvmx</span><span class="id"> B</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> submxE</span><span class="id"> -mulmxA</span><span class="id"> mulmx_coker</span><span class="id"> mulmx0</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> submxP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx_refl</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> submxE</span><span class="id"> mulmx_coker</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> submx_refl</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxMl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">D</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span> (<span class="id">D</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> submxE</span><span class="id"> -mulmxA</span><span class="id"> mulmx_coker</span><span class="id"> mulmx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxMr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/submxP=&gt;</span><span class="id"> D</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> submxMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_sub</span><span class="id"> m</span><span class="id"> n1</span><span class="id"> n2</span><span class="id"> p</span> (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n1</span>))<span class="id"> A</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n2,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> C</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/submxP=&gt;</span><span class="id"> D</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> submxMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx_trans</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/submxP=&gt;</span><span class="id"> D</span><span class="id"> -&gt;{A};</span><span class="id"> apply:</span><span class="id"> mulmx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmx_sub_trans</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/andP=&gt;</span><span class="id"> sAB</span><span class="id"> ltAB</span><span class="id"> sBC;</span><span class="id"> rewrite</span><span class="id"> ltmxE</span> (<span class="id">submx_trans</span><span class="id"> sAB</span>)<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra</span><span class="id"> ltAB;</span><span class="id"> apply:</span><span class="id"> submx_trans</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_ltmx_trans</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">B</span><span class="id"> &lt;</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sAB</span><span class="id"> /andP[sBC</span><span class="id"> ltBC];</span><span class="id"> rewrite</span><span class="id"> ltmxE</span> (<span class="id">submx_trans</span><span class="id"> sAB</span>)<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra</span><span class="id"> ltBC</span><span class="id"> =&gt;</span><span class="id"> sCA;</span><span class="id"> apply:</span><span class="id"> submx_trans</span><span class="id"> sAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmx_trans</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> transitive</span> (<span class="id">@ltmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A</span><span class="id"> B</span><span class="id"> C;</span><span class="id"> move/ltmxW;</span><span class="id"> apply:</span><span class="id"> sub_ltmx_trans</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmx_irrefl</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> irreflexive</span> (<span class="id">@ltmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> m</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> submx_refl</span><span class="id"> andbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub0mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> submxE</span><span class="id"> mul0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx0null</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)))<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/submxP=&gt;</span><span class="id"> D;</span><span class="id"> rewrite</span><span class="id"> mulmx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;=</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_n</span>))<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/idP/eqP=&gt;</span><span class="id"> [|-&gt;];</span><span class="id"> [apply:</span><span class="id"> submx0null</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> sub0mx]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> &lt;</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> sub0mx</span><span class="id"> submx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmx0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_n</span>))<span class="id">%MS</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> sub0mx</span><span class="id"> andbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx0P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> reflect</span> (<span class="id">A</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">A</span><span class="id"> ==</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_n</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> submx0</span><span class="id"> sub0mx</span><span class="id"> andbT;</span><span class="id"> apply:</span><span class="id"> eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_eq0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">B</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAB;</span><span class="id"> rewrite</span><span class="id"> -!submx0</span><span class="id"> eqAB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addmx_sub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> ((<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%R</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case/submxP=&gt;</span><span class="id"> A'</span><span class="id"> -&gt;;</span><span class="id"> case/submxP=&gt;</span><span class="id"> B'</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> -mulmxDl</span><span class="id"> submxMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowsub_sub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> 'I_m2</span><span class="id"> -&gt;</span><span class="id"> 'I_m1</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rowsubE</span><span class="id"> mulmx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summx_sub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">I</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">A_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> ((<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span>)<span class="id">%R</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> leAB;</span><span class="id"> elim/big_ind:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [|C</span><span class="id"> D];</span><span class="id"> [apply/sub0mx</span><span class="id"> |</span><span class="id"> apply/addmx_sub]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalemx_sub</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/submxP=&gt;</span><span class="id"> A'</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> scalemxAl</span><span class="id"> submxMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_sub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> rowsub_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_row_sub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> v</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> i</span><span class="id"> :</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> =</span><span class="id"> v</span><span class="id"> -&gt;</span> (<span class="id">v</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> row_sub</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> eq_row_sub</span><span class="id"> [m</span><span class="id"> n</span><span class="id"> v</span><span class="id"> A]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nz_row_sub</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">nz_row</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /nz_row;</span><span class="id"> case:</span><span class="id"> pickP</span><span class="id"> =&gt;</span><span class="id"> [i|]</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?row_sub</span><span class="id"> ?sub0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_subP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [sAB</span><span class="id"> i|sAB]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> submx_trans</span><span class="id"> sAB;</span><span class="id"> apply:</span><span class="id"> row_sub</span>.<br/>
<span class="id">rewrite</span><span class="id"> submxE;</span><span class="id"> apply/eqP/row_matrixP=&gt;</span><span class="id"> i;</span><span class="id"> apply/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> row_mul</span><span class="id"> row0</span><span class="id"> -submxE</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> row_subP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rV_subP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV_n,</span><span class="id"> v</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> v</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [sAB</span><span class="id"> v</span><span class="id"> Av</span><span class="id"> |</span><span class="id"> sAB];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> submx_trans</span><span class="id"> sAB</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/row_subP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> sAB</span><span class="id"> ?row_sub</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> rV_subP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_subPn</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> i,</span><span class="id"> ~~</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>) (<span class="id">~~</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">sameP</span><span class="id"> row_subP</span><span class="id"> forallP</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> forallPn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_rVP</span><span class="id"> n</span> (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV[F]_n</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> a,</span><span class="id"> u</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span>) (<span class="id">u</span><span class="id"> &lt;=</span><span class="id"> v</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> submxP</span>)<span class="id"> =&gt;</span><span class="id"> [[w</span><span class="id"> -&gt;]</span><span class="id"> |</span><span class="id"> [a</span><span class="id"> -&gt;]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">w</span><span class="id"> 0</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -mul_scalar_mx</span><span class="id"> -mx11_scalar</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> a%:M;</span><span class="id"> rewrite</span><span class="id"> mul_scalar_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_rV</span><span class="id"> n</span> (<span class="id">v</span><span class="id"> :</span><span class="id"> 'rV[F]_n</span>)<span class="id"> :</span><span class="id"> \rank</span><span class="id"> v</span><span class="id"> =</span> (<span class="id">v</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> nz_v];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxrank0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_row</span><span class="id"> lt0n</span><span class="id"> mxrank_eq0;</span><span class="id"> apply/eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowV0Pn</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV_n,</span><span class="id"> v</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> &amp;</span><span class="id"> v</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -submx0;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> [v</span><span class="id"> svA]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -submx0;</span><span class="id"> apply:</span><span class="id"> contra</span> (<span class="id">submx_trans</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> case/row_subPn=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> submx0;</span><span class="gallina-kwd"> exists</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?row_sub</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowV0P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV_n,</span><span class="id"> v</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[A</span><span class="id"> ==</span><span class="id"> 0]negbK;</span><span class="id"> case:</span><span class="id"> rowV0Pn</span><span class="id"> =&gt;</span><span class="id"> IH</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> right;</span><span class="id"> case:</span><span class="id"> IH</span><span class="id"> =&gt;</span><span class="id"> v</span><span class="id"> svA</span><span class="id"> nzv</span><span class="id"> IH;</span><span class="id"> case/eqP:</span><span class="id"> nzv;</span><span class="id"> apply:</span><span class="id"> IH</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> left=&gt;</span><span class="id"> v</span><span class="id"> svA;</span><span class="id"> apply/eqP/idPn=&gt;</span><span class="id"> nzv;</span><span class="id"> case:</span><span class="id"> IH;</span><span class="gallina-kwd"> exists</span><span class="id"> v</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx_full</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_full</span><span class="id"> B</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> submxE</span><span class="id"> /cokermx</span><span class="id"> =&gt;</span><span class="id"> /eqnP-&gt;;</span><span class="id"> rewrite</span><span class="id"> /copid_mx</span><span class="id"> pid_mx_1</span><span class="id"> subrr</span><span class="id"> !mulmx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_fullP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> B,</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1%:M</span>) (<span class="id">row_full</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [Afull</span><span class="id"> |</span><span class="id"> [B</span><span class="id"> kA]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">1%:M</span><span class="id"> *m</span><span class="id"> pinvmx</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> mulmxKpV</span> (<span class="id">submx_full</span><span class="id"> _</span><span class="id"> Afull</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> A]eqn_leq</span><span class="id"> rank_leq_col</span> (<span class="id">mulmx1_min_rank</span><span class="id"> B</span><span class="id"> 1%:M</span>)<span class="id"> ?mulmx1</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> row_fullP</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_full_inj</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> A</span><span class="id"> :</span><span class="id"> row_full</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id">@mulmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/row_fullP=&gt;</span><span class="id"> A'</span><span class="id"> A'K;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">mulmx</span><span class="id"> A'</span>)<span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> B</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> A'K</span><span class="id"> mul1mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_freeP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> B,</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 1%:M</span>) (<span class="id">row_free</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /row_free</span><span class="id"> -mxrank_tr</span>.<br/>
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> row_fullP</span>)<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [B</span><span class="id"> kA];</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> B^T;</span><span class="id"> rewrite</span><span class="id"> -trmx1</span><span class="id"> -kA</span><span class="id"> trmx_mul</span><span class="id"> ?trmxK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_free_inj</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> A</span><span class="id"> :</span><span class="id"> row_free</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> injective</span> ((<span class="id">@mulmx</span><span class="id"> F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span>)<span class="id">^~</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/row_freeP=&gt;</span><span class="id"> A'</span><span class="id"> AK;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">mulmx^~</span><span class="id"> A'</span>)<span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> B</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> AK</span><span class="id"> mulmx1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> row_free_injr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> A</span><span class="id"> :</span><span class="id"> row_free</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> injective</span> (<span class="id">mulmxr</span><span class="id"> A</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">@row_free_inj</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> A</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_free_unit</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> row_free</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/row_fullP/idP=&gt;</span><span class="id"> [[A']</span><span class="id"> |</span><span class="id"> uA];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case/mulmx1_unit</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">invmx</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulVmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_full_unit</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> row_full</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> unitmx</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> row_free_unit</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_unit</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> =</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -row_full_unit</span><span class="id"> =&gt;</span><span class="id"> /eqnP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> \rank</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> =</span><span class="id"> n</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> mxrank_unit</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_delta</span><span class="id"> m</span><span class="id"> n</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> \rank</span> (<span class="id">delta_mx</span><span class="id"> i</span><span class="id"> j</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> lt0n</span><span class="id"> mxrank_eq0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}</span>(<span class="id">mul_delta_mx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'I_1</span>))<span class="id"> mulmx_max_rank</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> move/matrixP;</span><span class="id"> move/</span>(_<span class="id"> i</span><span class="id"> j</span>)<span class="id">;</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !eqxx</span><span class="id"> oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrankS</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/submxP=&gt;</span><span class="id"> D</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> mxrankM_maxr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx1</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> 1%:M</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> submx_full</span><span class="id"> //</span><span class="id"> row_full_unit</span><span class="id"> unitmx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub1mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">1%:M</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/idP;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> submx_full</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/mxrankS;</span><span class="id"> rewrite</span><span class="id"> mxrank1</span><span class="id"> col_leq_rank</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmx1</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> 1%:M</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> sub1mx</span><span class="id"> submx1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt1mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">1%:M</span><span class="id"> &lt;</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> submx1</span><span class="id"> andbF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pinvmxE</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> -&gt;</span><span class="id"> pinvmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> invmx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> A_unit;</span><span class="id"> apply:</span> (<span class="id">@row_free_inj</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?row_free_unit//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[pinvmx</span><span class="id"> _]mul1mx</span><span class="id"> mulmxKpV</span><span class="id"> ?sub1mx</span><span class="id"> ?row_full_unit//</span><span class="id"> mulVmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulVpmx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_full</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> pinvmx</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fA;</span><span class="id"> rewrite</span><span class="id"> -[pinvmx</span><span class="id"> _]mul1mx</span><span class="id"> mulmxKpV//</span><span class="id"> sub1mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pinvmx_free</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_full</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> row_free</span> (<span class="id">pinvmx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /mulVpmx</span><span class="id"> pAA1;</span><span class="id"> apply/row_freeP;</span><span class="gallina-kwd"> exists</span><span class="id"> A</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pinvmx_full</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_free</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="id"> row_full</span> (<span class="id">pinvmx</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /mulmxVp</span><span class="id"> ApA1;</span><span class="id"> apply/row_fullP;</span><span class="gallina-kwd"> exists</span><span class="id"> A</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmxP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> andP</span>)<span class="id"> =&gt;</span><span class="id"> [[sAB</span><span class="id"> sBA]</span><span class="id"> |</span><span class="id"> eqAB];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !eqAB</span>.<br/>
<span class="id">split=&gt;</span><span class="id"> [|m3</span><span class="id"> C];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> !mxrankS</span>.<br/>
<span class="id">split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> apply/idP/idP;</span><span class="id"> apply:</span><span class="id"> submx_trans</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> sC;</span><span class="id"> apply:</span><span class="id"> submx_trans</span><span class="id"> sC</span><span class="id"> _</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> eqmxP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rV_eqP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> u</span><span class="id"> :</span><span class="id"> 'rV_n,</span> (<span class="id">u</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">u</span><span class="id"> &lt;=</span><span class="id"> B</span>))<span class="id">%MS</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [eqAB</span><span class="id"> u</span><span class="id"> |</span><span class="id"> eqAB];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">eqmxP</span><span class="id"> eqAB</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> apply/rV_subP=&gt;</span><span class="id"> u;</span><span class="id"> rewrite</span><span class="id"> eqAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxP</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> u</span><span class="id"> :</span><span class="id"> 'rV_m,</span><span class="id"> u</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> u</span><span class="id"> *m</span><span class="id"> B</span>) (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> eqP</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> //|eqAB]</span>.<br/>
<span class="id">apply:</span> (<span class="id">@row_full_inj</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 1%:M</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> row_full_unit</span><span class="id"> unitmx1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/row_matrixP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !row_mul</span><span class="id"> eqAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_refl</span><span class="id"> m1</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_sym</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">B</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAB;</span><span class="id"> split=&gt;</span><span class="id"> [|m3</span><span class="id"> C];</span><span class="id"> rewrite</span><span class="id"> !eqAB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_trans</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">B</span><span class="id"> :=:</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> :=:</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAB</span><span class="id"> eqBC;</span><span class="id"> split=&gt;</span><span class="id"> [|m4</span><span class="id"> D];</span><span class="id"> rewrite</span><span class="id"> !eqAB</span><span class="id"> !eqBC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_rank</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqmxP-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt_eqmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>)<span class="id">,</span> (((<span class="id">A</span><span class="id"> &lt;</span><span class="id"> C</span>)<span class="id"> =</span> (<span class="id">B</span><span class="id"> &lt;</span><span class="id"> C</span>))<span class="id">%MS</span><span class="id"> *</span> ((<span class="id">C</span><span class="id"> &lt;</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">C</span><span class="id"> &lt;</span><span class="id"> B</span>))<span class="id">%MS</span>)<span class="id">%type</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAB</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> !eqAB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmxMr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> :=:</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAB;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !submxMr</span><span class="id"> ?eqAB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmxMfull</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_full</span><span class="id"> A</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/row_fullP=&gt;</span><span class="id"> A'</span><span class="id"> A'A;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> submxMl</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/submxP;</span><span class="gallina-kwd"> exists</span><span class="id"> A';</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> A'A</span><span class="id"> mul1mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=:</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_n</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !sub0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_scale</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> *:</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nz_a;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> scalemx_sub</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1}[A]scale1r</span><span class="id"> -</span>(<span class="id">mulVf</span><span class="id"> nz_a</span>)<span class="id"> -scalerA</span><span class="id"> scalemx_sub</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_opp</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">-</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -scaleN1r;</span><span class="id"> apply:</span><span class="id"> eqmx_scale</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> oppr_eq0</span><span class="id"> oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submxMfree</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_free</span><span class="id"> C</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/row_freeP=&gt;</span><span class="id"> C'</span><span class="id"> C_C'_1;</span><span class="id"> apply/idP/idP=&gt;</span><span class="id"> sAB;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> submxMr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[A]mulmx1</span><span class="id"> -[B]mulmx1</span><span class="id"> -C_C'_1</span><span class="id"> !mulmxA</span><span class="id"> submxMr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmxMfree</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_free</span><span class="id"> C</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> :=:</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Cfree</span><span class="id"> eqAB;</span><span class="id"> apply/eqmxP;</span><span class="id"> move/eqmxP:</span><span class="id"> eqAB;</span><span class="id"> rewrite</span><span class="id"> !submxMfree</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrankMfree</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_free</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Bfree;</span><span class="id"> rewrite</span><span class="id"> -mxrank_tr</span><span class="id"> trmx_mul</span><span class="id"> eqmxMfull</span><span class="id"> /row_full</span><span class="id"> mxrank_tr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_row_base</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">row_base</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqmxP/andP;</span><span class="id"> split;</span><span class="id"> apply/submxP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)<span class="id"> *m</span><span class="id"> invmx</span> (<span class="id">col_ebase</span><span class="id"> A</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{8}[A]mulmx_ebase</span><span class="id"> !mulmxA</span><span class="id"> mulmxKV</span><span class="id"> //</span><span class="id"> pid_mx_id</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">col_ebase</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> -</span>(<span class="id">mulmxA</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">pid_mx</span><span class="id"> _</span>))<span class="id"> pid_mx_id</span><span class="id"> //</span><span class="id"> mulmx_ebase</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_base0</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span><span class="id"> row_base</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmx0P;</span><span class="id"> rewrite</span><span class="id"> !eq_row_base</span><span class="id"> !sub0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> qidmx_eq1</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> qidmx</span><span class="id"> A</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 1%:M</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /qidmx</span><span class="id"> eqxx</span><span class="id"> pid_mx_1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> genmx_witnessP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">equivmx</span><span class="id"> A</span> (<span class="id">row_full</span><span class="id"> A</span>) (<span class="id">genmx_witness</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /equivmx</span><span class="id"> qidmx_eq1</span><span class="id"> /genmx_witness</span>.<br/>
<span class="id">case</span><span class="id"> fullA:</span> (<span class="id">row_full</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span><span class="id"> sub1mx</span><span class="id"> submx1</span><span class="id"> fullA</span>.<br/>
<span class="id">set</span><span class="id"> B</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> _;</span><span class="id"> have</span><span class="id"> defB</span><span class="id"> :</span> (<span class="id">B</span><span class="id"> ==</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/andP;</span><span class="id"> split;</span><span class="id"> apply/submxP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)<span class="id"> *m</span><span class="id"> invmx</span> (<span class="id">col_ebase</span><span class="id"> A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{3}[A]mulmx_ebase</span><span class="id"> !mulmxA</span><span class="id"> mulmxKV</span><span class="id"> //</span><span class="id"> pid_mx_id</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">col_ebase</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> -</span>(<span class="id">mulmxA</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">pid_mx</span><span class="id"> _</span>))<span class="id"> pid_mx_id</span><span class="id"> //</span><span class="id"> mulmx_ebase</span>.<br/>
<span class="id">rewrite</span><span class="id"> defB</span><span class="id"> -negb_add</span><span class="id"> addbF;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> defB</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sub1mx</span><span class="id"> fullA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmxE</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">&lt;&lt;A&gt;&gt;</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unlock;</span><span class="id"> apply/eqmxP;</span><span class="id"> case/andP:</span> (<span class="id">chooseP</span> (<span class="id">genmx_witnessP</span><span class="id"> A</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_genmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> &lt;&lt;A&gt;&gt;</span><span class="id"> =</span><span class="id"> &lt;&lt;B&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqAB;</span><span class="id"> rewrite</span><span class="id"> unlock</span>.<br/>
<span class="id">have{}</span><span class="id"> eqAB:</span><span class="id"> equivmx</span><span class="id"> A</span> (<span class="id">row_full</span><span class="id"> A</span>)<span class="id"> =1</span><span class="id"> equivmx</span><span class="id"> B</span> (<span class="id">row_full</span><span class="id"> B</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /row_full</span><span class="id"> /equivmx</span><span class="id"> !eqAB</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eq_choose</span><span class="id"> eqAB</span>) (<span class="id">choose_id</span><span class="id"> _</span> (<span class="id">genmx_witnessP</span><span class="id"> B</span>))<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -eqAB</span><span class="id"> genmx_witnessP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmxP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">&lt;&lt;A&gt;&gt;</span><span class="id"> =</span><span class="id"> &lt;&lt;B&gt;&gt;</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> eqAB;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> eq_genmx</span> (<span class="id">eqmxP</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">genmxE</span><span class="id"> A</span>)<span class="id"> eqAB</span><span class="id"> !genmxE</span><span class="id"> andbb</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> genmxP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> &lt;&lt;0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id">&gt;&gt;%MS</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -submx0</span><span class="id"> genmxE</span><span class="id"> sub0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx1</span><span class="id"> n</span><span class="id"> :</span><span class="id"> &lt;&lt;1%:M</span><span class="id"> :</span><span class="id"> 'M_n&gt;&gt;%MS</span><span class="id"> =</span><span class="id"> 1%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock;</span><span class="id"> case/andP:</span> (<span class="id">chooseP</span> (<span class="id">@genmx_witnessP</span><span class="id"> n</span><span class="id"> n</span><span class="id"> 1%:M</span>))<span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> /eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> qidmx_eq1</span><span class="id"> row_full_unit</span><span class="id"> unitmx1</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_id</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">&lt;&lt;&lt;&lt;A&gt;&gt;&gt;&gt;</span><span class="id"> =</span><span class="id"> &lt;&lt;A&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/eq_genmx/genmxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_base_free</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_free</span> (<span class="id">row_base</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqnP;</span><span class="id"> rewrite</span><span class="id"> eq_row_base</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_gen</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> &lt;&lt;A&gt;&gt;%MS</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> genmxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_base_full</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_full</span> (<span class="id">col_base</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/row_fullP;</span><span class="gallina-kwd"> exists</span> (<span class="id">pid_mx</span> (<span class="id">\rank</span><span class="id"> A</span>)<span class="id"> *m</span><span class="id"> invmx</span> (<span class="id">col_ebase</span><span class="id"> A</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulmxA</span><span class="id"> mulmxKV</span><span class="id"> //</span><span class="id"> pid_mx_id</span><span class="id"> //</span><span class="id"> pid_mx_1</span>.<br/>
Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> row_base_free</span><span class="id"> col_base_full</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_leqif_sup</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> B</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sAB;</span><span class="id"> split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxrankS</span>.<br/>
<span class="id">apply/idP/idP=&gt;</span><span class="id"> [|</span><span class="id"> sBA];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> !mxrankS</span>.<br/>
<span class="id">case/submxP:</span><span class="id"> sAB</span><span class="id"> =&gt;</span><span class="id"> D</span><span class="id"> -&gt;;</span><span class="id"> set</span><span class="id"> r</span><span class="id"> :=</span><span class="id"> \rank</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mulmx_base</span><span class="id"> B</span>)<span class="id"> mulmxA</span>.<br/>
<span class="id">rewrite</span><span class="id"> mxrankMfree</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> /row_fullP[E</span><span class="id"> kE]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[rB</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> rB]mul1mx</span><span class="id"> -kE</span><span class="id"> -</span>(<span class="id">mulmxA</span><span class="id"> E</span>) (<span class="id">mulmxA</span><span class="id"> _</span><span class="id"> E</span>)<span class="id"> submxMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_leqif_eq</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> B</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> sAB;</span><span class="id"> rewrite</span><span class="id"> sAB;</span><span class="id"> apply:</span><span class="id"> mxrank_leqif_sup</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltmxErank</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span> (<span class="id">\rank</span><span class="id"> A</span><span class="id"> &lt;</span><span class="id"> \rank</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> andb_id2l</span><span class="id"> =&gt;</span><span class="id"> sAB;</span><span class="id"> rewrite</span> (<span class="id">ltn_leqif</span> (<span class="id">mxrank_leqif_sup</span><span class="id"> sAB</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_ltmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> &lt;</span><span class="id"> \rank</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltmxErank</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_cast</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">castmx</span><span class="id"> e</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> e</span><span class="id"> A;</span><span class="id"> case:</span><span class="id"> m2</span><span class="id"> /</span><span class="id"> =&gt;</span><span class="id"> A</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> castmx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_full_castmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_full</span> (<span class="id">castmx</span><span class="id"> e</span><span class="id"> A</span> <span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/eq_row_full/eqmx_cast</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_free_castmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> e</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_free</span> (<span class="id">castmx</span><span class="id"> e</span><span class="id"> A</span> <span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> row_free</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_free</span><span class="id"> eqmx_cast;</span><span class="id"> congr</span> (_<span class="id"> ==</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> e</span>.<span class="id">1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_conform</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">conform_mx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> A</span><span class="id"> \/</span><span class="id"> conform_mx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqVneq</span><span class="id"> m2</span><span class="id"> m1</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> neqm12]</span><span class="gallina-kwd"> in</span><span class="id"> B</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> right;</span><span class="id"> rewrite</span><span class="id"> conform_mx_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> left;</span><span class="id"> rewrite</span><span class="id"> nonconform_mx</span><span class="id"> ?neqm12</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> eqmx_sum_nop</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">addsmx_nop</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">eqmx_conform</span><span class="id"> &lt;&lt;A&gt;&gt;%MS</span><span class="id"> A</span>)<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> eq_id_gen</span>.<br/>
<span class="id">exact:</span><span class="id"> eqmx_trans</span> (<span class="id">genmxE</span><span class="id"> A</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rowsub_comp_sub</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> f</span> (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> 'I_p</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">rowsub</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> g</span>)<span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> rowsub_comp</span><span class="id"> rowsubE</span><span class="id"> mulmx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> submx_rowsub</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">h</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> 'I_p</span>)<span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">f</span><span class="id"> =1</span><span class="id"> g</span><span class="id"> \o</span><span class="id"> h</span><span class="id"> -&gt;</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> rowsub</span><span class="id"> g</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eq_rowsub-&gt;;</span><span class="id"> rewrite</span><span class="id"> rowsub_comp_sub</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> submx_rowsub</span><span class="id"> [m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n]</span><span class="id"> h</span><span class="id"> [f</span><span class="id"> g</span><span class="id"> A]</span><span class="id"> _</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_rowsub_comp_perm</span> (<span class="id">m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> 'S_m2</span>)<span class="id"> f</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">rowsub</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> s</span>)<span class="id"> A</span><span class="id"> :=:</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> rowsub_comp</span><span class="id"> rowsubE;</span><span class="id"> apply:</span><span class="id"> eqmxMfull</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -perm_mxEsub</span><span class="id"> row_full_unit</span><span class="id"> unitmx_perm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_rowsub_comp</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> f</span> (<span class="id">g</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> 'I_p</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">p</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> injective</span><span class="id"> g</span><span class="id"> -&gt;</span> (<span class="id">rowsub</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> g</span>)<span class="id"> A</span><span class="id"> :=:</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> leq_pn</span><span class="id"> g_inj;</span><span class="id"> have</span><span class="id"> eq_np</span><span class="id"> :</span><span class="id"> n</span><span class="id"> ==</span><span class="id"> p</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> leq_pn</span> (<span class="id">inj_leq</span><span class="id"> g</span>).<br/>
<span class="id">rewrite</span> (<span class="id">eqP</span><span class="id"> eq_np</span>)<span class="gallina-kwd"> in</span><span class="id"> g</span><span class="id"> g_inj</span><span class="id"> *</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eq_rowsub</span> (<span class="id">f</span><span class="id"> \o</span> (<span class="id">perm</span><span class="id"> g_inj</span>)))<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> permE</span>.<br/>
<span class="id">exact:</span><span class="id"> eqmx_rowsub_comp_perm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_rowsub</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">h</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> 'I_p</span>)<span class="id"> f</span><span class="id"> g</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">injective</span><span class="id"> h</span><span class="id"> -&gt;</span><span class="id"> p</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> g</span><span class="id"> \o</span><span class="id"> h</span><span class="id"> -&gt;</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> rowsub</span><span class="id"> g</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> leq_pn</span><span class="id"> h_inj</span><span class="id"> /eq_rowsub-&gt;;</span><span class="id"> apply:</span><span class="id"> eqmx_rowsub_comp</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> eqmx_rowsub</span><span class="id"> [m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n]</span><span class="id"> h</span><span class="id"> [f</span><span class="id"> g</span><span class="id"> A]</span><span class="id"> _</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> AddsmxSub</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m2,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> col_mx_sub</span><span class="id"> m3</span> (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">col_mx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !submxE</span><span class="id"> mul_col_mx</span><span class="id"> -col_mx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP/andP;</span><span class="id"> [case/eq_col_mx=&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> case;</span><span class="id"> do</span><span class="id"> 2!move/eqP-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxE</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> col_mx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:=</span><span class="id"> submx_refl</span> (<span class="id">col_mx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> col_mx_sub;</span><span class="id"> case/andP=&gt;</span><span class="id"> sAS</span><span class="id"> sBS</span>.<br/>
<span class="id">rewrite</span><span class="id"> unlock;</span><span class="id"> do</span><span class="id"> 2?case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [AB0</span><span class="id"> |</span><span class="id"> _];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> genmxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !eqmx_sum_nop</span><span class="id"> sBS</span><span class="id"> col_mx_sub</span><span class="id"> AB0</span><span class="id"> sub0mx</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !eqmx_sum_nop</span><span class="id"> sAS</span><span class="id"> col_mx_sub</span><span class="id"> AB0</span><span class="id"> sub0mx</span><span class="id"> andbT</span><span class="id"> /=</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_sub</span><span class="id"> m3</span> (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addsmxE</span><span class="id"> col_mx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxSl</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have:=</span><span class="id"> submx_refl</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS;</span><span class="id"> rewrite</span><span class="id"> addsmx_sub;</span><span class="id"> case/andP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxSr</span><span class="id"> :</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have:=</span><span class="id"> submx_refl</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS;</span><span class="id"> rewrite</span><span class="id"> addsmx_sub;</span><span class="id"> case/andP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_idPr</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:=</span><span class="id"> @eqmxP</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> B</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addsmxSr</span><span class="id"> addsmx_sub</span><span class="id"> submx_refl</span><span class="id"> !andbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_idPl</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:=</span><span class="id"> @eqmxP</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> A</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addsmxSl</span><span class="id"> addsmx_sub</span><span class="id"> submx_refl</span><span class="id"> !andbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> AddsmxSub</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adds0mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> +</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> addsmx_sub</span><span class="id"> sub0mx</span><span class="id"> addsmxSr</span><span class="id"> /=</span><span class="id"> andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> +</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> addsmx_sub</span><span class="id"> sub0mx</span><span class="id"> addsmxSl</span><span class="id"> /=</span><span class="id"> !andbT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> addsmx_nop_eq0</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">addsmx_nop</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!submx0</span><span class="id"> eqmx_sum_nop</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> addsmx_nop0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> addsmx_nop</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> addsmx_nop_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> addsmx_nop_id</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> addsmx_nop</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> conform_mx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxC</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> =</span><span class="id"> B</span><span class="id"> +</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> ==</span><span class="id"> B</span><span class="id"> +</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/andP;</span><span class="id"> rewrite</span><span class="id"> !addsmx_sub</span><span class="id"> andbC</span><span class="id"> -addsmx_sub</span><span class="id"> andbC</span><span class="id"> -addsmx_sub</span>.<br/>
<span class="id">move/genmxP;</span><span class="id"> rewrite</span><span class="id"> [@addsmx]unlock</span><span class="id"> -!submx0</span><span class="id"> !submx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 2!case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [//</span><span class="id"> -&gt;</span><span class="id"> |</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> ?genmx_id</span><span class="id"> ?addsmx_nop0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adds0mx_id</span><span class="id"> m1</span><span class="id"> n</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> eqxx</span><span class="id"> addsmx_nop_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx0_id</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">A</span><span class="id"> +</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)))<span class="id">%MS</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addsmxC</span><span class="id"> adds0mx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> +</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> C</span>)<span class="id"> =</span><span class="id"> A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> +</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:</span> (<span class="id">A</span><span class="id"> +</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> C</span>)<span class="id"> :=:</span><span class="id"> A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> +</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP/andP;</span><span class="id"> rewrite</span><span class="id"> !addsmx_sub</span><span class="id"> -andbA</span><span class="id"> andbA</span><span class="id"> -!addsmx_sub</span>.<br/>
<span class="id">rewrite</span><span class="id"> {1</span><span class="id"> 3}[in</span><span class="id"> @addsmx</span><span class="id"> _</span><span class="id"> m1]unlock</span><span class="id"> [in</span><span class="id"> @addsmx</span><span class="id"> _</span><span class="id"> n]unlock</span><span class="id"> !addsmx_nop_id</span><span class="id"> -!submx0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !addsmx_sub</span><span class="id"> ![@addsmx]unlock</span><span class="id"> -!submx0;</span><span class="id"> move/eq_genmx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 3!case:</span> (_<span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id">%MS;</span><span class="id"> rewrite</span><span class="id"> //=</span><span class="id"> !genmx_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Monoid</span>.<span class="id">isComLaw</span>.<span class="id">Build</span> (<span class="id">matrix</span><span class="id"> F</span><span class="id"> n</span><span class="id"> n</span>)<span class="id"> 0%MS</span><span class="id"> addsmx</span>.<span class="id">body</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@addsmxA</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@addsmxC</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@adds0mx_id</span><span class="id"> n</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxMr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> :=:</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> +</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !addsmxE</span><span class="id"> -!mul_col_mx</span><span class="id"> !submxMr</span><span class="id"> ?addsmxE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmxS</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> m4</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>)) (<span class="id">D</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m4,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> D</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> +</span><span class="id"> D</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sAC</span><span class="id"> sBD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addsmx_sub</span><span class="id"> {1}addsmxC</span><span class="id"> !</span>(<span class="id">submx_trans</span><span class="id"> _</span> (<span class="id">addsmxSr</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addmx_sub_adds</span><span class="id"> m</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">D</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> D</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%R</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> +</span><span class="id"> D</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sAC;</span><span class="id"> move/</span>(<span class="id">addsmxS</span><span class="id"> sAC</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> submx_trans</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addmx_sub</span><span class="id"> ?addsmxSl</span><span class="id"> ?addsmxSr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_addKl</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> m2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> +</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> C</span>)<span class="id">%R</span><span class="id"> :=:</span><span class="id"> A</span><span class="id"> +</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sBA;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !addsmx_sub</span><span class="id"> !addsmxSl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{3}[C]</span>(<span class="id">addKr</span><span class="id"> B</span>)<span class="id"> !addmx_sub_adds</span><span class="id"> ?eqmx_opp</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_addKr</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> m2</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> ((<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%R</span><span class="id"> +</span><span class="id"> C</span><span class="id"> :=:</span><span class="id"> A</span><span class="id"> +</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">addsmxC</span><span class="id"> C</span>)<span class="id"> addrC;</span><span class="id"> apply:</span><span class="id"> addsmx_addKl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adds_eqmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> m4</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>)) (<span class="id">D</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m4,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> D</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> +</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> C</span><span class="id"> +</span><span class="id"> D</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAC</span><span class="id"> eqBD;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !addsmxS</span><span class="id"> ?eqAC</span><span class="id"> ?eqBD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_adds</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">&lt;&lt;</span>(<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS&gt;&gt;</span><span class="id"> =</span><span class="id"> &lt;&lt;A&gt;&gt;</span><span class="id"> +</span><span class="id"> &lt;&lt;B&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">eq_genmx</span> (<span class="id">adds_eqmx</span> (<span class="id">genmxE</span><span class="id"> A</span>) (<span class="id">genmxE</span><span class="id"> B</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [@addsmx]unlock</span><span class="id"> !addsmx_nop_id</span><span class="id"> !</span>(<span class="id">fun_if</span> (<span class="id">@genmx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> !genmx_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_addsmxP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> u,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> u</span>.<span class="id">1</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> +</span><span class="id"> u</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> C</span>) (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> +</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[u</span><span class="id"> -&gt;]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addmx_sub_adds</span><span class="id"> ?submxMl</span>.<br/>
<span class="id">rewrite</span><span class="id"> addsmxE;</span><span class="id"> case/submxP=&gt;</span><span class="id"> u</span><span class="id"> -&gt;;</span><span class="gallina-kwd"> exists</span> (<span class="id">lsubmx</span><span class="id"> u,</span><span class="id"> rsubmx</span><span class="id"> u</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mul_row_col</span><span class="id"> hsubmxK</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> sub_addsmxP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B</span><span class="id"> C}</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> I</span><span class="id"> :</span><span class="id"> finType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_sums</span><span class="id"> P</span><span class="id"> n</span> (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">&lt;&lt;</span>(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span>)<span class="id">%MS&gt;&gt;%MS</span><span class="id"> =</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> &lt;&lt;B_</span><span class="id"> i&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> _</span> (<span class="id">@genmx_adds</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@genmx0</span><span class="id"> n</span><span class="id"> n</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumsmx_sup</span><span class="id"> i0</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">P</span><span class="id"> i0</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B_</span><span class="id"> i0</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Pi0</span><span class="id"> sAB;</span><span class="id"> apply:</span><span class="id"> submx_trans</span><span class="id"> sAB</span><span class="id"> _;</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> i0</span>)<span class="id"> //</span><span class="id"> addsmxSl</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> sumsmx_sup</span><span class="id"> i0</span><span class="id"> [P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B_]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumsmx_subP</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [sAB</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> |</span><span class="id"> sAB]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> submx_trans</span><span class="id"> sAB;</span><span class="id"> apply:</span><span class="id"> sumsmx_sup</span><span class="id"> Pi</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> elim/big_rec:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Ai</span><span class="id"> Pi</span><span class="id"> sAiB];</span><span class="id"> rewrite</span><span class="id"> ?sub0mx</span><span class="id"> //</span><span class="id"> addsmx_sub</span><span class="id"> sAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summx_sub_sums</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> B</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;((<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> i</span>)<span class="id">%R</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> sAB;</span><span class="id"> apply:</span><span class="id"> summx_sub</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span><span class="id"> i</span>)<span class="id"> ?sAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumsmxS</span><span class="id"> P</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> sAB;</span><span class="id"> apply/sumsmx_subP=&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span><span class="id"> i</span>)<span class="id"> ?sAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_sums</span><span class="id"> P</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> i</span><span class="id"> :=:</span><span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> i</span><span class="id"> :=:</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAB;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !sumsmxS</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> move/eqAB-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_sums_genmxP</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> u_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id">,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> u_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B_</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> &lt;&lt;B_</span><span class="id"> i&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> [u_</span><span class="id"> -&gt;]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> summx_sub_sums</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> genmxE;</span><span class="id"> apply:</span><span class="id"> submxMl</span>.<br/>
<span class="id">have</span><span class="id"> [b]</span><span class="id"> :=</span><span class="id"> ubnP</span><span class="id"> #|P|;</span><span class="id"> elim:</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> b</span><span class="id"> IHb</span><span class="gallina-kwd"> in</span><span class="id"> P</span><span class="id"> A</span><span class="id"> *</span>.<br/>
<span class="id">case:</span> (<span class="id">pickP</span><span class="id"> P</span>)<span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> Pi</span><span class="id"> |</span><span class="id"> P0</span><span class="id"> _];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_pred0</span><span class="id"> //;</span><span class="id"> move/submx0null-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> big_pred0</span>.<br/>
<span class="id">rewrite</span> (<span class="id">cardD1x</span><span class="id"> Pi</span>) (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> /IHb{b</span><span class="id"> IHb}</span><span class="id"> /=</span><span class="id"> IHi</span>.<br/>
<span class="id">rewrite</span> (<span class="id">adds_eqmx</span> (<span class="id">genmxE</span><span class="id"> _</span>) (<span class="id">eqmx_refl</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> /sub_addsmxP[u</span><span class="id"> -&gt;]</span>.<br/>
<span class="id">have</span><span class="id"> [u_</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> IHi</span><span class="id"> _</span> (<span class="id">submxMl</span><span class="id"> u</span>.<span class="id">2</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">exists</span><span class="id"> [eta</span><span class="id"> u_</span><span class="gallina-kwd"> with</span><span class="id"> i</span><span class="id"> |-&gt;</span><span class="id"> u</span>.<span class="id">1];</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span><span class="id"> Pi</span>)<span class="id">/=</span><span class="id"> eqxx;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> /andP[_</span><span class="id"> /negPf-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_sumsmxP</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> u_,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> u_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B_</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eqmx_sums</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> genmxE</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> apply/sub_sums_genmxP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumsmxMr_gen</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> &lt;&lt;A</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqmxP/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/sumsmx_subP=&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> genmxE</span><span class="id"> submxMr</span><span class="id"> ?</span>(<span class="id">sumsmx_sup</span><span class="id"> i</span>).<br/>
<span class="id">have</span><span class="id"> [u</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> sub_sumsmxP</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">submx_refl</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> i</span>)<span class="id">%MS</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmx_suml</span><span class="id"> summx_sub_sums</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> genmxE</span><span class="id"> -mulmxA</span><span class="id"> submxMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumsmxMr</span><span class="id"> P</span><span class="id"> n</span> (<span class="id">A_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M[F]_n</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">A_</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eqmx_trans</span> (<span class="id">sumsmxMr_gen</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">eqmx_sums</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> genmxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_pid_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> \rank</span> (<span class="id">pid_mx</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">do</span><span class="id"> 2!move/subnKC</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> pid_mx_block</span><span class="id"> block_mxEv</span><span class="id"> row_mx0</span><span class="id"> -addsmxE</span><span class="id"> addsmx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mxrank_tr</span><span class="id"> tr_row_mx</span><span class="id"> trmx0</span><span class="id"> trmx1</span><span class="id"> -addsmxE</span><span class="id"> addsmx0</span><span class="id"> mxrank1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_copid_mx</span><span class="id"> n</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> \rank</span> (<span class="id">copid_mx</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> r</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/subnKC</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> /copid_mx</span><span class="id"> pid_mx_block</span><span class="id"> scalar_mx_block</span>.<br/>
<span class="id">rewrite</span><span class="id"> opp_block_mx</span><span class="id"> !oppr0</span><span class="id"> add_block_mx</span><span class="id"> !addr0</span><span class="id"> subrr</span><span class="id"> block_mxEv</span><span class="id"> row_mx0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -addsmxE</span><span class="id"> adds0mx</span><span class="id"> -mxrank_tr</span><span class="id"> tr_row_mx</span><span class="id"> trmx0</span><span class="id"> trmx1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -addsmxE</span><span class="id"> adds0mx</span><span class="id"> mxrank1</span><span class="id"> addKn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_compl</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> A^C</span><span class="id"> =</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> \rank</span><span class="id"> A</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxrankMfree</span><span class="id"> ?row_free_unit</span><span class="id"> ?rank_copid_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_ker</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span> (<span class="id">kermx</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> \rank</span><span class="id"> A</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxrankMfree</span><span class="id"> ?row_free_unit</span><span class="id"> ?unitmx_inv</span><span class="id"> ?rank_copid_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> kermx_eq0</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">kermx</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> row_free</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mxrank_eq0</span><span class="id"> mxrank_ker</span><span class="id"> subn_eq0</span><span class="id"> row_leq_rank</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_coker</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span> (<span class="id">cokermx</span><span class="id"> A</span>)<span class="id"> =</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> \rank</span><span class="id"> A</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqmxMfull</span><span class="id"> ?row_full_unit</span><span class="id"> ?unitmx_inv</span><span class="id"> ?rank_copid_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cokermx_eq0</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">cokermx</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mxrank_eq0</span><span class="id"> mxrank_coker</span><span class="id"> subn_eq0</span><span class="id"> col_leq_rank</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_ker</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> kermx</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{2}[A]mulmx_ebase</span><span class="id"> !mulmxA</span><span class="id"> mulmxKV</span><span class="id"> //</span><span class="id"> mul_copid_mx_pid</span><span class="id"> ?mul0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmxKV_ker</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> col_ebase</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> kermx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mulmxA</span><span class="id"> mulmxBr</span><span class="id"> mulmx1</span><span class="id"> mulmxBl</span><span class="id"> mulmxK</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}[A]mulmx_ebase</span><span class="id"> !mulmxA</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">canRL</span> (<span class="id">mulmxK</span> (<span class="id">row_ebase_unit</span><span class="id"> A</span>))).<br/>
<span class="id">rewrite</span><span class="id"> mul0mx</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> BA0;</span><span class="id"> apply:</span> (<span class="id">canLR</span> (<span class="id">addrK</span><span class="id"> _</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">pid_mx_id</span><span class="id"> _</span><span class="id"> _</span><span class="id"> n</span> (<span class="id">rank_leq_col</span><span class="id"> A</span>))<span class="id"> mulmxA</span><span class="id"> BA0</span><span class="id"> !mul0mx</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_kermxP</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>) (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> kermx</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> submxP</span>)<span class="id"> =&gt;</span><span class="id"> [[D</span><span class="id"> -&gt;]|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> mulmx_ker</span><span class="id"> mulmx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/mulmxKV_ker;</span><span class="gallina-kwd"> exists</span> (<span class="id">B</span><span class="id"> *m</span><span class="id"> col_ebase</span><span class="id"> A</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_kermx</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> kermx</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/sub_kermxP/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> kermx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">kermx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=:</span><span class="id"> 1%:M</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> submx1/=</span><span class="id"> sub_kermx</span><span class="id"> mulmx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx_free_eq0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_free</span><span class="id"> B</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sub_kermx</span><span class="id"> -kermx_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> submx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> inj_row_free</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV_m,</span><span class="id"> v</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> v</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> row_free</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ainj;</span><span class="id"> rewrite</span><span class="id"> -kermx_eq0;</span><span class="id"> apply/eqP/row_matrixP</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> row0;</span><span class="id"> apply/Ainj;</span><span class="id"> rewrite</span><span class="id"> -row_mul</span><span class="id"> mulmx_ker</span><span class="id"> row0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_freePn</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> i,</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> M</span><span class="id"> &lt;=</span><span class="id"> row'</span><span class="id"> i</span><span class="id"> M</span>)<span class="id">%MS</span>) (<span class="id">~~</span><span class="id"> row_free</span><span class="id"> M</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -kermx_eq0;</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">rowV0Pn</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> [|[i0</span><span class="id"> /submxP[D</span><span class="id"> rM]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [v</span><span class="id"> /sub_kermxP</span><span class="id"> vM_eq0</span><span class="id"> /rV0Pn[i0</span><span class="id"> vi0_neq0]];</span><span class="gallina-kwd"> exists</span><span class="id"> i0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> :=</span><span class="id"> vM_eq0;</span><span class="id"> rewrite</span><span class="id"> mulmx_sum_row</span> (<span class="id">bigD1_ord</span><span class="id"> i0</span>)<span class="id">//=</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /</span>(<span class="id">canRL</span> (<span class="id">addrK</span><span class="id"> _</span>))<span class="id">/</span>(<span class="id">canRL</span> (<span class="id">scalerK</span><span class="id"> _</span>))<span class="id">-&gt;//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sub0r</span><span class="id"> scalerN</span><span class="id"> -scaleNr</span><span class="id"> scalemx_sub//</span><span class="id"> summx_sub//</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> scalemx_sub//</span><span class="id"> -row_rowsub</span><span class="id"> row_sub</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">\row_j</span><span class="id"> oapp</span> (<span class="id">D</span><span class="id"> 0</span>) (<span class="id">-</span><span class="id"> 1</span>) (<span class="id">unlift</span><span class="id"> i0</span><span class="id"> j</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/rV0Pn;</span><span class="gallina-kwd"> exists</span><span class="id"> i0;</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> unlift_none/=</span><span class="id"> oppr_eq0</span><span class="id"> oner_eq0</span>.<br/>
<span class="id">apply/sub_kermxP;</span><span class="id"> rewrite</span><span class="id"> mulmx_sum_row</span> (<span class="id">bigD1_ord</span><span class="id"> i0</span>)<span class="id">//=</span><span class="id"> !mxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> unlift_none</span><span class="id"> scaleN1r</span><span class="id"> rM</span><span class="id"> mulmx_sum_row</span><span class="id"> addrC</span><span class="id"> -sumrB</span><span class="id"> big1</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> liftK</span><span class="id"> row_rowsub</span><span class="id"> subrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> negb_row_free</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">M</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">~~</span><span class="id"> row_free</span><span class="id"> M</span><span class="id"> =</span><span class="id"> [exists</span><span class="id"> i,</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> M</span><span class="id"> &lt;=</span><span class="id"> row'</span><span class="id"> i</span><span class="id"> M</span>)<span class="id">%MS]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/row_freePn/existsP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulmx0_rank_max</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB0;</span><span class="id"> rewrite</span><span class="id"> -{3}</span>(<span class="id">subnK</span> (<span class="id">rank_leq_row</span><span class="id"> B</span>))<span class="id"> leq_add2r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mxrank_ker</span><span class="id"> mxrankS</span><span class="id"> //</span><span class="id"> sub_kermx</span><span class="id"> AB0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_Frobenius</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> B</span> (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> +</span><span class="id"> \rank</span> (<span class="id">B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> B</span><span class="id"> +</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -{2}</span>(<span class="id">mulmx_base</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>))<span class="id"> -mulmxA</span> (<span class="id">eqmxMfull</span><span class="id"> _</span> (<span class="id">col_base_full</span><span class="id"> _</span>)).<br/>
<span class="id">set</span><span class="id"> C2</span><span class="id"> :=</span><span class="id"> row_base</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> C</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}</span>(<span class="id">subnK</span> (<span class="id">rank_leq_row</span><span class="id"> C2</span>))<span class="id"> -</span>(<span class="id">mxrank_ker</span><span class="id"> C2</span>)<span class="id"> addnAC</span><span class="id"> leq_add2r</span>.<br/>
<span class="id">rewrite</span><span class="id"> addnC</span><span class="id"> -{1}</span>(<span class="id">mulmx_base</span><span class="id"> B</span>)<span class="id"> -mulmxA</span><span class="id"> eqmxMfull</span><span class="id"> //</span>.<br/>
<span class="id">set</span><span class="id"> C1</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> -{2}</span>(<span class="id">subnKC</span> (<span class="id">rank_leq_row</span><span class="id"> C1</span>))<span class="id"> leq_add2l</span><span class="id"> -mxrank_ker</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mxrankMfree</span><span class="id"> _</span> (<span class="id">row_base_free</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>))).<br/>
<span class="id">have:</span> (<span class="id">row_base</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> &lt;=</span><span class="id"> row_base</span><span class="id"> B</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !eq_row_base</span><span class="id"> submxMl</span>.<br/>
<span class="id">case/submxP=&gt;</span><span class="id"> D</span><span class="id"> defD;</span><span class="id"> rewrite</span><span class="id"> defD</span><span class="id"> mulmxA</span><span class="id"> mxrankMfree</span><span class="id"> ?mxrankS</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sub_kermx</span><span class="id"> -mulmxA</span> (<span class="id">mulmxA</span><span class="id"> D</span>)<span class="id"> -defD</span><span class="id"> -/C2</span><span class="id"> mulmx_ker</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_mul_min</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span><span class="id"> -</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> have:=</span><span class="id"> mxrank_Frobenius</span><span class="id"> A</span><span class="id"> 1%:M</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> mulmx1</span><span class="id"> mul1mx</span><span class="id"> mxrank1</span><span class="id"> leq_subLR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_compl_full</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_full</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> A^C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /row_full</span><span class="id"> addsmxE;</span><span class="id"> apply/row_fullP</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">row_mx</span> (<span class="id">pinvmx</span><span class="id"> A</span>) (<span class="id">cokermx</span><span class="id"> A</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mul_row_col</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{2}[A]mulmx_ebase</span><span class="id"> -!mulmxA</span><span class="id"> mulKmx</span><span class="id"> //</span><span class="id"> -mulmxDr</span><span class="id"> !mulmxA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> pid_mx_id</span><span class="id"> ?copid_mx_id</span><span class="id"> //</span><span class="id"> -mulmxDl</span><span class="id"> addrC</span><span class="id"> subrK</span><span class="id"> mul1mx</span><span class="id"> mulVmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_capmx_gen</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> capmx_gen</span><span class="id"> B</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/andP=&gt;</span><span class="id"> [sAI</span><span class="id"> |</span><span class="id"> [/submxP[B'</span><span class="id"> -&gt;{A}]</span><span class="id"> /submxP[C'</span><span class="id"> eqBC']]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">submx_trans</span><span class="id"> sAI</span>)<span class="id"> ?submxMl</span><span class="id"> //</span><span class="id"> /capmx_gen</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">have:=</span><span class="id"> mulmx_ker</span> (<span class="id">col_mx</span><span class="id"> B</span><span class="id"> C</span>)<span class="id">;</span><span class="id"> set</span><span class="id"> K</span><span class="id"> :=</span><span class="id"> kermx</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{1}[K]hsubmxK</span><span class="id"> mul_row_col;</span><span class="id"> move/</span>(<span class="id">canRL</span> (<span class="id">addrK</span><span class="id"> _</span>))<span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> add0r</span><span class="id"> -mulNmx</span><span class="id"> submxMl</span>.<br/>
<span class="id">have:</span> (<span class="id">row_mx</span><span class="id"> B'</span> (<span class="id">-</span><span class="id"> C'</span>)<span class="id"> &lt;=</span><span class="id"> kermx</span> (<span class="id">col_mx</span><span class="id"> B</span><span class="id"> C</span>))<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sub_kermx</span><span class="id"> mul_row_col</span><span class="id"> eqBC'</span><span class="id"> mulNmx</span><span class="id"> subrr</span>.<br/>
<span class="id">case/submxP=&gt;</span><span class="id"> D;</span><span class="id"> rewrite</span><span class="id"> -[kermx</span><span class="id"> _]hsubmxK</span><span class="id"> mul_mx_row</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/eq_row_mx=&gt;</span><span class="id"> -&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> submxMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> capmx_witnessP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> equivmx</span><span class="id"> A</span> (<span class="id">qidmx</span><span class="id"> A</span>) (<span class="id">capmx_witness</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /equivmx</span><span class="id"> qidmx_eq1</span><span class="id"> /qidmx</span><span class="id"> /capmx_witness</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sub1mx;</span><span class="id"> case</span><span class="id"> s1A:</span> (<span class="id">1%:M</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !genmxE</span><span class="id"> submx_refl</span><span class="id"> /=</span><span class="id"> -negb_add;</span><span class="id"> apply:</span><span class="id"> contra</span><span class="id"> {s1A}</span>(<span class="id">negbT</span><span class="id"> s1A</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [&lt;-</span><span class="id"> |</span><span class="id"> _]</span><span class="id"> :=</span><span class="id"> eqP;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> genmxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> pid_mx_1</span>.<br/>
<span class="id">case:</span> (<span class="id">m</span><span class="id"> =P</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> ne_mn]</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> s1A</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> conform_mx_id</span><span class="id"> submx_refl</span><span class="id"> pid_mx_1</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nonconform_mx</span><span class="id"> ?submx1</span><span class="id"> ?s1A</span><span class="id"> ?eqxx</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> capmx_normP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> equivmx_spec</span><span class="id"> A</span> (<span class="id">qidmx</span><span class="id"> A</span>) (<span class="id">capmx_norm</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/andP:</span> (<span class="id">chooseP</span> (<span class="id">capmx_witnessP</span><span class="id"> A</span>))<span class="id"> =&gt;</span><span class="id"> /eqmxP</span><span class="id"> defN</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> capmx_norm_eq</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qidmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> qidmx</span><span class="id"> B</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> ==</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> capmx_norm</span><span class="id"> A</span><span class="id"> =</span><span class="id"> capmx_norm</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqABid</span><span class="id"> /eqmxP</span><span class="id"> eqAB</span>.<br/>
<span class="id">have{eqABid}</span><span class="id"> eqAB:</span><span class="id"> equivmx</span><span class="id"> A</span> (<span class="id">qidmx</span><span class="id"> A</span>)<span class="id"> =1</span><span class="id"> equivmx</span><span class="id"> B</span> (<span class="id">qidmx</span><span class="id"> B</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> C;</span><span class="id"> rewrite</span><span class="id"> /equivmx</span><span class="id"> eqABid</span><span class="id"> !eqAB</span>.<br/>
<span class="id">rewrite</span><span class="id"> {1}/capmx_norm</span> (<span class="id">eq_choose</span><span class="id"> eqAB</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> choose_id;</span><span class="id"> first</span><span class="id"> rewrite</span><span class="id"> -eqAB;</span><span class="id"> apply:</span><span class="id"> capmx_witnessP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> capmx_nopP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> equivmx_spec</span><span class="id"> A</span> (<span class="id">qidmx</span><span class="id"> A</span>) (<span class="id">capmx_nop</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /capmx_nop;</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> ne_mn]</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> conform_mx_id</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nonconform_mx</span><span class="id"> ?ne_mn</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> capmx_normP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> sub_qidmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qidmx</span><span class="id"> B</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /qidmx</span><span class="id"> =&gt;</span><span class="id"> idB;</span><span class="id"> apply:</span><span class="id"> {A}submx_trans</span> (<span class="id">submx1</span><span class="id"> A</span>)<span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> B</span><span class="id"> idB</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> /eqP-&gt;</span><span class="id"> |</span><span class="id"> _</span><span class="id"> B];</span><span class="id"> rewrite</span> (<span class="id">=^~</span><span class="id"> sub1mx,</span><span class="id"> pid_mx_1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> qidmx_cap</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qidmx</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> qidmx</span><span class="id"> A</span><span class="id"> &amp;&amp;</span><span class="id"> qidmx</span><span class="id"> B</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span><span class="id"> -sub1mx</span>.<br/>
<span class="id">case</span><span class="id"> idA:</span> (<span class="id">qidmx</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> case</span><span class="id"> idB:</span> (<span class="id">qidmx</span><span class="id"> B</span>)<span class="id">;</span><span class="id"> try</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmx_nopP</span>.<br/>
<span class="id">case</span><span class="id"> s1B:</span> (_<span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmx_normP</span>.<br/>
<span class="id">apply/idP=&gt;</span><span class="id"> /</span>(<span class="id">sub_qidmx</span><span class="id"> 1%:M</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> capmx_normP</span><span class="id"> sub_capmx_gen</span><span class="id"> s1B</span><span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> capmx_eq_norm</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">qidmx</span><span class="id"> A</span><span class="id"> =</span><span class="id"> qidmx</span><span class="id"> B</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> capmx_norm</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqABid;</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> -sub1mx</span><span class="id"> {}eqABid</span>.<br/>
<span class="id">have</span><span class="id"> norm_id</span><span class="id"> m</span> (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">N</span><span class="id"> :=</span><span class="id"> capmx_norm</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> capmx_norm</span><span class="id"> N</span><span class="id"> =</span><span class="id"> N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> capmx_norm_eq;</span><span class="id"> rewrite</span><span class="id"> ?capmx_normP</span><span class="id"> ?andbb</span>.<br/>
<span class="id">case</span><span class="id"> idB:</span> (<span class="id">qidmx</span><span class="id"> B</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> norm_id</span>.<br/>
<span class="id">rewrite</span><span class="id"> /capmx_nop;</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> m2</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> neqm2n]</span><span class="gallina-kwd"> in</span><span class="id"> B</span><span class="id"> idB</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> idN</span><span class="id"> :=</span><span class="id"> idB;</span><span class="id"> rewrite</span><span class="id"> -{1}capmx_normP</span><span class="id"> !qidmx_eq1</span><span class="gallina-kwd"> in</span><span class="id"> idN</span><span class="id"> idB</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> conform_mx_id</span> (<span class="id">eqP</span><span class="id"> idN</span>) (<span class="id">eqP</span><span class="id"> idB</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nonconform_mx</span><span class="id"> ?neqm2n</span><span class="id"> ?norm_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxE</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> capmx_gen</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span><span class="id"> -sub1mx;</span><span class="id"> apply/eqmxP</span>.<br/>
<span class="id">have:=</span><span class="id"> submx_refl</span> (<span class="id">capmx_gen</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !sub_capmx_gen</span><span class="id"> =&gt;</span><span class="id"> /andP[sIA</span><span class="id"> sIB]</span>.<br/>
<span class="id">case</span><span class="id"> idA:</span> (<span class="id">qidmx</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !capmx_nopP</span><span class="id"> submx_refl</span><span class="id"> sub_qidmx</span>.<br/>
<span class="id">case</span><span class="id"> idB:</span> (<span class="id">qidmx</span><span class="id"> B</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !capmx_nopP</span><span class="id"> submx_refl</span><span class="id"> sub_qidmx</span>.<br/>
<span class="id">case</span><span class="id"> s1B:</span> (<span class="id">1%:M</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS;</span><span class="id"> rewrite</span><span class="id"> !capmx_normP</span><span class="id"> ?sub_capmx_gen</span><span class="id"> sIA</span><span class="id"> ?sIB</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> submx_refl</span> (<span class="id">submx_trans</span> (<span class="id">submx1</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxSl</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmxE</span><span class="id"> submxMl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_capmx</span><span class="id"> m</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> :&amp;:</span><span class="id"> C</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> &amp;&amp;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmxE</span><span class="id"> sub_capmx_gen</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxC</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> =</span><span class="id"> B</span><span class="id"> :&amp;:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [eqAB|]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">qidmx</span><span class="id"> A</span>) (<span class="id">qidmx</span><span class="id"> B</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">capmx_eq_norm</span><span class="id"> eqAB</span>) (<span class="id">capmx_eq_norm</span> (<span class="id">esym</span><span class="id"> eqAB</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> capmx_norm_eq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !qidmx_cap</span><span class="id"> andbC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> !sub_capmx</span><span class="id"> andbC</span><span class="id"> -sub_capmx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> negb_eqb</span><span class="id"> !unlock</span><span class="id"> =&gt;</span><span class="id"> /addbP</span><span class="id"> &lt;-;</span><span class="id"> case:</span> (<span class="id">qidmx</span><span class="id"> A</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxSr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmxC</span><span class="id"> capmxSl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmx_idPr</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> m2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span> (<span class="id">B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have:=</span><span class="id"> @eqmxP</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> B</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> capmxSr</span><span class="id"> sub_capmx</span><span class="id"> submx_refl</span><span class="id"> !andbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmx_idPl</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> m2</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmxC;</span><span class="id"> apply:</span><span class="id"> capmx_idPr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxS</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> m4</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>)) (<span class="id">D</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m4,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> D</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> :&amp;:</span><span class="id"> D</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> sAC</span><span class="id"> sBD;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> {1}capmxC</span><span class="id"> !</span>(<span class="id">submx_trans</span> (<span class="id">capmxSr</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cap_eqmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> m4</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>)) (<span class="id">D</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m4,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :=:</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> D</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> C</span><span class="id"> :&amp;:</span><span class="id"> D</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqAC</span><span class="id"> eqBD;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !capmxS</span><span class="id"> ?eqAC</span><span class="id"> ?eqBD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxMr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id"> *m</span><span class="id"> C</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> C</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> !submxMr</span><span class="id"> ?capmxSl</span><span class="id"> ?capmxSr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cap0mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :&amp;:</span><span class="id"> A</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> submx0null</span> (<span class="id">capmxSl</span><span class="id"> _</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmx0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :&amp;:</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)))<span class="id">%MS</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> submx0null</span> (<span class="id">capmxSr</span><span class="id"> _</span><span class="id"> _</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxT</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_full</span><span class="id"> B</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -sub1mx</span><span class="id"> =&gt;</span><span class="id"> s1B;</span><span class="id"> apply/eqmxP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> capmxSl</span><span class="id"> sub_capmx</span><span class="id"> submx_refl</span> (<span class="id">submx_trans</span> (<span class="id">submx1</span><span class="id"> A</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capTmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">row_full</span><span class="id"> A</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Afull;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> capmxC</span><span class="id"> !capmxT</span><span class="id"> ?andbb</span>. Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> capmx_nop_id</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><span class="id"> capmx_nop</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /capmx_nop</span><span class="id"> conform_mx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cap1mx</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">1%:M</span><span class="id"> :&amp;:</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> qidmx_eq1</span><span class="id"> eqxx</span><span class="id"> capmx_nop_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmx1</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> 1%:M</span><span class="id"> =</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmxC</span><span class="id"> cap1mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_cap</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">&lt;&lt;A</span><span class="id"> :&amp;:</span><span class="id"> B&gt;&gt;%MS</span><span class="id"> =</span> (<span class="id">&lt;&lt;A&gt;&gt;</span><span class="id"> :&amp;:</span><span class="id"> &lt;&lt;B&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">eq_genmx</span> (<span class="id">cap_eqmx</span> (<span class="id">genmxE</span><span class="id"> A</span>) (<span class="id">genmxE</span><span class="id"> B</span>))).<br/>
<span class="id">case</span><span class="id"> idAB:</span> (<span class="id">qidmx</span><span class="id"> &lt;&lt;A&gt;&gt;</span><span class="id"> ||</span><span class="id"> qidmx</span><span class="id"> &lt;&lt;B&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [@capmx]unlock</span><span class="id"> !capmx_nop_id</span><span class="id"> !</span>(<span class="id">fun_if</span> (<span class="id">@genmx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> !genmx_id</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">qidmx</span><span class="id"> _</span>)<span class="id"> idAB</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> -&gt;</span>.<br/>
<span class="id">case</span><span class="id"> idA:</span> (<span class="id">qidmx</span><span class="id"> _</span>)<span class="id"> idAB</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> idB;</span><span class="id"> rewrite</span><span class="id"> {2}capmx_eq_norm</span><span class="id"> ?idA</span><span class="id"> //</span>.<br/>
<span class="id">set</span><span class="id"> C</span><span class="id"> :=</span> (_<span class="id"> :&amp;:</span><span class="id"> _</span>)<span class="id">%MS;</span><span class="id"> have</span><span class="id"> eq_idC:</span><span class="id"> row_full</span><span class="id"> C</span><span class="id"> =</span><span class="id"> qidmx</span><span class="id"> C</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> qidmx_cap</span><span class="id"> idA</span><span class="id"> -sub1mx</span><span class="id"> sub_capmx</span><span class="id"> genmxE;</span><span class="id"> apply/andP=&gt;</span><span class="id"> [[s1A]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/idP:</span><span class="id"> idA;</span><span class="id"> rewrite</span><span class="id"> qidmx_eq1</span><span class="id"> -genmx1</span> (<span class="id">sameP</span><span class="id"> eqP</span><span class="id"> genmxP</span>)<span class="id"> submx1</span>.<br/>
<span class="id">rewrite</span><span class="id"> unlock</span><span class="id"> /capmx_norm</span><span class="id"> eq_idC</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> choose_id</span> (<span class="id">capmx_witnessP</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -eq_idC</span><span class="id"> genmx_witnessP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmxA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :&amp;:</span> (<span class="id">B</span><span class="id"> :&amp;:</span><span class="id"> C</span>)<span class="id"> =</span><span class="id"> A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :&amp;:</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span> (<span class="id">capmxC</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> capmxC;</span><span class="id"> wlog</span><span class="id"> idA:</span><span class="id"> m1</span><span class="id"> m3</span><span class="id"> A</span><span class="id"> C</span><span class="id"> /</span><span class="id"> qidmx</span><span class="id"> A</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> IH;</span><span class="id"> case</span><span class="id"> idA:</span> (<span class="id">qidmx</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> IH</span>.<br/>
&nbsp;&nbsp;<span class="id">case</span><span class="id"> idC:</span> (<span class="id">qidmx</span><span class="id"> C</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -IH</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@capmx_eq_norm</span><span class="id"> n</span><span class="id"> m3</span>)<span class="id"> ?qidmx_cap</span><span class="id"> ?idA</span><span class="id"> ?idC</span><span class="id"> ?andbF</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> capmx_eq_norm</span><span class="id"> ?qidmx_cap</span><span class="id"> ?idA</span><span class="id"> ?idC</span><span class="id"> ?andbF</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> capmx_norm_eq;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !qidmx_cap</span><span class="id"> andbAC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> rewrite</span><span class="id"> !sub_capmx</span><span class="id"> andbAC</span><span class="id"> -!sub_capmx</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!</span>(<span class="id">capmxC</span><span class="id"> A</span>)<span class="id"> [in</span><span class="id"> @capmx</span><span class="id"> _</span><span class="id"> m1]unlock</span><span class="id"> idA</span><span class="id"> capmx_nop_id</span>.<br/>
<span class="id">have</span><span class="id"> [eqBC|]</span><span class="id"> :=</span><span class="id"> eqVneq</span> (<span class="id">qidmx</span><span class="id"> B</span>) (<span class="id">qidmx</span><span class="id"> C</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@capmx_eq_norm</span><span class="id"> n</span>)<span class="id"> ?capmx_nopP</span><span class="id"> //</span><span class="id"> capmx_eq_norm</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> capmx_norm_eq;</span><span class="id"> rewrite</span><span class="id"> ?qidmx_cap</span><span class="id"> ?capmxS</span><span class="id"> ?capmx_nopP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !unlock</span><span class="id"> capmx_nopP</span><span class="id"> capmx_nop_id;</span><span class="id"> do</span><span class="id"> 2?case:</span> (<span class="id">qidmx</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> n</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Monoid</span>.<span class="id">isComLaw</span>.<span class="id">Build</span> (<span class="id">matrix</span><span class="id"> F</span><span class="id"> n</span><span class="id"> n</span>)<span class="id"> 1%:M</span><span class="id"> capmx</span>.<span class="id">body</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@capmxA</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@capmxC</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@cap1mx</span><span class="id"> n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigcapmx_inf</span><span class="id"> i0</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">P</span><span class="id"> i0</span><span class="id"> -&gt;</span> (<span class="id">A_</span><span class="id"> i0</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> -&gt;</span><span class="id"> \bigcap_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Pi0;</span><span class="id"> apply:</span><span class="id"> submx_trans;</span><span class="id"> rewrite</span> (<span class="id">bigD1</span><span class="id"> i0</span>)<span class="id"> //</span><span class="id"> capmxSl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_bigcapmxP</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B_</span><span class="id"> i</span>)<span class="id">%MS</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> \bigcap_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B_</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [sAB</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> |</span><span class="id"> sAB]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">submx_trans</span><span class="id"> sAB</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">bigcapmx_inf</span><span class="id"> Pi</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> elim/big_rec:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Pi</span><span class="id"> C</span><span class="id"> sAC];</span><span class="id"> rewrite</span><span class="id"> ?submx1</span><span class="id"> //</span><span class="id"> sub_capmx</span><span class="id"> sAB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_bigcap</span><span class="id"> P</span><span class="id"> n</span> (<span class="id">A_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">&lt;&lt;\bigcap_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i&gt;&gt;</span><span class="id"> =</span><span class="id"> \bigcap_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> &lt;&lt;A_</span><span class="id"> i&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> _</span> (<span class="id">@genmx_cap</span><span class="id"> n</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">@genmx1</span><span class="id"> n</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> matrix_modl</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> +</span> (<span class="id">B</span><span class="id"> :&amp;:</span><span class="id"> C</span>)<span class="id"> :=:</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id"> :&amp;:</span><span class="id"> C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sAC;</span><span class="id"> set</span><span class="id"> D</span><span class="id"> :=</span> ((<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id"> :&amp;:</span><span class="id"> C</span>)<span class="id">%MS;</span><span class="id"> apply/eqmxP</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> addsmxS</span><span class="id"> ?capmxSl</span><span class="id"> //</span><span class="id"> addsmx_sub</span><span class="id"> sAC</span><span class="id"> capmxSr</span><span class="id"> /=</span>.<br/>
<span class="id">have:</span> (<span class="id">D</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> +</span><span class="id"> A</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addsmxC</span><span class="id"> capmxSl</span>.<br/>
<span class="id">case/sub_addsmxP=&gt;</span><span class="id"> u</span><span class="id"> defD;</span><span class="id"> rewrite</span><span class="id"> defD</span><span class="id"> addrC</span><span class="id"> addmx_sub_adds</span><span class="id"> ?submxMl</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> submxMl</span><span class="id"> -[_</span><span class="id"> *m</span><span class="id"> B]</span>(<span class="id">addrK</span> (<span class="id">u</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> A</span>))<span class="id"> -defD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addmx_sub</span><span class="id"> ?capmxSr</span><span class="id"> //</span><span class="id"> eqmx_opp</span><span class="id"> mulmx_sub</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> matrix_modr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">C</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">C</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id"> +</span><span class="id"> C</span><span class="id"> :=:</span><span class="id"> A</span><span class="id"> :&amp;:</span> (<span class="id">B</span><span class="id"> +</span><span class="id"> C</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">capmxC</span><span class="id"> A</span>)<span class="id"> -!</span>(<span class="id">addsmxC</span><span class="id"> C</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> matrix_modl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmx_compl</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> A^C</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> D</span><span class="id"> :=</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> A^C</span>)<span class="id">%MS;</span><span class="id"> have:</span> (<span class="id">D</span><span class="id"> &lt;=</span><span class="id"> D</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> []</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> andbC</span><span class="id"> =&gt;</span><span class="id"> /andP[/submxP[B</span><span class="id"> defB]]</span>.<br/>
<span class="id">rewrite</span><span class="id"> submxE</span><span class="id"> =&gt;</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> defB</span><span class="id"> -!mulmxA</span><span class="id"> mulKVmx</span><span class="id"> ?copid_mx_id</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> mul0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_mul_ker</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> B</span>)<span class="id"> +</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> kermx</span><span class="id"> B</span>))<span class="id">%N</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> set</span><span class="id"> K</span><span class="id"> :=</span><span class="id"> kermx</span><span class="id"> B;</span><span class="id"> set</span><span class="id"> C</span><span class="id"> :=</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> K</span>)<span class="id">%MS</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">eqmxMr</span><span class="id"> B</span> (<span class="id">eq_row_base</span><span class="id"> A</span>))<span class="id">;</span><span class="id"> set</span><span class="id"> K'</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> B</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{2}</span>(<span class="id">subnKC</span> (<span class="id">rank_leq_row</span><span class="id"> K'</span>))<span class="id"> -mxrank_ker</span><span class="id"> eqn_add2l</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mxrankMfree</span><span class="id"> _</span> (<span class="id">row_base_free</span><span class="id"> A</span>))<span class="id"> mxrank_leqif_sup</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> -</span>(<span class="id">eq_row_base</span><span class="id"> A</span>)<span class="id"> submxMl</span><span class="id"> sub_kermx</span><span class="id"> -mulmxA</span><span class="id"> mulmx_ker/=</span>.<br/>
<span class="id">have</span><span class="id"> /submxP[C'</span><span class="id"> defC]:</span> (<span class="id">C</span><span class="id"> &lt;=</span><span class="id"> row_base</span><span class="id"> A</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eq_row_base</span><span class="id"> capmxSl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> defC</span><span class="id"> submxMr</span><span class="id"> //</span><span class="id"> sub_kermx</span><span class="id"> mulmxA</span><span class="id"> -defC</span><span class="id"> -sub_kermx</span><span class="id"> capmxSr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_injP</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">f</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">n,</span><span class="id"> p</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">\rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>) ((<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> kermx</span><span class="id"> f</span>)<span class="id">%MS</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -mxrank_eq0</span><span class="id"> -</span>(<span class="id">eqn_add2l</span> (<span class="id">\rank</span> (<span class="id">A</span><span class="id"> *m</span><span class="id"> f</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxrank_mul_ker</span><span class="id"> addn0</span><span class="id"> eq_sym;</span><span class="id"> apply:</span><span class="id"> eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_disjoint_sum</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">\rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB0;</span><span class="id"> pose</span><span class="id"> Ar</span><span class="id"> :=</span><span class="id"> row_base</span><span class="id"> A;</span><span class="id"> pose</span><span class="id"> Br</span><span class="id"> :=</span><span class="id"> row_base</span><span class="id"> B</span>.<br/>
<span class="id">have</span><span class="id"> [Afree</span><span class="id"> Bfree]:</span><span class="id"> row_free</span><span class="id"> Ar</span><span class="id"> /\</span><span class="id"> row_free</span><span class="id"> Br</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !row_base_free</span>.<br/>
<span class="id">have:</span> (<span class="id">Ar</span><span class="id"> :&amp;:</span><span class="id"> Br</span><span class="id"> &lt;=</span><span class="id"> A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> capmxS</span><span class="id"> ?eq_row_base</span>.<br/>
<span class="id">rewrite</span><span class="id"> {}AB0</span><span class="id"> submx0</span><span class="id"> -mxrank_eq0</span><span class="id"> capmxE</span><span class="id"> mxrankMfree</span><span class="id"> //</span>.<br/>
<span class="id">set</span><span class="id"> Cr</span><span class="id"> :=</span><span class="id"> col_mx</span><span class="id"> Ar</span><span class="id"> Br;</span><span class="id"> set</span><span class="id"> Crl</span><span class="id"> :=</span><span class="id"> lsubmx</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mxrank_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> Crl0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">adds_eqmx</span> (<span class="id">eq_row_base</span><span class="id"> _</span>) (<span class="id">eq_row_base</span><span class="id"> _</span>))<span class="id"> addsmxE</span><span class="id"> -/Cr</span>.<br/>
<span class="id">suffices</span><span class="id"> K0:</span><span class="id"> kermx</span><span class="id"> Cr</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_row</span><span class="id"> -subn_eq0</span><span class="id"> -mxrank_ker</span><span class="id"> K0</span><span class="id"> mxrank0</span>.<br/>
<span class="id">move/eqP:</span> (<span class="id">mulmx_ker</span><span class="id"> Cr</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> -[kermx</span><span class="id"> Cr]hsubmxK</span><span class="id"> mul_row_col</span><span class="id"> -/Crl</span><span class="id"> Crl0</span>.<br/>
<span class="id">rewrite</span><span class="id"> mul0mx</span><span class="id"> add0r</span><span class="id"> -mxrank_eq0</span><span class="id"> mxrankMfree</span><span class="id"> //</span><span class="id"> mxrank_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;</span>.<br/>
<span class="id">exact:</span><span class="id"> row_mx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diffmxE</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> A</span><span class="id"> :&amp;:</span> (<span class="id">capmx_gen</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">^C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unlock;</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !genmxE</span><span class="id"> !capmxE</span><span class="id"> andbb</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_diff</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">&lt;&lt;A</span><span class="id"> :\:</span><span class="id"> B&gt;&gt;</span><span class="id"> =</span><span class="id"> A</span><span class="id"> :\:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [@diffmx]unlock</span><span class="id"> genmx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diffmxSl</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span><span class="id"> &lt;=</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> diffmxE</span><span class="id"> capmxSl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> capmx_diff</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span>)<span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> pose</span><span class="id"> C</span><span class="id"> :=</span><span class="id"> capmx_gen</span><span class="id"> A</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> -submx0</span><span class="id"> -</span>(<span class="id">capmx_compl</span><span class="id"> C</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> -capmxE</span><span class="id"> sub_capmx</span><span class="id"> andbAC</span><span class="id"> -sub_capmx</span><span class="id"> -diffmxE</span><span class="id"> -sub_capmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addsmx_diff_cap_eq</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span><span class="id"> +</span><span class="id"> A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> addsmx_sub</span><span class="id"> capmxSl</span><span class="id"> diffmxSl</span><span class="id"> /=</span>.<br/>
<span class="id">set</span><span class="id"> C</span><span class="id"> :=</span> (<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span>)<span class="id">%MS;</span><span class="id"> set</span><span class="id"> D</span><span class="id"> :=</span><span class="id"> capmx_gen</span><span class="id"> A</span><span class="id"> B</span>.<br/>
<span class="id">suffices</span><span class="id"> sACD:</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> C</span><span class="id"> +</span><span class="id"> D</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">submx_trans</span><span class="id"> sACD</span>)<span class="id"> ?addsmxS</span><span class="id"> ?capmxE</span>.<br/>
<span class="id">have:=</span><span class="id"> addsmx_compl_full</span><span class="id"> D;</span><span class="id"> rewrite</span><span class="id"> /row_full</span><span class="id"> addsmxE</span>.<br/>
<span class="id">case/row_fullP=&gt;</span><span class="id"> U</span><span class="id"> /</span>(<span class="id">congr1</span> (<span class="id">mulmx</span><span class="id"> A</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulmx1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[U]hsubmxK</span><span class="id"> mul_row_col</span><span class="id"> mulmxDr</span><span class="id"> addrC</span><span class="id"> 2!mulmxA</span>.<br/>
<span class="id">set</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> defA;</span><span class="id"> rewrite</span><span class="id"> -defA;</span><span class="id"> move/</span>(<span class="id">canRL</span> (<span class="id">addrK</span><span class="id"> _</span>))<span class="id">:</span><span class="id"> defA</span><span class="id"> =&gt;</span><span class="id"> defV</span>.<br/>
<span class="id">suffices</span><span class="id"> /submxP[W</span><span class="id"> -&gt;]:</span> (<span class="id">V</span><span class="id"> &lt;=</span><span class="id"> C</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mul_row_col</span><span class="id"> addsmxE</span><span class="id"> submxMl</span>.<br/>
<span class="id">rewrite</span><span class="id"> diffmxE</span><span class="id"> sub_capmx</span><span class="id"> {1}defV</span><span class="id"> -mulNmx</span><span class="id"> addmx_sub</span><span class="id"> 1?mulmx_sub</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -capmxE</span><span class="id"> capmxSl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_cap_compl</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\rank</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id"> +</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span>))<span class="id">%N</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> addnC</span><span class="id"> -mxrank_disjoint_sum</span><span class="id"> ?addsmx_diff_cap_eq</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">capmxC</span><span class="id"> A</span>)<span class="id"> capmxA</span><span class="id"> capmx_diff</span><span class="id"> cap0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_sum_cap</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\rank</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id"> +</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> C</span><span class="id"> :=</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">%MS;</span><span class="id"> set</span><span class="id"> D</span><span class="id"> :=</span> (<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<span class="id">have</span><span class="id"> rDB:</span><span class="id"> \rank</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span><span class="id"> =</span><span class="id"> \rank</span> (<span class="id">D</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> mxrank_leqif_sup;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addsmxS</span><span class="id"> ?diffmxSl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addsmx_sub</span><span class="id"> addsmxSr</span><span class="id"> -</span>(<span class="id">addsmx_diff_cap_eq</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> addsmxS</span><span class="id"> ?capmxSr</span>.<br/>
<span class="id">rewrite</span><span class="id"> {1}rDB</span><span class="id"> mxrank_disjoint_sum</span><span class="id"> ?capmx_diff</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addnC</span><span class="id"> addnA</span><span class="id"> mxrank_cap_compl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_adds_leqif</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id"> &lt;=</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span><span class="id"> ?=</span><span class="id"> iff</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> &lt;=</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_n</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -mxrank_sum_cap;</span><span class="id"> split;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> leq_addr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addnC</span> (<span class="id">@eqn_add2r</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> eq_sym</span><span class="id"> mxrank_eq0</span><span class="id"> -submx0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_col_mx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">col_mx</span><span class="id"> A</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> n</span>)))<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -addsmxE</span><span class="id"> addsmx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_col_0mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">col_mx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> n</span>))<span class="id"> A</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -addsmxE</span><span class="id"> adds0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_row_mx0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">row_mx</span><span class="id"> A</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>)))<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mxrank_tr</span><span class="id"> -[RHS]mxrank_tr</span><span class="id"> tr_row_mx</span><span class="id"> trmx0</span><span class="id"> rank_col_mx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_row_0mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">row_mx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> p</span>))<span class="id"> A</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -mxrank_tr</span><span class="id"> -[RHS]mxrank_tr</span><span class="id"> tr_row_mx</span><span class="id"> trmx0</span><span class="id"> rank_col_0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_diag_block_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> p</span><span class="id"> q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">p,</span><span class="id"> q</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">block_mx</span><span class="id"> A</span><span class="id"> 0</span><span class="id"> 0</span><span class="id"> B</span>)<span class="id"> =</span> (<span class="id">\rank</span><span class="id"> A</span><span class="id"> +</span><span class="id"> \rank</span><span class="id"> B</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> block_mxEv</span><span class="id"> -addsmxE</span><span class="id"> mxrank_disjoint_sum</span><span class="id"> ?rank_row_mx0</span><span class="id"> ?rank_row_0mx//</span>.<br/>
<span class="id">apply/eqP/rowV0P</span><span class="id"> =&gt;</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> =&gt;</span><span class="id"> /andP[/submxP[x</span><span class="id"> -&gt;]]</span>.<br/>
<span class="id">rewrite</span><span class="id"> mul_mx_row</span><span class="id"> mulmx0</span><span class="id"> =&gt;</span><span class="id"> /submxP[y];</span><span class="id"> rewrite</span><span class="id"> mul_mx_row</span><span class="id"> mulmx0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /eq_row_mx[-&gt;</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> row_mx0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> proj_mx_sub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> U</span><span class="id"> V</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">W</span><span class="id"> *m</span><span class="id"> proj_mx</span><span class="id"> U</span><span class="id"> V</span><span class="id"> &lt;=</span><span class="id"> U</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulmx_sub</span><span class="id"> //</span><span class="id"> -addsmxE</span><span class="id"> addsmx0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> proj_mx_compl_sub</span><span class="id"> m</span><span class="id"> n</span><span class="id"> U</span><span class="id"> V</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">W</span><span class="id"> &lt;=</span><span class="id"> U</span><span class="id"> +</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> W</span><span class="id"> -</span><span class="id"> W</span><span class="id"> *m</span><span class="id"> proj_mx</span><span class="id"> U</span><span class="id"> V</span><span class="id"> &lt;=</span><span class="id"> V</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> addsmxE</span><span class="id"> =&gt;</span><span class="id"> sWUV;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> -{1}</span>(<span class="id">mulmxKpV</span><span class="id"> sWUV</span>)<span class="id"> -mulmxBr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmx_sub</span><span class="id"> //</span><span class="id"> opp_col_mx</span><span class="id"> add_col_mx</span><span class="id"> subrr</span><span class="id"> subr0</span><span class="id"> -addsmxE</span><span class="id"> adds0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> proj_mx_id</span><span class="id"> m</span><span class="id"> n</span><span class="id"> U</span><span class="id"> V</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :&amp;:</span><span class="id"> V</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">W</span><span class="id"> &lt;=</span><span class="id"> U</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> W</span><span class="id"> *m</span><span class="id"> proj_mx</span><span class="id"> U</span><span class="id"> V</span><span class="id"> =</span><span class="id"> W</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dxUV</span><span class="id"> sWU;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> -submx0</span><span class="id"> -dxUV</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> addmx_sub</span><span class="id"> ?eqmx_opp</span><span class="id"> ?proj_mx_sub</span><span class="id"> //=</span><span class="id"> -eqmx_opp</span><span class="id"> opprB</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> proj_mx_compl_sub</span><span class="id"> //</span> (<span class="id">submx_trans</span><span class="id"> sWU</span>)<span class="id"> ?addsmxSl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> proj_mx_0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> U</span><span class="id"> V</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :&amp;:</span><span class="id"> V</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">W</span><span class="id"> &lt;=</span><span class="id"> V</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> W</span><span class="id"> *m</span><span class="id"> proj_mx</span><span class="id"> U</span><span class="id"> V</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dxUV</span><span class="id"> sWV;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -submx0</span><span class="id"> -dxUV</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> proj_mx_sub</span><span class="id"> /=</span><span class="id"> -[_</span><span class="id"> *m</span><span class="id"> _]</span>(<span class="id">subrK</span><span class="id"> W</span>)<span class="id"> addmx_sub</span><span class="id"> //</span><span class="id"> -eqmx_opp</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> opprB</span><span class="id"> proj_mx_compl_sub</span><span class="id"> //</span> (<span class="id">submx_trans</span><span class="id"> sWV</span>)<span class="id"> ?addsmxSr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_proj_mx</span><span class="id"> m</span><span class="id"> n</span><span class="id"> U</span><span class="id"> V</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">U</span><span class="id"> :&amp;:</span><span class="id"> V</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">W</span><span class="id"> &lt;=</span><span class="id"> U</span><span class="id"> +</span><span class="id"> V</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">W</span><span class="id"> *m</span><span class="id"> proj_mx</span><span class="id"> U</span><span class="id"> V</span><span class="id"> +</span><span class="id"> W</span><span class="id"> *m</span><span class="id"> proj_mx</span><span class="id"> V</span><span class="id"> U</span><span class="id"> =</span><span class="id"> W</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dxUV</span><span class="id"> sWUV;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> -submx0</span><span class="id"> -dxUV</span>.<br/>
<span class="id">rewrite</span><span class="id"> -addrA</span><span class="id"> sub_capmx</span><span class="id"> {2}addrCA</span><span class="id"> -!</span>(<span class="id">opprB</span><span class="id"> W</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !{1}addmx_sub</span><span class="id"> ?proj_mx_sub</span><span class="id"> ?eqmx_opp</span><span class="id"> ?proj_mx_compl_sub</span><span class="id"> //</span><span class="id"> addsmxC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> proj_mx_proj</span><span class="id"> n</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> P</span><span class="id"> :=</span><span class="id"> proj_mx</span><span class="id"> U</span><span class="id"> V</span><span class="gallina-kwd"> in</span> (<span class="id">U</span><span class="id"> :&amp;:</span><span class="id"> V</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> *m</span><span class="id"> P</span><span class="id"> =</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> dxUV;</span><span class="id"> rewrite</span><span class="id"> -[P</span><span class="gallina-kwd"> in</span><span class="id"> P</span><span class="id"> *m</span><span class="id"> _]mul1mx</span><span class="id"> proj_mx_id</span><span class="id"> ?proj_mx_sub</span><span class="id"> ?mul1mx</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> complete_unitmx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">f</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">U</span><span class="id"> *m</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> {g</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> |</span><span class="id"> g</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> &amp;</span><span class="id"> U</span><span class="id"> *m</span><span class="id"> f</span><span class="id"> =</span><span class="id"> U</span><span class="id"> *m</span><span class="id"> g}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> injfU;</span><span class="id"> pose</span><span class="id"> V</span><span class="id"> :=</span><span class="id"> &lt;&lt;U&gt;&gt;%MS;</span><span class="id"> pose</span><span class="id"> W</span><span class="id"> :=</span><span class="id"> V</span><span class="id"> *m</span><span class="id"> f</span>.<br/>
<span class="id">pose</span><span class="id"> g</span><span class="id"> :=</span><span class="id"> proj_mx</span><span class="id"> V</span> (<span class="id">V^C</span>)<span class="id">%MS</span><span class="id"> *m</span><span class="id"> f</span><span class="id"> +</span><span class="id"> cokermx</span><span class="id"> V</span><span class="id"> *m</span><span class="id"> row_ebase</span><span class="id"> W</span>.<br/>
<span class="id">have</span><span class="id"> defW:</span><span class="id"> V</span><span class="id"> *m</span><span class="id"> g</span><span class="id"> =</span><span class="id"> W</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulmxDr</span><span class="id"> mulmxA</span><span class="id"> proj_mx_id</span><span class="id"> ?genmxE</span><span class="id"> ?capmx_compl</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> mulmx_coker</span><span class="id"> mul0mx</span><span class="id"> addr0</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> g;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> /submxP[u</span><span class="id"> -&gt;]:</span> (<span class="id">U</span><span class="id"> &lt;=</span><span class="id"> V</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> genmxE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!mulmxA</span><span class="id"> defW</span>.<br/>
<span class="id">rewrite</span><span class="id"> -row_full_unit</span><span class="id"> -sub1mx;</span><span class="id"> apply/submxP</span>.<br/>
<span class="id">have:</span> (<span class="id">invmx</span> (<span class="id">col_ebase</span><span class="id"> W</span>)<span class="id"> *m</span><span class="id"> W</span><span class="id"> &lt;=</span><span class="id"> V</span><span class="id"> *m</span><span class="id"> g</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> defW</span><span class="id"> submxMl</span>.<br/>
<span class="id">case/submxP=&gt;</span><span class="id"> v</span><span class="id"> def_v;</span><span class="gallina-kwd"> exists</span> (<span class="id">invmx</span> (<span class="id">row_ebase</span><span class="id"> W</span>)<span class="id"> *m</span> (<span class="id">v</span><span class="id"> *m</span><span class="id"> V</span><span class="id"> +</span> (<span class="id">V^C</span>)<span class="id">%MS</span>)).<br/>
<span class="id">rewrite</span><span class="id"> -mulmxA</span><span class="id"> mulmxDl</span><span class="id"> -mulmxA</span><span class="id"> -def_v</span><span class="id"> -{3}[W]mulmx_ebase</span><span class="id"> -mulmxA</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulKmx</span><span class="id"> ?col_ebase_unit</span><span class="id"> //</span><span class="id"> [_</span><span class="id"> *m</span><span class="id"> g]mulmxDr</span><span class="id"> mulmxA</span>.<br/>
<span class="id">rewrite</span> (<span class="id">proj_mx_0</span> (<span class="id">capmx_compl</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> mul0mx</span><span class="id"> add0r</span><span class="id"> 2!mulmxA</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmxK</span><span class="id"> ?row_ebase_unit</span><span class="id"> //</span><span class="id"> copid_mx_id</span><span class="id"> ?rank_leq_row</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span> (<span class="id">eqmxMr</span><span class="id"> _</span> (<span class="id">genmxE</span><span class="id"> U</span>))<span class="id"> injfU</span><span class="id"> genmxE</span><span class="id"> addrC</span><span class="id"> -mulmxDl</span><span class="id"> subrK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul1mx</span><span class="id"> mulVmx</span><span class="id"> ?row_ebase_unit</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmxMunitP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> P,</span><span class="id"> P</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> &amp;</span><span class="id"> U</span><span class="id"> =</span><span class="id"> P</span><span class="id"> *m</span><span class="id"> V</span>) (<span class="id">U</span><span class="id"> ==</span><span class="id"> V</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> eqmxP</span>)<span class="id"> =&gt;</span><span class="id"> [eqUV</span><span class="id"> |</span><span class="id"> [P</span><span class="id"> Punit</span><span class="id"> -&gt;]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqmxMfull;</span><span class="id"> rewrite</span><span class="id"> row_full_unit</span>.<br/>
<span class="id">have</span><span class="id"> [D</span><span class="id"> defU]:</span><span class="gallina-kwd"> exists</span><span class="id"> D,</span><span class="id"> U</span><span class="id"> =</span><span class="id"> D</span><span class="id"> *m</span><span class="id"> V</span><span class="gallina-kwd"> by</span><span class="id"> apply/submxP;</span><span class="id"> rewrite</span><span class="id"> eqUV</span>.<br/>
<span class="id">have{eqUV}</span><span class="id"> [Pt</span><span class="id"> Pt_unit</span><span class="id"> defUt]:</span><span class="id"> {Pt</span><span class="id"> |</span><span class="id"> Pt</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> &amp;</span><span class="id"> V^T</span><span class="id"> *m</span><span class="id"> D^T</span><span class="id"> =</span><span class="id"> V^T</span><span class="id"> *m</span><span class="id"> Pt}</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/complete_unitmx;</span><span class="id"> rewrite</span><span class="id"> -trmx_mul</span><span class="id"> -defU</span><span class="id"> !mxrank_tr</span><span class="id"> eqUV</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> Pt^T;</span><span class="id"> last</span><span class="id"> apply/trmx_inj;</span><span class="id"> rewrite</span><span class="id"> ?unitmx_tr</span><span class="id"> //</span><span class="id"> defU</span><span class="id"> !trmx_mul</span><span class="id"> trmxK</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_rank_unitmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">V</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span><span class="id"> U</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> {f</span><span class="id"> :</span><span class="id"> 'M_n</span><span class="id"> |</span><span class="id"> f</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> &amp;</span><span class="id"> V</span><span class="id"> :=:</span><span class="id"> U</span><span class="id"> *m</span><span class="id"> f}%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqrUV;</span><span class="id"> pose</span><span class="id"> f</span><span class="id"> :=</span><span class="id"> invmx</span> (<span class="id">row_ebase</span><span class="id"> &lt;&lt;U&gt;&gt;%MS</span>)<span class="id"> *m</span><span class="id"> row_ebase</span><span class="id"> &lt;&lt;V&gt;&gt;%MS</span>.<br/>
<span class="id">have</span><span class="id"> defUf:</span> (<span class="id">&lt;&lt;U&gt;&gt;</span><span class="id"> *m</span><span class="id"> f</span><span class="id"> :=:</span><span class="id"> &lt;&lt;V&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[&lt;&lt;U&gt;&gt;%MS]mulmx_ebase</span><span class="id"> mulmxA</span><span class="id"> mulmxK</span><span class="id"> ?row_ebase_unit</span><span class="id"> //</span><span class="id"> -mulmxA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> genmxE</span><span class="id"> eqrUV</span><span class="id"> -genmxE</span><span class="id"> -{3}[&lt;&lt;V&gt;&gt;%MS]mulmx_ebase</span><span class="id"> -mulmxA</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">pid_mx</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> W;</span><span class="id"> apply/eqmxP</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !eqmxMfull</span><span class="id"> ?andbb</span><span class="id"> //</span><span class="id"> row_full_unit</span><span class="id"> col_ebase_unit</span>.<br/>
<span class="id">have{defUf}</span><span class="id"> defV:</span> (<span class="id">V</span><span class="id"> :=:</span><span class="id"> U</span><span class="id"> *m</span><span class="id"> f</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">eqmxMr</span><span class="id"> f</span> (<span class="id">genmxE</span><span class="id"> U</span>))<span class="id"> !defUf</span><span class="id"> !genmxE</span><span class="id"> andbb</span>.<br/>
<span class="id">have</span><span class="id"> injfU:</span><span class="id"> \rank</span> (<span class="id">U</span><span class="id"> *m</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> \rank</span><span class="id"> U</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -defV</span><span class="id"> eqrUV</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [g</span><span class="id"> injg</span><span class="id"> defUg]</span><span class="id"> :=</span><span class="id"> complete_unitmx</span><span class="id"> injfU;</span><span class="gallina-kwd"> exists</span><span class="id"> g;</span><span class="id"> rewrite</span><span class="id"> -?defUg</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MaxRankSubMatrix</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> maxrankfun</span><span class="id"> :</span><span class="id"> 'I_m</span><span class="id"> ^</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[arg</span><span class="id"> max_</span>(<span class="id">f</span><span class="id"> &gt;</span><span class="id"> finfun</span> (<span class="id">widen_ord</span> (<span class="id">rank_leq_row</span><span class="id"> A</span>)))<span class="id"> \rank</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id">]</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> mxf</span><span class="id"> :=</span><span class="id"> maxrankfun</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxrowsub_free</span><span class="id"> :</span><span class="id"> row_free</span> (<span class="id">rowsub</span><span class="id"> mxf</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxf;</span><span class="id"> case:</span><span class="id"> arg_maxnP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> f</span><span class="id"> _</span><span class="id"> fM;</span><span class="id"> apply/negP</span><span class="id"> =&gt;</span><span class="id"> /negP</span><span class="id"> rfA</span>.<br/>
<span class="id">have</span><span class="id"> [i</span><span class="id"> NriA]</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> ~~</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> rowsub</span><span class="id"> f</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/row_subPn;</span><span class="id"> apply:</span><span class="id"> contraNN</span><span class="id"> rfA</span><span class="id"> =&gt;</span><span class="id"> /mxrankS;</span><span class="id"> rewrite</span><span class="id"> row_leq_rank</span>.<br/>
<span class="id">have</span><span class="id"> [j</span><span class="id"> rjfA]</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> j,</span> (<span class="id">row</span> (<span class="id">f</span><span class="id"> j</span>)<span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> rowsub</span> (<span class="id">f</span><span class="id"> \o</span><span class="id"> lift</span><span class="id"> j</span>)<span class="id"> A</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="id">case/row_freePn:</span><span class="id"> rfA</span><span class="id"> =&gt;</span><span class="id"> j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> row_rowsub</span><span class="id"> row'Esub</span><span class="id"> -mxsub_comp;</span><span class="gallina-kwd"> exists</span><span class="id"> j</span>.<br/>
<span class="id">pose</span><span class="id"> g</span><span class="id"> :</span><span class="id"> 'I_m</span><span class="id"> ^</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> finfun</span><span class="id"> [eta</span><span class="id"> f</span><span class="gallina-kwd"> with</span><span class="id"> j</span><span class="id"> |-&gt;</span><span class="id"> i]</span>.<br/>
<span class="id">suff:</span> (<span class="id">rowsub</span><span class="id"> f</span><span class="id"> A</span><span class="id"> &lt;</span><span class="id"> rowsub</span><span class="id"> g</span><span class="id"> A</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltmxErank</span><span class="id"> andbC</span><span class="id"> ltnNge</span><span class="id"> fM</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltmxE;</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contra</span><span class="id"> NriA;</span><span class="id"> apply:</span><span class="id"> submx_trans</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eq_row_sub</span><span class="id"> j</span>)<span class="id">//</span><span class="id"> row_rowsub</span><span class="id"> ffunE/=</span><span class="id"> eqxx</span>.<br/>
<span class="id">apply/row_subP</span><span class="id"> =&gt;</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> !row_rowsub</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|/negPf</span><span class="id"> eq_kjF]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> k</span><span class="id"> j;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">eq_row_sub</span><span class="id"> k</span>)<span class="id">//</span><span class="id"> row_rowsub</span><span class="id"> ffunE/=</span><span class="id"> eq_kjF</span>.<br/>
<span class="id">rewrite</span> (<span class="id">submx_trans</span><span class="id"> rjfA</span>)<span class="id">//</span> (<span class="id">submx_rowsub</span> (<span class="id">lift</span><span class="id"> j</span>))<span class="id">//</span><span class="id"> =&gt;</span><span class="id"> l</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ffunE/=</span><span class="id"> eq_sym</span> (<span class="id">negPf</span> (<span class="id">neq_lift</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_maxrowsub</span><span class="id"> :</span> (<span class="id">rowsub</span><span class="id"> mxf</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">eq_leqif</span> (<span class="id">mxrank_leqif_eq</span><span class="id"> _</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> maxrowsub_free</span>.<br/>
<span class="id">apply/row_subP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> apply/submxP;</span><span class="gallina-kwd"> exists</span> (<span class="id">delta_mx</span><span class="id"> 0</span> (<span class="id">mxf</span><span class="id"> i</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -rowE;</span><span class="id"> apply/rowP</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !mxE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxrankfun_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> mxf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> eqAij;</span><span class="id"> have</span><span class="id"> /row_free_inj</span><span class="id"> :=</span><span class="id"> maxrowsub_free</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /</span>(_<span class="id"> 1</span>)<span class="id"> /</span>(_ (<span class="id">delta_mx</span><span class="id"> 0</span><span class="id"> i</span>) (<span class="id">delta_mx</span><span class="id"> 0</span><span class="id"> j</span>)).<br/>
<span class="id">rewrite</span><span class="id"> -!rowE</span><span class="id"> !row_rowsub</span><span class="id"> eqAij</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> erefl</span>)<span class="id"> /matrixP</span><span class="id"> /</span>(_<span class="id"> 0</span><span class="id"> i</span>)<span class="id"> /eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> !eqxx/=;</span><span class="id"> case:</span> (<span class="id">i</span><span class="id"> =P</span><span class="id"> j</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Variable</span> (<span class="id">rkA</span><span class="id"> :</span><span class="id"> row_full</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxrowsub_full</span><span class="id"> :</span><span class="id"> row_full</span> (<span class="id">rowsub</span><span class="id"> mxf</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_full</span><span class="id"> eq_maxrowsub</span>. Qed.</div></details>
<span class="vernacular">Hint</span><span class="id"> Resolve</span><span class="id"> maxrowsub_full</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> fullrankfun</span><span class="id"> :</span><span class="id"> 'I_m</span><span class="id"> ^</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> finfun</span> (<span class="id">mxf</span><span class="id"> \o</span><span class="id"> cast_ord</span> (<span class="id">esym</span> (<span class="id">eqP</span><span class="id"> rkA</span>))).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> frf</span><span class="id"> :=</span><span class="id"> fullrankfun</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fullrowsub_full</span><span class="id"> :</span><span class="id"> row_full</span> (<span class="id">rowsub</span><span class="id"> frf</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxsub_ffunl</span><span class="id"> rowsub_comp</span><span class="id"> rowsub_cast</span><span class="id"> esymK</span><span class="id"> row_full_castmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fullrowsub_unit</span><span class="id"> :</span><span class="id"> rowsub</span><span class="id"> frf</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> unitmx</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -row_full_unit</span><span class="id"> fullrowsub_full</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fullrowsub_free</span><span class="id"> :</span><span class="id"> row_free</span> (<span class="id">rowsub</span><span class="id"> frf</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
 <span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> row_free_unit</span><span class="id"> fullrowsub_unit</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_fullrowsub</span><span class="id"> :</span><span class="id"> \rank</span> (<span class="id">rowsub</span><span class="id"> frf</span><span class="id"> A</span>)<span class="id"> =</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/eqP/fullrowsub_full</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_fullrowsub</span><span class="id"> :</span> (<span class="id">rowsub</span><span class="id"> frf</span><span class="id"> A</span><span class="id"> :=:</span><span class="id"> A</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxsub_ffunl</span><span class="id"> rowsub_comp</span><span class="id"> rowsub_cast</span><span class="id"> esymK</span>.<br/>
<span class="id">exact:</span> (<span class="id">eqmx_trans</span> (<span class="id">eqmx_cast</span><span class="id"> _</span><span class="id"> _</span>)<span class="id"> eq_maxrowsub</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fullrankfun_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> frf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> j;</span><span class="id"> rewrite</span><span class="id"> !ffunE</span><span class="id"> =&gt;</span><span class="id"> /maxrankfun_inj</span><span class="id"> /</span>(<span class="id">congr1</span><span class="id"> val</span>)<span class="id">/=</span><span class="id"> /val_inj</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MaxRankSubMatrix</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SumExpr</span>.<br/>
<br/>
<br/>
<span class="vernacular">Inductive</span><span class="id"> mxsum_spec</span><span class="id"> n</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> m,</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;<span class="id">|</span><span class="id"> TrivialMxsum</span><span class="id"> m</span><span class="id"> A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">:</span><span class="id"> @mxsum_spec</span><span class="id"> n</span><span class="id"> m</span><span class="id"> A</span> (<span class="id">\rank</span><span class="id"> A</span>)<br/>
&nbsp;<span class="id">|</span><span class="id"> ProperMxsum</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> T1</span><span class="id"> T2</span><span class="id"> r1</span><span class="id"> r2</span><span class="id"> of</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">@mxsum_spec</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> T1</span><span class="id"> r1</span><span class="id"> &amp;</span><span class="id"> @mxsum_spec</span><span class="id"> n</span><span class="id"> m2</span><span class="id"> T2</span><span class="id"> r2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">:</span><span class="id"> mxsum_spec</span> (<span class="id">T1</span><span class="id"> +</span><span class="id"> T2</span>)<span class="id">%MS</span> (<span class="id">r1</span><span class="id"> +</span><span class="id"> r2</span>)<span class="id">%N</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxsum_spec</span><span class="id"> {n%_N</span><span class="id"> m%_N}</span><span class="id"> T%_MS</span><span class="id"> r%_N</span>.<br/>
<br/>
<span class="vernacular">Structure</span><span class="id"> mxsum_expr</span><span class="id"> m</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> Mxsum</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">mxsum_val</span><span class="id"> :&gt;</span><span class="id"> wrapped</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">mxsum_rank</span><span class="id"> :</span><span class="id"> wrapped</span><span class="id"> nat;</span><br/>
&nbsp;&nbsp;_<span class="id"> :</span><span class="id"> mxsum_spec</span> (<span class="id">unwrap</span><span class="id"> mxsum_val</span>) (<span class="id">unwrap</span><span class="id"> mxsum_rank</span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Canonical</span><span class="id"> trivial_mxsum</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">@Mxsum</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">Wrap</span><span class="id"> A</span>) (<span class="id">Wrap</span> (<span class="id">\rank</span><span class="id"> A</span>)) (<span class="id">TrivialMxsum</span><span class="id"> A</span>).<br/>
<br/>
<span class="vernacular">Structure</span><span class="id"> proper_mxsum_expr</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> ProperMxsumExpr</span><span class="id"> {</span><br/>
&nbsp;&nbsp;<span class="id">proper_mxsum_val</span><span class="id"> :&gt;</span><span class="id"> 'M_n;</span><br/>
&nbsp;&nbsp;<span class="id">proper_mxsum_rank</span><span class="id"> :</span><span class="id"> nat;</span><br/>
&nbsp;&nbsp;_<span class="id"> :</span><span class="id"> mxsum_spec</span><span class="id"> proper_mxsum_val</span><span class="id"> proper_mxsum_rank</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> proper_mxsumP</span><span class="id"> n</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> proper_mxsum_expr</span><span class="id"> n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">let:</span><span class="id"> ProperMxsumExpr</span><span class="id"> _</span><span class="id"> _</span><span class="id"> termS</span><span class="id"> :=</span><span class="id"> S</span><span class="gallina-kwd"> return</span><span class="id"> mxsum_spec</span><span class="id"> S</span> (<span class="id">proper_mxsum_rank</span><span class="id"> S</span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">in</span><span class="id"> termS</span>.<br/>
<br/>
<span class="vernacular">Canonical</span><span class="id"> sum_mxsum</span><span class="id"> n</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> proper_mxsum_expr</span><span class="id"> n</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">@Mxsum</span><span class="id"> n</span><span class="id"> n</span> (<span class="id">wrap</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> 'M_n</span>)) (<span class="id">wrap</span> (<span class="id">proper_mxsum_rank</span><span class="id"> S</span>)) (<span class="id">proper_mxsumP</span><span class="id"> S</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Binary</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">S1</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m1</span><span class="id"> n</span>) (<span class="id">S2</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m2</span><span class="id"> n</span>).<br/>
<span class="vernacular">Fact</span><span class="id"> binary_mxsum_proof</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsum_spec</span> (<span class="id">unwrap</span><span class="id"> S1</span><span class="id"> +</span><span class="id"> unwrap</span><span class="id"> S2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">unwrap</span> (<span class="id">mxsum_rank</span><span class="id"> S1</span>)<span class="id"> +</span><span class="id"> unwrap</span> (<span class="id">mxsum_rank</span><span class="id"> S2</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> S1</span><span class="id"> S2</span><span class="id"> =&gt;</span><span class="id"> [A1</span><span class="id"> r1</span><span class="id"> A1P]</span><span class="id"> [A2</span><span class="id"> r2</span><span class="id"> A2P];</span><span class="id"> right</span>. Qed.</div></details>
<span class="vernacular">Canonical</span><span class="id"> binary_mxsum_expr</span><span class="id"> :=</span><span class="id"> ProperMxsumExpr</span><span class="id"> binary_mxsum_proof</span>.<br/>
<span class="vernacular">End</span><span class="id"> Binary</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Nary</span>.<br/>
<span class="vernacular">Context</span><span class="id"> J</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> J</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> J</span>)<span class="id"> n</span> (<span class="id">S_</span><span class="id"> :</span><span class="id"> J</span><span class="id"> -&gt;</span><span class="id"> mxsum_expr</span><span class="id"> n</span><span class="id"> n</span>).<br/>
<span class="vernacular">Fact</span><span class="id"> nary_mxsum_proof</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxsum_spec</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> unwrap</span> (<span class="id">S_</span><span class="id"> j</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> unwrap</span> (<span class="id">mxsum_rank</span> (<span class="id">S_</span><span class="id"> j</span>))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/big_rec2:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|j];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mxrank0</span><span class="id"> n</span><span class="id"> n</span>)<span class="id">;</span><span class="id"> left</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">S_</span><span class="id"> j</span>)<span class="id">;</span><span class="id"> right</span>.<br/>
Qed.</div></details>
<span class="vernacular">Canonical</span><span class="id"> nary_mxsum_expr</span><span class="id"> :=</span><span class="id"> ProperMxsumExpr</span><span class="id"> nary_mxsum_proof</span>.<br/>
<span class="vernacular">End</span><span class="id"> Nary</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxdirect_def</span><span class="id"> m</span><span class="id"> n</span><span class="id"> T</span><span class="id"> of</span><span class="id"> phantom</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>) (<span class="id">unwrap</span> (<span class="id">mxsum_val</span><span class="id"> T</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">unwrap</span><span class="id"> T</span>)<span class="id"> ==</span><span class="id"> unwrap</span> (<span class="id">mxsum_rank</span><span class="id"> T</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> SumExpr</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> mxdirect</span><span class="id"> A</span><span class="id"> :=</span> (<span class="id">mxdirect_def</span> (<span class="id">Phantom</span><span class="id"> 'M_</span>(<span class="id">_,_</span>)<span class="id"> A%MS</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirectP</span><span class="id"> n</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> proper_mxsum_expr</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">\rank</span><span class="id"> S</span><span class="id"> =</span><span class="id"> proper_mxsum_rank</span><span class="id"> S</span>) (<span class="id">mxdirect</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eqnP</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> mxdirectP</span><span class="id"> {n</span><span class="id"> S}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_trivial</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> :</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span> (<span class="id">@trivial_mxsum</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_sum_leqif</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\rank</span> (<span class="id">unwrap</span><span class="id"> S</span>)<span class="id"> &lt;=</span><span class="id"> unwrap</span> (<span class="id">mxsum_rank</span><span class="id"> S</span>)<span class="id"> ?=</span><span class="id"> iff</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mxdirect_def;</span><span class="id"> case:</span><span class="id"> S</span><span class="id"> =&gt;</span><span class="id"> [[A]</span><span class="id"> [r]</span><span class="id"> /=</span><span class="id"> defAr];</span><span class="id"> split=&gt;</span><span class="id"> //=</span>.<br/>
<span class="id">elim:</span><span class="id"> m</span><span class="id"> A</span><span class="id"> r</span><span class="id"> /</span><span class="id"> defAr</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> r1</span><span class="id"> r2</span><span class="id"> _</span><span class="id"> leAr1</span><span class="id"> _</span><span class="id"> leAr2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> leq_trans</span> (<span class="id">leq_add</span><span class="id"> leAr1</span><span class="id"> leAr2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mxrank_adds_leqif</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirectE</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxdirect</span> (<span class="id">unwrap</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">\rank</span> (<span class="id">unwrap</span><span class="id"> S</span>)<span class="id"> ==</span><span class="id"> unwrap</span> (<span class="id">mxsum_rank</span><span class="id"> S</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirectEgeq</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxdirect</span> (<span class="id">unwrap</span><span class="id"> S</span>)<span class="id"> =</span> (<span class="id">\rank</span> (<span class="id">unwrap</span><span class="id"> S</span>)<span class="id"> &gt;=</span><span class="id"> unwrap</span> (<span class="id">mxsum_rank</span><span class="id"> S</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">geq_leqif</span> (<span class="id">mxrank_sum_leqif</span><span class="id"> S</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> BinaryDirect</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_addsE</span> (<span class="id">S1</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m1</span><span class="id"> n</span>) (<span class="id">S2</span><span class="id"> :</span><span class="id"> mxsum_expr</span><span class="id"> m2</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">mxdirect</span> (<span class="id">unwrap</span><span class="id"> S1</span><span class="id"> +</span><span class="id"> unwrap</span><span class="id"> S2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">=</span><span class="id"> [&amp;&amp;</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span><span class="id"> S1</span>)<span class="id">,</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span><span class="id"> S2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="id"> unwrap</span><span class="id"> S1</span><span class="id"> :&amp;:</span><span class="id"> unwrap</span><span class="id"> S2</span><span class="id"> ==</span><span class="id"> 0]%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span> (<span class="id">@mxdirectE</span><span class="id"> n</span>)<span class="id"> /=</span>.<br/>
<span class="id">have:=</span><span class="id"> leqif_add</span> (<span class="id">mxrank_sum_leqif</span><span class="id"> S1</span>) (<span class="id">mxrank_sum_leqif</span><span class="id"> S2</span>).<br/>
<span class="id">move/</span>(<span class="id">leqif_trans</span> (<span class="id">mxrank_adds_leqif</span> (<span class="id">unwrap</span><span class="id"> S1</span>) (<span class="id">unwrap</span><span class="id"> S2</span>)))<span class="id">=&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> andbC</span><span class="id"> -andbA</span><span class="id"> submx0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_addsP</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span> (<span class="id">mxdirect</span> (<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxdirect_addsE</span><span class="id"> !mxdirect_trivial;</span><span class="id"> apply:</span><span class="id"> eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> BinaryDirect</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> NaryDirect</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> TIsum</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> :=</span> (<span class="id">A_</span><span class="id"> i</span><span class="id"> :&amp;:</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span><span class="id"> &amp;&amp;</span> (<span class="id">j</span><span class="id"> !=</span><span class="id"> i</span>))<span class="id"> A_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> 'M_n</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> mxdirect_sums_recP</span> (<span class="id">S_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> mxsum_expr</span><span class="id"> n</span><span class="id"> n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span> (<span class="id">S_</span><span class="id"> i</span>))<span class="id"> /\</span><span class="id"> TIsum</span> (<span class="id">unwrap</span><span class="id"> \o</span><span class="id"> S_</span>)<span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">unwrap</span> (<span class="id">S_</span><span class="id"> i</span>)))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /TIsum;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> eqnP</span>)<span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [dxS</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> |</span><span class="id"> dxS]</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span><span class="id"> Si'</span><span class="id"> :=</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> _</span>)<span class="id"> unwrap</span> (<span class="id">S_</span><span class="id"> j</span>))<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span> (<span class="id">S_</span><span class="id"> i</span>)<span class="id"> +</span><span class="id"> Si'</span>)<span class="gallina-kwd"> by</span><span class="id"> apply/eqnP;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> -!</span>(<span class="id">bigD1</span><span class="id"> i</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxdirect_addsE</span><span class="id"> =&gt;</span><span class="id"> /and3P[-&gt;</span><span class="id"> _</span><span class="id"> /eqP]</span>.<br/>
<span class="id">set</span><span class="id"> Q</span><span class="id"> :=</span><span class="id"> P;</span><span class="id"> have</span><span class="id"> [m]</span><span class="id"> :=</span><span class="id"> ubnP</span><span class="id"> #|Q|;</span><span class="id"> have:</span><span class="id"> Q</span><span class="id"> \subset</span><span class="id"> P</span><span class="gallina-kwd"> by</span><span class="id"> []</span>.<br/>
<span class="id">elim:</span><span class="id"> m</span><span class="id"> Q</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> m</span><span class="id"> IHm</span><span class="id"> Q</span><span class="id"> /subsetP-sQP</span>.<br/>
<span class="id">case:</span> (<span class="id">pickP</span><span class="id"> Q</span>)<span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> Qi</span><span class="id"> |</span><span class="id"> Q0];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !big_pred0</span><span class="id"> ?mxrank0</span>.<br/>
<span class="id">rewrite</span> (<span class="id">cardD1x</span><span class="id"> Qi</span>)<span class="id"> !</span>((<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> Q</span>)<span class="id"> //=</span>.<br/>
<span class="id">move/IHm=&gt;</span><span class="id"> &lt;-</span><span class="id"> {IHm}/=;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> apply/subsetP=&gt;</span><span class="id"> j</span><span class="id"> /andP[/sQP]</span>.<br/>
<span class="id">case:</span> (<span class="id">dxS</span><span class="id"> i</span> (<span class="id">sQP</span><span class="id"> i</span><span class="id"> Qi</span>))<span class="id"> =&gt;</span><span class="id"> /eqnP=&gt;</span><span class="id"> &lt;-</span><span class="id"> TiQ_0;</span><span class="id"> rewrite</span><span class="id"> mxrank_disjoint_sum</span><span class="id"> //</span>.<br/>
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -submx0</span><span class="id"> -{2}TiQ_0</span><span class="id"> capmxS</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/sumsmx_subP=&gt;</span><span class="id"> j</span><span class="id"> /=</span><span class="id"> /andP[Qj</span><span class="id"> i'j];</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span><span class="id"> j</span>)<span class="id"> ?[P</span><span class="id"> j]sQP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_sumsP</span> (<span class="id">A_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> :&amp;:</span> (<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span><span class="id"> &amp;&amp;</span> (<span class="id">j</span><span class="id"> !=</span><span class="id"> i</span>))<span class="id"> A_</span><span class="id"> j</span>)<span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">mxdirect_sums_recP</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> dxA</span><span class="id"> i</span><span class="id"> /dxA;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mxdirect_trivial</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_sumsE</span> (<span class="id">S_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> mxsum_expr</span><span class="id"> n</span><span class="id"> n</span>) (<span class="id">xunwrap</span><span class="id"> :=</span><span class="id"> unwrap</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">and</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> mxdirect</span> (<span class="id">unwrap</span> (<span class="id">S_</span><span class="id"> i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">xunwrap</span> (<span class="id">S_</span><span class="id"> i</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">unwrap</span> (<span class="id">S_</span><span class="id"> i</span>)))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span> (<span class="id">mxdirect_sums_recP</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> [dxS</span><span class="id"> |</span><span class="id"> [dxS_</span><span class="id"> dxS]</span><span class="id"> i</span><span class="id"> Pi]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> [split;</span><span class="id"> last</span><span class="id"> apply/mxdirect_sumsP]</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> case/dxS</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> [apply:</span><span class="id"> dxS_</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> mxdirect_sumsP</span><span class="id"> Pi]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> NaryDirect</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SubDaddsmx</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> m</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B1</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B2</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m2,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> sub_daddsmx_spec</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SubDaddsmxSpec</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> of</span> (<span class="id">A1</span><span class="id"> &lt;=</span><span class="id"> B1</span>)<span class="id">%MS</span><span class="id"> &amp;</span> (<span class="id">A2</span><span class="id"> &lt;=</span><span class="id"> B2</span>)<span class="id">%MS</span><span class="id"> &amp;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A1</span><span class="id"> +</span><span class="id"> A2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="gallina-kwd"> forall</span><span class="id"> C1</span><span class="id"> C2,</span> (<span class="id">C1</span><span class="id"> &lt;=</span><span class="id"> B1</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">C2</span><span class="id"> &lt;=</span><span class="id"> B2</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span><span class="id"> =</span><span class="id"> C1</span><span class="id"> +</span><span class="id"> C2</span><span class="id"> -&gt;</span><span class="id"> C1</span><span class="id"> =</span><span class="id"> A1</span><span class="id"> /\</span><span class="id"> C2</span><span class="id"> =</span><span class="id"> A2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_daddsmx</span><span class="id"> :</span> (<span class="id">B1</span><span class="id"> :&amp;:</span><span class="id"> B2</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span><span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B1</span><span class="id"> +</span><span class="id"> B2</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> sub_daddsmx_spec</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> dxB</span><span class="id"> /sub_addsmxP[u</span><span class="id"> defA]</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">u</span>.<span class="id">1</span><span class="id"> *m</span><span class="id"> B1</span>) (<span class="id">u</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> B2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?submxMl</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> C1</span><span class="id"> C2</span><span class="id"> sCB1</span><span class="id"> sCB2</span>.<br/>
<span class="id">move/</span>(<span class="id">canLR</span> (<span class="id">addrK</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> defC1</span>.<br/>
<span class="id">suffices:</span> (<span class="id">C2</span><span class="id"> -</span><span class="id"> u</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> B2</span><span class="id"> &lt;=</span><span class="id"> B1</span><span class="id"> :&amp;:</span><span class="id"> B2</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dxB</span><span class="id"> submx0</span><span class="id"> subr_eq0</span><span class="id"> -defC1</span><span class="id"> defA;</span><span class="id"> move/eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> addrK</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> -opprB</span><span class="id"> -{1}</span>(<span class="id">canLR</span> (<span class="id">addKr</span><span class="id"> _</span>)<span class="id"> defA</span>)<span class="id"> -addrA</span><span class="id"> defC1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">eqmx_opp,</span><span class="id"> addmx_sub</span>)<span class="id"> ?submxMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SubDaddsmx</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SubDsumsmx</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M[F]_n</span>).<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> sub_dsumsmx_spec</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">SubDsumsmxSpec</span><span class="id"> A_</span><span class="id"> of</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span> (<span class="id">A_</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="gallina-kwd"> forall</span><span class="id"> C,</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> C</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> C</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> SimplPred</span><span class="id"> P,</span><span class="id"> C</span><span class="id"> =1</span><span class="id"> A_}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub_dsumsmx</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B</span><span class="id"> i</span>)<span class="id"> -&gt;</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> B</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">sub_dsumsmx_spec</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move/mxdirect_sumsP=&gt;</span><span class="id"> dxB</span><span class="id"> /sub_sumsmxP[u</span><span class="id"> defA]</span>.<br/>
<span class="id">pose</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> u</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> A_</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [i</span><span class="id"> _</span><span class="id"> |</span><span class="id"> C</span><span class="id"> sCB</span><span class="id"> defAC</span><span class="id"> i</span><span class="id"> Pi];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> submxMl</span>.<br/>
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> -submx0</span><span class="id"> -{dxB}</span>(<span class="id">dxB</span><span class="id"> i</span><span class="id"> Pi</span>)<span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> addmx_sub</span><span class="id"> ?eqmx_opp</span><span class="id"> ?submxMl</span><span class="id"> ?sCB</span><span class="id"> //=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">subrK</span><span class="id"> A</span> (<span class="id">C</span><span class="id"> i</span>))<span class="id"> -addrA</span><span class="id"> -opprB</span><span class="id"> addmx_sub</span><span class="id"> ?eqmx_opp</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> addrC</span><span class="id"> defAC</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //</span><span class="id"> addKr</span><span class="id"> /=</span><span class="id"> summx_sub</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> Pi'j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span><span class="id"> j</span>)<span class="id"> ?sCB</span><span class="id"> //;</span><span class="id"> case/andP:</span><span class="id"> Pi'j</span>.<br/>
<span class="id">rewrite</span><span class="id"> addrC</span><span class="id"> defA</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //</span><span class="id"> addKr</span><span class="id"> /=</span><span class="id"> summx_sub</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> Pi'j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span><span class="id"> j</span>)<span class="id"> ?submxMl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> SubDsumsmx</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Eigenspace</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">g</span><span class="id"> :</span><span class="id"> 'M_n</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> eigenspace</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> kermx</span> (<span class="id">g</span><span class="id"> -</span><span class="id"> a%:M</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> eigenvalue</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> F</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> a</span><span class="id"> =&gt;</span><span class="id"> eigenspace</span><span class="id"> a</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eigenspaceP</span><span class="id"> a</span><span class="id"> m</span> (<span class="id">W</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">W</span><span class="id"> *m</span><span class="id"> g</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> W</span>) (<span class="id">W</span><span class="id"> &lt;=</span><span class="id"> eigenspace</span><span class="id"> a</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sub_kermx</span><span class="id"> mulmxBr</span><span class="id"> subr_eq0</span><span class="id"> mul_mx_scalar;</span><span class="id"> apply/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eigenvalueP</span><span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> v</span><span class="id"> :</span><span class="id"> 'rV_n,</span><span class="id"> v</span><span class="id"> *m</span><span class="id"> g</span><span class="id"> =</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v</span><span class="id"> &amp;</span><span class="id"> v</span><span class="id"> !=</span><span class="id"> 0</span>) (<span class="id">eigenvalue</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">rowV0Pn</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [v];</span><span class="id"> move/eigenspaceP;</span><span class="gallina-kwd"> exists</span><span class="id"> v</span>. Qed.</div></details>
<br/>
<span class="vernacular">Notation</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">V%MS</span><span class="id"> *m</span><span class="id"> f%R</span><span class="id"> &lt;=</span><span class="id"> V%MS</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eigenvectorP</span><span class="id"> {v</span><span class="id"> :</span><span class="id"> 'rV_n}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> a,</span> (<span class="id">v</span><span class="id"> &lt;=</span><span class="id"> eigenspace</span><span class="id"> a</span>)<span class="id">%MS</span>) (<span class="id">stablemx</span><span class="id"> v</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">sub_rVP</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> -[a]</span><span class="id"> /eigenspaceP;</span><span class="gallina-kwd"> exists</span><span class="id"> a</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_sum_eigenspace</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> a_</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> P</span><span class="id"> &amp;,</span><span class="id"> injective</span><span class="id"> a_}</span><span class="id"> -&gt;</span><span class="id"> mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> eigenspace</span> (<span class="id">a_</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [m]</span><span class="id"> :=</span><span class="id"> ubnP</span><span class="id"> #|P|;</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> P</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> m</span><span class="id"> IHm</span><span class="id"> P</span><span class="id"> lePm</span><span class="id"> inj_a</span>.<br/>
<span class="id">apply/mxdirect_sumsP=&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> apply/eqP/rowV0P</span><span class="id"> =&gt;</span><span class="id"> v</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> =&gt;</span><span class="id"> /andP[/eigenspaceP</span><span class="id"> def_vg]</span>.<br/>
<span class="id">set</span><span class="id"> Vi'</span><span class="id"> :=</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> _</span>)<span class="id"> _</span>)<span class="id">%MS</span><span class="id"> =&gt;</span><span class="id"> Vi'v</span>.<br/>
<span class="id">have</span><span class="id"> dxVi':</span><span class="id"> mxdirect</span><span class="id"> Vi'</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">cardD1x</span><span class="id"> Pi</span>)<span class="gallina-kwd"> in</span><span class="id"> lePm;</span><span class="id"> apply:</span><span class="id"> IHm</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> sub_in2</span><span class="id"> inj_a</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> /andP[]</span>.<br/>
<span class="id">case/sub_dsumsmx:</span><span class="id"> Vi'v</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> u</span><span class="id"> Vi'u</span><span class="id"> def_v</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> def_v</span><span class="id"> big1</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> Pi'j;</span><span class="id"> apply/eqP</span>.<br/>
<span class="id">have</span><span class="id"> nz_aij:</span><span class="id"> a_</span><span class="id"> i</span><span class="id"> -</span><span class="id"> a_</span><span class="id"> j</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/andP:</span><span class="id"> Pi'j</span><span class="id"> =&gt;</span><span class="id"> Pj</span><span class="id"> ne_ji;</span><span class="id"> rewrite</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span> (<span class="id">inj_in_eq</span><span class="id"> inj_a</span>).<br/>
<span class="id">case:</span> (<span class="id">sub_dsumsmx</span><span class="id"> dxVi'</span> (<span class="id">sub0mx</span><span class="id"> 1</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> C</span><span class="id"> _</span><span class="id"> _</span><span class="id"> uniqC</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">eqmx_eq0</span> (<span class="id">eqmx_scale</span><span class="id"> _</span><span class="id"> nz_aij</span>)).<br/>
<span class="id">rewrite</span> (<span class="id">uniqC</span> (<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span> (<span class="id">a_</span><span class="id"> i</span><span class="id"> -</span><span class="id"> a_</span><span class="id"> k</span>)<span class="id"> *:</span><span class="id"> u</span><span class="id"> k</span>))<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [|k</span><span class="id"> Pi'k|]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">uniqC</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> 0</span>))<span class="id"> ?big1</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> Pi'k;</span><span class="id"> apply:</span><span class="id"> sub0mx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> scalemx_sub</span><span class="id"> ?Vi'u</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}</span>(<span class="id">subrr</span> (<span class="id">v</span><span class="id"> *m</span><span class="id"> g</span>))<span class="id"> {1}def_vg</span><span class="id"> def_v</span><span class="id"> scaler_sumr</span><span class="id"> mulmx_suml</span><span class="id"> -sumrB</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> /Vi'u/eigenspaceP-&gt;;</span><span class="id"> rewrite</span><span class="id"> scalerBl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Eigenspace</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> RowSpaceTheory</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> submx_refl</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> submxP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eq_row_sub</span><span class="id"> [F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> v</span><span class="id"> A]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> row_subP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> rV_subP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> row_subPn</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sub_rVP</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> u</span><span class="id"> v}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> rV_eqP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> rowV0Pn</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> rowV0P</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eqmx0P</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> row_fullP</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> row_freeP</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eqmxP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> genmxP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addsmx_idPr</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addsmx_idPl</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sub_addsmxP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B</span><span class="id"> C}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sumsmx_sup</span><span class="id"> [F</span><span class="id"> I]</span><span class="id"> i0</span><span class="id"> [P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B_]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sumsmx_subP</span><span class="id"> {F</span><span class="id"> I</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A_</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sub_sumsmxP</span><span class="id"> {F</span><span class="id"> I</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B_}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sub_kermxP</span><span class="id"> {F</span><span class="id"> p</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> capmx_idPr</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> capmx_idPl</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> bigcapmx_inf</span><span class="id"> [F</span><span class="id"> I]</span><span class="id"> i0</span><span class="id"> [P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A_</span><span class="id"> B]</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sub_bigcapmxP</span><span class="id"> {F</span><span class="id"> I</span><span class="id"> P</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B_}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxrank_injP</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n}</span><span class="id"> p</span><span class="id"> {A</span><span class="id"> f}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxdirectP</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> S}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxdirect_addsP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> B}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxdirect_sumsP</span><span class="id"> {F</span><span class="id"> I</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A_}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxdirect_sumsE</span><span class="id"> {F</span><span class="id"> I</span><span class="id"> P</span><span class="id"> n</span><span class="id"> S_}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eigenspaceP</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> g</span><span class="id"> a</span><span class="id"> m</span><span class="id"> W}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eigenvalueP</span><span class="id"> {F</span><span class="id"> n</span><span class="id"> g</span><span class="id"> a}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> submx_rowsub</span><span class="id"> [F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n]</span><span class="id"> h</span><span class="id"> [f</span><span class="id"> g</span><span class="id"> A]</span><span class="id"> _</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eqmx_rowsub</span><span class="id"> [F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n]</span><span class="id"> h</span><span class="id"> [f</span><span class="id"> g</span><span class="id"> A]</span><span class="id"> _</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> mxrank</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> complmx</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> row_full</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> submx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> ltmx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> eqmx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> addsmx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> capmx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> diffmx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> A%_MS</span><span class="id"> B%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> genmx</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> A%_R</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\rank A&quot;</span><span class="id"> :=</span> (<span class="id">mxrank</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> nat_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;&lt;&lt; A &gt;&gt;&quot;</span><span class="id"> :=</span> (<span class="id">genmx</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A ^C&quot;</span><span class="id"> :=</span> (<span class="id">complmx</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A &lt;= B&quot;</span><span class="id"> :=</span> (<span class="id">submx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A &lt; B&quot;</span><span class="id"> :=</span> (<span class="id">ltmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A &lt;= B &lt;= C&quot;</span><span class="id"> :=</span> ((<span class="id">submx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> &amp;&amp;</span> (<span class="id">submx</span><span class="id"> B</span><span class="id"> C</span>))<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A &lt; B &lt;= C&quot;</span><span class="id"> :=</span> (<span class="id">ltmx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> &amp;&amp;</span><span class="id"> submx</span><span class="id"> B</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A &lt;= B &lt; C&quot;</span><span class="id"> :=</span> (<span class="id">submx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> &amp;&amp;</span><span class="id"> ltmx</span><span class="id"> B</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A &lt; B &lt; C&quot;</span><span class="id"> :=</span> (<span class="id">ltmx</span><span class="id"> A</span><span class="id"> B</span><span class="id"> &amp;&amp;</span><span class="id"> ltmx</span><span class="id"> B</span><span class="id"> C</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A == B&quot;</span><span class="id"> :=</span> ((<span class="id">submx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> &amp;&amp;</span> (<span class="id">submx</span><span class="id"> B</span><span class="id"> A</span>))<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A :=: B&quot;</span><span class="id"> :=</span> (<span class="id">eqmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A + B&quot;</span><span class="id"> :=</span> (<span class="id">addsmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A :&amp;: B&quot;</span><span class="id"> :=</span> (<span class="id">capmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A :\: B&quot;</span><span class="id"> :=</span> (<span class="id">diffmx</span><span class="id"> A</span><span class="id"> B</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> mxdirect</span><span class="id"> S</span><span class="id"> :=</span> (<span class="id">mxdirect_def</span> (<span class="id">Phantom</span><span class="id"> 'M_</span>(<span class="id">_,_</span>)<span class="id"> S%MS</span>)).<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ i B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_i</span><span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span>)<span class="id"> B%MS</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[addsmx/0%R]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i &lt;- r | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i &lt;- r ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( m &lt;= i &lt; n | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( m &lt;= i &lt; n ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ i B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_i</span><span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i : t | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i : t ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span>)<span class="id"> B%MS</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i &lt; n | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i &lt; n ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i 'in' A | P ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\bigcap_ ( i 'in' A ) B&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[capmx/1%:M]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> B%MS</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Stability</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> fieldType</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_stable</span><span class="id"> m</span><span class="id"> m'</span><span class="id"> n</span> (<span class="id">V</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">V'</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m',</span><span class="id"> n</span>)) (<span class="id">f</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">V</span><span class="id"> :=:</span><span class="id"> V'</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><span class="id"> =</span><span class="id"> stablemx</span><span class="id"> V'</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eqVV';</span><span class="id"> rewrite</span> (<span class="id">eqmxMr</span><span class="id"> _</span><span class="id"> eqVV'</span>)<span class="id"> eqVV'</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">V</span><span class="id"> W</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemx_row_base</span><span class="id"> :</span> (<span class="id">stablemx</span> (<span class="id">row_base</span><span class="id"> V</span>)<span class="id"> f</span>)<span class="id"> =</span> (<span class="id">stablemx</span><span class="id"> V</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> eqmx_stable;</span><span class="id"> apply:</span><span class="id"> eq_row_base</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemx_full</span><span class="id"> :</span><span class="id"> row_full</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> submx_full</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemxM</span><span class="id"> :</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span> (<span class="id">f</span><span class="id"> *m</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f_stab</span><span class="id"> /</span>(<span class="id">submx_trans</span><span class="id"> _</span>)<span class="id">-&gt;//;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> submxMr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemxD</span><span class="id"> :</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span> (<span class="id">f</span><span class="id"> +</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f_stab</span><span class="id"> g_stab;</span><span class="id"> rewrite</span><span class="id"> mulmxDr</span><span class="id"> addmx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemxN</span><span class="id"> :</span><span class="id"> stablemx</span><span class="id"> V</span> (<span class="id">-</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulmxN</span><span class="id"> eqmx_opp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemxC</span><span class="id"> x</span><span class="id"> :</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> x%:M</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_mx_scalar</span><span class="id"> scalemx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemx0</span><span class="id"> :</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulmx0</span><span class="id"> sub0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stableDmx</span><span class="id"> :</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> W</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> stablemx</span> (<span class="id">V</span><span class="id"> +</span><span class="id"> W</span>)<span class="id">%MS</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fV</span><span class="id"> fW;</span><span class="id"> rewrite</span><span class="id"> addsmxMr</span><span class="id"> addsmxS</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stableNmx</span><span class="id"> :</span><span class="id"> stablemx</span> (<span class="id">-</span><span class="id"> V</span>)<span class="id"> f</span><span class="id"> =</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulNmx</span><span class="id"> !eqmx_opp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stable0mx</span><span class="id"> :</span><span class="id"> stablemx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> f</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> FixedDim</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stableCmx</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> x</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> stablemx</span><span class="id"> x%:M</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|x_neq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul_scalar_mx</span><span class="id"> scale0r</span><span class="id"> sub0mx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -![x%:M]scalemx1</span><span class="id"> eqmx_scale//</span><span class="id"> submx_full//</span><span class="id"> -sub1mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemx_sums</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">V_</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> 'M[F]_n</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> stablemx</span> (<span class="id">V_</span><span class="id"> i</span>)<span class="id"> f</span>)<span class="id"> -&gt;</span><span class="id"> stablemx</span> (<span class="id">\sum_i</span><span class="id"> V_</span><span class="id"> i</span>)<span class="id">%MS</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> fV;</span><span class="id"> rewrite</span><span class="id"> sumsmxMr;</span><span class="id"> apply/sumsmx_subP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span><span class="id"> i</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> stablemx_unit</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">V</span><span class="id"> f</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><span class="id"> V</span><span class="id"> \in</span><span class="id"> unitmx</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> V</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Vunit;</span><span class="id"> rewrite</span><span class="id"> submx_full</span><span class="id"> ?row_full_unit</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Commutation</span>.<br/>
<br/>
<span class="vernacular">Variable</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_mx_stable</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><span class="id"> comm_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> stablemx</span><span class="id"> f</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> comm_fg;</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> *m</span><span class="id"> _]comm_fg</span><span class="id"> mulmx_sub</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_mx_stable_ker</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">comm_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> stablemx</span> (<span class="id">kermx</span><span class="id"> f</span>)<span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> comm_fg;</span><span class="id"> apply/sub_kermxP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> -[g</span><span class="id"> *m</span><span class="id"> _]comm_fg</span><span class="id"> mulmxA</span><span class="id"> mulmx_ker</span><span class="id"> mul0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> comm_mx_stable_eigenspace</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">comm_mx</span><span class="id"> f</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> stablemx</span> (<span class="id">eigenspace</span><span class="id"> f</span><span class="id"> a</span>)<span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cfg;</span><span class="id"> rewrite</span><span class="id"> comm_mx_stable_ker//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/comm_mx_sym/comm_mxB</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:comm_mx_scalar</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Commutation</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Stability</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> DirectSums</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> fieldType</span>) (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_delta</span><span class="id"> n</span><span class="id"> f</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> P</span><span class="id"> &amp;,</span><span class="id"> injective</span><span class="id"> f}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">mxdirect</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> &lt;&lt;delta_mx</span><span class="id"> 0</span> (<span class="id">f</span><span class="id"> i</span>)<span class="id"> :</span><span class="id"> 'rV[F]_n&gt;&gt;</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> fP</span><span class="id"> :=</span><span class="id"> image</span><span class="id"> f</span><span class="id"> P</span><span class="id"> =&gt;</span><span class="id"> Uf;</span><span class="id"> have</span><span class="id"> UfP:</span><span class="id"> uniq</span><span class="id"> fP</span><span class="gallina-kwd"> by</span><span class="id"> apply/dinjectiveP</span>.<br/>
<span class="id">suffices</span><span class="id"> /mxdirectP</span><span class="id"> :</span><span class="id"> mxdirect</span> (<span class="id">\sum_i</span><span class="id"> &lt;&lt;delta_mx</span><span class="id"> 0</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 'rV[F]_n&gt;&gt;</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> !</span>(<span class="id">bigID</span><span class="id"> [in</span><span class="id"> fP]</span><span class="id"> predT</span>)<span class="id"> -!big_uniq</span><span class="id"> //=</span><span class="id"> !big_map</span><span class="id"> !big_enum</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/mxdirectP;</span><span class="id"> rewrite</span><span class="id"> mxdirect_addsE</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>.<br/>
<span class="id">apply/mxdirectP=&gt;</span><span class="id"> /=;</span><span class="id"> transitivity</span> (<span class="id">mxrank</span> (<span class="id">1%:M</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply/eqmx_rank;</span><span class="id"> rewrite</span><span class="id"> submx1</span><span class="id"> mx1_sum_delta</span><span class="id"> summx_sub_sums</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">mul_delta_mx</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'I_1</span>))<span class="id"> genmxE</span><span class="id"> submxMl</span>.<br/>
<span class="id">rewrite</span><span class="id"> mxrank1</span><span class="id"> -[LHS]card_ord</span><span class="id"> -sum1_card</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eq_bigr=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> mxrank_gen</span><span class="id"> mxrank_delta</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> DirectSums</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CardGL</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> F</span><span class="id"> :</span><span class="id"> finFieldType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> card_GL</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">#|'GL_n[F]|</span><span class="id"> =</span> (<span class="id">#|F|</span><span class="id"> ^</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> 2</span>)<span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>) (<span class="id">#|F|</span><span class="id"> ^</span><span class="id"> i</span><span class="id"> -</span><span class="id"> 1</span>))<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n'</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> n'</span>.<span class="id">+1;</span><span class="id"> set</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> #|F|</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_nat_rev</span><span class="id"> big_add1</span><span class="id"> -bin2_sum</span><span class="id"> expn_sum</span><span class="id"> -big_split</span><span class="id"> /=</span>.<br/>
<span class="id">pose</span><span class="id"> fr</span><span class="id"> m</span><span class="id"> :=</span><span class="id"> [pred</span><span class="id"> A</span><span class="id"> :</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)<span class="id"> |</span><span class="id"> \rank</span><span class="id"> A</span><span class="id"> ==</span><span class="id"> m]</span>.<br/>
<span class="id">set</span><span class="id"> m</span><span class="id"> :=</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> [in</span><span class="id"> m</span>.<span class="id">+1]/m;</span><span class="id"> transitivity</span><span class="id"> #|fr</span><span class="id"> m|</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cardsT</span><span class="id"> /=</span><span class="id"> card_sub;</span><span class="id"> apply:</span><span class="id"> eq_card</span><span class="id"> =&gt;</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> -row_free_unit</span>.<br/>
<span class="id">have:</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> n</span><span class="gallina-kwd"> by</span><span class="id"> [];</span><span class="id"> elim:</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> [_</span><span class="id"> |</span><span class="id"> m</span><span class="id"> IHm</span><span class="id"> /ltnW-le_mn]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@eq_card1</span><span class="id"> _</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">0,</span><span class="id"> n</span>)))<span class="id"> ?big_geq</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> A</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> flatmx0</span><span class="id"> !inE</span><span class="id"> mxrank</span>.<span class="id">unlock</span><span class="id"> !eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_nat_recr</span><span class="id"> //</span><span class="id"> -{}IHm</span><span class="id"> //=</span><span class="id"> !subSS</span><span class="id"> mulnBr</span><span class="id"> muln1</span><span class="id"> -expnD</span><span class="id"> subnKC</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sum_nat_const</span><span class="id"> /=</span><span class="id"> -sum1_card</span><span class="id"> -add1n</span>.<br/>
<span class="id">rewrite</span> (<span class="id">partition_big</span><span class="id"> dsubmx</span> (<span class="id">fr</span><span class="id"> m</span>))<span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> [|A];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !inE</span><span class="id"> -{1}</span>(<span class="id">vsubmxK</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> move:</span><span class="id"> {A}</span>(_<span class="id"> A</span>) (_<span class="id"> A</span>)<span class="id"> =&gt;</span><span class="id"> Ad</span><span class="id"> Au</span><span class="id"> Afull</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_row</span><span class="id"> -</span>(<span class="id">leq_add2l</span> (<span class="id">\rank</span><span class="id"> Au</span>))<span class="id"> -mxrank_sum_cap</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> {1</span><span class="id"> 3}[@mxrank]lock</span><span class="id"> addsmxE</span> (<span class="id">eqnP</span><span class="id"> Afull</span>)<span class="id"> -lock</span><span class="id"> -addnA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> leq_add</span><span class="id"> ?rank_leq_row</span><span class="id"> ?leq_addr</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> A</span><span class="id"> rAm;</span><span class="id"> rewrite</span> (<span class="id">reindex</span> (<span class="id">col_mx^~</span><span class="id"> A</span>))<span class="id"> /=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> usubmx</span><span class="id"> =&gt;</span><span class="id"> [v</span><span class="id"> _</span><span class="id"> |</span><span class="id"> vA];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> col_mxKu</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case/andP=&gt;</span><span class="id"> _</span><span class="id"> /eqP</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> vsubmxK</span>.<br/>
<span class="id">transitivity</span><span class="id"> #|~:</span><span class="id"> [set</span><span class="id"> v</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> |</span><span class="id"> v</span><span class="gallina-kwd"> in</span><span class="id"> 'rV_m]|;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> cardsCs</span><span class="id"> setCK</span><span class="id"> card_imset</span><span class="id"> ?card_mx</span><span class="id"> ?card_ord</span><span class="id"> ?mul1n</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [B</span><span class="id"> AB1]</span><span class="id"> :=</span><span class="id"> row_freeP</span><span class="id"> rAm;</span><span class="id"> apply:</span><span class="id"> can_inj</span> (<span class="id">mulmx^~</span><span class="id"> B</span>)<span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> v</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> AB1</span><span class="id"> mulmx1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sum1_card;</span><span class="id"> apply:</span><span class="id"> eq_bigl</span><span class="id"> =&gt;</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> col_mxKd</span><span class="id"> eqxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> andbT</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_row</span><span class="id"> /=</span><span class="id"> -</span>(<span class="id">leq_add2r</span> (<span class="id">\rank</span> (<span class="id">v</span><span class="id"> :&amp;:</span><span class="id"> A</span>)<span class="id">%MS</span>)).<br/>
<span class="id">rewrite</span><span class="id"> -addsmxE</span><span class="id"> mxrank_sum_cap</span> (<span class="id">eqnP</span><span class="id"> rAm</span>)<span class="id"> addnAC</span><span class="id"> leq_add2r</span>.<br/>
<span class="id">rewrite</span> (<span class="id">ltn_leqif</span> (<span class="id">mxrank_leqif_sup</span><span class="id"> _</span>))<span class="id"> ?capmxSl</span><span class="id"> //</span><span class="id"> sub_capmx</span><span class="id"> submx_refl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (<span class="id">~~</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/submxP/imsetP=&gt;</span><span class="id"> []</span><span class="id"> [u];</span><span class="gallina-kwd"> exists</span><span class="id"> u</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> LUP_card_GL</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">#|'GL_n[F]|</span><span class="id"> =</span> (<span class="id">#|F|</span><span class="id"> ^</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> 2</span>)<span class="id"> *</span><span class="id"> \prod_</span>(<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span>) (<span class="id">#|F|</span><span class="id"> ^</span><span class="id"> i</span><span class="id"> -</span><span class="id"> 1</span>))<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n'</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> n'</span>.<span class="id">+1;</span><span class="id"> set</span><span class="id"> p</span><span class="id"> :=</span><span class="id"> #|F|</span>.<br/>
<span class="id">rewrite</span><span class="id"> cardsT</span><span class="id"> /=</span><span class="id"> card_sub</span><span class="id"> /GRing</span>.<span class="id">unit</span><span class="id"> /=</span><span class="id"> big_add1</span><span class="id"> /=</span><span class="id"> -bin2_sum</span><span class="id"> -/n</span><span class="id"> /=</span>.<br/>
<span class="id">elim:</span><span class="id"> {n'}n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !big_geq</span><span class="id"> //</span><span class="id"> mul1n</span> (<span class="id">@eq_card</span><span class="id"> _</span><span class="id"> _</span><span class="id"> predT</span>)<span class="id"> ?card_mx</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> M</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> {1}[M]flatmx0</span><span class="id"> -</span>(<span class="id">flatmx0</span><span class="id"> 1%:M</span>)<span class="id"> unitmx1</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big_nat_recr</span><span class="id"> //=</span><span class="id"> expnD</span><span class="id"> mulnAC</span><span class="id"> mulnA</span><span class="id"> -{}IHn</span><span class="id"> -mulnA</span><span class="id"> mulnC</span>.<br/>
<span class="id">set</span><span class="id"> LHS</span><span class="id"> :=</span><span class="id"> #|_|;</span><span class="id"> rewrite</span><span class="id"> -[n</span>.<span class="id">+1]muln1</span><span class="id"> -{2}[n]mul1n</span><span class="id"> {}/LHS</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!card_mx</span><span class="id"> subn1</span><span class="id"> -</span>(<span class="id">cardC1</span><span class="id"> 0</span>)<span class="id"> -mulnA;</span><span class="id"> set</span><span class="id"> nzC</span><span class="id"> :=</span><span class="id"> predC1</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sum1_card</span> (<span class="id">partition_big</span><span class="id"> lsubmx</span><span class="id"> nzC</span>)<span class="id"> =&gt;</span><span class="id"> [|A];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> unitmxE</span><span class="id"> unitfE;</span><span class="id"> apply:</span><span class="id"> contra;</span><span class="id"> move/eqP=&gt;</span><span class="id"> v0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[A]hsubmxK</span><span class="id"> v0</span><span class="id"> -[n</span>.<span class="id">+1]/</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -col_mx0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[rsubmx</span><span class="id"> _]vsubmxK</span><span class="id"> -det_tr</span><span class="id"> tr_row_mx</span><span class="id"> !tr_col_mx</span><span class="id"> !trmx0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> det_lblock</span><span class="id"> [0]mx11_scalar</span><span class="id"> det_scalar1</span><span class="id"> mxE</span><span class="id"> mul0r</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sum_nat_const;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> v</span><span class="id"> /cV0Pn[k</span><span class="id"> nza]</span>.<br/>
<span class="id">have</span><span class="id"> xrkK:</span><span class="id"> involutive</span> (<span class="id">@xrow</span><span class="id"> F</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span><span class="id"> k</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> m</span><span class="id"> A</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> /xrow</span><span class="id"> -row_permM</span><span class="id"> tperm2</span><span class="id"> row_perm1</span>.<br/>
<span class="id">rewrite</span> (<span class="id">reindex_inj</span> (<span class="id">inv_inj</span> (<span class="id">xrkK</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span>)))<span class="id"> /=</span><span class="id"> -[n</span>.<span class="id">+1]/</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<span class="id">rewrite</span> (<span class="id">partition_big</span><span class="id"> ursubmx</span><span class="id"> xpredT</span>)<span class="id"> //=</span><span class="id"> -sum_nat_const</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> u</span><span class="id"> _;</span><span class="id"> set</span><span class="id"> a</span><span class="id"> :</span><span class="id"> F</span><span class="id"> :=</span><span class="id"> v</span><span class="id"> _</span><span class="id"> _</span><span class="gallina-kwd"> in</span><span class="id"> nza</span>.<br/>
<span class="id">set</span><span class="id"> v1</span><span class="id"> :</span><span class="id"> 'cV_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> xrow</span><span class="id"> 0</span><span class="id"> k</span><span class="id"> v</span>.<br/>
<span class="id">have</span><span class="id"> def_a:</span><span class="id"> usubmx</span><span class="id"> v1</span><span class="id"> =</span><span class="id"> a%:M</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_</span><span class="id"> v1]mx11_scalar</span><span class="id"> mxE</span><span class="id"> lshift0</span><span class="id"> mxE</span><span class="id"> tpermL</span>.<br/>
<span class="id">pose</span><span class="id"> Schur</span><span class="id"> :=</span><span class="id"> dsubmx</span><span class="id"> v1</span><span class="id"> *m</span> (<span class="id">a^-1</span><span class="id"> *:</span><span class="id"> u</span>).<br/>
<span class="id">pose</span><span class="id"> L</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> a%:M</span><span class="id"> 0</span> (<span class="id">dsubmx</span><span class="id"> v1</span>)<span class="id"> 1%:M</span>.<br/>
<span class="id">pose</span><span class="id"> U</span><span class="id"> B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">1</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> :=</span><span class="id"> block_mx</span><span class="id"> 1</span> (<span class="id">a^-1</span><span class="id"> *:</span><span class="id"> u</span>)<span class="id"> 0</span><span class="id"> B</span>.<br/>
<span class="id">rewrite</span> (<span class="id">reindex</span> (<span class="gallina-kwd">fun</span><span class="id"> B</span><span class="id"> =&gt;</span><span class="id"> L</span><span class="id"> *m</span><span class="id"> U</span><span class="id"> B</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">fun</span><span class="id"> A1</span><span class="id"> =&gt;</span><span class="id"> drsubmx</span><span class="id"> A1</span><span class="id"> -</span><span class="id"> Schur</span>)<span class="id"> =&gt;</span><span class="id"> [B</span><span class="id"> _</span><span class="id"> |</span><span class="id"> A1]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmx_block</span><span class="id"> block_mxKdr</span><span class="id"> mul1mx</span><span class="id"> addrC</span><span class="id"> addKr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !inE</span><span class="id"> mulmx_block</span><span class="id"> !mulmx0</span><span class="id"> mul0mx</span><span class="id"> !mulmx1</span><span class="id"> !addr0</span><span class="id"> mul1mx</span><span class="id"> addrC</span><span class="id"> subrK</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul_scalar_mx</span><span class="id"> scalerA</span><span class="id"> divff</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> andbC;</span><span class="id"> case/and3P</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> &lt;-</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{1}</span>(<span class="id">hsubmxK</span><span class="id"> A1</span>)<span class="id"> xrowE</span><span class="id"> mul_mx_row</span><span class="id"> row_mxKl</span><span class="id"> -xrowE</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> def_v</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -def_a</span><span class="id"> block_mxEh</span><span class="id"> vsubmxK</span><span class="id"> /v1</span><span class="id"> -def_v</span><span class="id"> xrkK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> trmx_inj;</span><span class="id"> rewrite</span><span class="id"> tr_row_mx</span><span class="id"> tr_col_mx</span><span class="id"> trmx_ursub</span><span class="id"> trmx_drsub</span><span class="id"> trmx_lsub</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> hsubmxK</span><span class="id"> vsubmxK</span>.<br/>
<span class="id">rewrite</span><span class="id"> -sum1_card;</span><span class="id"> apply:</span><span class="id"> eq_bigl</span><span class="id"> =&gt;</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> xrowE</span><span class="id"> unitmxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> !det_mulmx</span><span class="id"> unitrM</span><span class="id"> -unitmxE</span><span class="id"> unitmx_perm</span><span class="id"> det_lblock</span><span class="id"> det_ublock</span>.<br/>
<span class="id">rewrite</span><span class="id"> !det_scalar1</span><span class="id"> det1</span><span class="id"> mulr1</span><span class="id"> mul1r</span><span class="id"> unitrM</span><span class="id"> unitfE</span><span class="id"> nza</span><span class="id"> -unitmxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmx_block</span><span class="id"> !mulmx0</span><span class="id"> mul0mx</span><span class="id"> !addr0</span><span class="id"> !mulmx1</span><span class="id"> mul1mx</span><span class="id"> block_mxKur</span>.<br/>
<span class="id">rewrite</span><span class="id"> mul_scalar_mx</span><span class="id"> scalerA</span><span class="id"> divff</span><span class="id"> //</span><span class="id"> scale1r</span><span class="id"> eqxx</span><span class="id"> andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> block_mxEh</span><span class="id"> mul_mx_row</span><span class="id"> row_mxKl</span><span class="id"> -def_a</span><span class="id"> vsubmxK</span><span class="id"> -xrowE</span><span class="id"> xrkK</span><span class="id"> eqxx</span><span class="id"> andbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> card_GL_1</span><span class="id"> :</span><span class="id"> #|'GL_1[F]|</span><span class="id"> =</span><span class="id"> #|F|</span>.<span class="id">-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> card_GL</span><span class="id"> //</span><span class="id"> mul1n</span><span class="id"> big_nat1</span><span class="id"> expn1</span><span class="id"> subn1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> card_GL_2</span><span class="id"> :</span><span class="id"> #|'GL_2[F]|</span><span class="id"> =</span> (<span class="id">#|F|</span><span class="id"> *</span><span class="id"> #|F|</span>.<span class="id">-1</span><span class="id"> ^</span><span class="id"> 2</span><span class="id"> *</span><span class="id"> #|F|</span>.<span class="id">+1</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> card_GL</span><span class="id"> //</span><span class="id"> big_ltn</span><span class="id"> //</span><span class="id"> big_nat1</span><span class="id"> expn1</span><span class="id"> -</span>(<span class="id">addn1</span><span class="id"> #|F|</span>)<span class="id"> -subn1</span><span class="id"> -!mulnA</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -subn_sqr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CardGL</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> logn_card_GL_p</span><span class="id"> n</span><span class="id"> p</span><span class="id"> :</span><span class="id"> prime</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> logn</span><span class="id"> p</span><span class="id"> #|'GL_n</span>(<span class="id">p</span>)<span class="id">|</span><span class="id"> =</span><span class="id"> 'C</span>(<span class="id">n,</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> p_pr;</span><span class="id"> have</span><span class="id"> p_gt1</span><span class="id"> :=</span><span class="id"> prime_gt1</span><span class="id"> p_pr</span>.<br/>
<span class="id">have</span><span class="id"> p_i_gt0:</span><span class="id"> p</span><span class="id"> ^</span><span class="id"> _</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> expn_gt0</span><span class="id"> ltnW</span>.<br/>
<span class="id">have</span><span class="id"> &lt;-</span><span class="id"> :</span><span class="id"> #|'GL_n</span>.<span class="id">-1</span>.<span class="id">+1</span>(<span class="id">p</span>)<span class="id">|</span><span class="id"> =</span><span class="id"> #|'GL_n</span>(<span class="id">p</span>)<span class="id">|</span><span class="gallina-kwd"> by</span><span class="id"> []</span>.<br/>
<span class="id">rewrite</span> (<span class="id">card_GL</span><span class="id"> _</span> (<span class="id">ltn0Sn</span><span class="id"> n</span>.<span class="id">-1</span>))<span class="id"> card_ord</span><span class="id"> Fp_cast</span><span class="id"> //</span><span class="id"> big_add1</span><span class="id"> /=</span>.<br/>
<span class="id">pose</span><span class="id"> p'gt0</span><span class="id"> m</span><span class="id"> :=</span><span class="id"> m</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> /\</span><span class="id"> logn</span><span class="id"> p</span><span class="id"> m</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<span class="id">suffices</span><span class="id"> [Pgt0</span><span class="id"> p'P]:</span><span class="id"> p'gt0</span> (<span class="id">\prod_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">-1</span>.<span class="id">+1</span>) (<span class="id">p</span><span class="id"> ^</span><span class="id"> i</span>.<span class="id">+1</span><span class="id"> -</span><span class="id"> 1</span>))<span class="id">%N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lognM</span><span class="id"> //</span><span class="id"> p'P</span><span class="id"> pfactorK</span><span class="id"> //</span><span class="id"> addn0;</span><span class="id"> case</span><span class="id"> n</span>.<br/>
<span class="id">apply:</span><span class="id"> big_ind</span><span class="id"> =&gt;</span><span class="id"> [|m1</span><span class="id"> m2</span><span class="id"> [m10</span><span class="id"> p'm1]</span><span class="id"> [m20]|i</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> {}/p'gt0</span><span class="id"> ?logn1</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> muln_gt0</span><span class="id"> m10</span><span class="id"> lognM</span><span class="id"> ?p'm1</span>.<br/>
<span class="id">rewrite</span><span class="id"> lognE</span><span class="id"> -if_neg</span><span class="id"> subn_gt0</span><span class="id"> p_pr</span><span class="id"> /=</span><span class="id"> -{1</span><span class="id"> 2}</span>(<span class="id">exp1n</span><span class="id"> i</span>.<span class="id">+1</span>)<span class="id"> ltn_exp2r</span><span class="id"> //</span><span class="id"> p_gt1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> dvdn_subr</span><span class="id"> ?dvdn_exp</span><span class="id"> //</span><span class="id"> gtnNdvd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> MatrixAlgebra</span>.<br/>
<br/>
<span class="vernacular">Variables</span><span class="id"> F</span><span class="id"> :</span><span class="id"> fieldType</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A \in R&quot;</span><span class="id"> :=</span> (<span class="id">@submx</span><span class="id"> F</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">mxvec</span><span class="id"> A</span>)<span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mem0mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> 0</span><span class="id"> \in</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> linear0</span><span class="id"> sub0mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx0</span><span class="id"> n</span><span class="id"> A</span><span class="id"> :</span> (<span class="id">A</span><span class="id"> \in</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'A_n</span>))<span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> submx0</span><span class="id"> mxvec_eq0;</span><span class="id"> move/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx1</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> :</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> mxvec</span><span class="id"> 1%:M</span>)<span class="id"> =</span><span class="id"> is_scalar_mx</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/sub_rVP/is_scalar_mxP=&gt;</span><span class="id"> [[a]</span><span class="id"> |</span><span class="id"> [a</span><span class="id"> -&gt;]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -linearZ</span><span class="id"> scale_scalar_mx</span><span class="id"> mulr1</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">can_inj</span><span class="id"> mxvecK</span>)<span class="id">;</span><span class="gallina-kwd"> exists</span><span class="id"> a</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> -linearZ</span><span class="id"> scale_scalar_mx</span><span class="id"> mulr1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx_subP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> A,</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R2</span>) (<span class="id">R1</span><span class="id"> &lt;=</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [sR12</span><span class="id"> A</span><span class="id"> R1_A</span><span class="id"> |</span><span class="id"> sR12];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> submx_trans</span><span class="id"> sR12</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/rV_subP=&gt;</span><span class="id"> vA;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">vec_mxK</span><span class="id"> vA</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> sR12</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> memmx_subP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx_eqP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> A,</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> R1</span>)<span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> R2</span>)) (<span class="id">R1</span><span class="id"> ==</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> eqmxP</span>)<span class="id"> =&gt;</span><span class="id"> [eqR12</span><span class="id"> A</span><span class="id"> |</span><span class="id"> eqR12];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqR12</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP/rV_eqP=&gt;</span><span class="id"> vA;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">vec_mxK</span><span class="id"> vA</span>)<span class="id"> eqR12</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> memmx_eqP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx_addsP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> D,</span><span class="id"> [/\</span><span class="id"> D</span>.<span class="id">1</span><span class="id"> \in</span><span class="id"> R1,</span><span class="id"> D</span>.<span class="id">2</span><span class="id"> \in</span><span class="id"> R2</span><span class="id"> &amp;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> D</span>.<span class="id">1</span><span class="id"> +</span><span class="id"> D</span>.<span class="id">2]</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> +</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> sub_addsmxP</span>)<span class="id"> =&gt;</span><span class="id"> [[u</span><span class="id"> /</span>(<span class="id">canRL</span><span class="id"> mxvecK</span>)<span class="id">-&gt;]</span><span class="id"> |</span><span class="id"> [D</span><span class="id"> []]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">vec_mx</span> (<span class="id">u</span>.<span class="id">1</span><span class="id"> *m</span><span class="id"> R1</span>)<span class="id">,</span><span class="id"> vec_mx</span> (<span class="id">u</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> R2</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> linearD</span><span class="id"> !vec_mxK</span><span class="id"> !submxMl</span>.<br/>
<span class="id">case/submxP=&gt;</span><span class="id"> u1</span><span class="id"> defD1</span><span class="id"> /submxP[u2</span><span class="id"> defD2]</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">u1,</span><span class="id"> u2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> linearD</span><span class="id"> /=</span><span class="id"> defD1</span><span class="id"> defD2</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> memmx_addsP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx_sumsP</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> R_</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> A_,</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> A_</span><span class="id"> i</span><span class="id"> &amp;</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> A_</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> R_</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> \in</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> R_</span><span class="id"> i</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> sub_sumsmxP</span>)<span class="id"> =&gt;</span><span class="id"> [[C</span><span class="id"> defA]</span><span class="id"> |</span><span class="id"> [A_</span><span class="id"> -&gt;</span><span class="id"> R_A]</span><span class="id"> {A}]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> vec_mx</span> (<span class="id">C</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> R_</span><span class="id"> i</span>))<span class="id"> =&gt;</span><span class="id"> [|i]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -linear_sum</span><span class="id"> -defA</span><span class="id"> /=</span><span class="id"> mxvecK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> vec_mxK</span><span class="id"> submxMl</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> mxvec</span> (<span class="id">A_</span><span class="id"> i</span>)<span class="id"> *m</span><span class="id"> pinvmx</span> (<span class="id">R_</span><span class="id"> i</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> linear_sum;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulmxKpV</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> memmx_sumsP</span><span class="id"> {I</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R_}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> has_non_scalar_mxP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">1%:M</span><span class="id"> \in</span><span class="id"> R</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> A,</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> ~~</span><span class="id"> is_scalar_mx</span><span class="id"> A</span>)<span class="id">%MS</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> \rank</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">posnP</span><span class="id"> n</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> |</span><span class="id"> n_gt0]</span><span class="gallina-kwd"> in</span><span class="id"> R</span><span class="id"> *;</span><span class="id"> set</span><span class="id"> S</span><span class="id"> :=</span><span class="id"> mxvec</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> sSR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [R]thinmx0</span><span class="id"> mxrank0;</span><span class="id"> right;</span><span class="id"> case;</span><span class="id"> rewrite</span><span class="id"> /is_scalar_mx</span><span class="id"> ?insubF</span>.<br/>
<span class="id">have</span><span class="id"> rankS:</span><span class="id"> \rank</span><span class="id"> S</span><span class="id"> =</span><span class="id"> 1%N</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqn_leq</span><span class="id"> rank_leq_row</span><span class="id"> lt0n</span><span class="id"> mxrank_eq0</span><span class="id"> mxvec_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mxrank_eq0</span><span class="id"> mxrank1</span><span class="id"> -lt0n</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{2}rankS</span> (<span class="id">ltn_leqif</span> (<span class="id">mxrank_leqif_sup</span><span class="id"> sSR</span>)).<br/>
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [/row_subPn[i]</span><span class="id"> |</span><span class="id"> [A</span><span class="id"> sAR]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[row</span><span class="id"> i</span><span class="id"> R]vec_mxK</span><span class="id"> memmx1;</span><span class="id"> set</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> vec_mx</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> nsA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> vec_mxK</span><span class="id"> row_sub</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -memmx1;</span><span class="id"> apply/contra/submx_trans</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> mulsmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A[F]_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_i</span><span class="id"> &lt;&lt;R1</span><span class="id"> *m</span><span class="id"> lin_mx</span> (<span class="id">mulmxr</span> (<span class="id">vec_mx</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> R2</span>)))<span class="id">&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> mulsmx</span><span class="id"> {m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> R1%_MS</span><span class="id"> R2%_MS</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;R1 * R2&quot;</span><span class="id"> :=</span> (<span class="id">mulsmx</span><span class="id"> R1</span><span class="id"> R2</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> genmx_muls</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">&lt;&lt;</span>(<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%MS&gt;&gt;%MS</span><span class="id"> =</span> (<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> genmx_sums;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> genmx_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mem_mulsmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> A1</span><span class="id"> A2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A1</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> -&gt;</span><span class="id"> A2</span><span class="id"> \in</span><span class="id"> R2</span><span class="id"> -&gt;</span><span class="id"> A1</span><span class="id"> *m</span><span class="id"> A2</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> R_A1</span><span class="id"> R_A2;</span><span class="id"> rewrite</span><span class="id"> -[A2]mxvecK;</span><span class="id"> case/submxP:</span><span class="id"> R_A2</span><span class="id"> =&gt;</span><span class="id"> a</span><span class="id"> -&gt;{A2}</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmx_sum_row</span><span class="id"> !linear_sum</span><span class="id"> summx_sub</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> 3!linearZ</span><span class="id"> scalemx_sub</span><span class="id"> {a}//=</span> (<span class="id">sumsmx_sup</span><span class="id"> i</span>)<span class="id"> //</span><span class="id"> genmxE</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[A1]mxvecK;</span><span class="id"> case/submxP:</span><span class="id"> R_A1</span><span class="id"> =&gt;</span><span class="id"> a</span><span class="id"> -&gt;{A1}</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/submxP;</span><span class="gallina-kwd"> exists</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> mul_rV_lin</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmx_subP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> A1</span><span class="id"> A2,</span><span class="id"> A1</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> -&gt;</span><span class="id"> A2</span><span class="id"> \in</span><span class="id"> R2</span><span class="id"> -&gt;</span><span class="id"> A1</span><span class="id"> *m</span><span class="id"> A2</span><span class="id"> \in</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> &lt;=</span><span class="id"> R</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> memmx_subP</span>)<span class="id"> =&gt;</span><span class="id"> [sR12R</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> R_A1</span><span class="id"> R_A2</span><span class="id"> |</span><span class="id"> sR12R</span><span class="id"> A]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sR12R</span><span class="id"> ?mem_mulsmx</span>.<br/>
<span class="id">case/memmx_sumsP=&gt;</span><span class="id"> A_</span><span class="id"> -&gt;</span><span class="id"> R_A;</span><span class="id"> rewrite</span><span class="id"> linear_sum</span><span class="id"> summx_sub</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span> (<span class="id">submx_trans</span> (<span class="id">R_A</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> genmxE;</span><span class="id"> apply/row_subP=&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> row_mul</span><span class="id"> mul_rV_lin</span><span class="id"> sR12R</span><span class="id"> ?vec_mxK</span><span class="id"> ?row_sub</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> mulsmx_subP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> m</span><span class="id"> n</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmxS</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> m4</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R3</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m3,</span><span class="id"> n</span>)) (<span class="id">R4</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m4,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> &lt;=</span><span class="id"> R3</span><span class="id"> -&gt;</span><span class="id"> R2</span><span class="id"> &lt;=</span><span class="id"> R4</span><span class="id"> -&gt;</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> &lt;=</span><span class="id"> R3</span><span class="id"> *</span><span class="id"> R4</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> sR13</span><span class="id"> sR24;</span><span class="id"> apply/mulsmx_subP=&gt;</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> R_A1</span><span class="id"> R_A2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> mem_mulsmx;</span><span class="id"> [apply:</span><span class="id"> submx_trans</span><span class="id"> sR13</span><span class="id"> |</span><span class="id"> apply:</span><span class="id"> submx_trans</span><span class="id"> sR24]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muls_eqmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> m4</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R3</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m3,</span><span class="id"> n</span>)) (<span class="id">R4</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m4,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> :=:</span><span class="id"> R3</span><span class="id"> -&gt;</span><span class="id"> R2</span><span class="id"> :=:</span><span class="id"> R4</span><span class="id"> -&gt;</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> =</span><span class="id"> R3</span><span class="id"> *</span><span class="id"> R4</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> eqR13</span><span class="id"> eqR24;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">genmx_muls</span><span class="id"> R1</span><span class="id"> R2</span>)<span class="id"> -</span>(<span class="id">genmx_muls</span><span class="id"> R3</span><span class="id"> R4</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/genmxP;</span><span class="id"> rewrite</span><span class="id"> !mulsmxS</span><span class="id"> ?eqR13</span><span class="id"> ?eqR24</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmxP</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists2</span><span class="id"> A1,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> A1</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> R1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="gallina-kwd"> exists2</span><span class="id"> A2,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> A2</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> R2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="id"> A</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> ^</span><span class="id"> 2</span>)<span class="id"> A1</span><span class="id"> i</span><span class="id"> *m</span><span class="id"> A2</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [R_A|[A1</span><span class="id"> R_A1</span><span class="id"> [A2</span><span class="id"> R_A2</span><span class="id"> -&gt;{A}]]];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> linear_sum</span><span class="id"> summx_sub</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mem_mulsmx</span>.<br/>
<span class="id">have{R_A}:</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> &lt;&lt;R2&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> memmx_subP</span><span class="id"> R_A;</span><span class="id"> rewrite</span><span class="id"> mulsmxS</span><span class="id"> ?genmxE</span>.<br/>
<span class="id">case/memmx_sumsP=&gt;</span><span class="id"> A_</span><span class="id"> -&gt;</span><span class="id"> R_A;</span><span class="id"> pose</span><span class="id"> A2_</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> vec_mx</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> &lt;&lt;R2&gt;&gt;%MS</span>).<br/>
<span class="id">pose</span><span class="id"> A1_</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> mxvec</span> (<span class="id">A_</span><span class="id"> i</span>)<span class="id"> *m</span><span class="id"> pinvmx</span> (<span class="id">R1</span><span class="id"> *m</span><span class="id"> lin_mx</span> (<span class="id">mulmxr</span> (<span class="id">A2_</span><span class="id"> i</span>)))<span class="id"> *m</span><span class="id"> R1</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">vec_mx</span><span class="id"> \o</span><span class="id"> A1_</span>)<span class="id"> =&gt;</span><span class="id"> [i|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> vec_mxK</span><span class="id"> submxMl</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> A2_</span><span class="id"> =&gt;</span><span class="id"> [i|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> vec_mxK</span><span class="id"> -</span>(<span class="id">genmxE</span><span class="id"> R2</span>)<span class="id"> row_sub</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> *m</span><span class="id"> _]</span>(<span class="id">mx_rV_lin</span> (<span class="id">mulmxr</span> (<span class="id">A2_</span><span class="id"> i</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> mulmxKpV</span><span class="id"> ?mxvecK</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">genmxE</span> (_<span class="id"> *m</span><span class="id"> _</span>))<span class="id"> R_A</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> mulsmxP</span><span class="id"> {m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmxA</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">R3</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> *</span> (<span class="id">R2</span><span class="id"> *</span><span class="id"> R3</span>)<span class="id"> =</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> *</span><span class="id"> R3</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">genmx_muls</span> (_<span class="id"> *</span><span class="id"> _</span>)<span class="id">%MS</span>)<span class="id"> -genmx_muls;</span><span class="id"> apply/genmxP/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/mulsmx_subP=&gt;</span><span class="id"> A1</span><span class="id"> A23</span><span class="id"> R_A1;</span><span class="id"> case/mulsmxP=&gt;</span><span class="id"> A2</span><span class="id"> R_A2</span><span class="id"> [A3</span><span class="id"> R_A3</span><span class="id"> -&gt;{A23}]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !linear_sum</span><span class="id"> summx_sub</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulmxA</span><span class="id"> !mem_mulsmx</span>.<br/>
<span class="id">apply/mulsmx_subP=&gt;</span><span class="id"> _</span><span class="id"> A3</span><span class="id"> /mulsmxP[A1</span><span class="id"> R_A1</span><span class="id"> [A2</span><span class="id"> R_A2</span><span class="id"> -&gt;]]</span><span class="id"> R_A3</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmx_suml</span><span class="id"> linear_sum</span><span class="id"> summx_sub</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulmxA</span><span class="id"> !mem_mulsmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmxDl</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">R3</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">R1</span><span class="id"> +</span><span class="id"> R2</span>)<span class="id"> *</span><span class="id"> R3</span><span class="id"> =</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R3</span><span class="id"> +</span><span class="id"> R2</span><span class="id"> *</span><span class="id"> R3</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">genmx_muls</span><span class="id"> R2</span><span class="id"> R3</span>)<span class="id"> -</span>(<span class="id">genmx_muls</span><span class="id"> R1</span><span class="id"> R3</span>)<span class="id"> -genmx_muls</span><span class="id"> -genmx_adds</span>.<br/>
<span class="id">apply/genmxP;</span><span class="id"> rewrite</span><span class="id"> andbC</span><span class="id"> addsmx_sub</span><span class="id"> !mulsmxS</span><span class="id"> ?addsmxSl</span><span class="id"> ?addsmxSr</span><span class="id"> //=</span>.<br/>
<span class="id">apply/mulsmx_subP=&gt;</span><span class="id"> _</span><span class="id"> A3</span><span class="id"> /memmx_addsP[A</span><span class="id"> [R_A1</span><span class="id"> R_A2</span><span class="id"> -&gt;]]</span><span class="id"> R_A3</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxDl</span><span class="id"> linearD</span><span class="id"> addmx_sub_adds</span><span class="id"> ?mem_mulsmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmxDr</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m3</span><span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>)) (<span class="id">R3</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m3,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> *</span> (<span class="id">R2</span><span class="id"> +</span><span class="id"> R3</span>)<span class="id"> =</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> +</span><span class="id"> R1</span><span class="id"> *</span><span class="id"> R3</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">genmx_muls</span><span class="id"> R1</span><span class="id"> R3</span>)<span class="id"> -</span>(<span class="id">genmx_muls</span><span class="id"> R1</span><span class="id"> R2</span>)<span class="id"> -genmx_muls</span><span class="id"> -genmx_adds</span>.<br/>
<span class="id">apply/genmxP;</span><span class="id"> rewrite</span><span class="id"> andbC</span><span class="id"> addsmx_sub</span><span class="id"> !mulsmxS</span><span class="id"> ?addsmxSl</span><span class="id"> ?addsmxSr</span><span class="id"> //=</span>.<br/>
<span class="id">apply/mulsmx_subP=&gt;</span><span class="id"> A1</span><span class="id"> _</span><span class="id"> R_A1</span><span class="id"> /memmx_addsP[A</span><span class="id"> [R_A2</span><span class="id"> R_A3</span><span class="id"> -&gt;]]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxDr</span><span class="id"> linearD</span><span class="id"> addmx_sub_adds</span><span class="id"> ?mem_mulsmx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulsmx0</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">R1</span><span class="id"> *</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -submx0;</span><span class="id"> apply/mulsmx_subP=&gt;</span><span class="id"> A1</span><span class="id"> A0</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [A0</span><span class="id"> \in</span><span class="id"> 0]eqmx0</span><span class="id"> =&gt;</span><span class="id"> /memmx0-&gt;;</span><span class="id"> rewrite</span><span class="id"> mulmx0</span><span class="id"> mem0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muls0mx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span> ((<span class="id">0</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>))<span class="id"> *</span><span class="id"> R2</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -submx0;</span><span class="id"> apply/mulsmx_subP=&gt;</span><span class="id"> A0</span><span class="id"> A2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [A0</span><span class="id"> \in</span><span class="id"> 0]eqmx0</span><span class="id"> =&gt;</span><span class="id"> /memmx0-&gt;;</span><span class="id"> rewrite</span><span class="id"> mul0mx</span><span class="id"> mem0mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> left_mx_ideal</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">R1</span><span class="id"> *</span><span class="id"> R2</span><span class="id"> &lt;=</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> right_mx_ideal</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">R2</span><span class="id"> *</span><span class="id"> R1</span><span class="id"> &lt;=</span><span class="id"> R2</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mx_ideal</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">left_mx_ideal</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> &amp;&amp;</span><span class="id"> right_mx_ideal</span><span class="id"> R1</span><span class="id"> R2</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxring_id</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> e</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[/\</span><span class="id"> e</span><span class="id"> !=</span><span class="id"> 0,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">e</span><span class="id"> \in</span><span class="id"> R,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> A,</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> e</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&amp;</span><span class="gallina-kwd"> forall</span><span class="id"> A,</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> e</span><span class="id"> =</span><span class="id"> A]%MS</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> has_mxring_id</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A[F]_</span>(<span class="id">m</span><span class="id"> ,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">R</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span><br/>
&nbsp;&nbsp;(<span class="id">row_mx</span><span class="id"> 0</span> (<span class="id">row_mx</span> (<span class="id">mxvec</span><span class="id"> R</span>) (<span class="id">mxvec</span><span class="id"> R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;=</span><span class="id"> row_mx</span> (<span class="id">cokermx</span><span class="id"> R</span>) (<span class="id">row_mx</span> (<span class="id">lin_mx</span> (<span class="id">mulmx</span><span class="id"> R</span><span class="id"> \o</span><span class="id"> lin_mulmx</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lin_mx</span> (<span class="id">mulmx</span><span class="id"> R</span><span class="id"> \o</span><span class="id"> lin_mulmxr</span>))))<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mxring</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">left_mx_ideal</span><span class="id"> R</span><span class="id"> R</span><span class="id"> &amp;&amp;</span><span class="id"> has_mxring_id</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxring_idP</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> e,</span><span class="id"> mxring_id</span><span class="id"> R</span><span class="id"> e</span>) (<span class="id">has_mxring_id</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> andP</span>)<span class="id"> =&gt;</span><span class="id"> [[nzR]</span><span class="id"> |</span><span class="id"> [e</span><span class="id"> [nz_e</span><span class="id"> Re</span><span class="id"> ideR</span><span class="id"> idRe]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">case/submxP=&gt;</span><span class="id"> v;</span><span class="id"> rewrite</span><span class="id"> -[v]vec_mxK;</span><span class="id"> move/vec_mx:</span><span class="id"> v</span><span class="id"> =&gt;</span><span class="id"> e</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mul_mx_row;</span><span class="id"> case/eq_row_mx</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> eq_sym</span><span class="id"> -submxE</span><span class="id"> =&gt;</span><span class="id"> Re</span>.<br/>
&nbsp;&nbsp;<span class="id">case/eq_row_mx;</span><span class="id"> rewrite</span><span class="id"> !{1}mul_rV_lin1</span><span class="id"> /=</span><span class="id"> mxvecK</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span><span class="id"> u</span><span class="id"> :=</span> (_<span class="id"> *m</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">can_inj</span><span class="id"> mxvecK</span>)<span class="id"> idRe</span><span class="id"> /</span>(<span class="id">can_inj</span><span class="id"> mxvecK</span>)<span class="id"> ideR</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> e;</span><span class="id"> split=&gt;</span><span class="id"> //</span><span class="id"> [</span><span class="id"> |</span><span class="id"> A</span><span class="id"> /submxP[a</span><span class="id"> defA]</span><span class="id"> |</span><span class="id"> A</span><span class="id"> /submxP[a</span><span class="id"> defA]]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contra</span><span class="id"> nzR;</span><span class="id"> rewrite</span><span class="id"> ideR</span><span class="id"> =&gt;</span><span class="id"> /eqP-&gt;;</span><span class="id"> rewrite</span><span class="id"> !linear0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -{2}[A]mxvecK</span><span class="id"> defA</span><span class="id"> idRe</span><span class="id"> mulmxA</span><span class="id"> mx_rV_lin</span><span class="id"> -defA</span><span class="id"> /=</span><span class="id"> mxvecK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{2}[A]mxvecK</span><span class="id"> defA</span><span class="id"> ideR</span><span class="id"> mulmxA</span><span class="id"> mx_rV_lin</span><span class="id"> -defA</span><span class="id"> /=</span><span class="id"> mxvecK</span>.<br/>
<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraNneq</span><span class="id"> nz_e</span><span class="id"> =&gt;</span><span class="id"> R0;</span><span class="id"> rewrite</span><span class="id"> R0</span><span class="id"> eqmx0</span><span class="gallina-kwd"> in</span><span class="id"> Re;</span><span class="id"> rewrite</span> (<span class="id">memmx0</span><span class="id"> Re</span>).<br/>
<span class="id">apply/submxP;</span><span class="gallina-kwd"> exists</span> (<span class="id">mxvec</span><span class="id"> e</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !mul_mx_row</span><span class="id"> !{1}mul_rV_lin1</span>.<br/>
<span class="id">rewrite</span><span class="id"> submxE</span><span class="gallina-kwd"> in</span><span class="id"> Re;</span><span class="id"> rewrite</span><span class="id"> {Re}</span>(<span class="id">eqP</span><span class="id"> Re</span>).<br/>
<span class="id">congr</span> (<span class="id">row_mx</span><span class="id"> 0</span> (<span class="id">row_mx</span> (<span class="id">mxvec</span><span class="id"> _</span>) (<span class="id">mxvec</span><span class="id"> _</span>)))<span class="id">;</span><span class="id"> apply/row_matrixP=&gt;</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !row_mul</span><span class="id"> !mul_rV_lin1</span><span class="id"> /=</span><span class="id"> mxvecK</span><span class="id"> ideR</span><span class="id"> vec_mxK</span><span class="id"> ?row_sub</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !row_mul</span><span class="id"> !mul_rV_lin1</span><span class="id"> /=</span><span class="id"> mxvecK</span><span class="id"> idRe</span><span class="id"> vec_mxK</span><span class="id"> ?row_sub</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> mxring_idP</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CentMxDef</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">m</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A[F]_</span>(<span class="id">m,</span><span class="id"> n</span>)).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> cent_mx_fun</span> (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M[F]_n</span>)<span class="id"> :=</span><span class="id"> R</span><span class="id"> *m</span><span class="id"> lin_mx</span> (<span class="id">mulmxr</span><span class="id"> B</span><span class="id"> \-</span><span class="id"> mulmx</span><span class="id"> B</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cent_mx_fun_is_linear</span><span class="id"> :</span><span class="id"> linear</span><span class="id"> cent_mx_fun</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a</span><span class="id"> A</span><span class="id"> B;</span><span class="id"> apply/row_matrixP=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> linearP</span><span class="id"> row_mul</span><span class="id"> mul_rV_lin</span>.<br/>
<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> [row</span><span class="id"> i</span><span class="id"> _</span><span class="gallina-kwd"> as</span><span class="id"> v</span><span class="gallina-kwd"> in</span><span class="id"> a</span><span class="id"> *:</span><span class="id"> v]row_mul</span><span class="id"> mul_rV_lin</span><span class="id"> row_mul</span><span class="id"> mul_rV_lin</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -linearP</span><span class="id"> -</span>(<span class="id">linearP</span> (<span class="id">mulmx</span> (<span class="id">vec_mx</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> R</span>))<span class="id"> \-</span><span class="id"> mulmxr</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">GRing</span>.<span class="id">isSemilinear</span>.<span class="id">Build</span><span class="id"> F</span><span class="id"> 'M[F]_n</span><span class="id"> 'M[F]_</span>(<span class="id">m,</span><span class="id"> n</span><span class="id"> *</span><span class="id"> n</span>)<span class="id"> _</span><span class="id"> cent_mx_fun</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">GRing</span>.<span class="id">semilinear_linear</span><span class="id"> cent_mx_fun_is_linear</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> cent_mx</span><span class="id"> :=</span><span class="id"> kermx</span> (<span class="id">lin_mx</span><span class="id"> cent_mx_fun</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> center_mx</span><span class="id"> :=</span> (<span class="id">R</span><span class="id"> :&amp;:</span><span class="id"> cent_mx</span>)<span class="id">%MS</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> CentMxDef</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''C' ( R )&quot;</span><span class="id"> :=</span> (<span class="id">cent_mx</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;''Z' ( R )&quot;</span><span class="id"> :=</span> (<span class="id">center_mx</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cent_rowP</span><span class="id"> m</span><span class="id"> n</span><span class="id"> B</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i</span> (<span class="id">A</span><span class="id"> :=</span><span class="id"> vec_mx</span> (<span class="id">row</span><span class="id"> i</span><span class="id"> R</span>))<span class="id">,</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> A</span>) (<span class="id">B</span><span class="id"> \in</span><span class="id"> 'C</span>(<span class="id">R</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> sub_kermxP</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mul_vec_lin</span><span class="id"> =&gt;</span><span class="id"> cBE</span>.<br/>
&nbsp;&nbsp;<span class="id">move/</span>(<span class="id">canRL</span><span class="id"> mxvecK</span>)<span class="id">:</span><span class="id"> cBE</span><span class="id"> =&gt;</span><span class="id"> cBE</span><span class="id"> i</span><span class="id"> A</span><span class="id"> /=;</span><span class="id"> move/</span>(<span class="id">congr1</span> (<span class="id">row</span><span class="id"> i</span>))<span class="id">:</span><span class="id"> cBE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> row_mul</span><span class="id"> mul_rV_lin</span><span class="id"> -/A;</span><span class="id"> move/</span>(<span class="id">canRL</span><span class="id"> mxvecK</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/</span>(<span class="id">canRL</span> (<span class="id">subrK</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !linear0</span><span class="id"> add0r</span>.<br/>
<span class="id">apply:</span> (<span class="id">canLR</span><span class="id"> vec_mxK</span>)<span class="id">;</span><span class="id"> apply/row_matrixP=&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> row_mul</span><span class="id"> mul_rV_lin</span><span class="id"> /=</span><span class="id"> cBE</span><span class="id"> subrr</span><span class="id"> !linear0</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> cent_rowP</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> B</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cent_mxP</span><span class="id"> m</span><span class="id"> n</span><span class="id"> B</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> A,</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> A</span>) (<span class="id">B</span><span class="id"> \in</span><span class="id"> 'C</span>(<span class="id">R</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> cent_rowP</span>)<span class="id"> =&gt;</span><span class="id"> cEB</span><span class="id"> =&gt;</span><span class="id"> [A</span><span class="id"> sAE</span><span class="id"> |</span><span class="id"> i</span><span class="id"> A]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[A]mxvecK</span><span class="id"> -</span>(<span class="id">mulmxKpV</span><span class="id"> sAE</span>)<span class="id">;</span><span class="id"> move:</span> (<span class="id">mxvec</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> u</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !mulmx_sum_row</span><span class="id"> !linear_sum</span><span class="id"> mulmx_suml;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> 2!linearZ</span><span class="id"> -scalemxAl</span><span class="id"> /=</span><span class="id"> cEB</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cEB</span><span class="id"> //</span><span class="id"> vec_mxK</span><span class="id"> row_sub</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> cent_mxP</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> B</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> scalar_mx_cent</span><span class="id"> m</span><span class="id"> n</span><span class="id"> a</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">a%:M</span><span class="id"> \in</span><span class="id"> 'C</span>(<span class="id">R</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/cent_mxP=&gt;</span><span class="id"> A</span><span class="id"> _;</span><span class="id"> apply:</span><span class="id"> scalar_mxC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> center_mx_sub</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">'Z</span>(<span class="id">R</span>)<span class="id"> &lt;=</span><span class="id"> R</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> capmxSl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> center_mxP</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> R</span><span class="id"> /\</span><span class="gallina-kwd"> forall</span><span class="id"> B,</span><span class="id"> B</span><span class="id"> \in</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> *m</span><span class="id"> A</span><span class="id"> =</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span><span class="id"> \in</span><span class="id"> 'Z</span>(<span class="id">R</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> sub_capmx;</span><span class="id"> case</span><span class="id"> R_A:</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> R</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> right;</span><span class="id"> case</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> cent_mxP</span>)<span class="id"> =&gt;</span><span class="id"> [cAR</span><span class="id"> |</span><span class="id"> [_</span><span class="id"> cAR]]</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> center_mxP</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxring_id_uniq</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> e1</span><span class="id"> e2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mxring_id</span><span class="id"> R</span><span class="id"> e1</span><span class="id"> -&gt;</span><span class="id"> mxring_id</span><span class="id"> R</span><span class="id"> e2</span><span class="id"> -&gt;</span><span class="id"> e1</span><span class="id"> =</span><span class="id"> e2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> [_</span><span class="id"> Re1</span><span class="id"> idRe1</span><span class="id"> _]</span><span class="id"> [_</span><span class="id"> Re2</span><span class="id"> _</span><span class="id"> ide2R];</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">idRe1</span><span class="id"> _</span><span class="id"> Re2</span>)<span class="id"> ide2R</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cent_mx_ideal</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> left_mx_ideal</span><span class="id"> 'C</span>(<span class="id">R</span>)<span class="id">%MS</span><span class="id"> 'C</span>(<span class="id">R</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/mulsmx_subP=&gt;</span><span class="id"> A1</span><span class="id"> A2</span><span class="id"> C_A1</span><span class="id"> C_A2;</span><span class="id"> apply/cent_mxP=&gt;</span><span class="id"> B</span><span class="id"> R_B</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulmxA</span> (<span class="id">cent_mxP</span><span class="id"> C_A1</span>)<span class="id"> //</span><span class="id"> -!mulmxA</span> (<span class="id">cent_mxP</span><span class="id"> C_A2</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cent_mx_ring</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> n</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> mxring</span><span class="id"> 'C</span>(<span class="id">R</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> n_gt0;</span><span class="id"> rewrite</span><span class="id"> /mxring</span><span class="id"> cent_mx_ideal;</span><span class="id"> apply/mxring_idP</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> 1%:M;</span><span class="id"> split=&gt;</span><span class="id"> [||A</span><span class="id"> _|A</span><span class="id"> _];</span><span class="id"> rewrite</span><span class="id"> ?mulmx1</span><span class="id"> ?mul1mx</span><span class="id"> ?scalar_mx_cent</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mxrank_eq0</span><span class="id"> mxrank1</span><span class="id"> -lt0n</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_adds_center</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">R1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">R2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mx_ideal</span> (<span class="id">R1</span><span class="id"> +</span><span class="id"> R2</span>)<span class="id">%MS</span><span class="id"> R1</span><span class="id"> -&gt;</span><span class="id"> mx_ideal</span> (<span class="id">R1</span><span class="id"> +</span><span class="id"> R2</span>)<span class="id">%MS</span><span class="id"> R2</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mxdirect</span> (<span class="id">R1</span><span class="id"> +</span><span class="id"> R2</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">'Z</span>((<span class="id">R1</span><span class="id"> +</span><span class="id"> R2</span>)<span class="id">%MS</span>)<span class="id"> :=:</span><span class="id"> 'Z</span>(<span class="id">R1</span>)<span class="id"> +</span><span class="id"> 'Z</span>(<span class="id">R2</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case/andP=&gt;</span><span class="id"> idlR1</span><span class="id"> idrR1</span><span class="id"> /andP[idlR2</span><span class="id"> idrR2]</span><span class="id"> /mxdirect_addsP</span><span class="id"> dxR12</span>.<br/>
<span class="id">apply/eqmxP/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/memmx_subP=&gt;</span><span class="id"> z0;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>.<br/>
&nbsp;&nbsp;<span class="id">case/memmx_addsP=&gt;</span><span class="id"> z</span><span class="id"> [R1z1</span><span class="id"> R2z2</span><span class="id"> -&gt;{z0}]</span><span class="id"> Cz</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> linearD</span><span class="id"> addmx_sub_adds</span><span class="id"> //=</span><span class="id"> ?sub_capmx</span><span class="id"> ?R1z1</span><span class="id"> ?R2z2</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/cent_mxP=&gt;</span><span class="id"> A</span><span class="id"> R1_A;</span><span class="id"> have</span><span class="id"> R_A</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R1_A</span> (<span class="id">addsmxSl</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have</span><span class="id"> Rz2</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R2z2</span> (<span class="id">addsmxSr</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{1}[z</span>.<span class="id">1]</span>(<span class="id">addrK</span><span class="id"> z</span>.<span class="id">2</span>)<span class="id"> mulmxBr</span> (<span class="id">cent_mxP</span><span class="id"> Cz</span>)<span class="id"> //</span><span class="id"> mulmxDl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [A</span><span class="id"> *m</span><span class="id"> z</span>.<span class="id">2]memmx0</span><span class="id"> 1?[z</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> A]memmx0</span><span class="id"> ?addrK</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply/cent_mxP=&gt;</span><span class="id"> A</span><span class="id"> R2_A;</span><span class="id"> have</span><span class="id"> R_A</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R2_A</span> (<span class="id">addsmxSr</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Rz1</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R1z1</span> (<span class="id">addsmxSl</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{1}[z</span>.<span class="id">2]</span>(<span class="id">addKr</span><span class="id"> z</span>.<span class="id">1</span>)<span class="id"> mulmxDr</span> (<span class="id">cent_mxP</span><span class="id"> Cz</span>)<span class="id"> //</span><span class="id"> mulmxDl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulmxN</span><span class="id"> [A</span><span class="id"> *m</span><span class="id"> z</span>.<span class="id">1]memmx0</span><span class="id"> 1?[z</span>.<span class="id">1</span><span class="id"> *m</span><span class="id"> A]memmx0</span><span class="id"> ?addKr</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR2</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR2</span>).<br/>
<span class="id">rewrite</span><span class="id"> addsmx_sub;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/memmx_subP=&gt;</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> =&gt;</span><span class="id"> /andP[R1z</span><span class="id"> cR1z]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Rz</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R1z</span> (<span class="id">addsmxSl</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sub_capmx</span><span class="id"> Rz;</span><span class="id"> apply/cent_mxP=&gt;</span><span class="id"> A0</span>.<br/>
&nbsp;&nbsp;<span class="id">case/memmx_addsP=&gt;</span><span class="id"> A</span><span class="id"> [R1_A1</span><span class="id"> R2_A2]</span><span class="id"> -&gt;{A0}</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> R_A2</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R2_A2</span> (<span class="id">addsmxSr</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulmxDl</span><span class="id"> mulmxDr</span> (<span class="id">cent_mxP</span><span class="id"> cR1z</span>)<span class="id"> //;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [A</span>.<span class="id">2</span><span class="id"> *m</span><span class="id"> z]memmx0</span><span class="id"> 1?[z</span><span class="id"> *m</span><span class="id"> A</span>.<span class="id">2]memmx0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR2</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR2</span>).<br/>
<span class="id">apply/memmx_subP=&gt;</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !sub_capmx</span><span class="id"> =&gt;</span><span class="id"> /andP[R2z</span><span class="id"> cR2z]</span>.<br/>
<span class="id">have</span><span class="id"> Rz</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R2z</span> (<span class="id">addsmxSr</span><span class="id"> R1</span><span class="id"> R2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> Rz</span>.<br/>
<span class="id">apply/cent_mxP=&gt;</span><span class="id"> _</span><span class="id"> /memmx_addsP[A</span><span class="id"> [R1_A1</span><span class="id"> R2_A2</span><span class="id"> -&gt;]]</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulmxDl</span><span class="id"> mulmxDr</span> (<span class="id">cent_mxP</span><span class="id"> cR2z</span><span class="id"> _</span><span class="id"> R2_A2</span>)<span class="id"> //;</span><span class="id"> congr</span> (_<span class="id"> +</span><span class="id"> _</span>).<br/>
<span class="id">have</span><span class="id"> R_A1</span><span class="id"> :=</span><span class="id"> submx_trans</span><span class="id"> R1_A1</span> (<span class="id">addsmxSl</span><span class="id"> R1</span><span class="id"> R2</span>).<br/>
<span class="id">rewrite</span><span class="id"> [A</span>.<span class="id">1</span><span class="id"> *m</span><span class="id"> z]memmx0</span><span class="id"> 1?[z</span><span class="id"> *m</span><span class="id"> A</span>.<span class="id">1]memmx0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR2</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -dxR12</span><span class="id"> sub_capmx</span> (<span class="id">mulsmx_subP</span><span class="id"> idrR1</span>)<span class="id"> //</span> (<span class="id">mulsmx_subP</span><span class="id"> idlR2</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxdirect_sums_center</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>)<span class="id"> m</span><span class="id"> n</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> R_</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\sum_i</span><span class="id"> R_</span><span class="id"> i</span><span class="id"> :=:</span><span class="id"> R</span>)<span class="id">%MS</span><span class="id"> -&gt;</span><span class="id"> mxdirect</span> (<span class="id">\sum_i</span><span class="id"> R_</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> I,</span><span class="id"> mx_ideal</span><span class="id"> R</span> (<span class="id">R_</span><span class="id"> i</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">'Z</span>(<span class="id">R</span>)<span class="id"> :=:</span><span class="id"> \sum_i</span><span class="id"> 'Z</span>(<span class="id">R_</span><span class="id"> i</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> defR</span><span class="id"> dxR</span><span class="id"> idealR</span>.<br/>
<span class="id">have</span><span class="id"> sR_R:</span> (<span class="id">R_</span><span class="id"> _</span><span class="id"> &lt;=</span><span class="id"> R</span>)<span class="id">%MS</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> -defR</span> (<span class="id">sumsmx_sup</span><span class="id"> i</span>).<br/>
<span class="id">have</span><span class="id"> anhR</span><span class="id"> i</span><span class="id"> j</span><span class="id"> A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> j</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> \in</span><span class="id"> R_</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> B</span><span class="id"> \in</span><span class="id"> R_</span><span class="id"> j</span><span class="id"> -&gt;</span><span class="id"> A</span><span class="id"> *m</span><span class="id"> B</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> ne_ij</span><span class="id"> RiA</span><span class="id"> RjB;</span><span class="id"> apply:</span><span class="id"> memmx0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [[_</span><span class="id"> idRiR]</span><span class="id"> [idRRj</span><span class="id"> _]]</span><span class="id"> :=</span> (<span class="id">andP</span> (<span class="id">idealR</span><span class="id"> i</span>)<span class="id">,</span><span class="id"> andP</span> (<span class="id">idealR</span><span class="id"> j</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mxdirect_sumsP</span><span class="id"> dxR</span><span class="id"> j</span>)<span class="id"> //</span><span class="id"> sub_capmx</span> (<span class="id">sumsmx_sup</span><span class="id"> i</span>)<span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">mulsmx_subP</span><span class="id"> idRRj</span>)<span class="id"> //</span> (<span class="id">memmx_subP</span> (<span class="id">sR_R</span><span class="id"> i</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">mulsmx_subP</span><span class="id"> idRiR</span>)<span class="id"> //</span> (<span class="id">memmx_subP</span> (<span class="id">sR_R</span><span class="id"> j</span>)).<br/>
<span class="id">apply/eqmxP/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/memmx_subP=&gt;</span><span class="id"> Z;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{1}defR</span><span class="id"> =&gt;</span><span class="id"> /memmx_sumsP[z</span><span class="id"> -&gt;{Z}</span><span class="id"> Rz</span><span class="id"> cRz]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/memmx_sumsP;</span><span class="gallina-kwd"> exists</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span><span class="id"> Rz</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/cent_mxP=&gt;</span><span class="id"> A</span><span class="id"> RiA;</span><span class="id"> have:=</span><span class="id"> cent_mxP</span><span class="id"> cRz</span><span class="id"> A</span> (<span class="id">memmx_subP</span> (<span class="id">sR_R</span><span class="id"> i</span>)<span class="id"> A</span><span class="id"> RiA</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //=</span><span class="id"> mulmxDl</span><span class="id"> mulmxDr</span><span class="id"> mulmx_suml</span><span class="id"> mulmx_sumr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> j;</span><span class="id"> last</span><span class="id"> rewrite</span><span class="id"> eq_sym;</span><span class="id"> move/anhR-&gt;</span>.<br/>
<span class="id">apply/sumsmx_subP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> apply/memmx_subP=&gt;</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span>.<br/>
<span class="id">case/andP=&gt;</span><span class="id"> Riz</span><span class="id"> cRiz;</span><span class="id"> rewrite</span><span class="id"> sub_capmx</span> (<span class="id">memmx_subP</span> (<span class="id">sR_R</span><span class="id"> i</span>))<span class="id"> //=</span>.<br/>
<span class="id">apply/cent_mxP=&gt;</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> -{1}defR;</span><span class="id"> case/memmx_sumsP=&gt;</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> R_a</span>.<br/>
<span class="id">rewrite</span> (<span class="id">bigD1</span><span class="id"> i</span>)<span class="id"> //</span><span class="id"> mulmxDl</span><span class="id"> mulmxDr</span><span class="id"> mulmx_suml</span><span class="id"> mulmx_sumr</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big1</span><span class="id"> =&gt;</span><span class="id"> [|j|j];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !addr0</span> (<span class="id">cent_mxP</span><span class="id"> cRiz</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> =&gt;</span><span class="id"> /anhR-&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/anhR-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MatrixAlgebra</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> mulsmx</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> R1%_MS</span><span class="id"> R2%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> left_mx_ideal</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span><span class="id"> S%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> right_mx_ideal</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span><span class="id"> S%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mx_ideal</span><span class="id"> {F</span><span class="id"> m1%_N</span><span class="id"> m2%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span><span class="id"> S%_MS</span><span class="id"> :</span><span class="id"> rename</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxring_id</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span><span class="id"> e%_R</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> has_mxring_id</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxring</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> cent_mx</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> center_mx</span><span class="id"> {F</span><span class="id"> m%_N</span><span class="id"> n%_N}</span><span class="id"> R%_MS</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;A \in R&quot;</span><span class="id"> :=</span> (<span class="id">submx</span> (<span class="id">mxvec</span><span class="id"> A</span>)<span class="id"> R</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;R * S&quot;</span><span class="id"> :=</span> (<span class="id">mulsmx</span><span class="id"> R</span><span class="id"> S</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''C' ( R )&quot;</span><span class="id"> :=</span> (<span class="id">cent_mx</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''C_' R ( S )&quot;</span><span class="id"> :=</span> (<span class="id">R</span><span class="id"> :&amp;:</span><span class="id"> 'C</span>(<span class="id">S</span>))<span class="id">%MS</span><span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''C_' ( R ) ( S )&quot;</span><span class="id"> :=</span> (<span class="id">'C_R</span>(<span class="id">S</span>))<span class="id">%MS</span> (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;''Z' ( R )&quot;</span><span class="id"> :=</span> (<span class="id">center_mx</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> matrix_set_scope</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> memmx_subP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> memmx_eqP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> memmx_addsP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n}</span><span class="id"> A</span><span class="id"> {R1</span><span class="id"> R2}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> memmx_sumsP</span><span class="id"> {F</span><span class="id"> I</span><span class="id"> P</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R_}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mulsmx_subP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> m</span><span class="id"> n</span><span class="id"> R1</span><span class="id"> R2</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mulsmxP</span><span class="id"> {F</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R1</span><span class="id"> R2}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mxring_idP</span><span class="id"> F</span><span class="id"> {m</span><span class="id"> n</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> cent_rowP</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> B</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> cent_mxP</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> B</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> center_mxP</span><span class="id"> {F</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> R}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MapMatrixSpaces</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span class="id">aF</span><span class="id"> rF</span><span class="id"> :</span><span class="id"> fieldType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> {rmorphism</span><span class="id"> aF</span><span class="id"> -&gt;</span><span class="id"> rF}</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;A ^f&quot;</span><span class="id"> :=</span> (<span class="id">map_mx</span><span class="id"> f</span><span class="id"> A</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Gaussian_elimination_map</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Gaussian_elimination_</span><span class="id"> A^f</span><span class="id"> =</span> ((<span class="id">col_ebase</span><span class="id"> A</span>)<span class="id">^f,</span> (<span class="id">row_ebase</span><span class="id"> A</span>)<span class="id">^f,</span><span class="id"> \rank</span><span class="id"> A</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> mxrankE</span><span class="id"> /row_ebase</span><span class="id"> /col_ebase</span><span class="id"> unlock</span>.<br/>
<span class="id">elim:</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> [|n]</span><span class="id"> A</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ?map_mx1</span><span class="id"> //</span>.<br/>
<span class="id">set</span><span class="id"> pAnz</span><span class="id"> :=</span><span class="id"> [pred</span><span class="id"> k</span><span class="id"> |</span><span class="id"> A</span><span class="id"> k</span>.<span class="id">1</span><span class="id"> k</span>.<span class="id">2</span><span class="id"> !=</span><span class="id"> 0]</span>.<br/>
<span class="id">rewrite</span> (<span class="id">@eq_pick</span><span class="id"> _</span><span class="id"> _</span><span class="id"> pAnz</span>)<span class="id"> =&gt;</span><span class="id"> [|k];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> mxE</span><span class="id"> fmorph_eq0</span>.<br/>
<span class="id">case:</span><span class="id"> {+}</span>(<span class="id">pick</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> [[i</span><span class="id"> j]|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !map_mx1</span>.<br/>
<span class="id">rewrite</span><span class="id"> mxE</span><span class="id"> -fmorphV</span> <span class="id"> -map_xcol</span><span class="id"> -map_xrow</span><span class="id"> -map_dlsubmx</span><span class="id"> -map_drsubmx</span>.<br/>
<span class="id">rewrite</span><span class="id"> -map_ursubmx</span><span class="id"> -map_mxZ</span><span class="id"> -map_mxM</span><span class="id"> -map_mxB</span><span class="id"> {}IHm</span><span class="id"> /=</span>.<br/>
<span class="id">case:</span><span class="id"> {+}</span>(<span class="id">Gaussian_elimination_</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> [[L</span><span class="id"> U]</span><span class="id"> r]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> map_xrow</span><span class="id"> map_xcol</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">@map_block_mx</span><span class="id"> _</span><span class="id"> _</span><span class="id"> f</span><span class="id"> 1</span><span class="id"> _</span><span class="id"> 1</span>)<span class="id"> !map_mx0</span><span class="id"> ?map_mx1</span><span class="id"> ?map_scalar_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mxrank_map</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> \rank</span><span class="id"> A^f</span><span class="id"> =</span><span class="id"> \rank</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mxrankE</span><span class="id"> Gaussian_elimination_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_free_map</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_free</span><span class="id"> A^f</span><span class="id"> =</span><span class="id"> row_free</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_free</span><span class="id"> mxrank_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> row_full_map</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><span class="id"> row_full</span><span class="id"> A^f</span><span class="id"> =</span><span class="id"> row_full</span><span class="id"> A</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /row_full</span><span class="id"> mxrank_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_row_ebase</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">row_ebase</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> row_ebase</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {2}/row_ebase</span><span class="id"> unlock</span><span class="id"> Gaussian_elimination_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_col_ebase</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">col_ebase</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> col_ebase</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> {2}/col_ebase</span><span class="id"> unlock</span><span class="id"> Gaussian_elimination_map</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_row_base</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">row_base</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">mxrank_map</span><span class="id"> A,</span><span class="id"> erefl</span><span class="id"> n</span>) (<span class="id">row_base</span><span class="id"> A^f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span> (<span class="id">mxrank_map</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> {2}/row_base</span><span class="id"> mxrank_map</span><span class="id"> =&gt;</span><span class="id"> eqrr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> castmx_id</span><span class="id"> map_mxM</span><span class="id"> map_pid_mx</span><span class="id"> map_row_ebase</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_col_base</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">col_base</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> castmx</span> (<span class="id">erefl</span><span class="id"> m,</span><span class="id"> mxrank_map</span><span class="id"> A</span>) (<span class="id">col_base</span><span class="id"> A^f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span> (<span class="id">mxrank_map</span><span class="id"> A</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> {2}/col_base</span><span class="id"> mxrank_map</span><span class="id"> =&gt;</span><span class="id"> eqrr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> castmx_id</span><span class="id"> map_mxM</span><span class="id"> map_pid_mx</span><span class="id"> map_col_ebase</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_pinvmx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">pinvmx</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> pinvmx</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !map_mxM</span><span class="id"> !map_invmx</span><span class="id"> map_row_ebase</span><span class="id"> map_col_ebase</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> map_pid_mx</span><span class="id"> -mxrank_map</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_kermx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">kermx</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> kermx</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !map_mxM</span><span class="id"> map_invmx</span><span class="id"> map_col_ebase</span><span class="id"> -mxrank_map</span><span class="id"> map_copid_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_cokermx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">cokermx</span><span class="id"> A</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> cokermx</span><span class="id"> A^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !map_mxM</span><span class="id"> map_invmx</span><span class="id"> map_row_ebase</span><span class="id"> -mxrank_map</span><span class="id"> map_copid_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_submx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A^f</span><span class="id"> &lt;=</span><span class="id"> B^f</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;=</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !submxE</span><span class="id"> -map_cokermx</span><span class="id"> -map_mxM</span><span class="id"> map_mx_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_ltmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A^f</span><span class="id"> &lt;</span><span class="id"> B^f</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> &lt;</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ltmx</span><span class="id"> !map_submx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_eqmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">A^f</span><span class="id"> :=:</span><span class="id"> B^f</span>)<span class="id">%MS</span><span class="id"> &lt;-&gt;</span> (<span class="id">A</span><span class="id"> :=:</span><span class="id"> B</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [/eqmxP|eqAB];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !map_submx</span><span class="id"> =&gt;</span><span class="id"> /eqmxP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !map_submx</span><span class="id"> !eqAB</span><span class="id"> !submx_refl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_genmx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">&lt;&lt;A&gt;&gt;^f</span><span class="id"> :=:</span><span class="id"> &lt;&lt;A^f&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">genmxE,</span><span class="id"> map_submx</span>)<span class="id"> andbb</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_addsmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(((<span class="id">A</span><span class="id"> +</span><span class="id"> B</span>)<span class="id">%MS</span>)<span class="id">^f</span><span class="id"> :=:</span><span class="id"> A^f</span><span class="id"> +</span><span class="id"> B^f</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !addsmxE</span><span class="id"> -map_col_mx</span><span class="id"> !map_submx</span><span class="id"> !addsmxE</span><span class="id"> andbb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_capmx_gen</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">capmx_gen</span><span class="id"> A</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> capmx_gen</span><span class="id"> A^f</span><span class="id"> B^f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_mxM</span><span class="id"> map_lsubmx</span><span class="id"> map_kermx</span><span class="id"> map_col_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_capmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">A</span><span class="id"> :&amp;:</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> :=:</span><span class="id"> A^f</span><span class="id"> :&amp;:</span><span class="id"> B^f</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !capmxE</span><span class="id"> -map_capmx_gen</span><span class="id"> !map_submx</span><span class="id"> -!capmxE</span><span class="id"> andbb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_complmx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A^C^f</span><span class="id"> =</span><span class="id"> A^f^C</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_mxM</span><span class="id"> map_row_ebase</span><span class="id"> -mxrank_map</span><span class="id"> map_copid_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_diffmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">A</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">B</span><span class="id"> :</span><span class="id"> 'M_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">A</span><span class="id"> :\:</span><span class="id"> B</span>)<span class="id">^f</span><span class="id"> :=:</span><span class="id"> A^f</span><span class="id"> :\:</span><span class="id"> B^f</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !diffmxE</span><span class="id"> -map_capmx_gen</span><span class="id"> -map_complmx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -!map_capmx</span><span class="id"> !map_submx</span><span class="id"> -!diffmxE</span><span class="id"> andbb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_eigenspace</span><span class="id"> n</span> (<span class="id">g</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> a</span><span class="id"> :</span> (<span class="id">eigenspace</span><span class="id"> g</span><span class="id"> a</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> eigenspace</span><span class="id"> g^f</span> (<span class="id">f</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_kermx</span><span class="id"> map_mxB</span><span class="id"> ?map_scalar_mx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eigenvalue_map</span><span class="id"> n</span> (<span class="id">g</span><span class="id"> :</span><span class="id"> 'M_n</span>)<span class="id"> a</span><span class="id"> :</span><span class="id"> eigenvalue</span><span class="id"> g^f</span> (<span class="id">f</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> eigenvalue</span><span class="id"> g</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /eigenvalue</span><span class="id"> -map_eigenspace</span><span class="id"> map_mx_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> memmx_map</span><span class="id"> m</span><span class="id"> n</span><span class="id"> A</span> (<span class="id">E</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">A^f</span><span class="id"> \in</span><span class="id"> E^f</span>)<span class="id">%MS</span><span class="id"> =</span> (<span class="id">A</span><span class="id"> \in</span><span class="id"> E</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -map_mxvec</span><span class="id"> map_submx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_mulsmx</span><span class="id"> m1</span><span class="id"> m2</span><span class="id"> n</span> (<span class="id">E1</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m1,</span><span class="id"> n</span>)) (<span class="id">E2</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m2,</span><span class="id"> n</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">E1</span><span class="id"> *</span><span class="id"> E2</span>)<span class="id">%MS^f</span><span class="id"> :=:</span><span class="id"> E1^f</span><span class="id"> *</span><span class="id"> E2^f</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mulsmx;</span><span class="id"> elim/big_rec2:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> A</span><span class="id"> Af</span><span class="id"> _</span><span class="id"> eqA];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> map_mx0</span>.<br/>
<span class="id">apply:</span> (<span class="id">eqmx_trans</span> (<span class="id">map_addsmx</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> apply:</span><span class="id"> adds_eqmx</span><span class="id"> {A</span><span class="id"> Af}eqA</span>.<br/>
<span class="id">apply/eqmxP;</span><span class="id"> rewrite</span><span class="id"> !map_genmx</span><span class="id"> !genmxE</span><span class="id"> map_mxM</span>.<br/>
<span class="id">apply/rV_eqP=&gt;</span><span class="id"> u;</span><span class="id"> congr</span> (<span class="id">u</span><span class="id"> &lt;=</span><span class="id"> _</span><span class="id"> *m</span><span class="id"> _</span>)<span class="id">%MS</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> map_lin_mx</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> map_mxM</span><span class="id"> //</span><span class="id"> map_vec_mx</span><span class="id"> map_row</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_cent_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">E</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> (<span class="id">'C</span>(<span class="id">E</span>)<span class="id">%MS</span>)<span class="id">^f</span><span class="id"> =</span><span class="id"> 'C</span>(<span class="id">E^f</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> map_kermx;</span><span class="id"> congr</span><span class="id"> kermx;</span><span class="id"> apply:</span><span class="id"> map_lin_mx</span><span class="id"> =&gt;</span><span class="id"> A;</span><span class="id"> rewrite</span><span class="id"> map_mxM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (_<span class="id"> *m</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> map_lin_mx</span><span class="id"> =&gt;</span><span class="id"> B;</span><span class="id"> rewrite</span><span class="id"> map_mxB</span><span class="id"> ?map_mxM</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> map_center_mx</span><span class="id"> m</span><span class="id"> n</span> (<span class="id">E</span><span class="id"> :</span><span class="id"> 'A_</span>(<span class="id">m,</span><span class="id"> n</span>))<span class="id"> :</span> ((<span class="id">'Z</span>(<span class="id">E</span>))<span class="id">^f</span><span class="id"> :=:</span><span class="id"> 'Z</span>(<span class="id">E^f</span>))<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /center_mx</span><span class="id"> -map_cent_mx;</span><span class="id"> apply:</span><span class="id"> map_capmx</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MapMatrixSpaces</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> RowColDiagBlockMatrix</span>.<br/>
<span class="vernacular">Import</span><span class="id"> tagnat</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {F</span><span class="id"> :</span><span class="id"> fieldType}</span><span class="id"> {n</span><span class="id"> :</span><span class="id"> nat}</span><span class="id"> {p_</span><span class="id"> :</span><span class="id"> 'I_n</span><span class="id"> -&gt;</span><span class="id"> nat}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqmx_col</span><span class="id"> {m}</span> (<span class="id">V_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[F]_</span>(<span class="id">p_</span><span class="id"> i,</span><span class="id"> m</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\mxcol_i</span><span class="id"> V_</span><span class="id"> i</span><span class="id"> :=:</span><span class="id"> \sum_i</span><span class="id"> &lt;&lt;V_</span><span class="id"> i&gt;&gt;</span>)<span class="id">%MS</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqmxP/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/row_subP</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> row_mxcol</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">sumsmx_sup</span> (<span class="id">sig1</span><span class="id"> i</span>))<span class="id">//</span><span class="id"> genmxE</span><span class="id"> row_sub</span>.<br/>
<span class="id">apply/sumsmx_subP</span><span class="id"> =&gt;</span><span class="id"> i0</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> genmxE;</span><span class="id"> apply/row_subP</span><span class="id"> =&gt;</span><span class="id"> j</span>.<br/>
<span class="id">apply:</span> (<span class="id">eq_row_sub</span> (<span class="id">Rank</span><span class="id"> _</span><span class="id"> j</span>))<span class="id">;</span><span class="id"> apply/rowP</span><span class="id"> =&gt;</span><span class="id"> k</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mxE</span><span class="id"> Rank2K;</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> esym;</span><span class="id"> rewrite</span><span class="id"> cast_ord_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> rank_mxdiag</span> (<span class="id">V_</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 'M[F]_</span>(<span class="id">p_</span><span class="id"> i</span>))<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\rank</span> (<span class="id">\mxdiag_i</span><span class="id"> V_</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_i</span><span class="id"> \rank</span> (<span class="id">V_</span><span class="id"> i</span>))<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> {+}n</span><span class="id"> {+}p_</span><span class="id"> V_</span><span class="id"> =&gt;</span><span class="id"> [|m</span><span class="id"> IHm]</span><span class="id"> q_</span><span class="id"> V_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span> (<span class="id">\mxdiag__</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !big_ord0</span><span class="id"> =&gt;</span><span class="id"> M;</span><span class="id"> rewrite</span><span class="id"> flatmx0</span><span class="id"> mxrank0</span>.<br/>
<span class="id">rewrite</span><span class="id"> mxdiag_recl</span><span class="id"> [RHS]big_ord_recl/=</span><span class="id"> -IHm</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> mxsize_recl;</span><span class="id"> rewrite</span><span class="id"> ?castmx_id</span><span class="id"> rank_diag_block_mx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> RowColDiagBlockMatrix</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/affeldt-aist/rocqnavi/">rocqnavi</a></div>
    </div>
  </div>
    </main>
</body>
</html>
